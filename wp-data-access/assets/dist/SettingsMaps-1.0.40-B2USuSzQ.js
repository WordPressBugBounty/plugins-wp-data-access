import{j as t}from"./cm-1.0.40-DO7MoydR.js";import{l as h,h as C,R as S,A as y,cq as E}from"./lib-1.0.40-CJM-IO_o.js";import{u as F}from"./useStoreTable-1.0.40-C_-ljzWa.js";import{a as T}from"./hooks-1.0.40-DoKijNI1.js";import{u as k}from"./useTableUpdater-1.0.40-0UQrI-Q9.js";import{u as B}from"./useMetadata-1.0.40-DdsiIGYX.js";import{c as D,d as L,e as R}from"./BuilderMenu-1.0.40-wmot84K1.js";import{P as w}from"./PremiumFeature-1.0.40-C4a0KOip.js";import{M as P,C as v}from"./MapsApiKey-1.0.40-nYTtqqiU.js";import{u as K}from"./useApp-1.0.40-BcA7hdP2.js";import{r as f}from"./redux-1.0.40-W_04YL6Z.js";import{A as U,a as z}from"./AccordionSummary-1.0.40-BaFEiNF8.js";import{A as H}from"./AccordionDetails-1.0.40-AFOWsBZA.js";import{F as b,a as M}from"./FormHelperText-1.0.40-D6buAdoc.js";import{F as N}from"./FormControlLabel-1.0.40-BH1qH5qy.js";import{S as q}from"./Switch-1.0.40-CJ3Ir4CS.js";import{B as x}from"./Spinner-1.0.40-Bmn0_C4u.js";import{T as _,a as j}from"./ToggleButtonGroup-1.0.40-NUyVrBPO.js";import{u as G,S as O,a as W,b as J,c as Z}from"./SettingsMapMarkers-1.0.40-D1ScLBC8.js";import"./vendor-1.0.40-CN03Eozo.js";import"./loglevel-1.0.40-BZ7XahX3.js";import"./lodash-1.0.40-yZQKpWII.js";import"./moment-1.0.40-C5S46NFB.js";import"./iconBase-1.0.40-CH6TO7hF.js";import"./Typography-1.0.40-oRKYqE3b.js";import"./useEnhancedEffect-1.0.40-DvrM_gBo.js";import"./index-1.0.40-DmMQghWt.js";import"./notistack-1.0.40-HUa4vT_u.js";import"./ConfirmDialog-1.0.40-DRjx8-xC.js";import"./AdminTheme-1.0.40-B669Ow89.js";import"./Menu-1.0.40-BKp7UqHL.js";import"./ThemeProvider-1.0.40-D9QtC9zH.js";import"./MenuItem-1.0.40-UKMJrtYZ.js";import"./index-1.0.40-DlucSO_j.js";import"./FormLabel-1.0.40-DLOepjQ0.js";import"./useFormControl-1.0.40-BL8koKXQ.js";import"./TextField-1.0.40-CejEr0KU.js";import"./Select-1.0.40-Db-Xnyoo.js";import"./utils-1.0.40-iop7lDec.js";import"./useControlled-1.0.40-B7yPDtn1.js";import"./createSvgIcon-1.0.40-DryBVjDb.js";import"./Link-1.0.40-rVkAFnTh.js";import"./Collapse-1.0.40-C90ayxyF.js";import"./SwitchBase-1.0.40-BQrnL2Sx.js";import"./useMapUpdater-1.0.40-BcGwfhdr.js";import"./CssUnitTextField-1.0.40-bZOEwhww.js";import"./RadioGroup-1.0.40-D9A3e6h3.js";import"./Radio-1.0.40-BfbkSgOE.js";import"./Slider-1.0.40-w2yGdRCB.js";import"./visuallyHidden-1.0.40-Dan1xhjv.js";import"./main-1.0.40.js";import"./react-number-format.es-1.0.40-BdajC67w.js";const Q=({appId:s,tableStore:d,updateTableSettings:l,setUpdateStatus:r})=>{var n;const p=B(s),c=f.useMemo(()=>{var a,m,u;let e=[];try{e=JSON.parse((u=(m=(a=p==null?void 0:p.app)==null?void 0:a.container)==null?void 0:m[0])==null?void 0:u.cnt_cls)}catch(A){h.error(A)}return e},[]);f.useEffect(()=>{g(C({appDbId:0,appId:s,appName:"",appTitle:"",appType:y.MAP,appCntId:0,appCntSeqNr:0,appDatabase:null,appTable:null,appColumns:c,appRelationTable:null,appRelationColumns:[],appRestApi:{authorization:S.AUTHORIZED,authorized_roles:[],authorized_users:[]},appAddToMenu:!1,appMenuTitle:"",appMetaData:void 0,mapApiKey:o.maps.apiKey,mapColumnLatitude:o.maps.columnLatitude,mapColumnLongitude:o.maps.columnLongitude}))},[]);const g=T(),i=K(),o=d.table;return f.useEffect(()=>{const e={...o.maps};e.apiKey=i.appMap.apiKey,e.columnLatitude=i.appMap.columnLatitude,e.columnLongitude=i.appMap.columnLongitude,l("maps",e)},[i.appMap]),t.jsxs(U,{disableGutters:!0,children:[t.jsx(z,{children:"Enable Map Integration"}),t.jsxs(H,{children:[t.jsxs(b,{fullWidth:!0,sx:{marginBottom:0},children:[t.jsx(N,{control:t.jsx(q,{checked:o.maps.enabled,onChange:e=>{const a={...o.maps};a.enabled=!o.maps.enabled,l("maps",a),e.stopPropagation()}}),label:"Enable"}),t.jsx(M,{component:"div",children:"Enable this feature to add a map to the table header or footer."})]}),((n=o==null?void 0:o.maps)==null?void 0:n.enabled)===!0&&t.jsxs(x,{sx:{display:"grid",gap:"20px",marginTop:"30px"},children:[t.jsxs("fieldset",{className:"pp-fieldset",children:[t.jsx("legend",{children:"Map Configuration"}),t.jsxs(x,{sx:{display:"grid",gap:"30px",marginTop:"5px"},children:[t.jsx(P,{app:i}),t.jsx(x,{sx:{"& .MuiFormHelperText-root > div":{marginBottom:"5px"}},children:t.jsx(v,{app:i})}),t.jsxs(x,{sx:{marginTop:"-10px"},children:[t.jsxs(_,{color:"primary",exclusive:!0,fullWidth:!0,value:"undocked",disabled:!0,onChange:(e,a)=>{const m={...o.maps};m.docked=a,l("maps",m),r(!0),e.stopPropagation()},children:[t.jsxs(j,{value:"top",disabled:d.state.masterDetailConditions!==void 0,children:[t.jsx(D,{})," Header"]}),t.jsxs(j,{value:"bottom",disabled:d.state.masterDetailConditions!==void 0,children:[t.jsx(L,{})," Footer"]}),t.jsxs(j,{value:"undocked",children:[t.jsx(R,{})," Undocked"]})]}),t.jsx(b,{children:t.jsx(M,{children:"Choose where the chart should be positioned: header, footer, or undocked. Charts for detail tables cannot be docked."})})]})]})]}),t.jsx(w,{title:"Some map configuration features require a premium license.",margin:"0"})]})]})]})},Zt=({appId:s})=>{var i,o;h.debug(s);const d=T(),l=k(s),r=F(s),p=G(s),c=(n,e,a)=>{const[m,...u]=e.split(".");return{...n,[m]:u.length?c(n[m],u.join("."),a):a}},g=(n,e)=>{h.debug(n,e);const a=c(r==null?void 0:r.table,n,e);h.debug(a),d(E({appId:s,tableSettings:a})),l(!0)};return t.jsxs(t.Fragment,{children:[t.jsx(Q,{appId:s,tableStore:r,updateTableSettings:g,setUpdateStatus:l}),((o=(i=r==null?void 0:r.table)==null?void 0:i.maps)==null?void 0:o.enabled)===!0&&t.jsxs(t.Fragment,{children:[t.jsx(O,{appId:s,mapSettings:p}),t.jsx(W,{appId:s,mapSettings:p}),t.jsx(J,{appId:s,mapSettings:p,disableRadiusSearch:!0}),t.jsx(Z,{appId:s,mapSettings:p})]})]})};export{Zt as default};
