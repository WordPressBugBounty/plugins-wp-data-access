import{s as et,l as i,r as u,_ as Ae,P as mt,j as e,A as We,a as f,u as tt,b as ht,e as d,C as R,c as ge,d as gt,f as Qe,g as st,h as He,i as Ge,S as ft,R as $,k as jt,m as Ve,n as bt,o as At,p as le,q as yt,t as Tt,v as Ct,w as vt,x as St,y as Ie,z as Dt,B as Rt,D as Ye,E as Je,F as It,G as wt,H as Nt,I as at,J as Mt,K as Ue,L as $e,M as Te,N as Lt,O as _t,Q as Et,T as kt,U as Pt,V as Ot,W as Ce,X as zt}from"./main-1.0.18.js";import{A as ne,a as Ft}from"./AdminTheme-1.0.18-73e13a4f.js";import{u as P,a as W,R as Bt}from"./RestApi-1.0.18-cb72bd79.js";import{R as qt,B as Wt,a as Qt,T as Ht,b as Gt,c as ve}from"./TabPanel-1.0.18-2d718e76.js";import{T as Se,C as oe}from"./ConfirmDialog-1.0.18-eb1f3988.js";import{A as rt,T as it,M as we,a as Vt,b as Yt,c as Jt,d as Ut,e as $t,f as Zt,g as Kt,h as nt,i as Xt,j as es,k as Ne,l as Me,m as ts,n as ss,o as as,p as rs,q as is,r as ns,s as os,t as ps,u as ls}from"./index.esm-1.0.18-12f13c4a.js";import{u as ye,C as cs,a as ds,b as us}from"./ComponentColumn-1.0.18-5c48b102.js";import{a as xs,b as ms,c as hs,d as gs,e as fs,f as js,g as bs,h as As,i as ys,j as Ts}from"./ActionsApp-1.0.18-0ab2bedd.js";import{B as n,S as ce}from"./Spinner-1.0.18-de8df990.js";/* empty css                        */import{T as Re}from"./Typography-1.0.18-dc3c0740.js";import{I as q,P as ot}from"./iconBase-1.0.18-3c21f5e2.js";import{C as de,a as ue,B as V}from"./CardContent-1.0.18-3d5e5525.js";import{T as De}from"./Tabs-1.0.18-d7d53c1e.js";import{F as Cs,a as vs}from"./index.esm-1.0.18-32f5cee0.js";import{F as Ss}from"./FileSaver.min-1.0.18-38588eff.js";import{C as Ds}from"./index-1.0.18-744bc51a.js";import{u as fe}from"./colorManipulator-1.0.18-95bf61ec.js";import{T as O}from"./Tooltip-1.0.18-5f32f0fd.js";import{L as K}from"./Link-1.0.18-41cc6055.js";import{M as Rs}from"./Menu-1.0.18-e8cb0649.js";import{M as Z}from"./MenuItem-1.0.18-0088f2a2.js";import{F as X,a as xe}from"./FormHelperText-1.0.18-8b4ce85f.js";import{F as pt}from"./FormControlLabel-1.0.18-2840e084.js";import{C as Is}from"./Checkbox-1.0.18-3ed60478.js";import{l as ws,D as k}from"./useTheme-1.0.18-c1f3f722.js";import{R as Ns}from"./RadioGroup-1.0.18-4960e4a8.js";import{F as Ze}from"./FormLabel-1.0.18-47dbe87d.js";import{R as Ke}from"./Radio-1.0.18-210e4079.js";import{A as je,C as be}from"./Autocomplete-1.0.18-a264f80a.js";import{T as H,I as lt,S as Le}from"./TextField-1.0.18-cf148b4e.js";import{S as Ms}from"./Switch-1.0.18-cbb6329b.js";import{P as Ls}from"./PremiumFeature-1.0.18-2f6283b7.js";import{B as _s}from"./index.esm-1.0.18-bb69b89a.js";import{C as _e}from"./CardHeader-1.0.18-1e38ceea.js";import{D as Es}from"./Divider-1.0.18-eca54fd7.js";import{c as ks}from"./index-1.0.18-bd94b546.js";import{S as Ps,a as Os,b as zs}from"./Stepper-1.0.18-05ecefbc.js";import{L as Fs}from"./ListItemIcon-1.0.18-7ee6feae.js";import{L as Bs}from"./ListItemText-1.0.18-4e83a23e.js";import qs from"./AppMetaData-1.0.18-dd1a9a22.js";import{T as Ws}from"./index.esm-1.0.18-1950fc28.js";/* empty css                    */import{v as Qs}from"./FallbackSpinner-1.0.18-e10446f4.js";import{T as Hs}from"./ThemeProvider-1.0.18-247b72cc.js";import{I as Gs}from"./InputAdornment-1.0.18-958a8148.js";const Vs=()=>{const s=P(p=>et(p));return i.debug("appApps",s),s},Ys=u.lazy(()=>Ae(()=>import("./SettingsApp-1.0.18-c19f84a8.js"),["./SettingsApp-1.0.18-c19f84a8.js","./main-1.0.18.js","./index.esm-1.0.18-12f13c4a.js","./Typography-1.0.18-dc3c0740.js","./iconBase-1.0.18-3c21f5e2.js","./TargetEnum-1.0.18-b82380d5.js","./ConfirmDialog-1.0.18-eb1f3988.js","./AdminTheme-1.0.18-73e13a4f.js","./DialogContent-1.0.18-5570cba4.js","./Modal-1.0.18-870f459d.js","./CardContent-1.0.18-3d5e5525.js","./ConfirmDialog-1.0.18-9bff3a93.css","./ActionsSettings-1.0.18-41fd8841.js","./RestApi-1.0.18-cb72bd79.js","./AccordionSummary-1.0.18-f9e114cf.js","./index-1.0.18-ff546563.js","./useSlot-1.0.18-71f9e7ae.js","./useControlled-1.0.18-12a74006.js","./Collapse-1.0.18-8e581380.js","./AccordionDetails-1.0.18-2900e110.js","./FormHelperText-1.0.18-8b4ce85f.js","./useFormControl-1.0.18-87a8487d.js","./PremiumFeature-1.0.18-2f6283b7.js","./index.esm-1.0.18-32f5cee0.js","./FormLabel-1.0.18-47dbe87d.js","./FormControlLabel-1.0.18-2840e084.js","./createStyled-1.0.18-b238c9ff.js","./Switch-1.0.18-cbb6329b.js","./SwitchBase-1.0.18-e2aa3211.js","./TextField-1.0.18-cf148b4e.js","./Menu-1.0.18-e8cb0649.js","./ThemeProvider-1.0.18-247b72cc.js","./Popover-1.0.18-54868205.js","./Grow-1.0.18-4ebc2ce8.js","./createSvgIcon-1.0.18-dcf0276e.js","./Spinner-1.0.18-de8df990.js","./TabPanel-1.0.18-2d718e76.js","./useScreenSize-1.0.18-62aeb4c4.js","./Tabs-1.0.18-d7d53c1e.js","./ComponentColumn-1.0.18-5c48b102.js","./ActionsExplorer-1.0.18-ae07c36b.js","./Autocomplete-1.0.18-a264f80a.js","./Close-1.0.18-d90e9fa7.js","./Popper-1.0.18-20544c9b.js","./ActionsApp-1.0.18-0ab2bedd.js","./Checkbox-1.0.18-3ed60478.js","./Tooltip-1.0.18-5f32f0fd.js","./Link-1.0.18-41cc6055.js","./FileSaver.min-1.0.18-38588eff.js","./index-1.0.18-744bc51a.js","./colorManipulator-1.0.18-95bf61ec.js","./MenuItem-1.0.18-0088f2a2.js","./useTheme-1.0.18-c1f3f722.js","./RadioGroup-1.0.18-4960e4a8.js","./Radio-1.0.18-210e4079.js","./index.esm-1.0.18-bb69b89a.js","./CardHeader-1.0.18-1e38ceea.js","./Divider-1.0.18-eca54fd7.js","./index-1.0.18-bd94b546.js","./Stepper-1.0.18-05ecefbc.js","./ListItemIcon-1.0.18-7ee6feae.js","./ListItemText-1.0.18-4e83a23e.js","./AppMetaData-1.0.18-dd1a9a22.js","./usePrepareStore-1.0.18-44f9cb72.js","./Chart-1.0.18-142bb265.js","./FallbackSpinner-1.0.18-e10446f4.js","./Alert-1.0.18-8e754392.js","./AlertTitle-1.0.18-0fd475c6.js","./index.esm-1.0.18-1950fc28.js","./InputAdornment-1.0.18-958a8148.js","./settings-1.0.18-871bbe9f.css","./main-1.0.18-5f42aabb.css"],import.meta.url)),Js=u.lazy(()=>Ae(()=>import("./SettingApps-1.0.18-a3f22bdf.js"),["./SettingApps-1.0.18-a3f22bdf.js","./main-1.0.18.js","./AccordionSummary-1.0.18-f9e114cf.js","./Typography-1.0.18-dc3c0740.js","./index-1.0.18-ff546563.js","./useSlot-1.0.18-71f9e7ae.js","./iconBase-1.0.18-3c21f5e2.js","./useControlled-1.0.18-12a74006.js","./Collapse-1.0.18-8e581380.js","./index.esm-1.0.18-12f13c4a.js","./AdminTheme-1.0.18-73e13a4f.js","./RestApi-1.0.18-cb72bd79.js","./TabPanel-1.0.18-2d718e76.js","./useScreenSize-1.0.18-62aeb4c4.js","./ThemeProvider-1.0.18-247b72cc.js","./Modal-1.0.18-870f459d.js","./Tabs-1.0.18-d7d53c1e.js","./createSvgIcon-1.0.18-dcf0276e.js","./ConfirmDialog-1.0.18-eb1f3988.js","./DialogContent-1.0.18-5570cba4.js","./CardContent-1.0.18-3d5e5525.js","./ConfirmDialog-1.0.18-9bff3a93.css","./ComponentColumn-1.0.18-5c48b102.js","./ActionsExplorer-1.0.18-ae07c36b.js","./FormHelperText-1.0.18-8b4ce85f.js","./useFormControl-1.0.18-87a8487d.js","./Autocomplete-1.0.18-a264f80a.js","./TextField-1.0.18-cf148b4e.js","./FormLabel-1.0.18-47dbe87d.js","./Menu-1.0.18-e8cb0649.js","./Popover-1.0.18-54868205.js","./Grow-1.0.18-4ebc2ce8.js","./Close-1.0.18-d90e9fa7.js","./Popper-1.0.18-20544c9b.js","./ActionsApp-1.0.18-0ab2bedd.js","./Spinner-1.0.18-de8df990.js","./FormControlLabel-1.0.18-2840e084.js","./createStyled-1.0.18-b238c9ff.js","./Checkbox-1.0.18-3ed60478.js","./SwitchBase-1.0.18-e2aa3211.js","./Tooltip-1.0.18-5f32f0fd.js","./Link-1.0.18-41cc6055.js","./index.esm-1.0.18-32f5cee0.js","./FileSaver.min-1.0.18-38588eff.js","./index-1.0.18-744bc51a.js","./colorManipulator-1.0.18-95bf61ec.js","./MenuItem-1.0.18-0088f2a2.js","./useTheme-1.0.18-c1f3f722.js","./RadioGroup-1.0.18-4960e4a8.js","./Radio-1.0.18-210e4079.js","./Switch-1.0.18-cbb6329b.js","./PremiumFeature-1.0.18-2f6283b7.js","./index.esm-1.0.18-bb69b89a.js","./CardHeader-1.0.18-1e38ceea.js","./Divider-1.0.18-eca54fd7.js","./index-1.0.18-bd94b546.js","./Stepper-1.0.18-05ecefbc.js","./ListItemIcon-1.0.18-7ee6feae.js","./ListItemText-1.0.18-4e83a23e.js","./AppMetaData-1.0.18-dd1a9a22.js","./usePrepareStore-1.0.18-44f9cb72.js","./Chart-1.0.18-142bb265.js","./ActionsSettings-1.0.18-41fd8841.js","./TargetEnum-1.0.18-b82380d5.js","./FallbackSpinner-1.0.18-e10446f4.js","./Alert-1.0.18-8e754392.js","./AlertTitle-1.0.18-0fd475c6.js","./index.esm-1.0.18-1950fc28.js","./InputAdornment-1.0.18-958a8148.js","./settings-1.0.18-871bbe9f.css","./main-1.0.18-5f42aabb.css"],import.meta.url)),Us=u.lazy(()=>Ae(()=>import("./SettingsData-1.0.18-f8b0213d.js"),["./SettingsData-1.0.18-f8b0213d.js","./main-1.0.18.js","./ComponentColumn-1.0.18-5c48b102.js","./RestApi-1.0.18-cb72bd79.js","./Typography-1.0.18-dc3c0740.js","./ActionsExplorer-1.0.18-ae07c36b.js","./FormHelperText-1.0.18-8b4ce85f.js","./useFormControl-1.0.18-87a8487d.js","./Autocomplete-1.0.18-a264f80a.js","./TextField-1.0.18-cf148b4e.js","./index.esm-1.0.18-12f13c4a.js","./iconBase-1.0.18-3c21f5e2.js","./FormLabel-1.0.18-47dbe87d.js","./Menu-1.0.18-e8cb0649.js","./ThemeProvider-1.0.18-247b72cc.js","./Popover-1.0.18-54868205.js","./Modal-1.0.18-870f459d.js","./Grow-1.0.18-4ebc2ce8.js","./useControlled-1.0.18-12a74006.js","./createSvgIcon-1.0.18-dcf0276e.js","./Close-1.0.18-d90e9fa7.js","./index-1.0.18-ff546563.js","./Popper-1.0.18-20544c9b.js","./AdminTheme-1.0.18-73e13a4f.js","./ActionsApp-1.0.18-0ab2bedd.js","./Spinner-1.0.18-de8df990.js","./FormControlLabel-1.0.18-2840e084.js","./createStyled-1.0.18-b238c9ff.js","./Checkbox-1.0.18-3ed60478.js","./SwitchBase-1.0.18-e2aa3211.js","./Tooltip-1.0.18-5f32f0fd.js","./Link-1.0.18-41cc6055.js","./PremiumFeature-1.0.18-2f6283b7.js","./index.esm-1.0.18-32f5cee0.js","./AccordionSummary-1.0.18-f9e114cf.js","./useSlot-1.0.18-71f9e7ae.js","./Collapse-1.0.18-8e581380.js","./AccordionDetails-1.0.18-2900e110.js","./RadioGroup-1.0.18-4960e4a8.js","./Radio-1.0.18-210e4079.js","./MenuItem-1.0.18-0088f2a2.js","./TabPanel-1.0.18-2d718e76.js","./useScreenSize-1.0.18-62aeb4c4.js","./Tabs-1.0.18-d7d53c1e.js","./ConfirmDialog-1.0.18-eb1f3988.js","./DialogContent-1.0.18-5570cba4.js","./CardContent-1.0.18-3d5e5525.js","./ConfirmDialog-1.0.18-9bff3a93.css","./FileSaver.min-1.0.18-38588eff.js","./index-1.0.18-744bc51a.js","./colorManipulator-1.0.18-95bf61ec.js","./useTheme-1.0.18-c1f3f722.js","./Switch-1.0.18-cbb6329b.js","./index.esm-1.0.18-bb69b89a.js","./CardHeader-1.0.18-1e38ceea.js","./Divider-1.0.18-eca54fd7.js","./index-1.0.18-bd94b546.js","./Stepper-1.0.18-05ecefbc.js","./ListItemIcon-1.0.18-7ee6feae.js","./ListItemText-1.0.18-4e83a23e.js","./AppMetaData-1.0.18-dd1a9a22.js","./usePrepareStore-1.0.18-44f9cb72.js","./Chart-1.0.18-142bb265.js","./ActionsSettings-1.0.18-41fd8841.js","./TargetEnum-1.0.18-b82380d5.js","./FallbackSpinner-1.0.18-e10446f4.js","./Alert-1.0.18-8e754392.js","./AlertTitle-1.0.18-0fd475c6.js","./index.esm-1.0.18-1950fc28.js","./InputAdornment-1.0.18-958a8148.js","./settings-1.0.18-871bbe9f.css","./main-1.0.18-5f42aabb.css"],import.meta.url)),$s=u.lazy(()=>Ae(()=>import("./SettingsAuthorization-1.0.18-f31dd7e8.js"),["./SettingsAuthorization-1.0.18-f31dd7e8.js","./main-1.0.18.js","./RestApi-1.0.18-cb72bd79.js","./Typography-1.0.18-dc3c0740.js","./index.esm-1.0.18-12f13c4a.js","./iconBase-1.0.18-3c21f5e2.js","./Spinner-1.0.18-de8df990.js","./FormControlLabel-1.0.18-2840e084.js","./useFormControl-1.0.18-87a8487d.js","./createStyled-1.0.18-b238c9ff.js","./Switch-1.0.18-cbb6329b.js","./SwitchBase-1.0.18-e2aa3211.js","./useControlled-1.0.18-12a74006.js","./index-1.0.18-ff546563.js","./FormHelperText-1.0.18-8b4ce85f.js","./Link-1.0.18-41cc6055.js","./TextField-1.0.18-cf148b4e.js","./FormLabel-1.0.18-47dbe87d.js","./Menu-1.0.18-e8cb0649.js","./ThemeProvider-1.0.18-247b72cc.js","./Popover-1.0.18-54868205.js","./Modal-1.0.18-870f459d.js","./Grow-1.0.18-4ebc2ce8.js","./createSvgIcon-1.0.18-dcf0276e.js","./index-1.0.18-744bc51a.js","./Tooltip-1.0.18-5f32f0fd.js","./Popper-1.0.18-20544c9b.js","./AccordionSummary-1.0.18-f9e114cf.js","./useSlot-1.0.18-71f9e7ae.js","./Collapse-1.0.18-8e581380.js","./AccordionDetails-1.0.18-2900e110.js","./AdminTheme-1.0.18-73e13a4f.js","./TabPanel-1.0.18-2d718e76.js","./useScreenSize-1.0.18-62aeb4c4.js","./Tabs-1.0.18-d7d53c1e.js","./ConfirmDialog-1.0.18-eb1f3988.js","./DialogContent-1.0.18-5570cba4.js","./CardContent-1.0.18-3d5e5525.js","./ConfirmDialog-1.0.18-9bff3a93.css","./ComponentColumn-1.0.18-5c48b102.js","./ActionsExplorer-1.0.18-ae07c36b.js","./Autocomplete-1.0.18-a264f80a.js","./Close-1.0.18-d90e9fa7.js","./ActionsApp-1.0.18-0ab2bedd.js","./Checkbox-1.0.18-3ed60478.js","./index.esm-1.0.18-32f5cee0.js","./FileSaver.min-1.0.18-38588eff.js","./colorManipulator-1.0.18-95bf61ec.js","./MenuItem-1.0.18-0088f2a2.js","./useTheme-1.0.18-c1f3f722.js","./RadioGroup-1.0.18-4960e4a8.js","./Radio-1.0.18-210e4079.js","./PremiumFeature-1.0.18-2f6283b7.js","./index.esm-1.0.18-bb69b89a.js","./CardHeader-1.0.18-1e38ceea.js","./Divider-1.0.18-eca54fd7.js","./index-1.0.18-bd94b546.js","./Stepper-1.0.18-05ecefbc.js","./ListItemIcon-1.0.18-7ee6feae.js","./ListItemText-1.0.18-4e83a23e.js","./AppMetaData-1.0.18-dd1a9a22.js","./usePrepareStore-1.0.18-44f9cb72.js","./Chart-1.0.18-142bb265.js","./ActionsSettings-1.0.18-41fd8841.js","./TargetEnum-1.0.18-b82380d5.js","./FallbackSpinner-1.0.18-e10446f4.js","./Alert-1.0.18-8e754392.js","./AlertTitle-1.0.18-0fd475c6.js","./index.esm-1.0.18-1950fc28.js","./InputAdornment-1.0.18-958a8148.js","./settings-1.0.18-871bbe9f.css","./main-1.0.18-5f42aabb.css"],import.meta.url)),Zs=({appDbId:s})=>{var z,F;i.debug(s);const p=W(),t=ye(),c=((z=ne)==null?void 0:z.palette.mode)===mt.LIGHT?(F=ne)==null?void 0:F.palette.primary.main:"",[j,l]=u.useState(!1);i.debug(j);const[m,g]=u.useState(!1);i.debug(m);const C=()=>{p(tt({}))},a=()=>{j?g(!0):C()},o=()=>{if(!t.appName)return d("App name is required",{variant:"error"}),!1;if(!t.appTitle)return d("App title is required",{variant:"error"}),!1;if(t.appType==f.APPCONTAINER)t.appApps.length===0&&d("No apps added",{variant:"info"});else{if(!t.appDatabase)return d("Database is required",{variant:"error"}),!1;if(t.appType==f.CHART){if(!t.appQuery)return d("SQL query is required",{variant:"error"}),!1}else{if(!t.appTable)return d("Table is required",{variant:"error"}),!1;if(t.appColumns.filter(T=>T.isSelected).length===0)return d("At least one column must be selected",{variant:"error"}),!1}}return!0},h=()=>{o()&&xs(t,T=>{if(i.debug(T),T!=null&&T.code&&(T==null?void 0:T.message)!==void 0)switch(T.code){case"ok":d(T.message,{variant:"success"}),p(ge({}));break;case"info":d(T.message,{variant:"info"});break;default:i.error(T),d(T.message??R.contactSupport,{variant:"error"})}else i.error(T),d(R.contactSupport,{variant:"error"})},T=>{i.error("error",T),d(T??R.contactSupport,{variant:"error"})})},D=()=>{o()&&(h(),C())},w=T=>{p(ht({anchor:T}))},[N,b]=u.useState("1"),S=(T,_)=>{b(_)};return e.jsxs(e.Fragment,{children:[e.jsxs(qt,{closeDrawer:a,children:[e.jsx(rt,{position:"static",elevation:4,sx:{borderRadius:0},children:e.jsxs(it,{className:"pp-setting-toolbar",sx:{borderRadius:0},children:[e.jsxs(n,{sx:{flexGrow:1},children:[e.jsx(Re,{variant:"h5",noWrap:!0,component:"div",className:"unselectable",sx:{paddingLeft:"6px"},children:"Manage App"}),e.jsx(Re,{sx:{fontSize:"10px",paddingLeft:"10px"},children:t.appName})]}),e.jsx(Se,{title:"Dock to left",position:"bottom",children:e.jsx(q,{onClick:()=>{w(We.LEFT)},size:"large",color:"inherit",sx:{fontSize:"1em"},children:e.jsx(Wt,{})})}),e.jsx(Se,{title:"Dock to right",position:"bottom",children:e.jsx(q,{onClick:()=>{w(We.RIGHT)},size:"large",color:"inherit",sx:{fontSize:"1em"},children:e.jsx(Qt,{})})}),e.jsx(Se,{title:"Close",position:"bottom",children:e.jsx(q,{onClick:a,size:"large",color:"inherit",sx:{fontSize:"1.4em"},children:e.jsx(we,{})})})]})}),e.jsx(de,{className:"pp-settings-container",children:e.jsx(ue,{sx:{padding:0,margin:0},children:e.jsxs(Ht,{value:N,children:[e.jsxs(Gt,{variant:"fullWidth",textColor:"primary",onChange:S,sx:{width:"100%",height:"80px",padding:0,margin:0,backgroundColor:"rgb(242, 242, 242)"},children:[e.jsx(De,{label:"App Info",value:"1",sx:{fontWeight:"bold",fontSize:"110%",height:"80px"}}),e.jsx(De,{label:t.appType==f.APPCONTAINER?"Apps":"Data Source",value:"2",sx:{fontWeight:"bold",fontSize:"110%",height:"80px"}}),e.jsx(De,{label:"Access",value:"3",sx:{fontWeight:"bold",fontSize:"110%",height:"80px"}})]}),e.jsxs(n,{sx:{margin:0,padding:0,overflowX:"hidden",overflowY:"auto",height:"calc(100vh - 250px)","& > div.MuiTabPanel-root":{padding:0}},children:[e.jsx(ve,{value:"1",children:e.jsx(u.Suspense,{fallback:e.jsx(ce,{}),children:e.jsx(Ys,{app:t,setIsUpdated:l})})}),e.jsx(ve,{value:"2",children:t.appType==f.APPCONTAINER?e.jsx(u.Suspense,{fallback:e.jsx(ce,{}),children:e.jsx(Js,{app:t,setIsUpdated:l})}):e.jsx(u.Suspense,{fallback:e.jsx(ce,{}),children:e.jsx(Us,{app:t,setIsUpdated:l})})}),e.jsx(ve,{value:"3",children:e.jsx(u.Suspense,{fallback:e.jsx(ce,{}),children:e.jsx($s,{app:t,setIsUpdated:l})})})]})]})})}),e.jsx(de,{className:"pp-setting-footer",sx:{borderRadius:0,backgroundColor:c},children:e.jsxs(ue,{className:"pp-setting-footer-buttons",sx:{borderRadius:0},children:[e.jsx(V,{variant:"outlined",className:"footer_action_button_apply",onClick:h,children:"Apply"}),e.jsx(V,{variant:"outlined",className:"footer_action_button",onClick:D,children:"OK"}),e.jsx(V,{variant:"outlined",className:"footer_action_button",onClick:a,children:"Cancel"})]})})]}),e.jsx(oe,{title:"Close App Manager?",message:"All uncommitted changes will be lost!",open:m,setOpen:g,onConfirm:()=>{C()},onKeep:()=>{C()}})]})},Ks=()=>{const s=P(p=>gt(p));return i.debug("showAppStructure",s),s},ct=({appType:s})=>s==f.APPCONTAINER?e.jsx(n,{sx:{fontSize:"26px",display:"flex",width:"28px",justifyContent:"center",alignContent:"center",marginRight:"5px"},children:e.jsx(Vt,{})}):s==f.DATAENTRY?e.jsx(n,{sx:{fontSize:"22px",display:"flex",width:"28px",justifyContent:"center",alignContent:"center",marginRight:"5px"},children:e.jsx(Yt,{})}):s==f.CHART?e.jsx(n,{sx:{fontSize:"22px",display:"flex",width:"28px",justifyContent:"center",alignContent:"center",marginRight:"5px"},children:e.jsx(Jt,{})}):s==f.REGISTRATION?e.jsx(n,{sx:{fontSize:"22px",display:"flex",width:"28px",justifyContent:"center",alignContent:"center",marginRight:"5px"},children:e.jsx(Cs,{})}):e.jsx(n,{sx:{fontSize:"20px",display:"flex",width:"28px",justifyContent:"center",alignContent:"center",marginRight:"5px"},children:e.jsx(vs,{})}),Xe=({app:s,density:p})=>{var J,U,te,Y;i.debug(s);const t=W(),[c,j]=u.useState(!1),[l,m]=u.useState(!1),[g,C]=u.useState(!1),[a,o]=u.useState(!1),h=r=>{let A={};try{A=JSON.parse(r.app_settings)}catch(M){A.rest_api={authorization:$.AUTHORIZED,authorized_roles:[],authorized_users:[]},i.error("Invalid JSON - app settings"),i.error(M),d("Invalid JSON, check console",{variant:"error"})}return A},D=r=>{ms(r,A=>{var se,Q,ae,x,v,B,G,re,L,me,ie,he,Ee,ke,Pe,Oe,ze,Fe,Be,qe;const M=A==null?void 0:A.data;if(i.debug("response data",M),M.app&&M.app.app&&Array.isArray(M.app.app)&&M.app.container&&Array.isArray(M.app.container)&&M.app.apps&&Array.isArray(M.app.apps)){const E=M.app.app[0];if(i.debug(E),E.app_type==f.APPCONTAINER){const I=h(E),pe=M.app.apps;i.debug(pe),t(He({appDbId:r,appId:Ge(r),appName:E.app_name,appTitle:E.app_title,appType:E.app_type,appCntId:0,appCntSeqNr:0,appDatabase:null,appTable:null,appColumns:[],appQuery:"",appRelationTable:null,appRelationColumns:[],appRestApi:I==null?void 0:I.rest_api,appAddToMenu:E.app_add_to_menu!=="0",appMenuTitle:((se=I==null?void 0:I.settings)==null?void 0:se.app_menu_title)??E.app_title,appMetaData:M,appLanguage:(Q=I==null?void 0:I.settings)==null?void 0:Q.app_language,fullScreen:((ae=I==null?void 0:I.settings)==null?void 0:ae.app_fullscreen)??!0,safeMode:((x=I==null?void 0:I.settings)==null?void 0:x.app_safe_mode)??!1,appApps:pe}))}else{const I=M.app.container[0];i.debug(I);let pe=[];try{pe=JSON.parse(I.cnt_cls)}catch(xt){i.error("Invalid JSON - app columns"),i.error(xt),d("Invalid JSON, check console",{variant:"error"})}const y=h(E);t(He({appDbId:r,appId:Ge(r),appName:E.app_name,appTitle:E.app_title,appType:E.app_type,appCntId:I.cnt_id,appCntSeqNr:I.cnt_seq_nr,appDatabase:I.cnt_dbs,appTable:I.cnt_tbl,appColumns:pe,appQuery:I.cnt_query??"",appRelationTable:null,appRelationColumns:[],appRestApi:y==null?void 0:y.rest_api,appAddToMenu:E.app_add_to_menu!=="0",appMenuTitle:((v=y==null?void 0:y.settings)==null?void 0:v.app_menu_title)??E.app_title,appMetaData:M,appLanguage:(B=y==null?void 0:y.settings)==null?void 0:B.app_language,fullScreen:((G=y==null?void 0:y.settings)==null?void 0:G.app_fullscreen)??!0,safeMode:((re=y==null?void 0:y.settings)==null?void 0:re.app_safe_mode)??!1,registrationMessage:((me=(L=y==null?void 0:y.settings)==null?void 0:L.app_registration)==null?void 0:me.message)??void 0,registrationShowMessage:((he=(ie=y==null?void 0:y.settings)==null?void 0:ie.app_registration)==null?void 0:he.showMessage)??!1,registrationAllowUpdates:((ke=(Ee=y==null?void 0:y.settings)==null?void 0:Ee.app_registration)==null?void 0:ke.allowUpdates)??!0,cacheData:((Oe=(Pe=y==null?void 0:y.settings)==null?void 0:Pe.app_chart)==null?void 0:Oe.cacheData)??!1,updateValue:((Fe=(ze=y==null?void 0:y.settings)==null?void 0:ze.app_chart)==null?void 0:Fe.updateValue)??12,updateUnit:((qe=(Be=y==null?void 0:y.settings)==null?void 0:Be.app_chart)==null?void 0:qe.updateUnit)??"h"}))}}else d(R.contactSupport,{variant:"error"})},A=>{i.error("error",A),d(A??R.contactSupport,{variant:"error"})})},w=()=>{hs(s.appId,r=>{if(i.debug(r),r!=null&&r.code&&(r==null?void 0:r.message)!==void 0)switch(r.code){case"ok":d(r.message,{variant:"success"}),t(ge({}));break;case"info":d(r.message,{variant:"info"});break;default:i.error(r),d(r.message??R.contactSupport,{variant:"error"})}else i.error(r),d(R.contactSupport,{variant:"error"});j(!1)},r=>{i.error("error",r),d(r??R.contactSupport,{variant:"error"}),j(!1)})},N=()=>{gs(s.appId,r=>{i.debug(r),r!=null&&r.code&&(r==null?void 0:r.message)!==void 0?r.data.data?Ss(new Blob([r.data.data],{type:"text/json;charset=utf-8"}),"wpda-export-"+s.appName+".sql"):(i.error(r),d(r.message??R.contactSupport,{variant:"error"})):(i.error(r),d(R.contactSupport,{variant:"error"})),j(!1)},r=>{i.error("error",r),d(r??R.contactSupport,{variant:"error"}),j(!1)})},b=r=>{fs(r,A=>{if(i.debug(A),A!=null&&A.code&&(A==null?void 0:A.message)!==void 0)switch(A.code){case"ok":d(A.message,{variant:"success"}),t(ge({}));break;case"info":d(A.message,{variant:"info"});break;default:i.error(A),d(A.message??R.contactSupport,{variant:"error"})}else i.error(A),d(R.contactSupport,{variant:"error"});C(!1)},A=>{i.error("error",A),d(A??R.contactSupport,{variant:"error"}),C(!1)})},S=()=>{if(b(s.appId),s.appType==f.APPCONTAINER&&a===!0){const r=et(ft.getState());r[s.appId]!==void 0&&Array.isArray(r[s.appId])&&(i.debug("start deleting detail apps",r[s.appId]),r[s.appId].map(A=>{i.debug("delete detail app",A),b(A)}))}},z=fe("(max-width:700px)"),F=fe("(max-width:900px)"),[T,_]=u.useState(null),ee=!!T;return e.jsxs(e.Fragment,{children:[e.jsxs(n,{sx:{display:"grid",gridTemplateColumns:"auto auto",justifyContent:"space-between",alignItems:"center",padding:p==="small"?"8px 8px 8px 12px":p==="medium"?"16px":"24px",...F&&{".pp-row-actions":{width:0}},"&:hover":{".pp-row-title":{display:F?"inline-block":"none"},".pp-row-actions":{visibility:F?"hidden":"visible"}}},children:[e.jsxs(n,{sx:{display:"grid",gridTemplateColumns:"auto auto",alignItems:"center"},children:[e.jsxs(n,{sx:{width:"100%",display:"grid",gridTemplateColumns:"auto 1fr",gridGap:p==="small"?"3px":p==="medium"?"6px":"9px",justifyContent:"center",alignItems:"center"},children:[e.jsx(ct,{appType:s.appType}),e.jsxs(n,{sx:{textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden"},children:[s.appName,e.jsxs(n,{className:"pp-row-title",sx:{display:"inline-block",marginLeft:"5px",fontSize:"80%"},children:["−",e.jsx(n,{sx:{display:"inline-block",width:"5px"}}),s.appTitle," (App ID: ",s.appId,")"]})]})]}),e.jsxs(n,{sx:{display:"grid",visibility:"hidden",gridTemplateColumns:"auto auto auto auto",gridGap:"10px",marginLeft:"10px",alignItems:"center"},className:"pp-row-actions",children:[e.jsx(n,{sx:{borderLeft:"1px solid black",height:"100%"}}),e.jsx(O,{title:"Manage App",children:e.jsx(K,{sx:{cursor:"pointer"},underline:"none",onClick:r=>{D(s.appId),r.preventDefault(),r.stopPropagation()},children:"Manage"})}),e.jsx(n,{sx:{borderLeft:"1px solid black",height:"100%"}}),e.jsx(O,{title:"Run & Build App",children:e.jsx(K,{sx:{cursor:"pointer"},underline:"none",onClick:r=>{t(Qe({isActive:!0,appDbId:s.appId})),r.preventDefault(),r.stopPropagation()},children:"Run & Build"})})]})]}),e.jsxs(n,{sx:{display:"grid",gridTemplateColumns:"auto auto auto auto auto auto auto",justifyContent:z?"end":"space-evenly",alignItems:"center"},children:[e.jsx(n,{sx:{paddingRight:"10px"},children:z?"":st(s.appType)}),e.jsx(O,{title:"Manage App",children:e.jsx(q,{sx:{color:(J=ne)==null?void 0:J.palette.primary.main},onClick:r=>{D(s.appId),r.preventDefault(),r.stopPropagation()},children:e.jsx(Ut,{})})}),e.jsx(O,{title:"Run & Build App",children:e.jsx(q,{sx:{color:(U=ne)==null?void 0:U.palette.primary.main},onClick:r=>{t(Qe({isActive:!0,appDbId:s.appId})),r.preventDefault(),r.stopPropagation()},children:e.jsx($t,{})})}),e.jsx(O,{title:"More App actions",children:e.jsx(q,{sx:{color:(te=ne)==null?void 0:te.palette.primary.main},onClick:r=>{_(r.currentTarget),r.preventDefault(),r.stopPropagation()},children:e.jsx(Zt,{})})}),e.jsxs(Rs,{id:"pp-app-builder-more-actions",anchorEl:T,open:ee,onClose:()=>{_(null)},MenuListProps:{"aria-labelledby":"pp-app-builder-more-actions"},sx:{zIndex:9999999999},anchorOrigin:{vertical:"top",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"right"},children:[e.jsxs(Z,{onClick:r=>{_(null),j(!0),r.preventDefault(),r.stopPropagation()},children:[e.jsx(Kt,{}),e.jsx("span",{style:{margin:"0 10px"},children:"Copy"})]}),e.jsxs(Z,{onClick:r=>{_(null),m(!0),r.preventDefault(),r.stopPropagation()},children:[e.jsx(nt,{}),e.jsx("span",{style:{margin:"0 10px"},children:"Export"})]}),e.jsx(Ds,{text:`[wpda_app app_id="${s.appId}"]`,onCopy:()=>{d(`Shortcode [wpda_app app_id="${s.appId}"] was copied to your clipboard`,{variant:"info"})},children:e.jsxs(Z,{onClick:r=>{_(null),r.preventDefault(),r.stopPropagation()},children:[e.jsx(Xt,{}),e.jsx("span",{style:{margin:"0 10px"},children:"Shortcode"})]})}),e.jsxs(Z,{onClick:r=>{_(null),C(!0),o(!1),r.preventDefault(),r.stopPropagation()},sx:{color:(Y=ne)==null?void 0:Y.palette.error.main},children:[e.jsx(es,{}),e.jsx("span",{style:{margin:"0 10px"},children:"Delete"})]})]})]})]}),c&&e.jsx(oe,{title:"Please confirm",message:"Copy this app including all containers?",open:c,setOpen:j,onConfirm:()=>w()}),l&&e.jsx(oe,{title:"Please confirm",message:"Export this app including all containers?",open:l,setOpen:m,onConfirm:()=>N()}),g&&e.jsx(oe,{title:"Delete App?",message:e.jsxs("div",{children:["Are you sure you want to delete app ",s.appName,"?",e.jsx("br",{}),e.jsx("strong",{children:"This action cannot be undone!"}),s.appType==f.APPCONTAINER&&e.jsxs(e.Fragment,{children:[e.jsx("br",{}),e.jsx("br",{}),e.jsx(X,{children:e.jsx(pt,{control:e.jsx(Is,{checked:a,onChange:(r,A)=>{o(A)}}),label:"Delete detail app?"})})]})]}),open:g,setOpen:C,onConfirm:()=>S()})]})},Xs=({apps:s,appApps:p,search:t,types:c,isLoading:j,density:l})=>{i.debug(s,p,t,c);const m=Ks(),g=o=>{if(c.length===0&&t.trim()==="")return!0;if(m&&p[o.appId]){let h=!1;if(p[o.appId].map(D=>{const w=s.filter(N=>N.appId==D)[0];w?(Ve(w.appName+" "+w.appTitle,t)&&(h=!0),c.filter(N=>N.id===Number(w.appType)).length>0&&(h=!0)):i.error(`Detail app lost? Data App ${o.appId} cannot find detail app ${D}!`)}),h)return!0}return!(!Ve(o.appName+" "+o.appTitle,t)||c.length>0&&c.filter(h=>h.id===Number(o.appType)).length===0)},C=s.filter(o=>g(o)?o:null),a=o=>p[o]?e.jsxs(n,{sx:{marginLeft:l==="small"?"48px":l==="medium"?"56px":"64px","& > div":{borderTop:"1px solid #ddd",borderRadius:"0 !important"}},children:[...p[o].map(h=>{const D=s.filter(w=>w.appId==h);return D.length>0?e.jsx(Xe,{app:D[0],density:l}):null})]}):null;return e.jsx(ot,{elevation:4,children:e.jsxs(n,{sx:{backgroundColor:"#fff",borderRadius:"4px",overflow:"hidden","& .MuiBox-root:first-of-type":{borderTopLeftRadius:"4px",borderTopRightRadius:"4px"},"& .MuiBox-root:hover":{backgroundColor:"rgb(242, 242, 242)"},"& .pp-app-details:nth-of-type(odd)":{backgroundColor:"#f9f9f9"}},children:[...s.map(o=>{const h=g(o);return m&&Object.keys(p).filter(D=>p[D].includes(Number(o.appId))).length>0?null:e.jsxs(n,{className:"pp-app-details"+(h?" pp-app-details-visible":""),sx:{visibility:h?"visible":"hidden",position:h?"relative":"fixed",borderTop:"1px solid #ddd","&:first-of-type":{borderTop:"unset"}},children:[e.jsx(Xe,{app:o,density:l}),m&&a(o.appId)]})}),C.length===0&&e.jsx(n,{sx:{padding:"35px",borderRadius:"4px"},children:j?e.jsx(ce,{title:"Loading apps...",align:jt.LEFT}):e.jsx(n,{children:"No apps found"})})]})})},dt=()=>{const s=P(p=>bt(p));return i.debug("apps",s),s},ut=()=>{const s=P(p=>At(p));return i.debug("appMetaData",s),s},ea=({setIsUpdated:s})=>{const p=W(),t=ye(),c=ut(),j=u.useMemo(()=>{const o=[];if((c==null?void 0:c.roles)!==void 0)for(const h in c.roles)o.push({key:h,value:c.roles[h]});return o},[c.roles]);i.debug(j);const l=u.useMemo(()=>{const o=[];if((c==null?void 0:c.users)!==void 0)for(const h in c.users)o.push({key:h,value:c.users[h]});return o},[c.users]);i.debug(l);const m=u.useMemo(()=>j.filter(o=>t.appRestApi.authorized_roles.includes(o.key)),[t.appRestApi.authorized_roles,j]),g=u.useMemo(()=>l.filter(o=>t.appRestApi.authorized_users.includes(o.key)),[t.appRestApi.authorized_users,l]),[C,a]=u.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsxs("fieldset",{className:"pp-fieldset",style:{padding:"20px"},children:[e.jsx("legend",{children:"Authorization"}),e.jsx(X,{sx:{width:"100%"},children:e.jsxs(Ns,{children:[e.jsxs(Ze,{className:"align-label-radio",sx:{cursor:"pointer"},children:[e.jsx(Ke,{checked:t.appRestApi.authorization===$.AUTHORIZED,onChange:o=>{p(le({restApiActions:{...t.appRestApi,authorization:$.AUTHORIZED}})),s&&s(!0),o.stopPropagation()}}),"Authorized access only"]}),e.jsxs(n,{sx:{display:"grid",gridGap:"10px",margin:"20px 20px 15px 42px"},children:[e.jsx(je,{multiple:!0,options:j,disableCloseOnSelect:!0,getOptionLabel:o=>o.value,value:m,onChange:(o,h)=>{p(le({restApiActions:{...t.appRestApi,authorized_roles:h.map(D=>D.key)}})),s&&s(!0),o.stopPropagation()},renderInput:o=>e.jsx(H,{...o,label:"Roles"}),renderTags:(o,h)=>o.map((D,w)=>{const{key:N,...b}=h({index:w});return e.jsx(be,{variant:"outlined",label:D.value,...b},N)})}),e.jsx(je,{multiple:!0,options:l,disableCloseOnSelect:!0,getOptionLabel:o=>o.value,value:g,onChange:(o,h)=>{p(le({restApiActions:{...t.appRestApi,authorized_users:h.map(D=>D.key)}})),s&&s(!0),o.stopPropagation()},renderInput:o=>e.jsx(H,{...o,label:"Users"}),renderTags:(o,h)=>o.map((D,w)=>{const{key:N,...b}=h({index:w});return e.jsx(be,{variant:"outlined",label:D.value,...b},N)})})]}),e.jsxs(Ze,{className:"align-label-radio",sx:{cursor:"pointer"},children:[e.jsx(Ke,{checked:t.appRestApi.authorization===$.ANONYMOUS,onChange:o=>{p(le({restApiActions:{...t.appRestApi,authorization:$.ANONYMOUS}})),s&&s(!0),o.stopPropagation()}}),"Anonymous access"]})]})})]}),e.jsx(X,{children:e.jsxs(xe,{component:"div",sx:{marginLeft:0},children:[e.jsx(n,{sx:{marginTop:"25px"},children:e.jsxs(K,{sx:{textDecoration:"none",cursor:"pointer",display:"inline-flex","& svg":{fontSize:"1rem",marginRight:"2px"}},onClick:()=>a(!C),children:[e.jsx(Ne,{}),"What is the difference between authorized and anonymous access?"]})}),C&&e.jsxs(e.Fragment,{children:[e.jsxs(n,{sx:{marginTop:"20px"},children:[e.jsx("strong",{children:"Authorized access:"}),e.jsxs("ul",{style:{listStyle:"disc",padding:"0 40px"},children:[e.jsx("li",{children:"Users with the selected roles can access this app"}),e.jsx("li",{children:"Selected users can access this app"}),e.jsx("li",{children:"Other registered users cannot access this app"}),e.jsx("li",{children:"Anonymous users cannot access this app"})]})]}),e.jsxs(n,{sx:{marginTop:"20px"},children:[e.jsx("strong",{children:"Anonymous access:"}),e.jsx("ul",{style:{listStyle:"disc",padding:"0 40px"},children:e.jsx("li",{children:"Any user can access this app"})})]}),e.jsx(n,{sx:{marginTop:"20px"},children:"App authorization is applied to both back-end and front-end usage. Back-end access is restricted to registered users only. A Data Table app displayed on the front-end typically allows anonymous access, enabling visitors to view the table. In contrast, Data Management apps usually require authorized access to prevent unauthorized users from altering table data."})]})]})})]})},ta=({app:s,setIsUpdated:p})=>{const t=W(),[c,j]=u.useState(!1),l=dt(),m=l.filter(a=>s.appDbId!==a.appId&&a.appType!=f.APPCONTAINER),g=[];s.appApps.map(a=>{const o=l.filter(h=>h.appId===a);o.length===1&&g.push(o[0])});const C=a=>a.appName+(c?" ("+a.appTitle+")":"");return e.jsxs(X,{sx:{width:"100%",marginTop:"8px"},children:[e.jsx(je,{multiple:!0,options:m,value:g,disableCloseOnSelect:!0,getOptionLabel:a=>C(a),onChange:(a,o)=>{t(yt({appApps:o.map(h=>h.appId)})),p&&p(!0),a.stopPropagation()},renderInput:a=>e.jsx(H,{...a,label:"Apps"}),renderTags:(a,o)=>a.map((h,D)=>{const{key:w,...N}=o({index:D});return e.jsx(be,{variant:"outlined",label:C(h),...N},w)})}),e.jsxs(xe,{component:"div",sx:{display:"grid",gridTemplateColumns:"auto auto",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("span",{children:"Apps will be added in the order they are entered here."}),e.jsx(pt,{sx:{"& span.MuiFormControlLabel-label":{fontSize:"0.75rem"}},control:e.jsx(Ms,{checked:c,onChange:a=>{j(!c),a.stopPropagation()}}),label:"Show title",labelPlacement:"end"})]})]})},sa=({app:s,hasErrors:p,setIsUpdated:t})=>{i.debug(s,p);const c=W();return e.jsx(H,{type:"text",label:"App Name",error:p,fullWidth:!0,required:!0,helperText:"App name must be unique.",value:s.appName,autoFocus:!0,autoComplete:"off",onChange:j=>{c(Tt({appName:j.target.value})),t&&t(!0)}})},aa=({app:s,hasErrors:p,setIsUpdated:t})=>{i.debug(s,p);const c=W();return e.jsx(H,{type:"text",label:"App Title",error:p,fullWidth:!0,required:!0,helperText:"App title describes the purpose of the app.",value:s.appTitle,autoComplete:"off",onChange:j=>{c(Ct({appTitle:j.target.value})),t&&t(!0)}})},ra=()=>{const s=P(p=>vt());return i.debug("appLanguage",s),s},ia=({app:s,setIsUpdated:p})=>{i.debug(s);const t=W();ut();const c=ra(),j=P(g=>St(g));i.debug("updateSiteLanguage",j),u.useEffect(()=>{const g={appLanguage:Ie.defaultLanguage.code};t(Dt(g))},[]);const[l,m]=u.useState(!1);return e.jsxs(n,{sx:{width:"100%"},children:[e.jsxs(X,{fullWidth:!0,disabled:!0,children:[e.jsx(lt,{variant:"outlined",children:"App Language"}),e.jsxs(Le,{MenuProps:{id:"pp-select-menu"},label:"App Language",value:c,onChange:g=>{},children:[...ws.map(g=>e.jsx(Z,{value:g.code,children:g.language},g.code))]}),e.jsx(xe,{children:"Selected app language is applied to all (master and detail) tables and forms."})]}),!1,e.jsx(X,{children:e.jsxs(xe,{component:"div",sx:{marginLeft:0},children:[e.jsx(n,{sx:{marginTop:"20px"},children:e.jsxs(K,{sx:{textDecoration:"none",cursor:"pointer",display:"inline-flex","& svg":{fontSize:"1rem",marginRight:"2px"}},onClick:()=>m(!l),children:[e.jsx(Ne,{}),"Which app information is localized?"]})}),l&&e.jsxs(e.Fragment,{children:[e.jsxs(n,{sx:{marginTop:"20px"},children:[e.jsx("strong",{children:"Information provided in the selected app language:"}),e.jsxs("ul",{style:{listStyle:"disc",padding:"0 40px"},children:[e.jsx("li",{children:"Tooltips"}),e.jsx("li",{children:"Field labels"}),e.jsx("li",{children:"Field hints"}),e.jsx("li",{children:"Info and success messages"}),e.jsx("li",{children:"Most error messages"})]})]}),e.jsxs(n,{sx:{marginTop:"20px"},children:[e.jsx("strong",{children:"Information not provided in the selected language:"}),e.jsxs("ul",{style:{listStyle:"disc",padding:"0 40px"},children:[e.jsx("li",{children:"Builders, Wizards and Managers are provided in English"}),e.jsx("li",{children:"Database and server errors are not translated"})]})]}),e.jsx(n,{sx:{marginTop:"20px"},children:"If you discover any translation errors, please let us know. We are committed to improving our translations."})]})]})}),e.jsx(Ls,{})]})},na=({setIsUpdated:s})=>{const p=W(),[t,c]=u.useState({});i.debug(t);const[j,l]=u.useState(!1),m=P(a=>Rt(a));i.debug("appQuery",m);const g=()=>{t!=null&&Object.keys(t).length===0?Bt(Ie.appUrlQueryBuilderList,{},a=>{i.debug(a),a.data!==void 0&&Array.isArray(a.data)?(c(a.data[0]),l(!0)):c({})},()=>{i.error("Error loading Query Builder list."),c({})}):l(!0)},C=a=>{p(It({appDatabase:t[a].schema_name})),p(Je({appQuery:Ye(t[a].query)})),s&&s(!0)};return e.jsxs(n,{sx:{width:"100%"},children:[e.jsxs(n,{sx:{display:"flex",justifyContent:"flex-end",marginBottom:"5px",position:"relative"},children:[e.jsxs(V,{variant:"contained",onClick:()=>{g()},children:["Import from Query Builder  ",e.jsx(nt,{})]}),j===!0&&t!==void 0&&t!==null&&Object.keys(t).length>0&&e.jsx(n,{sx:{position:"absolute",top:0,right:0},children:e.jsxs(Le,{MenuProps:{id:"pp-qb-list"},value:"",variant:"standard",open:j===!0,onClose:()=>{l(!1)},children:[...Object.keys(t).map(a=>e.jsx(Z,{value:a,onClick:()=>{l(!1)},sx:{maxWidth:"600px"},children:e.jsxs(de,{sx:{width:"100%",position:"relative"},children:[e.jsx(_e,{title:e.jsxs(n,{sx:{width:"100%"},children:[e.jsx("span",{children:a}),e.jsxs(V,{variant:"contained",color:"primary",sx:{position:"absolute",top:"13px",right:"20px",fontWeight:"bold"},onClick:()=>{C(a)},children:["Select  ",e.jsx(Me,{})]})]})}),e.jsxs(ue,{children:[e.jsxs(Re,{variant:"subtitle1",sx:{display:"grid",gridTemplateColumns:"auto auto",justifyContent:"start",alignItems:"center",gap:"5px",fontWeight:"bold"},children:[e.jsx(_s,{}),e.jsx("span",{children:t[a].schema_name})]}),e.jsx(Es,{sx:{margin:"20px 0"}}),e.jsx(n,{sx:{whiteSpace:"pre-wrap"},children:Ye(t[a].query)})]})]})}))]})})]}),e.jsx(H,{fullWidth:!0,label:"SQL Query",value:m,required:!0,multiline:!0,minRows:5,maxRows:10,helperText:"Enter a valid SQL query. Test your query in Query Builder before submitting.",variant:"outlined",onChange:a=>{p(Je({appQuery:a.target.value})),s&&s(!0)}})]})},oa=({setMode:s})=>{const p=W(),t=ye(),c=()=>t.appType===f.APPCONTAINER,j=c()?["App info","Apps","Authorization"]:["App info","Data source","Authorization"],[l,m]=u.useState(0);u.useEffect(()=>{let b=null;switch(t.appType){case f.DATATABLE:case f.CHART:b=$.ANONYMOUS;break;case f.DATAENTRY:case f.MASTERDETAIL:case f.REGISTRATION:case f.UPDATEFORM:case f.APPCONTAINER:b=$.AUTHORIZED;break}b!==null?p(le({restApiActions:wt(b)})):d(R.contactSupport,{variant:"error"})},[t.appType]);const[g,C]=u.useState({appName:!1,appTitle:!1,appDatabase:!1,appTable:!1,appColumns:!1});i.debug(g);const a=()=>{const b=ks(Nt);b.table.transactions.insert=Number(t.appType)===f.DATAENTRY||Number(t.appType)===f.MASTERDETAIL||Number(t.appType)===f.REGISTRATION,b.table.transactions.update=Number(t.appType)===f.DATAENTRY||Number(t.appType)===f.MASTERDETAIL||Number(t.appType)===f.UPDATEFORM||Number(t.appType)===f.REGISTRATION,b.table.transactions.delete=Number(t.appType)===f.DATAENTRY||Number(t.appType)===f.MASTERDETAIL,js(t,b,S=>{if(i.debug(S),S!=null&&S.code&&(S==null?void 0:S.message)!==void 0)switch(S.code){case"ok":d(S.message,{variant:"success"}),s(k.TABLE),p(ge({}));break;case"info":d(S.message,{variant:"info"});break;default:i.error(S),d(S.message??R.contactSupport,{variant:"error"})}else i.error(S),d(R.contactSupport,{variant:"error"})},S=>{i.error("error",S),d(S??R.contactSupport,{variant:"error"})}),t.updateSiteLanguage&&t.appLanguage!==void 0&&bs(t.appLanguage,()=>{},()=>{})},o=()=>{var S,z,F;let b=!0;if(l===0){let T=!1,_=!1;t.appName.trim()===""&&(d("App name is required",{variant:"error"}),T=!0,b=!1),t.appTitle.trim()===""&&(d("App title is required",{variant:"error"}),_=!0,b=!1),C({...g,appName:T,appTitle:_})}if(l===1){let T=!1,_=!1,ee=!1,J=!1;c()?t.appApps.length===0&&d("No apps added",{variant:"info"}):(((S=t.appDatabase)==null?void 0:S.trim())===""&&(d("Database is required",{variant:"error"}),T=!0,b=!1),t.appType==f.CHART?((z=t.appQuery)==null?void 0:z.trim())===""&&(d("SQL query is required",{variant:"error"}),J=!0,b=!1):(((F=t.appTable)==null?void 0:F.trim())===""&&(d("Table is required",{variant:"error"}),_=!0,b=!1),t.appColumns.filter(U=>U.isSelected===!0).length===0&&(d("No columns selected",{variant:"error"}),ee=!0,b=!1))),C({...g,appDatabase:T,appTable:_,appQuery:J,appColumns:ee})}return l===j.length-1&&a(),i.debug(b),b},h=()=>e.jsxs(n,{sx:{textAlign:"right",display:"grid",gridTemplateColumns:"auto auto",justifyContent:"space-between",alignItems:"center"},children:[l>0?e.jsx(V,{variant:"outlined",size:"medium",sx:{width:"160px",marginRight:"10px"},onClick:()=>{m(l-1)},startIcon:e.jsx(ts,{}),children:e.jsx(n,{children:"Back"})}):e.jsx(n,{}),e.jsx(V,{variant:"contained",size:"medium",sx:{width:"160px"},onClick:()=>{o()&&l<j.length-1&&m(l+1)},startIcon:l>=j.length-1&&e.jsx(ss,{}),endIcon:l<j.length-1&&e.jsx(Me,{}),children:e.jsx(n,{children:l<j.length-1?"Next":"Finish"})})]}),D=()=>e.jsxs(e.Fragment,{children:[e.jsx(sa,{app:t,hasErrors:g.appName}),e.jsx(aa,{app:t,hasErrors:g.appName}),e.jsx(ia,{app:t}),h()]}),w=()=>c()?e.jsxs(e.Fragment,{children:[e.jsx(ta,{app:t}),h()]}):e.jsxs(e.Fragment,{children:[e.jsx(cs,{}),e.jsx(n,{sx:{display:t.appDatabase?"block":"none"},children:t.appType==f.CHART?e.jsx(na,{}):e.jsx(ds,{})}),t.appType!=f.CHART&&e.jsx(n,{sx:{display:t.appTable?"block":"none"},children:e.jsx(us,{app:t})}),h()]}),N=()=>e.jsxs(e.Fragment,{children:[e.jsx(n,{children:e.jsx(ea,{})}),h()]});return e.jsxs(e.Fragment,{children:[e.jsx(Ps,{activeStep:l,sx:{margin:"10px 0 30px 0"},children:j.map((b,S)=>(i.debug(b,S),e.jsx(Os,{children:e.jsx(zs,{children:b})},b)))}),e.jsxs("form",{onSubmit:b=>(b.preventDefault(),o()&&m(l+1),!1),style:{display:"grid",gridGap:"40px"},children:[l===0&&D(),l===1&&w(),l===2&&N(),e.jsx("input",{type:"submit",style:{display:"none"}})]})]})},pa=({app:s,isNew:p,setIsUpdated:t})=>{i.debug(s);const c=W(),j=at(),l=p?"Select App Type *":"App Type *";return e.jsxs(X,{fullWidth:!0,children:[e.jsx(lt,{variant:"outlined",children:l}),e.jsxs(Le,{MenuProps:{id:"pp-select-menu"},label:l,value:s.appType,disabled:p!==!0&&(s.appType==f.APPCONTAINER||s.appType==f.REGISTRATION||s.appType==f.CHART),onChange:m=>{c(Mt({appType:m.target.value})),t&&t(!0)},sx:{"& .MuiSelect-select":{display:"flex",alignItems:"center"}},children:[...j.map(m=>{let g=m.id===f.DATATABLE||m.id===f.DATAENTRY||m.id===f.REGISTRATION||m.id===f.APPCONTAINER||m.id===f.CHART;return p!==!0&&(m.id===f.APPCONTAINER||m.id==f.REGISTRATION||m.id==f.CHART)&&(g=!1),e.jsxs(Z,{value:m.id,disabled:!g,children:[e.jsx(Fs,{sx:{minWidth:"unset"},children:e.jsx(ct,{appType:m.id})}),e.jsx(Bs,{children:m.text})]})})]}),e.jsxs(xe,{children:["Select ",e.jsx("strong",{children:"Data Table"})," to create a read-only app, or ",e.jsx("strong",{children:"Data Administration"})," to enable transactions. To create an app that contains one or more other apps, select ",e.jsx("strong",{children:"Data App"}),"."]})]})},la=({setMode:s})=>{const p=ye();i.debug(p);const[t,c]=u.useState(!1),[j,l]=u.useState(!1),m=t?`Add new ${st(p.appType)} app`:"Add new app";return e.jsxs(e.Fragment,{children:[e.jsxs(de,{sx:{padding:"50px 70px 40px 70px",display:"grid",gridGap:"40px"},elevation:4,children:[e.jsxs(n,{sx:{display:"grid",gridTemplateColumns:"auto auto",justifyContent:"space-between",alignItems:"start"},children:[e.jsx(_e,{title:"App Wizard",subheader:m,sx:{padding:0}}),e.jsx(n,{children:e.jsx(O,{title:"Close",children:e.jsx(K,{sx:{cursor:"pointer"},underline:"none",onClick:g=>{l(!0),g.preventDefault(),g.stopPropagation()},children:e.jsx(n,{sx:{fontSize:"1.5rem",color:"#000"},children:e.jsx(we,{})})})})})]}),e.jsx(ue,{sx:{padding:0,display:"grid",gridGap:"30px"},children:t?e.jsx(oa,{setMode:s}):e.jsxs(n,{sx:{display:"grid",gap:"10px"},children:[e.jsx(pa,{app:p,isNew:!0}),e.jsx(n,{sx:{textAlign:"end"},children:e.jsx(V,{variant:"contained",size:"medium",endIcon:e.jsx(Me,{}),onClick:()=>{c(!0)},sx:{width:"160px"},children:"Start Wizard"})})]})})]}),e.jsx(oe,{title:"Close App Wizard?",message:"All uncommitted changes will be lost!",open:j,setOpen:l,onConfirm:()=>{s(k.TABLE)}})]})},ca=({close:s})=>{const[p,t]=u.useState(""),[c,j]=u.useState(""),[l,m]=u.useState(!1),[g,C]=u.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsxs(de,{sx:{padding:"50px 70px 40px 70px",display:"grid",gridGap:"40px"},elevation:4,children:[e.jsxs(n,{sx:{display:"grid",gridTemplateColumns:"auto auto",justifyContent:"space-between",alignItems:"start"},children:[e.jsx(_e,{title:"Rename Database",sx:{padding:0}}),e.jsx(n,{children:e.jsx(O,{title:"Close",children:e.jsx(K,{sx:{cursor:"pointer"},underline:"none",onClick:a=>{s(),a.preventDefault(),a.stopPropagation()},children:e.jsx(n,{sx:{fontSize:"1.5rem",color:"#000"},children:e.jsx(we,{})})})})})]}),e.jsxs(ue,{sx:{padding:0,display:"grid",gridGap:"30px"},children:[e.jsx(H,{type:"text",label:"Old Database Name",fullWidth:!0,required:!0,value:p,onChange:a=>{t(a.target.value)}}),e.jsx(H,{type:"text",label:"New Database Name",fullWidth:!0,required:!0,value:c,onChange:a=>{j(a.target.value)}}),e.jsxs(n,{sx:{display:"grid",gridTemplateColumns:"auto auto",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs(K,{sx:{textDecoration:"none",cursor:"pointer",display:"inline-flex","& svg":{fontSize:"1rem",marginRight:"2px"}},onClick:()=>m(!l),children:[e.jsx(Ne,{}),"Manually updating database names"]}),e.jsx(V,{disabled:p.trim()===""||c.trim()==="",variant:"contained",sx:{width:"120px"},onClick:()=>{C(!0)},children:"Rename"})]}),l&&e.jsxs(n,{children:[e.jsx(n,{children:"When databases or tables are renamed or transferred using external tools, the stored database name in the repository may need updating. The Rename Database feature automatically updates all instances of the old database name to the new one across all app types and legacy tools."}),e.jsxs(n,{sx:{"& ul":{listStyleType:"disc",paddingLeft:"30px"}},children:[e.jsx("h3",{children:"Usage"}),e.jsxs("ul",{children:[e.jsx("li",{children:"After exporting a WordPress website to a new server"}),e.jsx("li",{children:"After renaming or moving databases or tables with external tools"})]})]})]})]})]}),g&&e.jsx(oe,{title:"Rename Database?",message:e.jsxs(n,{children:["Are you sure you want to replace all occurrences of ",e.jsxs("strong",{children:["`",p,"`"]})," with ",e.jsxs("strong",{children:["`",c,"`"]}),"?",e.jsx("br",{}),e.jsx("br",{}),e.jsx("strong",{children:"This action cannot be undone!"})]}),open:g,setOpen:C,onConfirm:()=>As(p,c,a=>{if(a!=null&&a.code&&(a==null?void 0:a.message)!==void 0)switch(a.code){case"ok":d(a.message,{variant:"success"});break;case"info":d(a.message,{variant:"info"});break;default:i.error(a),d(a.message??R.contactSupport,{variant:"error"})}else i.error(a),d(R.contactSupport,{variant:"error"})},a=>{i.error(a),d(a??R.contactSupport,{variant:"error"})})})]})};const da=()=>{const s=W(),p=u.useMemo(()=>Qs(),[]),[t,c]=u.useState(k.TABLE);i.debug(t),u.useEffect(()=>{const x=localStorage.getItem("ppAppsDbsSearch");x!==null&&s(Ue({dbSearch:x}));const v=localStorage.getItem("ppAppsDbsSearchType");if(v!==null){const G=JSON.parse(v);s($e({dbTypes:G}))}localStorage.getItem("ppAppsShowStructure")==="false"&&s(Te({showAppStructure:!1})),window.ppActionRenameDatabase=function(){b(!0)}},[]);const j=dt(),l=Vs(),m=P(x=>Lt(x));i.debug("appDbId",m);const g=P(x=>_t(x));i.debug("dbSearch",g);const C=P(x=>Et(x));i.debug("dbTypes",C);const a=P(x=>kt(x));i.debug("designMode",a);const o=P(x=>Pt(x));i.debug("reload",o);const h=x=>{x?(window.document.documentElement.style.setProperty("--addRenameDatabaseVisibility","visible"),window.document.documentElement.style.setProperty("--addAppIconVisibility","visible")):(window.document.documentElement.style.setProperty("--addRenameDatabaseVisibility","hidden"),window.document.documentElement.style.setProperty("--addAppIconVisibility","hidden"))},[D,w]=u.useState(!0),[N,b]=u.useState(!1);u.useEffect(()=>{h(!N)},[N]),u.useEffect(()=>{z(),S()},[o]);const S=()=>{ys(function(x){const v=x==null?void 0:x.data;i.debug("response data",v);const B=x==null?void 0:x.context;if(i.debug("response context",B),Array.isArray(v)){const G=[];for(let L=0;L<v.length;L++)G.push({appId:v[L].app_id,appName:v[L].app_name,appTitle:v[L].app_title,appType:v[L].app_type,appSettings:v[L].app_settings,appAddToMenu:v[L].app_add_to_menu});const re=B.reduce((L,me)=>{const{app_id:ie,app_id_detail:he}=me;return L[ie]=L[ie]??[],L[ie].push(Number(he)),L},{});s(Ce({appList:G,appApps:re}))}else i.error(v),d((v==null?void 0:v.message)??R.contactSupport,{variant:"error"}),s(Ce({appList:[],appApps:[]}));w(!1)},x=>{i.error("error",x),d(x??R.contactSupport,{variant:"error"}),s(Ce({appList:[],appApps:[]})),w(!1)})},z=()=>{Ts(function(x){const v=x==null?void 0:x.data;i.debug("response data",v),s(zt({appMetaData:v}))},x=>{i.error("error",x),d(x??R.contactSupport,{variant:"error"})})};u.useEffect(()=>{t===k.TABLE&&z()},[t]),u.useEffect(()=>{Ie.appPlugin&&(window.ppActionCreateApp=function(){t===0&&!(a.isActive===!0&&a.appDbId>0)&&c(k.FORM)},h(!(t===1||a.isActive===!0&&a.appDbId>0)))},[t,a]);const[F,T]=u.useState(250),_=fe("(max-width: 600px)"),ee=fe("(max-width: 900px)");u.useEffect(()=>{te.current&&T(te.current.offsetWidth)},[C]);const J=Ft(),U=at();i.debug(U);const te=u.useRef(),Y=()=>a.isActive===!0&&a.appDbId>0,r=()=>e.jsx(O,{title:"Add new app",children:e.jsx(q,{sx:{color:"inherit"},onClick:()=>{s(tt({})),c(k.FORM)},children:e.jsx(ls,{})})}),A=()=>e.jsx(O,{title:"Rename Database",children:e.jsx(q,{sx:{color:"inherit"},onClick:()=>{b(!N)},children:e.jsx(Ws,{})})}),M={};Y()&&(M.visibility="hidden");const se=localStorage.getItem("ppAppsDensity"),[Q,ae]=u.useState(se==="large"||se==="medium"?se:"small");return u.useEffect(()=>{localStorage.setItem("ppAppsDensity",Q)},[Q]),e.jsxs(Hs,{theme:J,children:[e.jsxs(n,{className:"pp-applist",sx:{width:"100%",visibility:Y()?"hidden":"visible",position:Y()?"fixed":"auto",height:Y()?0:"auto",...Y()&&{visibility:"hidden",position:"absolute",left:-99999},"& .pp-app-details":{...M}},children:[e.jsx(rt,{position:"relative",elevation:4,sx:{margin:"0 0 5px 0"},children:e.jsxs(it,{className:"pp-applist-toolbar",sx:{display:"grid",gap:"12px",paddingRight:"12px !important",..._?{gap:0,paddingRight:"10px",paddingBottom:"10px",paddingLeft:"10px","& .pp-applist-search":{gridTemplateColumns:"1fr",gridGap:"2px"}}:{...ee?{gap:0,paddingRight:"10px",paddingBottom:"10px",paddingLeft:"10px","& .pp-applist-search":{justifyContent:"end",gridTemplateColumns:"auto auto auto"}}:{justifyContent:"space-between",gridTemplateColumns:"auto 1fr"}}},children:[e.jsxs(n,{className:"pp-applist-title",sx:{display:"inline-grid",gridTemplateColumns:"auto auto auto",justifyContent:"start",alignItems:"center",gridGap:"10px"},children:[e.jsx(n,{sx:{fontSize:"18px",lineHeight:"18px",fontWeight:"bold",whiteSpace:"nowrap"},children:"Apps"}),e.jsxs(n,{sx:{display:"inline-grid",gridTemplateColumns:"auto auto",justifyContent:"start",alignItems:"center"},children:[e.jsx(n,{children:t===k.TABLE&&!N&&e.jsx(e.Fragment,{children:r()})}),e.jsx(n,{children:t===k.TABLE&&!N&&e.jsx(e.Fragment,{children:A()})})]})]}),e.jsxs(n,{className:"pp-applist-search",sx:{display:"grid",gridTemplateColumns:"auto auto auto",gridGap:"10px",justifyContent:"end",alignItems:"center"},children:[e.jsxs(n,{children:[e.jsx(O,{title:"App View",children:e.jsx(q,{onClick:()=>{s(Te({showAppStructure:!0})),localStorage.setItem("ppAppsShowStructure","true")},sx:{color:"#fff"},children:e.jsx(as,{})})}),e.jsx(O,{title:"List View",children:e.jsx(q,{onClick:()=>{s(Te({showAppStructure:!1})),localStorage.setItem("ppAppsShowStructure","false")},sx:{color:"#fff"},children:e.jsx(rs,{})})}),e.jsx(O,{title:"Toggle density",children:e.jsx(q,{onClick:()=>{ae(Q==="large"?"medium":Q==="medium"?"small":"large")},sx:{color:"#fff"},children:Q==="small"?e.jsx(is,{}):Q==="medium"?e.jsx(ns,{}):e.jsx(os,{})})})]}),e.jsx(H,{value:g,type:"search",placeholder:"Search",disabled:t===k.FORM,onChange:x=>{s(Ue({dbSearch:x.target.value})),localStorage.setItem("ppAppsDbsSearch",x.target.value)},sx:{backgroundColor:"#fff",fontSize:"1em",margin:0,padding:0,borderRadius:"4px","&.MuiFormControl-root.MuiTextField-root .MuiInputBase-root":{paddingRight:0},"&.MuiFormControl-root.MuiTextField-root input":{padding:"8px"}},InputProps:{startAdornment:e.jsx(Gs,{position:"end",sx:{fontSize:"1.5rem",padding:0,margin:0},children:e.jsx(ps,{})})}}),e.jsx(je,{multiple:!0,size:"small",options:U,getOptionLabel:x=>x.text,isOptionEqualToValue:(x,v)=>x.id===v.id,value:C,disableCloseOnSelect:!0,disabled:t===k.FORM,onChange:(x,v)=>{s($e({dbTypes:v.map(B=>({id:B.id,text:Object.values(Ot)[B.id]}))})),localStorage.setItem("ppAppsDbsSearchType",JSON.stringify(v))},PaperComponent:({children:x})=>e.jsx(ot,{sx:{width:`${F}px`},children:x}),renderInput:x=>e.jsx(n,{ref:te,children:e.jsx(H,{...x,sx:{minWidth:"250px","& .MuiInputBase-root":{backgroundColor:"#fff",padding:"0",maxHeight:"39px",overflow:"hidden"},"& .MuiButtonBase-root.MuiChip-root.MuiAutocomplete-tag":{height:"auto"}},placeholder:C.length===0?"Select app types":""})}),renderTags:(x,v)=>x.map((B,G)=>{const{key:re,...L}=v({index:G});return e.jsx(be,{variant:"outlined",label:B.text,...L},re)})})]})]})}),N?e.jsx(ca,{close:()=>b(!1)}):e.jsxs(e.Fragment,{children:[t===k.TABLE&&e.jsx(Xs,{apps:j,appApps:l,search:g,types:C,isLoading:D,density:Q}),t===k.FORM&&e.jsx(la,{setMode:c}),m!==0&&m!==void 0&&e.jsx(Zs,{appDbId:m})]})]}),a.isActive===!0&&a.appDbId>0&&e.jsx(qs,{appId:p,appDbId:a.appDbId,designMode:!0,isExploring:!0})]})},rr=Object.freeze(Object.defineProperty({__proto__:null,default:da},Symbol.toStringTag,{value:"Module"}));export{sa as A,na as C,aa as a,pa as b,ia as c,ta as d,ea as e,rr as f};
