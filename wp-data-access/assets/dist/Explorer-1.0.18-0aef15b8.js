import{r as i,j as e,_ as q,l,ba as ws,bb as vs,C as G,bc as Es,bd as ks,be as _s,bf as Ms,bg as Ps,bh as Ls,bi as As,bj as Ds,bk as Os,bl as zs,bm as Rs,bn as Fs,bo as Bs,bp as Ks,bq as fe,br as Vs,bs as Ns,bt as Ws,m as he,bu as $s,bv as Gs,bw as Hs,bx as qs,by as Ys,bz as Qs,bA as Us,bB as Js,bC as Xs,bD as Zs,bE as Ne,aY as et,bF as je,bG as ye,bH as st,bI as tt,bJ as We,bK as $e,bL as Ge,bM as He,bN as at,bO as nt,bP as ot,bQ as rt,bR as it,bS as lt,bT as ct,S as dt,e as ze,bU as pt,b3 as ut,y as xt,aZ as mt,bV as gt,bW as ht,bX as ft}from"./main-1.0.18.js";import{l as jt,a as yt,b as bt,c as Tt,d as Ct,e as St,f as It,g as wt,h as vt}from"./ActionsExplorer-1.0.18-ae07c36b.js";import{a as R,u as C}from"./RestApi-1.0.18-cb72bd79.js";import{B as u,C as Et,S as kt}from"./Spinner-1.0.18-de8df990.js";import{_ as pe,b as V,c as qe,i as Le,m as _t,n as Mt,T as we}from"./Typography-1.0.18-dc3c0740.js";import{u as oe,M as re,B as Re,T as Ye,a as Qe,b as Ie,c as N,d as Ue}from"./index.esm-1.0.18-9725e44a.js";import{T as Q,u as Ae,a as Pt,b as Lt,c as At}from"./ActionsAdmin-1.0.18-de8008ec.js";import{b as Je,c as Xe,d as Ze,B as Dt}from"./index.esm-1.0.18-bb69b89a.js";import{D as be,E as Ot,F as zt,d as Rt,G as Ft,t as Bt,H as Kt,A as De,T as Oe,I as Vt,J as Nt,K as es,L as ss,M as Wt,N as $t,O as Gt,v as Fe,P as Ht,h as qt,q as Yt,r as Qt,s as Ut}from"./index.esm-1.0.18-12f13c4a.js";import{a as Jt,b as Xt}from"./index.esm-1.0.18-1950fc28.js";import{u as ts,t as Y,T as Zt,a as ea,b as sa,g as ta,S as aa}from"./TreeItem2Provider-1.0.18-a27a86e4.js";import{C as na}from"./Collapse-1.0.18-8e581380.js";import{u as Be,r as ee,I as ne,P as Me}from"./iconBase-1.0.18-3c21f5e2.js";import{a as Te,u as oa}from"./colorManipulator-1.0.18-95bf61ec.js";import{E as Ce}from"./ExplorerActionEnum-1.0.18-304129ea.js";import{A as X}from"./AdminTheme-1.0.18-73e13a4f.js";import{C as J}from"./Checkbox-1.0.18-3ed60478.js";import{T as ue}from"./Tooltip-1.0.18-5f32f0fd.js";import{L as se}from"./Link-1.0.18-41cc6055.js";import{C as ra,a as ia,B as ge}from"./CardContent-1.0.18-3d5e5525.js";import{C as la}from"./CardHeader-1.0.18-1e38ceea.js";import{F as te}from"./FormHelperText-1.0.18-8b4ce85f.js";import{F as Se}from"./FormLabel-1.0.18-47dbe87d.js";import{C as ca}from"./CardActions-1.0.18-9693078a.js";import{T as as,S as ns,I as da}from"./TextField-1.0.18-cf148b4e.js";import{I as Ke}from"./InputAdornment-1.0.18-958a8148.js";import{D as pa,a as ua,b as xa,C as os,T as ma}from"./ConfirmDialog-1.0.18-eb1f3988.js";import{D as ga,a as ha,b as fa}from"./DialogContent-1.0.18-5570cba4.js";import{M as xe}from"./MenuItem-1.0.18-0088f2a2.js";/* empty css                    */import"./createSvgIcon-1.0.18-dcf0276e.js";import"./Modal-1.0.18-870f459d.js";import"./useControlled-1.0.18-12a74006.js";import"./FormControlLabel-1.0.18-2840e084.js";import"./useFormControl-1.0.18-87a8487d.js";import"./createStyled-1.0.18-b238c9ff.js";import"./Radio-1.0.18-210e4079.js";import"./SwitchBase-1.0.18-e2aa3211.js";import"./Autocomplete-1.0.18-a264f80a.js";import"./Close-1.0.18-d90e9fa7.js";import"./index-1.0.18-ff546563.js";import"./Popper-1.0.18-20544c9b.js";import"./AlertTitle-1.0.18-0fd475c6.js";import"./useSlot-1.0.18-71f9e7ae.js";import"./Menu-1.0.18-e8cb0649.js";import"./ThemeProvider-1.0.18-247b72cc.js";import"./Popover-1.0.18-54868205.js";import"./Grow-1.0.18-4ebc2ce8.js";import"./ListItemIcon-1.0.18-7ee6feae.js";import"./Divider-1.0.18-eca54fd7.js";import"./Switch-1.0.18-cbb6329b.js";import"./TimePicker-1.0.18-01aff462.js";import"./useMobilePicker-1.0.18-1215309b.js";import"./ListItem-1.0.18-e1cfc559.js";import"./date-time-utils-1.0.18-97c8c662.js";import"./DateTimePicker-1.0.18-b82ef175.js";import"./Tabs-1.0.18-d7d53c1e.js";import"./dateViewRenderers-1.0.18-21bd6103.js";import"./DatePicker-1.0.18-90c55de2.js";import"./Slider-1.0.18-32b00bb2.js";function ja(s){const{instance:t,selection:{multiSelect:o}}=ts(),a=t.isItemExpandable(s),c=t.isItemExpanded(s),d=t.isItemFocused(s),y=t.isItemSelected(s),f=t.isItemDisabled(s);return{disabled:f,expanded:c,selected:y,focused:d,handleExpansion:r=>{if(!f){d||t.focusItem(r,s);const b=o&&(r.shiftKey||r.ctrlKey||r.metaKey);a&&!(b&&t.isItemExpanded(s))&&t.toggleItemExpansion(r,s)}},handleSelection:r=>{f||(d||t.focusItem(r,s),o&&(r.shiftKey||r.ctrlKey||r.metaKey)?r.shiftKey?t.selectRange(r,{end:s}):t.selectItem(r,s,!0):t.selectItem(r,s))},preventSelection:r=>{(r.shiftKey||r.ctrlKey||r.metaKey||f)&&r.preventDefault()}}}const ya=["classes","className","displayIcon","expansionIcon","icon","label","itemId","onClick","onMouseDown"],rs=i.forwardRef(function(t,o){const{classes:a,className:c,displayIcon:d,expansionIcon:y,icon:f,label:x,itemId:j,onClick:n,onMouseDown:r}=t,b=pe(t,ya),{disabled:W,expanded:P,selected:w,focused:D,handleExpansion:F,handleSelection:z,preventSelection:_}=ja(j),I=f||y||d,A=h=>{_(h),r&&r(h)},v=h=>{F(h),z(h),n&&n(h)};return e.jsxs("div",V({},b,{className:qe(c,a.root,P&&a.expanded,w&&a.selected,D&&a.focused,W&&a.disabled),onClick:v,onMouseDown:A,ref:o,children:[e.jsx("div",{className:a.iconContainer,children:I}),e.jsx("div",{className:a.label,children:x})]}))}),ba=["children","className","slots","slotProps","ContentComponent","ContentProps","itemId","id","label","onClick","onMouseDown","onFocus","onBlur","onKeyDown"],Ta=["ownerState"],Ca=["ownerState"],Sa=["ownerState"],Ia=s=>{const{classes:t}=s;return Mt({root:["root"],content:["content"],expanded:["expanded"],selected:["selected"],focused:["focused"],disabled:["disabled"],iconContainer:["iconContainer"],label:["label"],groupTransition:["groupTransition"]},ta,t)},wa=Le("li",{name:"MuiTreeItem",slot:"Root",overridesResolver:(s,t)=>t.root})({listStyle:"none",margin:0,padding:0,outline:0}),va=Le(rs,{name:"MuiTreeItem",slot:"Content",overridesResolver:(s,t)=>[t.content,t.iconContainer&&{[`& .${Y.iconContainer}`]:t.iconContainer},t.label&&{[`& .${Y.label}`]:t.label}]})(({theme:s})=>({padding:s.spacing(.5,1),borderRadius:s.shape.borderRadius,width:"100%",boxSizing:"border-box",display:"flex",alignItems:"center",gap:s.spacing(1),cursor:"pointer",WebkitTapHighlightColor:"transparent","&:hover":{backgroundColor:(s.vars||s).palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${Y.disabled}`]:{opacity:(s.vars||s).palette.action.disabledOpacity,backgroundColor:"transparent"},[`&.${Y.focused}`]:{backgroundColor:(s.vars||s).palette.action.focus},[`&.${Y.selected}`]:{backgroundColor:s.vars?`rgba(${s.vars.palette.primary.mainChannel} / ${s.vars.palette.action.selectedOpacity})`:Te(s.palette.primary.main,s.palette.action.selectedOpacity),"&:hover":{backgroundColor:s.vars?`rgba(${s.vars.palette.primary.mainChannel} / calc(${s.vars.palette.action.selectedOpacity} + ${s.vars.palette.action.hoverOpacity}))`:Te(s.palette.primary.main,s.palette.action.selectedOpacity+s.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:s.vars?`rgba(${s.vars.palette.primary.mainChannel} / ${s.vars.palette.action.selectedOpacity})`:Te(s.palette.primary.main,s.palette.action.selectedOpacity)}},[`&.${Y.focused}`]:{backgroundColor:s.vars?`rgba(${s.vars.palette.primary.mainChannel} / calc(${s.vars.palette.action.selectedOpacity} + ${s.vars.palette.action.focusOpacity}))`:Te(s.palette.primary.main,s.palette.action.selectedOpacity+s.palette.action.focusOpacity)}},[`& .${Y.iconContainer}`]:{width:16,display:"flex",flexShrink:0,justifyContent:"center","& svg":{fontSize:18}},[`& .${Y.label}`]:V({width:"100%",boxSizing:"border-box",minWidth:0,position:"relative"},s.typography.body1)})),Ea=Le(na,{name:"MuiTreeItem",slot:"GroupTransition",overridesResolver:(s,t)=>t.groupTransition})({margin:0,padding:0,paddingLeft:12}),$=i.forwardRef(function(t,o){const{icons:a,runItemPlugins:c,selection:{multiSelect:d},disabledItemsFocusable:y,instance:f}=ts(),x=_t({props:t,name:"MuiTreeItem"}),{children:j,className:n,slots:r,slotProps:b,ContentComponent:W=rs,ContentProps:P,itemId:w,id:D,label:F,onClick:z,onMouseDown:_,onBlur:I,onKeyDown:A}=x,v=pe(x,ba),{contentRef:h,rootRef:O}=c(x),M=Be(o,O),m=Be(P==null?void 0:P.ref,h),p={expandIcon:(r==null?void 0:r.expandIcon)??a.slots.expandIcon??Zt,collapseIcon:(r==null?void 0:r.collapseIcon)??a.slots.collapseIcon??ea,endIcon:(r==null?void 0:r.endIcon)??a.slots.endIcon,icon:r==null?void 0:r.icon,groupTransition:r==null?void 0:r.groupTransition},g=k=>Array.isArray(k)?k.length>0&&k.some(g):!!k,T=g(j),E=f.isItemExpanded(w),S=f.isItemFocused(w),B=f.isItemSelected(w),H=f.isItemDisabled(w),Z=V({},x,{expanded:E,focused:S,selected:B,disabled:H}),K=Ia(Z),ce=p.groupTransition??void 0,ds=be({elementType:ce,ownerState:{},externalSlotProps:b==null?void 0:b.groupTransition,additionalProps:{unmountOnExit:!0,in:E,component:"ul",role:"group"},className:K.groupTransition}),ve=E?p.collapseIcon:p.expandIcon,ps=be({elementType:ve,ownerState:{},externalSlotProps:k=>E?V({},ee(a.slotProps.collapseIcon,k),ee(b==null?void 0:b.collapseIcon,k)):V({},ee(a.slotProps.expandIcon,k),ee(b==null?void 0:b.expandIcon,k))}),us=pe(ps,Ta),xs=T&&ve?e.jsx(ve,V({},us)):null,Ee=T?void 0:p.endIcon,ms=be({elementType:Ee,ownerState:{},externalSlotProps:k=>T?{}:V({},ee(a.slotProps.endIcon,k),ee(b==null?void 0:b.endIcon,k))}),gs=pe(ms,Ca),hs=Ee?e.jsx(Ee,V({},gs)):null,ke=p.icon,fs=be({elementType:ke,ownerState:{},externalSlotProps:b==null?void 0:b.icon}),js=pe(fs,Sa),ys=ke?e.jsx(ke,V({},js)):null;let _e;d?_e=B:B&&(_e=!0);function bs(k){!S&&(!H||y)&&k.currentTarget===k.target&&f.focusItem(k,w)}function Ts(k){I==null||I(k),f.removeFocusedItem()}const Cs=k=>{A==null||A(k),f.handleItemKeyDown(k,w)},Ss=f.getTreeItemId(w,D),Is=f.canItemBeTabbed(w)?0:-1;return e.jsx(sa,{itemId:w,children:e.jsxs(wa,V({className:qe(K.root,n),role:"treeitem","aria-expanded":T?E:void 0,"aria-selected":_e,"aria-disabled":H||void 0,id:Ss,tabIndex:Is},v,{ownerState:Z,onFocus:bs,onBlur:Ts,onKeyDown:Cs,ref:M,children:[e.jsx(va,V({as:W,classes:{root:K.content,expanded:K.expanded,selected:K.selected,focused:K.focused,disabled:K.disabled,iconContainer:K.iconContainer,label:K.label},label:F,itemId:w,onClick:z,onMouseDown:_,icon:ys,expansionIcon:xs,displayIcon:hs,ownerState:Z},P,{ref:m})),j&&e.jsx(Ea,V({as:ce},ds,{children:j}))]}))})}),U=()=>e.jsxs(u,{sx:{display:"grid",gridTemplateColumns:"auto auto",justifyContent:"start",alignItems:"center",gap:"10px",padding:"30px"},children:[e.jsx(Et,{sx:{width:"1em !important",height:"1em !important"}}),e.jsx(we,{children:"Loading..."})]}),ie={columns:[],data:[],initialState:{},enableColumnActions:!1,enableColumnFilters:!1,enablePagination:!1,enableSorting:!1,enableBottomToolbar:!1,enableTopToolbar:!1,muiTablePaperProps:{sx:{display:"grid",boxShadow:"none"}},muiTableProps:{sx:{border:"unset","& th, td":{borderTop:"unset",borderRight:"unset",borderLeft:"unset"}}},muiTableHeadCellProps:{sx:{paddingTop:"1rem",paddingRight:"1rem",paddingBottom:"1rem",paddingLeft:"1rem"}},muiTableBodyRowProps:{hover:!0},muiTableBodyCellProps:{sx:{verticalAlign:"top"}}},le=({msg:s})=>e.jsx(u,{sx:{padding:"1rem 0"},children:e.jsx(we,{children:s})}),ka=i.lazy(()=>q(()=>import("./Alert-1.0.18-8e754392.js"),["./Alert-1.0.18-8e754392.js","./main-1.0.18.js","./index.esm-1.0.18-bb69b89a.js","./iconBase-1.0.18-3c21f5e2.js","./Typography-1.0.18-dc3c0740.js","./AlertTitle-1.0.18-0fd475c6.js","./index-1.0.18-ff546563.js","./useSlot-1.0.18-71f9e7ae.js","./createSvgIcon-1.0.18-dcf0276e.js","./Close-1.0.18-d90e9fa7.js"],import.meta.url)),_a=({dbs:s,tbl:t})=>{l.debug(s,t);const o=R(),a=C(n=>ws(n,s,t));l.debug(a);const c=C(n=>vs(n,s,t));l.debug(c);const[d,y]=i.useState("");i.useEffect(()=>{a||f()},[a]);const f=()=>{jt(s,t,n=>{const r=n==null?void 0:n.data;l.debug("response data",r),o(Es({dbs:s,tbl:t,cls:r}))},n=>{l.error("error",n),y(n??G.contactSupport)})},x=i.useMemo(()=>[{accessorKey:"ordinal_position",header:"#",size:40},{accessorKey:"column_name",header:"Column name",size:100},{accessorKey:"column_type",header:"Column type",size:100},{accessorKey:"is_nullable",header:"Nullable?",size:50},{accessorKey:"character_maximum_length",header:"Max length",size:70,muiTableHeadCellProps:{align:"right"},muiTableBodyCellProps:{align:"right"}},{accessorKey:"numeric_precision",header:"Precision",size:60,muiTableHeadCellProps:{align:"right"},muiTableBodyCellProps:{align:"right"}},{accessorKey:"numeric_scale",header:"Scale",size:60,muiTableHeadCellProps:{align:"right"},muiTableBodyCellProps:{align:"right"}},{accessorKey:"extra",header:"Extra",size:100},{accessorKey:"column_default",header:"Default value",size:100}],[]),j=oe({...ie,columns:x,data:c,initialState:{columnOrder:["ordinal_position","column_name","column_type","is_nullable","extra","column_default","character_maximum_length","numeric_precision","numeric_scale"],density:"comfortable"},muiTableProps:{className:"pp-explorer-table"}});return l.debug(j),d!==""?e.jsx(i.Suspense,{children:e.jsx(ka,{severity:"error",message:d,close:!1})}):a?a&&c.length===0?e.jsx(le,{msg:"Table has no columns"}):(l.debug(c),e.jsx(re,{table:j})):e.jsx(U,{})},Ma=i.lazy(()=>q(()=>import("./Alert-1.0.18-8e754392.js"),["./Alert-1.0.18-8e754392.js","./main-1.0.18.js","./index.esm-1.0.18-bb69b89a.js","./iconBase-1.0.18-3c21f5e2.js","./Typography-1.0.18-dc3c0740.js","./AlertTitle-1.0.18-0fd475c6.js","./index-1.0.18-ff546563.js","./useSlot-1.0.18-71f9e7ae.js","./createSvgIcon-1.0.18-dcf0276e.js","./Close-1.0.18-d90e9fa7.js"],import.meta.url)),Pa=({dbs:s,tbl:t})=>{l.debug(s,t);const o=R(),a=C(n=>ks(n,s,t));l.debug(a);const c=C(n=>_s(n,s,t));l.debug(c);const[d,y]=i.useState("");i.useEffect(()=>{a||f()},[a]);const f=()=>{yt(s,t,n=>{const r=n==null?void 0:n.data;l.debug("response data",r),o(Ms({dbs:s,tbl:t,idx:r}))},n=>{l.error("error",n),y(n??G.contactSupport)})},x=i.useMemo(()=>[{accessorKey:"index_name",header:"Index name",size:100},{accessorKey:"non_unique",header:"Unique",size:80},{accessorKey:"seq_in_name",header:"#",size:40,muiTableHeadCellProps:{align:"right"},muiTableBodyCellProps:{align:"right"}},{accessorKey:"column_name",header:"Column name",size:100},{accessorKey:"collation",header:"Collation",size:80},{accessorKey:"nullable",header:"Nullable?",size:80},{accessorKey:"index_type",header:"Index type",size:100},{accessorKey:"cardinality",header:"Cardinality",size:80,muiTableHeadCellProps:{align:"right"},muiTableBodyCellProps:{align:"right"}}],[]),j=oe({...ie,columns:x,data:c,initialState:{density:"comfortable"},muiTableProps:{className:"pp-explorer-table"}});return l.debug(j),d!==""?e.jsx(i.Suspense,{children:e.jsx(Ma,{severity:"error",message:d,close:!1})}):a?a&&c.length===0?e.jsx(le,{msg:"Table has no indexes"}):e.jsx(re,{table:j}):e.jsx(U,{})},La=i.lazy(()=>q(()=>import("./Alert-1.0.18-8e754392.js"),["./Alert-1.0.18-8e754392.js","./main-1.0.18.js","./index.esm-1.0.18-bb69b89a.js","./iconBase-1.0.18-3c21f5e2.js","./Typography-1.0.18-dc3c0740.js","./AlertTitle-1.0.18-0fd475c6.js","./index-1.0.18-ff546563.js","./useSlot-1.0.18-71f9e7ae.js","./createSvgIcon-1.0.18-dcf0276e.js","./Close-1.0.18-d90e9fa7.js"],import.meta.url)),Aa=({dbs:s,tbl:t})=>{l.debug(s,t);const o=R(),a=C(n=>Ps(n,s,t));l.debug(a);const c=C(n=>Ls(n,s,t));l.debug(c);const[d,y]=i.useState("");i.useEffect(()=>{a||f()},[a]);const f=()=>{bt(s,t,n=>{const r=n==null?void 0:n.data;l.debug("response data",r),o(As({dbs:s,tbl:t,trg:r}))},n=>{l.error("error",n),y(n??G.contactSupport)})},x=i.useMemo(()=>[{accessorKey:"trigger_name",header:"Trigger name",size:120},{accessorKey:"event_manipulation",header:"Event",size:80},{accessorKey:"action_timing",header:"Timin",size:80},{accessorKey:"action_statement",header:"SQL",size:200,Cell:({cell:n})=>e.jsx("pre",{style:{padding:0,margin:0},children:n.getValue()})}],[]),j=oe({...ie,columns:x,data:c,initialState:{density:"comfortable"},muiTableProps:{className:"pp-explorer-table"}});return l.debug(j),d!==""?e.jsx(i.Suspense,{children:e.jsx(La,{severity:"error",message:d,close:!1})}):a?a&&c.length===0?e.jsx(le,{msg:"Table has no triggers"}):e.jsx(re,{table:j}):e.jsx(U,{})},Da=i.lazy(()=>q(()=>import("./Alert-1.0.18-8e754392.js"),["./Alert-1.0.18-8e754392.js","./main-1.0.18.js","./index.esm-1.0.18-bb69b89a.js","./iconBase-1.0.18-3c21f5e2.js","./Typography-1.0.18-dc3c0740.js","./AlertTitle-1.0.18-0fd475c6.js","./index-1.0.18-ff546563.js","./useSlot-1.0.18-71f9e7ae.js","./createSvgIcon-1.0.18-dcf0276e.js","./Close-1.0.18-d90e9fa7.js"],import.meta.url)),Oa=({dbs:s,tbl:t})=>{l.debug(s,t);const o=R(),a=C(n=>Ds(n,s,t));l.debug(a);const c=C(n=>Os(n,s,t));l.debug(c);const[d,y]=i.useState("");i.useEffect(()=>{a||f()},[a]);const f=()=>{Tt(s,t,n=>{const r=n==null?void 0:n.data;l.debug("response data",r),o(zs({dbs:s,tbl:t,frk:r}))},n=>{l.error("error",n),y(n)})},x=i.useMemo(()=>[{accessorKey:"constraint_name",header:"Constraint name",size:100},{accessorKey:"column_name",header:"Column name",size:100},{accessorKey:"referenced_table_name",header:"Referenced table",size:100},{accessorKey:"referenced_column_name",header:"Referenced column",size:100}],[]),j=oe({...ie,columns:x,data:c,initialState:{density:"comfortable"},muiTableProps:{className:"pp-explorer-table"}});return l.debug(j),d!==""?e.jsx(i.Suspense,{children:e.jsx(Da,{severity:"error",message:d,close:!1})}):a?a&&c.length===0?e.jsx(le,{msg:"Table contains no foreign keys"}):e.jsx(re,{table:j}):e.jsx(U,{})},is=i.memo(({dbs:s,tbl:t,typ:o})=>(l.debug(s,t,o),e.jsxs(e.Fragment,{children:[e.jsx($,{itemId:s+"-"+t+"-columns",label:e.jsxs(u,{sx:{display:"inline-grid",gridTemplateColumns:"auto auto",gap:"10px",alignItems:"center"},children:[e.jsx(Ot,{}),e.jsx("span",{children:"Columns"})]}),sx:{padding:0,minWidth:0},children:e.jsx(_a,{dbs:s,tbl:t})}),o===Q.TABLE&&e.jsxs(e.Fragment,{children:[e.jsx($,{itemId:s+"-"+t+"-indexes",label:e.jsxs(u,{sx:{display:"inline-grid",gridTemplateColumns:"auto auto",gap:"10px",alignItems:"center"},children:[e.jsx(zt,{}),e.jsx("span",{children:"Indexes"})]}),sx:{padding:0,minWidth:0},children:e.jsx(Pa,{dbs:s,tbl:t})}),e.jsx($,{itemId:s+"-"+t+"-foreignkeys",label:e.jsxs(u,{sx:{display:"inline-grid",gridTemplateColumns:"auto auto",gap:"10px",alignItems:"center"},children:[e.jsx(Jt,{}),e.jsx("span",{children:"Foreign Keys"})]}),sx:{padding:0,minWidth:0},children:e.jsx(Oa,{dbs:s,tbl:t})}),e.jsx($,{itemId:s+"-"+t+"-triggers",label:e.jsxs(u,{sx:{display:"inline-grid",gridTemplateColumns:"auto auto",gap:"10px",alignItems:"center"},children:[e.jsx(Je,{}),e.jsx("span",{children:"Triggers"})]}),sx:{padding:0,minWidth:0},children:e.jsx(Aa,{dbs:s,tbl:t})})]})]}))),za=s=>{const t=C(o=>Rs(o,s));return l.debug("tablesSelected",t),t},Ra=s=>{const t=C(o=>Fs(o,s));return l.debug("viewsSelected",t),t},ls=i.memo(({dbs:s,tbl:t,typ:o,tableContext:a})=>{var j,n;l.debug(s,t,o);const c=R(),d=za(s),y=Ra(s),f=oa("(max-width:900px)"),x=i.useMemo(()=>(a==null?void 0:a.wp_tables)!==void 0&&a.wp_tables.filter(r=>r===t).length>0?" (WordPress Table)":(a==null?void 0:a.wpda_tables)!==void 0&&a.wpda_tables.filter(r=>r===t).length>0?" (Plugin Table)":"",[]);return e.jsxs(u,{color:"primary",sx:{display:"grid",gridTemplateColumns:"calc(100% - 110px) auto",justifyContent:"space-between",alignItems:"center",gridGap:"20px",marginLeft:"-10px","&:hover":{".pp-row-actions":{visibility:f?"hidden":"visible"}}},children:[e.jsxs(u,{sx:{display:"grid",gridTemplateColumns:"auto auto",justifyContent:"start",alignItems:"center",gridGap:"0",overflow:"hidden"},children:[e.jsx(u,{sx:{display:"grid",alignItems:"center"},children:e.jsx(J,{size:"small",checked:y.includes(t)||d.includes(t),onClick:r=>{o===Q.VIEW?c(Bs({dbs:s,vws:t,isSelected:!y.includes(t)})):c(Ks({dbs:s,tbl:t,isSelected:!d.includes(t)})),r.stopPropagation()}})}),e.jsxs(u,{sx:{display:"grid",gridTemplateColumns:"auto auto",alignItems:"stretch"},children:[e.jsxs(u,{sx:{textOverflow:"ellipsis",whiteSpace:"nowrap"},children:[t," ",x]}),e.jsxs(u,{sx:{display:"grid",gridTemplateColumns:"auto auto auto auto",gridGap:"10px",marginLeft:"10px",alignItems:"center",visibility:"hidden"},className:"pp-row-actions",children:[e.jsx(u,{sx:{borderLeft:"1px solid black",height:"100%"}}),e.jsx(ue,{title:"Manage table `"+t+"`",placement:"bottom",children:e.jsx(se,{underline:"none",onClick:r=>{c(fe({dbs:s,tbl:t,typ:o,explorerAction:Ce.MANAGE})),r.preventDefault(),r.stopPropagation()},children:"Manage"})}),e.jsx(u,{sx:{borderLeft:"1px solid black",height:"100%"}}),e.jsx(ue,{title:"Explore table `"+t+"`",placement:"bottom",children:e.jsx(se,{underline:"none",onClick:r=>{c(fe({dbs:s,tbl:t,typ:o,explorerAction:Ce.EXPLORE})),r.preventDefault(),r.stopPropagation()},children:"Explore"})})]})]})]}),e.jsxs(u,{sx:{display:"grid",gridTemplateColumns:"auto auto",justifyContent:"space-evenly",alignItems:"center"},children:[e.jsx(ue,{title:"Manage table `"+t+"`",placement:"bottom",children:e.jsx(ne,{sx:{color:(j=X)==null?void 0:j.palette.primary.main},onClick:r=>{c(fe({dbs:s,tbl:t,typ:o,explorerAction:Ce.MANAGE})),r.preventDefault(),r.stopPropagation()},children:e.jsx(Rt,{})})}),e.jsx(ue,{title:"Explore table `"+t+"`",placement:"bottom",children:e.jsx(ne,{sx:{color:(n=X)==null?void 0:n.palette.primary.main},onClick:r=>{c(fe({dbs:s,tbl:t,typ:o,explorerAction:Ce.EXPLORE})),r.preventDefault(),r.stopPropagation()},children:e.jsx(Ft,{})})})]})]})}),Fa=i.lazy(()=>q(()=>import("./Alert-1.0.18-8e754392.js"),["./Alert-1.0.18-8e754392.js","./main-1.0.18.js","./index.esm-1.0.18-bb69b89a.js","./iconBase-1.0.18-3c21f5e2.js","./Typography-1.0.18-dc3c0740.js","./AlertTitle-1.0.18-0fd475c6.js","./index-1.0.18-ff546563.js","./useSlot-1.0.18-71f9e7ae.js","./createSvgIcon-1.0.18-dcf0276e.js","./Close-1.0.18-d90e9fa7.js"],import.meta.url)),Ba=i.memo(({dbs:s,search:t})=>{const o=R();l.debug(s,t);const a=C(x=>Vs(x,s));l.debug("tablesLoaded",a);const c=C(x=>Ns(x,s));l.debug("tables",c);const d=C(x=>Ws(x,s));l.debug("tableContext",d);const[y,f]=i.useState("");return i.useEffect(()=>{a||Ct(s,function(x){const j=x==null?void 0:x.data;l.debug("response data",j),o($s({dbs:s,tbl:j,context:x.context??void 0}))},x=>{l.error("error",x),f(x??G.contactSupport)})},[a]),y!==""?e.jsx(i.Suspense,{children:e.jsx(Fa,{severity:"error",message:y,close:!1})}):a?a&&c.length===0?e.jsx(u,{sx:{padding:"1rem"},children:e.jsx(we,{children:"Database contains no tables"})}):e.jsxs(e.Fragment,{children:[...c.map(x=>{const j=!he(x,t);return e.jsx($,{itemId:s+"-"+x,label:e.jsx(ls,{dbs:s,tbl:x,typ:Q.TABLE,tableContext:d}),sx:{visibility:j?"hidden":"inherit",position:j?"fixed !important":"inherit"},children:e.jsx(is,{dbs:s,tbl:x,typ:Q.TABLE})})})]}):e.jsx(U,{})}),Ka=i.lazy(()=>q(()=>import("./Alert-1.0.18-8e754392.js"),["./Alert-1.0.18-8e754392.js","./main-1.0.18.js","./index.esm-1.0.18-bb69b89a.js","./iconBase-1.0.18-3c21f5e2.js","./Typography-1.0.18-dc3c0740.js","./AlertTitle-1.0.18-0fd475c6.js","./index-1.0.18-ff546563.js","./useSlot-1.0.18-71f9e7ae.js","./createSvgIcon-1.0.18-dcf0276e.js","./Close-1.0.18-d90e9fa7.js"],import.meta.url)),Va=({dbs:s,search:t})=>{const o=R();l.debug(s,t);const a=C(x=>Gs(x,s));l.debug(a);const[c,d]=i.useState("");i.useEffect(()=>{a||f()},[a]);const y=C(x=>Hs(x,s));l.debug(y);const f=()=>{St(s,x=>{const j=x==null?void 0:x.data;l.debug("response data",j),o(qs({dbs:s,vws:j}))},x=>{l.error("error",x),d(x??G.contactSupport)})};return c!==""?e.jsx(i.Suspense,{children:e.jsx(Ka,{severity:"error",message:c,close:!1})}):a?a&&y.length===0?e.jsx(u,{sx:{padding:"1rem"},children:e.jsx(we,{children:"Database contains no views"})}):e.jsxs(e.Fragment,{children:[...y.map(x=>{const j=!he(x,t);return e.jsx($,{itemId:s+"-"+x,label:e.jsx(ls,{dbs:s,tbl:x,typ:Q.VIEW}),sx:{visibility:j?"hidden":"unset",position:j?"fixed !important":"inherit"},children:e.jsx(is,{dbs:s,tbl:x,typ:Q.VIEW})})})]}):e.jsx(U,{})},Na=i.lazy(()=>q(()=>import("./Alert-1.0.18-8e754392.js"),["./Alert-1.0.18-8e754392.js","./main-1.0.18.js","./index.esm-1.0.18-bb69b89a.js","./iconBase-1.0.18-3c21f5e2.js","./Typography-1.0.18-dc3c0740.js","./AlertTitle-1.0.18-0fd475c6.js","./index-1.0.18-ff546563.js","./useSlot-1.0.18-71f9e7ae.js","./createSvgIcon-1.0.18-dcf0276e.js","./Close-1.0.18-d90e9fa7.js"],import.meta.url)),Wa=({dbs:s,search:t})=>{l.debug(s,t);const o=R(),a=C(n=>Ys(n,s));l.debug(a);const c=C(n=>Qs(n,s));l.debug(c);const[d,y]=i.useState("");i.useEffect(()=>{a||f()},[a]);const f=()=>{It(s,n=>{const r=n==null?void 0:n.data;l.debug("response data",r),o(Us({dbs:s,prc:r}))},n=>{l.error("error",n),y(n??G.contactSupport)})},x=i.useMemo(()=>[{accessorKey:"routine_name",header:"Name",size:100},{accessorKey:"routine_definition",header:"Body",size:300,Cell:({cell:n})=>e.jsx("pre",{style:{padding:0,margin:0},children:n.getValue()})}],[]),j=oe({...ie,columns:x,data:c.filter(n=>he(n.routine_name,t)),initialState:{density:"comfortable"},muiTableProps:{className:"pp-explorer-table"}});return l.debug(j),d!==""?e.jsx(i.Suspense,{children:e.jsx(Na,{severity:"error",message:d,close:!1})}):a?a&&c.length===0?e.jsx(le,{msg:"Database contains no stored procedures"}):e.jsx(re,{table:j}):e.jsx(U,{})},$a=i.lazy(()=>q(()=>import("./Alert-1.0.18-8e754392.js"),["./Alert-1.0.18-8e754392.js","./main-1.0.18.js","./index.esm-1.0.18-bb69b89a.js","./iconBase-1.0.18-3c21f5e2.js","./Typography-1.0.18-dc3c0740.js","./AlertTitle-1.0.18-0fd475c6.js","./index-1.0.18-ff546563.js","./useSlot-1.0.18-71f9e7ae.js","./createSvgIcon-1.0.18-dcf0276e.js","./Close-1.0.18-d90e9fa7.js"],import.meta.url)),Ga=({dbs:s,search:t})=>{l.debug(s,t);const o=R(),a=C(n=>Js(n,s));l.debug(a);const c=C(n=>Xs(n,s));l.debug(c);const[d,y]=i.useState("");i.useEffect(()=>{a||f()},[a]);const f=()=>{wt(s,n=>{const r=n==null?void 0:n.data;l.debug("response data",r),o(Zs({dbs:s,fnc:r}))},n=>{l.error("error",n),y(n??G.contactSupport)})},x=i.useMemo(()=>[{accessorKey:"routine_name",header:"Name",size:100},{accessorKey:"routine_definition",header:"Body",size:300,Cell:({cell:n})=>e.jsx("pre",{style:{padding:0,margin:0},children:n.getValue()})}],[]),j=oe({...ie,columns:x,data:c.filter(n=>he(n.routine_name,t)),initialState:{density:"comfortable"},muiTableProps:{className:"pp-explorer-table"}});return l.debug(j),d!==""?e.jsx(i.Suspense,{children:e.jsx($a,{severity:"error",message:d,close:!1})}):a?a&&c.length===0?e.jsx(le,{msg:"Database contains no functions"}):e.jsx(re,{table:j}):e.jsx(U,{})};var L=(s=>(s.WP="wp",s.LOCAL="local",s.REMOTE="remote",s.SYSTEM="system",s))(L||{});const Ha=({setShowFilter:s})=>{const t=R(),o=C(c=>Ne(c));l.debug(o);const a=C(c=>et(c));return l.debug(a),i.useEffect(()=>{localStorage.setItem("ppExplorerSearchDbsTypes",JSON.stringify(o))},[o]),e.jsxs(ra,{sx:{position:"absolute",top:"3em",right:"0",minWidth:"-webkit-fill-available",zIndex:9999999},children:[e.jsx(la,{title:"Database filter",sx:{textAlign:"center"}}),e.jsx(ia,{sx:{textAlign:"center",padding:0,borderTop:"1px solid #eee",borderBottom:"1px solid #eee"},children:e.jsxs(u,{sx:{display:"inline-grid",textAlign:"left",padding:"2em","& label":{display:"flex",alignItems:"center"}},children:[e.jsx(te,{children:e.jsxs(Se,{children:[e.jsx(J,{size:"small",checked:o.includes(L.WP),onChange:(c,d)=>{t(d?je({dbsType:L.WP}):ye({dbsType:L.WP}))}}),"WordPress database"]})}),e.jsx(te,{children:e.jsxs(Se,{children:[e.jsx(J,{size:"small",checked:o.includes(L.LOCAL),onChange:(c,d)=>{t(d?je({dbsType:L.LOCAL}):ye({dbsType:L.LOCAL}))}}),"Local databases"]})}),e.jsx(te,{children:e.jsxs(Se,{children:[e.jsx(J,{size:"small",checked:o.includes(L.REMOTE),onChange:(c,d)=>{t(d?je({dbsType:L.REMOTE}):ye({dbsType:L.REMOTE}))}}),"Remote databases"]})}),e.jsx(te,{children:e.jsxs(Se,{children:[e.jsx(J,{size:"small",checked:o.includes(L.SYSTEM),onChange:(c,d)=>{t(d?je({dbsType:L.SYSTEM}):ye({dbsType:L.SYSTEM}))}}),"System databases"]})})]})}),e.jsxs(ca,{sx:{display:"grid",gridTemplateColumns:"1fr 1fr"},children:[e.jsx(u,{}),e.jsx(ge,{variant:"contained",onClick:()=>s(!1),children:"OK"})]})]})},ae=({search:s,setSearch:t,addFilter:o})=>{l.debug(s,o);const[a,c]=i.useState(!1);return e.jsxs(u,{sx:{position:"relative"},children:[e.jsx(as,{value:s,type:"search",onChange:d=>{t(d.target.value)},onClick:d=>{d.stopPropagation()},onKeyDown:d=>{d.stopPropagation()},sx:{backgroundColor:"#fff",fontSize:"1em",margin:0,padding:0,borderRadius:"4px","&.MuiFormControl-root.MuiTextField-root .MuiInputBase-root":{paddingRight:0},"&.MuiFormControl-root.MuiTextField-root input":{padding:"8px"}},InputProps:{startAdornment:e.jsx(Ke,{position:"end",sx:{fontSize:"1.5rem",padding:0,margin:0},children:e.jsx(Bt,{})}),endAdornment:e.jsx(e.Fragment,{children:o&&e.jsx(Ke,{position:"end",sx:{fontSize:"1.5rem",padding:0,margin:0},children:e.jsx(ne,{onClick:()=>{c(!a)},children:e.jsx(Kt,{})})})})}}),a&&e.jsx(Ha,{setShowFilter:c})]})},qa=(s,t)=>{const o=C(a=>st(a,s,t));return l.debug("allTablesSelected",o),o},Ya=(s,t)=>{const o=C(a=>tt(a,s,t));return l.debug("allViewsSelected",o),o},me=s=>{const[t,o]=i.useState(localStorage.getItem(s)??""),a=c=>{o(c),localStorage.setItem(s,c)};return l.debug(t),{search:t,setSearch:a}},Qa=i.memo(({dbs:s})=>{l.debug(s);const t=R(),[o,a]=i.useState(!1),{search:c,setSearch:d}=me(`ppExplorerSearchTables-${s}`);l.debug(o,c);const[y,f]=i.useState(!1),{search:x,setSearch:j}=me(`ppExplorerSearchViews-${s}`);l.debug(y,x);const[n,r]=i.useState(!1),{search:b,setSearch:W}=me(`ppExplorerSearchProcedures-${s}`);l.debug(n,b);const[P,w]=i.useState(!1),{search:D,setSearch:F}=me(`ppExplorerSearchFunctions-${s}`);l.debug(P,D);const z=qa(s,c),_=Ya(s,x),[I,A]=i.useState("");l.debug(I);const v=Ae();return e.jsxs(e.Fragment,{children:[e.jsx($,{itemId:s+"-tables",className:"pp-data-exporer-table-tree-item "+I,onClickCapture:h=>{var O,M;!(h.target instanceof HTMLInputElement)&&!(h.target instanceof HTMLAnchorElement)&&!((O=h.target.closest("span"))!=null&&O.classList.contains("pp-select-all-tables"))&&((M=h.target.closest("li"))!=null&&M.classList.contains("pp-data-exporer-table-tree-item"))&&(A(I===""?"hide-details":""),o?h.stopPropagation():(a(!0),A("")))},sx:{padding:0,minWidth:0,"&.hide-details > ul":{visibility:"hidden",position:"fixed"}},label:e.jsxs(u,{sx:{display:"grid",gridTemplateColumns:"auto auto",gap:"20px",justifyContent:"space-between",alignItems:"center","&:hover":{".pp-row-actions":{display:"grid"}}},children:[e.jsxs(u,{sx:{display:"grid",gridTemplateColumns:"auto auto",gap:"10px",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs(u,{sx:{display:"grid",gridTemplateColumns:"auto auto",gap:o&&I===""?0:"10px",justifyContent:"space-between",alignItems:"center",margin:"0 8px 0 4px"},children:[o&&I===""?e.jsx(J,{size:"small",className:"pp-select-all-tables",checked:z,onClick:h=>{t(We({dbs:s,isSelected:!z,search:c})),h.stopPropagation()},sx:{marginLeft:"-12px"}}):e.jsx(Xe,{}),e.jsxs("span",{style:{display:"grid",gridTemplateColumns:"auto auto",alignItems:"center",gap:"5px"},children:[e.jsx("span",{children:"Tables"}),e.jsx("span",{style:{fontSize:"90%"},children:v[s].tablesLoaded===!0?"("+v[s].tables.length+"/"+v[s].tablesSelected.length+")":""})]})]}),e.jsxs(u,{className:"pp-row-actions",sx:{display:"none",gridTemplateColumns:"auto auto",gridGap:"10px",alignItems:"center"},children:[e.jsx(u,{sx:{borderLeft:"1px solid black",height:"100%"}}),e.jsx(se,{underline:"none",onClick:h=>{t($e({dbs:s})),h.preventDefault(),h.stopPropagation()},children:"Refresh"})]})]}),e.jsx(u,{children:o&&I===""&&e.jsx(ae,{search:c,setSearch:d})})]}),children:e.jsx(Ba,{dbs:s,search:c})}),e.jsx($,{itemId:s+"-views",onClick:()=>{f(!y)},label:e.jsxs(u,{sx:{display:"grid",gridTemplateColumns:"auto auto",gap:"20px",justifyContent:"space-between",alignItems:"center","&:hover":{".pp-row-actions":{display:"grid"}}},children:[e.jsxs(u,{sx:{display:"grid",gridTemplateColumns:"auto auto",gap:"10px",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs(u,{sx:{display:"grid",gridTemplateColumns:"auto auto",gap:y?0:"10px",justifyContent:"space-between",alignItems:"center",margin:"0 8px 0 4px"},children:[y?e.jsx(J,{size:"small",checked:_,onClick:h=>{t(Ge({dbs:s,isSelected:!_,search:x})),h.stopPropagation()},sx:{marginLeft:"-12px"}}):e.jsx(Ze,{}),e.jsxs("span",{style:{display:"grid",gridTemplateColumns:"auto auto",alignItems:"center",gap:"5px"},children:[e.jsx("span",{children:"Views"}),e.jsx("span",{style:{fontSize:"90%"},children:v[s].viewsLoaded===!0?"("+v[s].views.length+"/"+v[s].viewsSelected.length+")":""})]})]}),e.jsxs(u,{className:"pp-row-actions",sx:{display:"none",gridTemplateColumns:"auto auto",gridGap:"10px",alignItems:"center"},children:[e.jsx(u,{sx:{borderLeft:"1px solid black",height:"100%"}}),e.jsx(se,{underline:"none",onClick:h=>{t(He({dbs:s})),h.preventDefault(),h.stopPropagation()},children:"Refresh"})]})]}),e.jsx(u,{children:y&&e.jsx(ae,{search:x,setSearch:j})})]}),sx:{padding:0,minWidth:0},children:e.jsx(Va,{dbs:s,search:x})}),e.jsx($,{itemId:s+"-procedures",onClick:()=>{r(!n)},label:e.jsxs(u,{sx:{display:"grid",gridTemplateColumns:"auto auto",gap:"20px",justifyContent:"space-between",alignItems:"center","&:hover":{".pp-row-actions":{display:"grid"}}},children:[e.jsxs(u,{sx:{display:"grid",gridTemplateColumns:"auto auto",gap:"10px",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs(u,{sx:{display:"grid",gridTemplateColumns:"auto auto",gap:"10px",justifyContent:"space-between",alignItems:"center",margin:"0 8px 0 4px"},children:[e.jsx(Je,{}),e.jsxs("span",{style:{display:"grid",gridTemplateColumns:"auto auto",alignItems:"center",gap:"5px"},children:[e.jsx("span",{children:"Stored Procedures"}),e.jsx("span",{style:{fontSize:"90%"},children:v[s].proceduresLoaded===!0?"("+v[s].procedures.length+")":""})]})]}),e.jsxs(u,{className:"pp-row-actions",sx:{display:"none",gridTemplateColumns:"auto auto",gridGap:"10px",alignItems:"center"},children:[e.jsx(u,{sx:{borderLeft:"1px solid black",height:"100%"}}),e.jsx(se,{underline:"none",onClick:h=>{t(at({dbs:s})),h.preventDefault(),h.stopPropagation()},children:"Refresh"})]})]}),e.jsx(u,{children:n&&e.jsx(ae,{search:b,setSearch:W})})]}),sx:{padding:0,minWidth:0},children:e.jsx(Wa,{dbs:s,search:b})}),e.jsx($,{itemId:s+"-functions",onClick:()=>{w(!P)},label:e.jsxs(u,{sx:{display:"grid",gridTemplateColumns:"auto auto",gap:"20px",justifyContent:"space-between",alignItems:"center","&:hover":{".pp-row-actions":{display:"grid"}}},children:[e.jsxs(u,{sx:{display:"grid",gridTemplateColumns:"auto auto",gap:"10px",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs(u,{sx:{display:"grid",gridTemplateColumns:"auto auto",gap:"10px",justifyContent:"space-between",alignItems:"center",margin:"0 8px 0 4px"},children:[e.jsx(Xt,{}),e.jsxs("span",{style:{display:"grid",gridTemplateColumns:"auto auto",alignItems:"center",gap:"5px"},children:[e.jsx("span",{children:"Functions"}),e.jsx("span",{style:{fontSize:"90%"},children:v[s].functionsLoaded===!0?"("+v[s].functions.length+")":""})]})]}),e.jsxs(u,{className:"pp-row-actions",sx:{display:"none",gridTemplateColumns:"auto auto",gridGap:"10px",alignItems:"center"},children:[e.jsx(u,{sx:{borderLeft:"1px solid black",height:"100%"}}),e.jsx(se,{underline:"none",onClick:h=>{t(nt({dbs:s})),h.preventDefault(),h.stopPropagation()},children:"Refresh"})]})]}),e.jsx(u,{children:P&&e.jsx(ae,{search:D,setSearch:F})})]}),sx:{padding:0,minWidth:0},children:e.jsx(Ga,{dbs:s,search:D})})]})}),Ua=()=>{const s=C(t=>ot(t));return l.debug("countSelectedTables",s),s},Ja=()=>{const s=C(t=>rt(t));return l.debug("hasBulkActions",s),s},Xa=()=>{const s=C(t=>it(t));return l.debug("countSelectedViews",s),s};function Za(s){const t=i.useRef(null);return e.jsx(xa,{nodeRef:t,handle:"#draggable-dialog-title",cancel:'[class*="MuiDialogContent-root"]',children:e.jsx(Me,{ref:t,...s})})}const Pe=s=>{const{title:t,message:o,open:a,setOpen:c,onConfirm:d}=s;return e.jsxs(ga,{open:a,onClose:()=>c(!1),PaperComponent:Za,"aria-labelledby":"confirm-dialog",children:[e.jsx(pa,{style:{marginTop:"10px",cursor:"move"},id:"draggable-dialog-title",children:t}),e.jsx(ha,{children:e.jsx(ua,{component:"div",children:o})}),e.jsx(fa,{sx:{marginRight:"15px",marginBottom:"15px"},children:e.jsx(ge,{variant:"contained",onClick:()=>{c(!1),d!==void 0&&d()},children:"OK"})})]})},cs=()=>{const s=C(t=>lt(t));return l.debug("context",s),s},de={export:"Export table(s)",truncate:"Truncate table(s)",drop:"Drop table(s)/view(s)"},en=()=>{const s=R(),t=Ja(),o=Ua(),a=Xa(),c=cs(),[d,y]=i.useState({}),[f,x]=i.useState("*"),[j,n]=i.useState(null),[r,b]=i.useState(!1),[W,P]=i.useState(!1),[w,D]=i.useState(!1);i.useEffect(()=>{o===0&&(f==="export"||f==="truncate")&&x("*")},[o]);const F={vertical:"top",horizontal:"right"},z=()=>{const m=ct(dt.getState()),p={};return m==null?{}:(Object.keys(m).map(g=>{m[g].tablesSelected.map(T=>{p[g]===void 0&&(p[g]={}),p[g][T]={status:null,typ:Q.TABLE}}),f==="drop"&&m[g].viewsSelected.map(T=>{p[g]===void 0&&(p[g]={}),p[g][T]={status:null,typ:Q.VIEW}})}),p)},_=(m,p,g)=>{const T={...d};p==="*"?Object.keys(T[m]).map(E=>T[m][E].status=g):T[m][p].status=g,y(T)},I=()=>{Object.keys(d).length>0&&Object.keys(d).map(m=>{window.document.getElementById(`pp-export-tables-${m}`).submit(),_(m,"*",!0)})},A=()=>{Object.keys(d).length>0&&Object.keys(d).map(m=>{Object.keys(d[m]).map(p=>{Pt(m,p,g=>{l.debug(g),(g==null?void 0:g.code)==="ok"&&(g==null?void 0:g.message)!==void 0?_(m,p,!0):_(m,p,!1)},g=>{l.error("error",m,p,g),_(m,p,!1)})})})},v=()=>{Object.keys(d).length>0&&Object.keys(d).map(m=>{Object.keys(d[m]).map(p=>{Lt(m,p,d[m][p].typ,g=>{l.debug(g),(g==null?void 0:g.code)==="ok"&&(g==null?void 0:g.message)!==void 0?_(m,p,!0):_(m,p,!1)},g=>{l.error("error",g),_(m,p,!1)})})})},h=m=>e.jsxs(Ye,{sx:{"& th":{fontWeight:"bold",padding:"4px 6px"},"& td":{padding:"4px 6px",border:"none"}},children:[e.jsx(Qe,{children:e.jsxs(Ie,{children:[e.jsx(N,{children:"Database"}),e.jsx(N,{children:"Table | View"}),e.jsx(N,{children:"Status"})]})}),e.jsx(Ue,{children:Object.keys(m).map(p=>Object.keys(m[p]).map((g,T)=>{var E,S;return e.jsxs(Ie,{children:[e.jsx(N,{children:T===0?p:null}),e.jsx(N,{children:g}),e.jsxs(N,{children:[m[p][g]===null&&e.jsx(Nt,{style:{display:"block",margin:"0 auto"}}),m[p][g].status===!0&&e.jsx(es,{color:(E=X)==null?void 0:E.palette.success.main,style:{display:"block",margin:"0 auto"}}),m[p][g].status===!1&&e.jsx(ss,{color:(S=X)==null?void 0:S.palette.error.main,style:{display:"block",margin:"0 auto"}})]})]},T)}))})]}),O=()=>e.jsx(u,{children:h(d)}),M=()=>{const m=z();return y(m),e.jsxs(u,{children:[h(m),(f==="truncate"||f==="drop")&&e.jsxs(e.Fragment,{children:[e.jsx("hr",{style:{marginTop:"20px"}}),e.jsx(u,{sx:{marginTop:"20px",marginBottom:"20px"},children:f==="drop"?e.jsx("span",{children:"Deletes views and tables with all data permanently."}):e.jsx("span",{children:"Deletes all data permanently."})}),e.jsx(u,{children:e.jsx("strong",{children:"This actions cannot be undone!"})}),e.jsxs(u,{children:["'",e.jsx("strong",{children:"NO"}),"' to stop, '",e.jsx("strong",{children:"YES"}),"' to continue."]}),e.jsxs(u,{sx:{marginTop:"20px",fontSize:"80%",display:"inline-grid",gridTemplateColumns:"auto auto",justifyContent:"space-between",alignItems:"center",gap:"5px"},children:[e.jsx(Vt,{}),e.jsxs("span",{children:["Does not ",f," WordPress tables"]})]})]})]})};return t?e.jsxs(e.Fragment,{children:[e.jsx(De,{className:"pp-bulk-actions-container",color:"inherit",position:"relative",elevation:4,sx:{margin:"0 0 5px 0"},children:e.jsxs(Oe,{sx:{display:"grid",gridTemplateColumns:"auto auto",gap:"12px",justifyContent:"space-between"},children:[e.jsxs(u,{sx:{display:"grid",gridTemplateColumns:"auto auto",gap:"12px",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(te,{variant:"standard",sx:{minWidth:200},children:e.jsxs(ns,{MenuProps:{id:"pp-select-menu"},value:f,onChange:m=>{x(m.target.value)},children:[e.jsx(xe,{value:"*",children:"Bulk actions"}),e.jsx(xe,{value:"export",disabled:o===0,children:de.export}),e.jsx(xe,{value:"truncate",disabled:o===0,children:de.truncate}),e.jsx(xe,{value:"drop",children:de.drop})]})}),e.jsx(ge,{variant:"contained",onClick:()=>{f!=="*"?(n(M()),b(!0)):P(!0)},children:"Apply"})]}),e.jsxs(u,{sx:{display:"grid",gridTemplateColumns:"auto auto",gap:"12px",justifyContent:"space-between"},children:[e.jsx(Re,{badgeContent:o,color:"info",anchorOrigin:F,children:e.jsx(Xe,{color:"action",size:20})}),e.jsx(Re,{badgeContent:a,color:"info",anchorOrigin:F,children:e.jsx(Ze,{color:"action",size:20})})]})]})}),f==="export"&&Object.keys(d).map(m=>e.jsxs("form",{id:"pp-export-tables-"+m,action:c.wp.home+"?action=wpda_export",method:"post",target:"_blank",children:[e.jsx("input",{type:"hidden",name:"type",value:"table"}),e.jsx("input",{type:"hidden",name:"wpdaschema_name",value:m}),Object.keys(d[m]).map(p=>e.jsx("input",{type:"hidden",name:"table_names[]",value:p},p)),e.jsx("input",{type:"hidden",name:"_wpnonce",value:c.wp.nonce.split("-")[0]})]},"pp-export-tables-"+m)),e.jsx(Pe,{title:"Apply bulk action",message:"No bulk action selected",open:W,setOpen:P}),e.jsx(os,{title:de[f],message:j,open:r,setOpen:b,onConfirm:()=>{switch(D(!0),f){case"export":I();break;case"truncate":A();break;case"drop":v()}}}),e.jsx(Pe,{title:de[f],message:O(),open:w,setOpen:D,onConfirm:()=>{Object.keys(d).map(m=>{s($e({dbs:m})),s(We({dbs:m,isSelected:!1,search:""})),s(He({dbs:m})),s(Ge({dbs:m,isSelected:!1,search:""}))})}})]}):null},sn=({setCanImport:s})=>{var O,M,m;const t=cs(),o=Ae(),[a,c]=i.useState(""),[d,y]=i.useState("");i.useEffect(()=>{if(o!=null&&Object.keys(o).length>0){const p=Object.keys(o).filter(g=>o[g].dbsType===L.WP);(p==null?void 0:p.length)>0&&c(p[0])}},[o]);const f=i.useRef(null),[x,j]=i.useState(null),n=(O=t==null?void 0:t.wp)!=null&&O.zip?".sql,.zip":".sql",r=(M=t==null?void 0:t.wp)!=null&&M.zip?"SQL and ZIP":"SQL",b=(m=t==null?void 0:t.wp)==null?void 0:m.upload,[W,P]=i.useState(!1),[w,D]=i.useState(null),[F,z]=i.useState(!1),[_,I]=i.useState(""),[A,v]=i.useState(null),h=p=>e.jsx(e.Fragment,{children:e.jsxs(Ye,{sx:{"& th":{fontWeight:"bold",padding:"4px 6px"},"& td":{padding:"4px 6px",border:"none"}},children:[e.jsx(Qe,{children:e.jsxs(Ie,{children:[e.jsx(N,{children:"Import file"}),e.jsx(N,{children:"Message"}),e.jsx(N,{children:"Status"})]})}),e.jsx(Ue,{children:p.map(g=>Object.keys(g).map(T=>{var E,S;return e.jsxs(Ie,{children:[e.jsx(N,{sx:{verticalAlign:"text-top"},children:T}),e.jsxs(N,{sx:{verticalAlign:"text-top"},children:[g[T].msg,g[T].errors.map(B=>{var H;return e.jsx("ul",{style:{listStyle:"disc",padding:"0 40px"},children:e.jsx("li",{style:{color:(H=X)==null?void 0:H.palette.error.main},children:B})})})]}),e.jsx(N,{sx:{verticalAlign:"text-top"},children:g[T].status==="error"?e.jsx(ss,{color:(E=X)==null?void 0:E.palette.error.main,style:{display:"block",margin:"0 auto"}}):e.jsx(es,{color:(S=X)==null?void 0:S.palette.success.main,style:{display:"block",margin:"0 auto"}})})]},T)}))})]})});return e.jsxs(e.Fragment,{children:[e.jsxs(u,{className:"pp-import-container",sx:{position:"relative","& > .tooltip":{position:"absolute",top:"10px",right:"10px",zIndex:999}},children:[e.jsx(ma,{title:"Close",position:"bottom",children:e.jsx(ne,{onClick:()=>{f.current&&(f.current.value=""),y(""),s(!1)},size:"large",color:"inherit",sx:{fontSize:"1.4em"},children:e.jsx(Wt,{})})}),e.jsx(De,{className:"pp-import-container",color:"inherit",position:"relative",elevation:4,sx:{display:"grid",alignItems:"center",margin:"0 0 5px 0"},children:e.jsxs(Oe,{sx:{display:"grid",gap:"10px",alignItems:"center",height:"max-content",paddingTop:"50px",paddingBottom:"30px"},children:[e.jsx(e.Fragment,{children:e.jsxs(u,{sx:{display:"flex",flexWrap:"wrap",justifyContent:"start",alignItems:"center",gap:"15px"},children:[e.jsx(u,{children:e.jsxs(te,{sx:{minWidth:"300px"},children:[e.jsx(da,{variant:"outlined",children:"Select destination database"}),e.jsx(ns,{MenuProps:{id:"pp-select-menu"},label:"Select destination database",value:a,onChange:p=>{c(p.target.value)},children:o!=null&&Object.keys(o).map(p=>{const g=o[p].dbsType===L.WP?p+" (WordPress database)":p;return e.jsx(xe,{value:p,children:g},p)})})]})}),e.jsx(u,{children:e.jsx("form",{children:e.jsxs(ge,{component:"label",variant:"outlined",startIcon:e.jsx($t,{}),children:["Select file(s)",e.jsx(as,{type:"file",inputProps:{accept:n,multiple:!0},onChange:p=>{const g=p.target.files;j(g);const T=Object.keys(g).map(E=>g[E].name).toString();y(T)},InputProps:{inputRef:f},sx:{display:"none"}})]})})}),d!==""&&e.jsx(e.Fragment,{children:e.jsx(u,{children:e.jsx(ge,{component:"label",variant:"contained",startIcon:e.jsx(Gt,{}),onClick:()=>{D(e.jsxs(u,{children:[e.jsxs(u,{sx:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:["Selected file(s): ",e.jsx("strong",{children:d})]}),e.jsxs(u,{children:["Selected database: ",e.jsx("strong",{children:a})]}),e.jsxs(u,{sx:{marginTop:"20px",fontSize:"80%"},children:[e.jsx("strong",{children:"NOTE"}),"  You can work on other tasks while your import is performed in the background."]})]})),P(!0)},children:"Import file(s)"})})})]})}),d!==""&&e.jsxs(u,{sx:{marginTop:"20px",marginBottom:"10px",minWidth:0,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",textAlign:"left",fontWeight:"bold"},children:["Selected file(s): ",d]}),e.jsxs("fieldset",{className:"pp-fieldset",style:{marginTop:"5px",padding:"10px 30px",minWidth:0},children:[e.jsx("legend",{children:"IMPORTANT"}),e.jsxs("ul",{style:{paddingLeft:"15px",listStyle:"disc",padding:"0 40px"},children:[e.jsx("li",{children:"Supports multiple file uploads simultaneously."}),e.jsxs("li",{children:["Server supports ",r," file types."]}),e.jsxs("li",{children:["Maximum supported file size on this server is ",b,"."]}),e.jsx("li",{children:"Add a ; and a new line character at the end of every SQL statement."})]})]})]})})]}),e.jsx(os,{title:"Import selected file(s)?",message:w,open:W,setOpen:P,onConfirm:()=>{At(a,x,p=>{var g;if(p!=null&&p.message&&((g=p==null?void 0:p.context)!=null&&g.imported)&&Array.isArray(p.context.imported)){const T=p.context.imported;z(!0),I(p.message),v(h(T))}else ze(G.contactSupport,{variant:"error"})},p=>{l.error("error",p),ze(G.contactSupport,{variant:"error"})})}}),e.jsx(Pe,{title:_,message:A,open:F,setOpen:z,onConfirm:()=>{y(""),s(!1)}})]})};const Ve=i.lazy(()=>q(()=>import("./Alert-1.0.18-8e754392.js"),["./Alert-1.0.18-8e754392.js","./main-1.0.18.js","./index.esm-1.0.18-bb69b89a.js","./iconBase-1.0.18-3c21f5e2.js","./Typography-1.0.18-dc3c0740.js","./AlertTitle-1.0.18-0fd475c6.js","./index-1.0.18-ff546563.js","./useSlot-1.0.18-71f9e7ae.js","./createSvgIcon-1.0.18-dcf0276e.js","./Close-1.0.18-d90e9fa7.js"],import.meta.url)),po=()=>{var v;const s=R(),t=i.useRef(null),{search:o,setSearch:a}=me("ppExplorerSearch"),c=Ae(),d=C(h=>pt(h));l.debug(d);const y=C(h=>ut(h));l.debug(y);const f=C(h=>Ne(h));l.debug(f);const[x,j]=i.useState("");i.useEffect(()=>{window.ppActionEnableImport=(h=!0)=>{D(h)},n()},[]);const n=()=>{let h=[];const O=localStorage.getItem("ppExplorerSearchDbsTypes");O!=null&&O!==""?h=JSON.parse(O):h=[L.WP,L.LOCAL,L.REMOTE],vt(M=>{const m=M==null?void 0:M.data;l.debug("response data",m);const p=[],g={};m.map(S=>{p.push({dbs:S.dbs,dbsType:S.dbs_type,pdsDbs:S.pds}),g[S.dbs]=!1}),b(g),p.sort((S,B)=>{var H,Z,K,ce;return((H=S==null?void 0:S.dbs)==null?void 0:H.toLocaleLowerCase())>((Z=B==null?void 0:B.dbs)==null?void 0:Z.toLocaleLowerCase())?1:((K=B==null?void 0:B.dbs)==null?void 0:K.toLocaleLowerCase())>((ce=S==null?void 0:S.dbs)==null?void 0:ce.toLocaleLowerCase())?-1:0}),l.debug(p),s(gt({dbs:p,dbsTypes:h}));const T={};m.map(S=>{T[S.dbs]=S.dbs_type}),s(ht({dbs:T}));const E=M.context;l.debug("context",E),s(ft({context:E}))},M=>{l.error("error",M),j(M??G.contactSupport)})},[r,b]=i.useState({}),[W,P]=i.useState(!0),[w,D]=i.useState(!1),F=()=>e.jsx(ue,{title:"Import data or execute scripts",children:e.jsx(ne,{sx:{color:"inherit"},onClick:()=>{D(!w)},children:e.jsx(qt,{})})}),z=()=>e.jsx(ne,{onClick:()=>{A(I==="large"?"medium":I==="medium"?"small":"large")},sx:{color:"#fff"},children:I==="small"?e.jsx(Yt,{}):I==="medium"?e.jsx(Qt,{}):e.jsx(Ut,{})}),_=localStorage.getItem("ppDataExplorerDensity"),[I,A]=i.useState(_==="large"||_==="medium"?_:"small");return i.useEffect(()=>{localStorage.setItem("ppDataExplorerDensity",I)},[I]),x!==""?e.jsx(i.Suspense,{children:e.jsx(Ve,{severity:"error",message:x,close:!1})}):e.jsxs(u,{className:"pp-sub-container-explorer",sx:{width:"100%"},children:[e.jsx(De,{className:"pp-explorer-header",elevation:4,position:"relative",sx:{margin:"0 0 5px 0"},children:e.jsx(Oe,{sx:{display:"grid",gridTemplateColumns:"1fr auto",gap:"12px",justifyContent:"space-between",paddingRight:"0 !important"},children:((v=xt.appOrig)==null?void 0:v.appTarget)==="backend"?e.jsxs(u,{sx:{display:"grid",gridTemplateColumns:"auto auto auto",justifyContent:"end",alignItems:"center",gridGap:"10px"},children:[z(),e.jsx(u,{sx:{textAlign:"right"},children:"Search & Filter"}),e.jsx(ae,{search:o,setSearch:a,addFilter:!0})]}):e.jsxs(u,{sx:{display:"grid",gridTemplateColumns:"auto auto 1fr",justifyContent:"space-between",alignItems:"center",gridGap:"10px"},children:[e.jsx(u,{sx:{fontSize:"18px",lineHeight:"18px",fontWeight:"bold",whiteSpace:"nowrap"},children:"Data Explorer"}),e.jsx(u,{children:F()}),e.jsxs(u,{sx:{display:"grid",gridTemplateColumns:"auto auto",justifyContent:"end",alignItems:"center",gap:"10px"},children:[z(),e.jsx(ae,{search:o,setSearch:a,addFilter:!0})]})]})})}),e.jsx(en,{}),w&&e.jsx(sn,{setCanImport:D}),c==null?e.jsx(u,{sx:{padding:"30px"},children:e.jsx(kt,{title:"Loading..."})}):e.jsxs(e.Fragment,{children:[d!==""&&e.jsx(Me,{sx:{marginBottom:"5px"},elevation:4,children:e.jsx(i.Suspense,{children:e.jsx(Ve,{severity:"error",message:d,close:!0,setClose:()=>{s(mt({error:""}))}})})}),e.jsx(Me,{className:"pp-data-exporer",elevation:4,children:e.jsx(aa,{className:"pp-data-exporer-database-tree pp-density-"+I,"aria-label":"Data Explorer",sx:{display:"grid",gridGap:"0","& li.MuiTreeItem-root:first-of-type li.MuiTreeItem-root:first-of-type":{borderTopLeftRadius:0,borderTopRightRadius:0}},children:Object.keys(c).map(h=>{var M;if(f.includes(y[h])===!1||o!==""&&!he(h,o))return null;const O=((M=y[h])==null?void 0:M.toLocaleLowerCase())==="wp"?h+" (WordPress database)":h;return e.jsx($,{ref:t,slots:{expandIcon:Fe,collapseIcon:W?Fe:Ht},itemId:h,className:"pp-data-exporer-database-tree-item hide-details",onClickCapture:m=>{var p,g,T,E;if((p=m.target.closest("li"))!=null&&p.classList.contains("pp-data-exporer-database-tree-item"))if((g=m.target.closest("li"))!=null&&g.classList.contains("hide-details")?((T=m.target.closest("li"))==null||T.classList.remove("hide-details"),P(!1)):((E=m.target.closest("li"))==null||E.classList.add("hide-details"),P(!0)),r[h])m.stopPropagation();else{const S=r;S[h]=!0,b(S)}},sx:{padding:"0","&:first-of-type":{borderTopLeftRadius:"4px",borderTopRightRadius:"4px",overflow:"hidden"},"&.hide-details > ul":{visibility:"hidden",position:"fixed"}},label:e.jsxs(u,{sx:{display:"grid",gridTemplateColumns:"auto auto",justifyContent:"start",alignItems:"center",gap:"10px"},children:[e.jsx(Dt,{}),O]}),children:e.jsx(Qa,{dbs:h})},h)})})})]})]})};export{po as default};
