const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./TableContainer-1.0.36-CsHiUQr0.js","./cm-1.0.36-c_d2YVSf.js","./redux-1.0.36-Dw38apwx.js","./vendor-1.0.36-CN03Eozo.js","./AdminTheme-1.0.36-Bhvs-n11.js","./lib-1.0.36-RK2jtnD_.js","./loglevel-1.0.36-BZ7XahX3.js","./lodash-1.0.36-DFhYoGis.js","./moment-1.0.36-C5S46NFB.js","./Typography-1.0.36-CpRCY5e-.js","./main-1.0.36.js","./notistack-1.0.36-BWLrSPn1.js","./tanstack-1.0.36-BtzdZ5qw.js","./FallbackSpinner-1.0.36-D7KlMhQ_.js","./Spinner-1.0.36-BfGTD4Gb.js","./hooks-1.0.36-DVpFeylj.js","./ActionsSettings-1.0.36-BoYKkBaN.js","./RestApi-1.0.36-XUqEDvWp.js","./TargetEnum-1.0.36-DPFnTxiX.js","./Tooltip-1.0.36-COg3Mxx7.js","./iconBase-1.0.36-Cg_-P7_6.js","./useEnhancedEffect-1.0.36-CTzd5Szc.js","./Tooltip-1.0.36--D4jr2go.css","./ScopeEnum-1.0.36-B4DDvIDj.js","./index-1.0.36-BaUawQwX.js","./index-1.0.36-Cdz_jNzK.js","./TabPanel-1.0.36-CEnbl1IG.js","./useThemeProps-1.0.36-BvrgfXwP.js","./getThemeProps-1.0.36-R5fuQQuM.js","./ConfirmDialog-1.0.36-_-4q7QfI.js","./useTableUpdater-1.0.36-hYY8Nrtx.js","./settings-1.0.36-CMky96jX.js","./Menu-1.0.36-BJc4ujw0.js","./ThemeProvider-1.0.36-BePdakPr.js","./isHostComponent-1.0.36-DVu5iVWx.js","./debounce-1.0.36-Be36O1Ab.js","./MenuItem-1.0.36-BUF9VZzL.js","./dividerClasses-1.0.36-cwzIcK9n.js","./settings-1.0.36-Bx2jvYL6.css","./LanguagesSupport-1.0.36-CNwr1suX.js","./useFormDetails-1.0.36-Bik4Yf-M.js","./useChartSettings-1.0.36-DKli_4MO.js","./Row-1.0.36-DStLjbIC.js","./useTableSettings-1.0.36-CsJX39Me.js","./useStoreTable-1.0.36-DAzrykvV.js","./ActionsDml-1.0.36-CcZ8-7p5.js","./AppTheme-1.0.36-BB9LBkIC.js","./index-1.0.36-xGqEIHxf.js","./useStoreFormSettings-1.0.36-DjvLmz7r.js","./useScreenSize-1.0.36-Cyh3FPEf.js","./dompurify-1.0.36-DhD2mIk-.js","./AlertDialog-1.0.36-PpU2DQEA.js","./SanitizeComponent-1.0.36-DO2eoRBQ.js","./Tooltip-1.0.36-BmrJt8sK.js","./useControlled-1.0.36-DU9XYnsb.js","./Popper-1.0.36-B2EKBEPA.js","./Alert-1.0.36-rBuhK0_W.js","./AlertTitle-1.0.36-BMDG6EIt.js","./createSvgIcon-1.0.36-CIHUMY7B.js","./Close-1.0.36-Bg2BHC5L.js","./Settings-1.0.36-xUukCfSJ.js","./useFormStore-1.0.36-GV5p6sJj.js","./TableChartDock-1.0.36-Ca9tBvtf.js","./Chart-1.0.36-DVqQ3GnJ.js"])))=>i.map(i=>d[i]);
import{_ as se}from"./main-1.0.36.js";import{j as t}from"./cm-1.0.36-c_d2YVSf.js";import{r as i}from"./redux-1.0.36-Dw38apwx.js";import{l as r,b8 as Et,b6 as Ct,b7 as Xt,b4 as L,P as Qt,v as qt,b9 as Zt,a_ as Re,S as ne,ba as Le,E as Kt,bb as ct,bc as mt,bd as Me,be as It,bf as Ue,W as He,bg as Oe,bh as en,A as Ae,bi as ke,T as Ft,b as tn,aW as De,b5 as dt,af as nn,U as sn,d as on,a8 as rn,X as ln,bj as an,bk as un,bl as cn,bm as mn}from"./lib-1.0.36-RK2jtnD_.js";import{u as q,a as _e}from"./hooks-1.0.36-DVpFeylj.js";import{B as M,S as Ye}from"./Spinner-1.0.36-BfGTD4Gb.js";import{a as dn}from"./AdminTheme-1.0.36-Bhvs-n11.js";import{u as ze}from"./useStoreTable-1.0.36-DAzrykvV.js";import{s as fn,u as ft,i as gt}from"./ActionsDml-1.0.36-CcZ8-7p5.js";import{e as k}from"./notistack-1.0.36-BWLrSPn1.js";import{a as gn,u as We}from"./AppTheme-1.0.36-BB9LBkIC.js";import"./moment-1.0.36-C5S46NFB.js";import{c as Ge,a as vt,u as xn,b as hn}from"./useChartSettings-1.0.36-DKli_4MO.js";import{A as wt,T as Rt,X as xt,J as ht,e as Mt,M as Ot,E as pn}from"./index-1.0.36-Cdz_jNzK.js";import{u as kt}from"./useStoreFormSettings-1.0.36-DjvLmz7r.js";import{u as Nt,C as bn,B as _n}from"./useFormDetails-1.0.36-Bik4Yf-M.js";import{u as jn}from"./useScreenSize-1.0.36-Cyh3FPEf.js";import{D as Sn,B as me,C as Tn}from"./ConfirmDialog-1.0.36-_-4q7QfI.js";import"./dompurify-1.0.36-DhD2mIk-.js";import{g as yn}from"./vendor-1.0.36-CN03Eozo.js";import{r as En,D as Q}from"./LanguagesSupport-1.0.36-CNwr1suX.js";import{P as pt,I as be}from"./iconBase-1.0.36-Cg_-P7_6.js";import{T as Cn}from"./ThemeProvider-1.0.36-BePdakPr.js";import{F as Be}from"./FallbackSpinner-1.0.36-D7KlMhQ_.js";import{A as Fn}from"./AlertDialog-1.0.36-PpU2DQEA.js";import{S as bt}from"./SanitizeComponent-1.0.36-DO2eoRBQ.js";import{T as _t}from"./Tooltip-1.0.36-BmrJt8sK.js";const Pe=e=>{const o=q(m=>{var l,b;return(b=(l=m.forms[e])==null?void 0:l.state)==null?void 0:b.data});return r.debug("data",o,e),o};var Ve=(e=>(e[e.SELECT=0]="SELECT",e[e.INSERT=1]="INSERT",e[e.UPDATE=2]="UPDATE",e[e.DELETE=3]="DELETE",e[e.EXPORT=4]="EXPORT",e[e.IMPORT=5]="IMPORT",e[e.VIEW=6]="VIEW",e))(Ve||{});i.lazy(()=>se(()=>import("./TableContainer-1.0.36-CsHiUQr0.js").then(e=>e.T),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41]),import.meta.url));i.lazy(()=>se(()=>import("./TableContainer-1.0.36-CsHiUQr0.js").then(e=>e.T),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41]),import.meta.url));const Pt=e=>4,vn=e=>{const o=q(m=>{var l;return((l=m.forms[e])==null?void 0:l.columns)??[]});return r.debug("storeColumns",o),o},jt=e=>{const o=q(m=>m.forms[e]!==void 0?m.forms[e].columns.filter(l=>l.more).length>0:!1);return r.debug("hasMoreColumns",o),o},wn=e=>{const o=q(m=>{var l,b;return((b=(l=m.forms[e])==null?void 0:l.state)==null?void 0:b.more)??!1});return r.debug("moreState",o),o},Rn=e=>{const o=q(m=>{var l,b;return(b=(l=m.forms[e])==null?void 0:l.state)==null?void 0:b.initialData});return r.debug("initialData",o),o},Vt=e=>({}),Lt=e=>(Pe(e),m=>{}),Mn=e=>(_e(),(m,l)=>{}),On=(e,o)=>(_e(),(l,b)=>{}),kn=i.lazy(()=>se(()=>import("./Row-1.0.36-DStLjbIC.js"),__vite__mapDeps([42,10,1,2,3,11,5,6,7,8,15,43,41,39,14,9,4,44,45,17,46,47,28,21,25,20,48,40,49,29,50,33,13,51,52,53,54,55]),import.meta.url)),Nn=({appId:e,metaData:o,primaryKey:m,formMode:l,formUuid:b})=>{var H;r.debug(e,o,m,l,b);const v=kt(),W=Ge(e),_=Pe(e),w=Rn(e),N=Vt(),f=Lt(e),x=Mn(),P=On();i.useEffect(()=>{var g;Et(o)&&((g=N==null?void 0:N.onRowInit)==null?void 0:g.enabled)==!0&&Ct(N.onRowInit.code??"",Xt(o),!1,{mode:l,getColumnValue:f,setColumnValue:x,setColumnStyle:P})},[]);const[T,Z]=i.useState("30px");return i.useEffect(()=>{},[v.spacing]),t.jsx("form",{id:b,className:"pp-form-content",onSubmit:g=>(g.preventDefault(),!1),children:t.jsx(M,{className:"pp-form-grid",sx:{display:"grid",gridTemplateColumns:{lg:`repeat(${v.cellsPerRow}, 1fr)`,md:"repeat("+Math.min(v.cellsPerRow,2)+", 1fr)",xs:"1fr"},gap:T,marginBottom:0,background:v.showGrid?((H=gn)==null?void 0:H.palette.mode)===Qt.LIGHT?"repeating-linear-gradient( -45deg, transparent, transparent 10px, #eee 10px, #eee 20px )":"repeating-linear-gradient( -45deg, transparent, transparent 10px, #111 10px, #111 20px )":"","& p.MuiFormHelperText-root":{...l===L.VIEW&&!0&&{display:"none"}}},children:t.jsx(i.Suspense,{fallback:t.jsx(Ye,{}),children:t.jsx(kn,{appId:e,metaData:o,data:_,initialData:w,primaryKey:m,formMode:l,formSettings:v,language:W.language})})})})},Pn=e=>{const o=q(m=>{var l,b;return((b=(l=m.forms[e])==null?void 0:l.state)==null?void 0:b.m2mUpdate)??!1});return r.debug("m2mUpdate",o),o},Vn=({code:e,safeMode:o,isExpression:m,args:l})=>{const b=Ct(e,o,m,l);return window.jQuery&&b instanceof window.jQuery&&b.html(),null};var Ln=En();const Ne=yn(Ln),St=i.lazy(()=>se(()=>import("./Alert-1.0.36-rBuhK0_W.js"),__vite__mapDeps([56,1,2,3,24,20,9,5,6,7,8,21,57,58,59]),import.meta.url)),Tt=({appId:e,primaryKey:o,formMode:m,showTable:l,showForm:b,detailKey:v,children:W,relationAppId:_,relTab:w,joinTab:N,isEmbedded:f,masterAppId:x,isModal:P})=>{var Ke,Ie,et,tt,nt,st;r.debug(e,o,m,v,_,w,N,f,x,P);const T=_e(),Z=i.useRef(null),H=vn(e),g=vt(e),K=Pt(),O=ze(e),oe=Ge(e),D=Vt();Lt(e);const[G,$]=i.useState(m),J=i.useMemo(()=>qt(),[]),[I,Y]=i.useState(!1),[ee,de]=i.useState(""),s=We(e),re=Pe(e),F=Zt((Ke=s==null?void 0:s.app)==null?void 0:Ke.container[0]),fe=Pn(e),U=We(x??""),je=Pe(x??""),ge=Nt(e),[ie,le]=i.useState(null);i.useEffect(()=>{r.debug(fe,e),fe===!0&&(r.debug("setM2MUpdate: false"),X(!1,()=>{},()=>{},()=>{T(ct({appId:e,update:!1}))}))},[fe]),i.useEffect(()=>{o===null?Te():Object.keys(o).length>0?Se():Y(!0)},[o]);const Se=()=>{fn(e,o,s==null?void 0:s.media,n=>{if(r.debug(n),(n==null?void 0:n.code)==="ok"){if(Array.isArray(n.data)&&n.data.length>0){const d={...n.data[0]},h={...n.context};delete h.debug,T(Le({appId:e,data:d,context:h})),n.data.length>1?le("Query returned more than one row. Check configuration."):le(null)}else{const d={...n.context};delete d.debug,T(Le({appId:e,data:{},context:d})),le("Invalid primary key. Check configuration.")}Y(!0)}else k(g.invalidResponse,{variant:"error"})},n=>{r.error("error",n),de(n??g.invalidResponse)},!1,w)},Te=()=>{var n,d;if(s.columns&&Array.isArray(s.columns)){const h={},y=Re.getSelectors().selectFormColumns(ne.getState().forms,e),a=Object.fromEntries(y.map(p=>[p.columnName,p.defaultValue]));r.debug("defaultValues",a);for(let p=0;p<s.columns.length;p++)h[s.columns[p].column_name]=null,a[s.columns[p].column_name]!==void 0&&(a[s.columns[p].column_name]==="@wpda_wp_user_id"?h[s.columns[p].column_name]=(d=(n=s==null?void 0:s.settings)==null?void 0:n.env)==null?void 0:d.id:a[s.columns[p].column_name]==="@now"?s.columns[p]==="date"?h[s.columns[p].column_name]=Ne(Date.now()).format("YYYY-MM-DD"):h[s.columns[p].column_name]=Ne(Date.now()).format("YYYY-MM-DD HH:mm:ss"):s.columns[p].column_default!==null&&s.columns[p].column_default!=="NULL"&&s.columns[p].column_default!==""?s.columns[p].column_default==="CURRENT_TIMESTAMP"?s.columns[p]==="date"?h[s.columns[p].column_name]=Ne(Date.now()).format("YYYY-MM-DD"):h[s.columns[p].column_name]=Ne(Date.now()).format("YYYY-MM-DD HH:mm:ss"):h[s.columns[p].column_name]=s.columns[p].column_default:h[s.columns[p].column_name]=a[s.columns[p].column_name]);r.debug(h),T(Le({appId:e,data:h,context:{media:{}}})),r.debug("init"),Y(!0)}},xe=()=>{let n="";for(const d in s.columns)s.columns[d].extra==="auto_increment"&&(n=s.columns[d].column_name);return r.debug(n),n},he=n=>{var p;const d=(p=Re.getSelectors().selectFormState(ne.getState().forms,e))==null?void 0:p.validation;r.debug("rowValidation",d);let h=!1;for(const u in d)if(d[u].error===!0&&d[u].type===Me.COLUMN){h=!0;break}if(h)return r.debug("validateForm returned errors"),!1;let y=!0;const a=xe();for(const u in n){const c=It(s,u);let E=!0;c.column_name!==a&&c.is_nullable==="NO"&&(n[u]===null||n[u]==="")&&(m===L.UPDATE||m===L.INSERT&&(c.column_default===null||c.column_default==="NULL"||c.column_default==="")||$e.preserveSpacesOnUpdate===!1&&n[u]==="")&&(T(Ue({appId:e,columnName:u,columnError:!0,columnText:g.mandatoryField,columnType:Me.FORM})),E=!1,y=!1);const C=Re.getSelectors().selectFormColumns(ne.getState().forms,e);let B;for(let S=0;S<C.length;S++)C[S].columnName===u&&(B=C[S]);if(r.debug(B),E&&c.data_type==="time"){const S=n[u];if(S.length===6){let A=S.substring(2,3),V=S.substring(4,5);(Number(A)>5||Number(V)>5)&&(T(Ue({appId:e,columnName:u,columnError:!0,columnText:g.mandatoryField,columnType:Me.FORM})),E=!1,y=!1)}}E&&T(Ue({appId:e,columnName:u,columnError:!1,columnText:"",columnType:Me.FORM}))}return y},ye=()=>{},pe=n=>{},X=(n,d,h,y)=>{var p;const a=(p=Re.getSelectors().selectFormState(ne.getState().forms,e))==null?void 0:p.data;if(r.debug(a),ye()!==!1)if(he(a)){if(o!==null){const u={};Object.keys(a).map(c=>{H.map(E=>{c===E.columnName&&E.updatable&&(u[c]=a[c])})}),r.debug(u),ft(e,o,u,c=>{var E;if(r.debug(c),c!=null&&c.code&&(c!=null&&c.message)){switch(c.code){case"ok":k(g.updatedSuccessful,{variant:"success"}),((E=c.context)==null?void 0:E.updated)!==void 0&&Object.keys(c.context.updated).map(C=>{T(dt({appId:e,columnName:C,columnValue:c.context.updated[C]}))}),n&&(d!==void 0&&d(o),setTimeout(()=>{l(!0,_)},1e3)),y&&y();break;case"info":k(g.nothingToUpdate,{variant:"info"}),n&&(d!==void 0&&d(o),setTimeout(()=>{l(!0,_)},1e3)),y&&y();break;default:r.error(c),k(c.message??g.invalidResponse,{variant:"error"}),n&&l(!0,_)}pe(c==null?void 0:c.code)}else r.error(c),k(g.invalidResponse,{variant:"error"})},c=>{r.error("error",c),k(c??g.invalidResponse,{variant:"error"})},!1,N,w)}else T(Kt({appId:e,property:{isRowCountUpdated:!0}})),gt(e,a,u=>{if(r.debug(u),u!=null&&u.code&&(u!=null&&u.message)){let c;const E={};switch(u.code){case"ok":k(g.insertSuccessful,{variant:"success"}),c=xe();for(let C=0;C<s.primary_key.length;C++){const B=nn(s,s.primary_key[C]);let S;B!==void 0&&(S=s==null?void 0:s.columns[B]),c!==""&&c===(S==null?void 0:S.column_name)?E[s.primary_key[C]]=u.context.insert_id:E[s.primary_key[C]]=a[s.primary_key[C]]}if((F==null?void 0:F.cardinality)===ke.ONE_TO_ONE){const C={};U!=null&&U.primary_key&&Array.isArray(U==null?void 0:U.primary_key)&&(U==null||U.primary_key.map(S=>C[S]=je[S]));const B={};if(F.join_condition!==void 0){const S=F.join_condition.split(",");for(let A=0;A<S.length;A++){const V=S[A].split("=");V.length===2&&(B[V[0]]=E[V[1]])}}ft(e,C,B,()=>{Object.keys(je).map(S=>{if(F.join_condition!==void 0){const A=F.join_condition.split(",");for(let V=0;V<A.length;V++){const ce=A[V].split("=");ce.length===2&&ce[0]===S&&T(dt({appId:x,columnName:S,columnValue:re[ce[1]]}))}}})},()=>{})}if(n){d!==void 0&&d(E),l(!0,_);return}b(E,Ve.UPDATE),h&&h(),y&&y();break;default:r.error(u),k(u.message??g.invalidResponse,{variant:"error"})}pe(u==null?void 0:u.code)}else r.error(u),k(g.invalidResponse,{variant:"error"})},u=>{r.error("error",u),k(u??g.invalidResponse,{variant:"error"})},!1,N,w);r.debug(_),_!==void 0&&(r.debug("setM2MUpdate: true"),T(ct({appId:_,update:!0})))}else r.error("Validation failed: ",a)},Ee=()=>ie===null?null:t.jsx(i.Suspense,{children:t.jsx(M,{sx:{marginTop:"30px"},children:t.jsx(St,{severity:"error",message:ie,close:!1})})}),Ce=n=>{if(n!==null&&he(re)){const d=De.getSelectors().selectTableById(ne.getState().tables,e),h=d.state.relation.relation_join_condition.split(",").map(a=>a.split("=")),y={...d.state.detailKey};h.map(a=>{y[a[0]]=n[a[1]]}),gt(e,y,a=>{if(r.debug(a),a!=null&&a.code&&(a!=null&&a.message))switch(a.code){case"ok":r.debug("Added relation to join table",a);break;default:r.error(a),k(a.message??g.invalidResponse,{variant:"error"})}else r.error(a),k(g.invalidResponse,{variant:"error"})},a=>{r.error(a),k(a??g.invalidResponse,{variant:"error"})},!1,!0,!1)}},[Fe,j]=i.useState(void 0),R=()=>{try{X(!1,()=>{},()=>{var d,h,y,a,p,u,c,E,C,B,S,A,V,ce,ot,rt,it,lt,at,ut;const n=JSON.parse((h=(d=s==null?void 0:s.app)==null?void 0:d.app[0])==null?void 0:h.app_settings);if(r.debug(n),((a=(y=n==null?void 0:n.settings)==null?void 0:y.app_registration)==null?void 0:a.showMessage)===!0&&((u=(p=n==null?void 0:n.settings)==null?void 0:p.app_registration)==null?void 0:u.message)!==void 0&&((E=(c=n==null?void 0:n.settings)==null?void 0:c.app_registration)==null?void 0:E.message)!==null&&((B=(C=n==null?void 0:n.settings)==null?void 0:C.app_registration)==null?void 0:B.message.trim())!==""&&j((A=(S=n==null?void 0:n.settings)==null?void 0:S.app_registration)==null?void 0:A.message),((ce=(V=n==null?void 0:n.settings)==null?void 0:V.app_registration)==null?void 0:ce.allowUpdates)!==!0&&($(L.VIEW),((rt=(ot=n==null?void 0:n.settings)==null?void 0:ot.app_registration)==null?void 0:rt.showUrl)===!0&&((lt=(it=n==null?void 0:n.settings)==null?void 0:it.app_registration)==null?void 0:lt.url)!=="")){const Jt=((ut=(at=n==null?void 0:n.settings)==null?void 0:at.app_registration)==null?void 0:ut.urlTime)??3;setTimeout(()=>{window.location.href=n.settings.app_registration.url},Jt)}})}catch(n){r.error("Invalid JSON - app settings"),r.error(n),k(tn.contactSupport,{variant:"error"})}},ve=()=>{X(!1)},we=()=>{var d,h,y;const n=De.getSelectors().selectTableById(ne.getState().tables,e);r.debug((d=n==null?void 0:n.state)==null?void 0:d.relation),((y=(h=n==null?void 0:n.state)==null?void 0:h.relation)==null?void 0:y.cardinality)===ke.MANY_TO_MANY?X(!0,Ce):X(!0)},ae=()=>{l(!0,_)},$e=kt(),Ut=jt(e),Bt=jt(_??""),te=wn(e),z=i.useRef(null),At=jn(),[ue,Dt]=i.useState((Ie=z==null?void 0:z.current)==null?void 0:Ie.offsetWidth),[Wt,Ht]=i.useState({paddingTop:"50px",paddingBottom:"50px",paddingLeft:"50px",paddingRight:"50px"}),[Yt,Je]=i.useState("30px"),[zt,Xe]=i.useState("");if(i.useEffect(()=>{if(z.current!==null){Dt(z.current.offsetWidth);let n=ue<600?.3:ue<900?.6:1;(P??!1)===!0&&(n=1),Ht({paddingTop:`calc(${n} * 50px)`,paddingBottom:`calc(${n} * 50px)`,paddingLeft:`calc(${n} * 50px)`,paddingRight:`calc(${n} * 50px)`}),ue<600?(Je("10px"),Xe("10px")):ue<900&&(Je("20px"),Xe("20px"))}},[At.width,z.current,$e.spacing]),ee!=="")return t.jsx(i.Suspense,{children:t.jsx(St,{severity:"error",message:ee,close:!1})});const Qe=()=>t.jsx(Nn,{appId:e,metaData:s,primaryKey:o,formMode:G,formUuid:J}),Gt=()=>t.jsxs(t.Fragment,{children:[t.jsx(be,{color:"inherit",onClick:()=>{const n={appId:e};r.info(F),F!=null&&(n.hideThemeSettings=!0),_!==void 0&&(n.isRelationForm=!0),T(Ft(n))},children:t.jsx(Mt,{})}),t.jsx(be,{color:"inherit",onClick:()=>{ae()},children:t.jsx(Ot,{})})]}),$t=i.useMemo(()=>{var n,d,h,y,a;return(n=s==null?void 0:s.src)!=null&&n.app_id&&((h=(d=s==null?void 0:s.app)==null?void 0:d.app[0])==null?void 0:h.app_title)!==""?s.app.app[0].app_title:(y=s==null?void 0:s.src)!=null&&y.dbs&&((a=s==null?void 0:s.src)!=null&&a.tbl)?s.src.dbs+" - "+s.src.tbl:"WP Data Access"},[]),qe=(((tt=(et=O==null?void 0:O.table)==null?void 0:et.modal)==null?void 0:tt.maxHeight)??95)+(((st=(nt=O==null?void 0:O.table)==null?void 0:nt.modal)==null?void 0:st.maxHeightUnit)??"vh"),Ze=()=>{var n,d,h;return t.jsxs(pt,{elevation:K,ref:Z,children:[(P??!1)===!0&&t.jsx(wt,{sx:{position:"unset",borderBottomRightRadius:0,borderBottomLeftRadius:0,boxShadow:"none"},children:t.jsxs(Rt,{sx:{display:"grid",gridTemplateColumns:"auto auto",justifyContent:"space-between",alignItems:"center"},children:[t.jsx(M,{sx:{display:"flex",alignItems:"center",cursor:"move",gap:"2px","& svg":{width:"2em",height:"2em"}},id:mt(s,"title"),children:t.jsx(M,{sx:{display:"block",whiteSpace:"nowrap",fontSize:"18px",lineHeight:"18px",fontWeight:"bold",textOverflow:"ellipsis",overflow:"hidden",marginRight:"10px"},children:$t})}),t.jsx(M,{children:(P??!1)===!0&&He(s)&&t.jsx(t.Fragment,{children:Gt()})})]})}),t.jsxs(M,{style:Wt,sx:{...(P??!1)===!0&&ge!==void 0&&{maxHeight:`calc(${qe} - 240px)`,overflow:"auto",backgroundColor:"transparent",border:"none",borderRadius:0}},children:[t.jsxs(M,{sx:{margin:0,padding:"5px 0",...(P??!1)===!0&&ge===void 0&&{maxHeight:`calc(${qe} - 240px)`,overflow:"auto"}},children:[Qe(),W,Ee()]}),t.jsxs(M,{sx:{marginTop:{marginTop:Yt},paddingRight:{paddingRight:zt},padding:0,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[t.jsxs(M,{sx:{display:"flex",gap:"8px"},children:[!1,(Ut||Bt)&&t.jsx(t.Fragment,{children:ue<600?t.jsx(be,{color:"primary",onClick:()=>{T(Oe({appId:e,more:!te})),_!==void 0&&T(Oe({appId:_,more:!te}))},children:te?t.jsx(xt,{}):t.jsx(ht,{})}):t.jsx(me,{variant:"outlined",startIcon:te?t.jsx(xt,{}):t.jsx(ht,{}),onClick:()=>{T(Oe({appId:e,more:!te})),_!==void 0&&T(Oe({appId:_,more:!te}))},children:te?g.less:g.more})}),((n=D==null?void 0:D.customActionsBottom)==null?void 0:n.enabled)===!0&&Et(s)&&t.jsx(t.Fragment,{children:t.jsx(Vn,{code:D.customActionsBottom.code??"",safeMode:oe.safeMode,isExpression:!1,args:{row:re,mode:en[m]}})}),t.jsx(M,{className:"pp-registration-form-message",children:Fe})]}),t.jsx(M,{sx:{...ue<600&&{marginLeft:"0 !important","& button":{marginLeft:"2px",padding:"6px"}}},children:m!==L.VIEW?t.jsx(t.Fragment,{children:((h=(d=s==null?void 0:s.app)==null?void 0:d.app[0])==null?void 0:h.app_type)==Ae.REGISTRATION&&O.state.masterDetailConditions===void 0?t.jsx(t.Fragment,{children:(G===L.INSERT||G===L.UPDATE)&&t.jsx(me,{variant:"contained",onClick:R,type:"submit",form:J,sx:{marginLeft:"8px"},children:g.ok})}):t.jsxs(t.Fragment,{children:[t.jsx(me,{variant:"contained",onClick:ve,type:"submit",form:J,disabled:ie!==null,children:g.apply}),(F==null?void 0:F.cardinality)!==ke.ONE_TO_ONE&&t.jsxs(t.Fragment,{children:[t.jsx(me,{variant:"outlined",onClick:we,sx:{marginLeft:"8px"},children:g.ok}),t.jsx(me,{variant:"outlined",onClick:ae,sx:{marginLeft:"8px"},children:g.cancel})]})]})}):t.jsx(t.Fragment,{children:(F==null?void 0:F.cardinality)!==ke.ONE_TO_ONE&&t.jsx(me,{variant:"contained",onClick:ae,children:g.back})})})]}),t.jsx(t.Fragment,{children:!1})]})]})};return f?Qe():(i.useEffect(()=>{var n;z.current!==null&&((n=window.document.getElementById(`pp-app-${e}`))==null||n.scrollIntoView())},[z.current]),t.jsx("div",{className:`${e}_wrapper pp-form`,ref:z,style:{scrollMarginTop:"70px"},children:I&&re!==null?t.jsx(t.Fragment,{children:(P??!1)===!0?t.jsx(t.Fragment,{children:t.jsx(Sn,{handle:"#"+mt(s,"title"),nodeRef:Z,offsetParent:document.body,children:Ze()})}):t.jsx(t.Fragment,{children:Ze()})}):t.jsx(pt,{style:{padding:"50px"},elevation:K,children:t.jsx(Ye,{title:g.loadingData})})}))},Un=i.lazy(()=>se(()=>import("./Settings-1.0.36-xUukCfSJ.js"),__vite__mapDeps([60,10,1,2,3,11,5,6,7,8,15,4,9,16,17,18,23,19,20,21,22,24,25,26,27,28,29,61,14,31,32,33,34,35,36,37,38,46,47,39]),import.meta.url)),yt=({appId:e,primaryKey:o,formMode:m,showTable:l,showForm:b,metaData:v,detailKey:W,selectionForm:_,masterAppId:w})=>{r.debug(e,o,m,v,W,_,w);const N=dn(),x=ze(e).table;r.debug("relationship",null);const T=i.useMemo(()=>{},[]);r.debug("relationAppId",T);const Z=()=>null,H=()=>null,g=()=>null,K=()=>{var oe,D,G,$,J,I,Y,ee;return t.jsx(pn,{open:!0,className:"pp-form-modal",sx:{zIndex:9999990},children:t.jsx(M,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",minWidth:(((oe=x==null?void 0:x.modal)==null?void 0:oe.minWidth)??60)+(((D=x==null?void 0:x.modal)==null?void 0:D.minWidthUnit)??"vw"),maxWidth:(((G=x==null?void 0:x.modal)==null?void 0:G.maxWidth)??90)+((($=x==null?void 0:x.modal)==null?void 0:$.maxWidthUnit)??"vw"),minHeight:(((J=x==null?void 0:x.modal)==null?void 0:J.minHeight)??0)+(((I=x==null?void 0:x.modal)==null?void 0:I.minHeightUnit)??"vh"),maxHeight:(((Y=x==null?void 0:x.modal)==null?void 0:Y.maxHeight)??95)+(((ee=x==null?void 0:x.modal)==null?void 0:ee.maxHeightUnit)??"vh"),backgroundColor:"transparent"},children:t.jsx(Tt,{appId:e,primaryKey:o,formMode:m,showTable:l,showForm:b,detailKey:W,relationAppId:T,masterAppId:w,isModal:!0,children:H()})})})},O=()=>t.jsx(Tt,{appId:e,primaryKey:o,formMode:m,showTable:l,showForm:b,detailKey:W,relationAppId:T,masterAppId:w,children:H()});return t.jsxs(t.Fragment,{children:[_===!0?t.jsx(t.Fragment,{children:Z()}):t.jsx(t.Fragment,{children:x.formModal===!0?t.jsx(t.Fragment,{children:K()}):t.jsx(t.Fragment,{children:O()})}),t.jsx(t.Fragment,{children:He(v)&&t.jsx(Cn,{theme:N,children:t.jsx(i.Suspense,{fallback:t.jsx(Ye,{}),children:t.jsx(Un,{appId:e})})})}),g()]})},Bn=e=>{const o=q(m=>{var l,b;return((b=(l=m.tables[e])==null?void 0:l.state)==null?void 0:b.fullScreen)??!1});return r.debug("fullScreen",o),o},An=()=>{const e=q(o=>o.ui);return r.debug("uiSetting",e),e},Dn=e=>(_e(),{builtinLog:e,builtinShowAlert:(b,v)=>{},builtinShowConfirm:(b,v,W)=>{},builtinShowSnackbar:(b,v)=>{}}),Wn=i.lazy(()=>se(()=>import("./TableContainer-1.0.36-CsHiUQr0.js").then(e=>e.T),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41]),import.meta.url));i.lazy(()=>se(()=>import("./TableChartDock-1.0.36-Ca9tBvtf.js"),__vite__mapDeps([62,1,2,3,63,10,11,5,6,7,8,41,39,15,14,9,25,20,21,53,33,54,55,46,47,28]),import.meta.url));const Hn=({appId:e})=>{var ge,ie,le,Se,Te,xe,he,ye,pe,X,Ee,Ce,Fe;r.debug(e);const o=_e(),m=xn(),l=bn(),b=Pt(),v=Nt(e);hn(e),ze(e).table;const _=An(),w=vt(e),N="pp-remove-body-vertical-scrollbar",f=We(e),x=i.useMemo(()=>{var j,R,ve,we,ae;return(j=f==null?void 0:f.src)!=null&&j.app_id&&((ve=(R=f==null?void 0:f.app)==null?void 0:R.app[0])==null?void 0:ve.app_title)!==""?f.app.app[0].app_title:(we=f==null?void 0:f.src)!=null&&we.dbs&&((ae=f==null?void 0:f.src)!=null&&ae.tbl)?f.src.dbs+" - "+f.src.tbl:"WP Data Access"},[]),{builtinLog:P,builtinShowAlert:T,builtinShowConfirm:Z,builtinShowSnackbar:H}=Dn(r);window.wpda={log:P,alert:T,confirm:Z,snackbar:H};const g=Bn(e);i.useEffect(()=>(r.debug(g),()=>{var j;(j=window.document.getElementById(N))==null||j.remove(),window.document.body.classList.remove("pp-fullscreen")}),[g]);const K=i.useMemo(()=>De.getSelectors().selectTableExploring(ne.getState().tables,e),[e]);r.debug("tableExploring",K);const[O,oe]=i.useState(((ie=(ge=f==null?void 0:f.app)==null?void 0:ge.app[0])==null?void 0:ie.app_type)==Ae.REGISTRATION?Q.FORM:Q.TABLE),[D,G]=i.useState(!1),$=j=>{o(cn({appId:e,mode:j})),oe(j)};i.useEffect(()=>{window.ppShowForm=function(j){r.debug(j),Y(j),$(Q.FORM)}},[e]);const J=(j,R)=>{r.debug(j,R),mn(e)&&(l(e),R!==void 0&&(m(R),l(R))),j&&G(!D),$(Q.TABLE)},[I,Y]=i.useState(null),[ee,de]=i.useState(L.VIEW),s=(j,R)=>{switch(r.debug(j,R),R){case Ve.INSERT:de(L.INSERT);break;case Ve.UPDATE:de(L.UPDATE);break;default:de(L.VIEW)}Y(j),$(Q.FORM)};let re={};Ge(e);const[F]=i.useState(((Te=window.PP_APP_CONFIG[(Se=(le=f==null?void 0:f.app)==null?void 0:le.app[0])==null?void 0:Se.app_id])==null?void 0:Te.hideTitleBar)===!0),fe=()=>null,U=()=>t.jsx(i.Suspense,{fallback:t.jsx(Be,{title:w.loadingForm}),children:t.jsx(yt,{appId:e,primaryKey:I,formMode:L.INSERT,showTable:()=>{},showForm:s,metaData:f})}),je=()=>{var j,R;return((R=(j=f==null?void 0:f.app)==null?void 0:j.app[0])==null?void 0:R.app_type)==Ae.REGISTRATION?U():t.jsxs(t.Fragment,{children:[t.jsxs(i.Suspense,{fallback:t.jsx(Be,{title:w.loadingTable}),children:[!1,t.jsx(Wn,{appId:e,display:O===Q.TABLE,refresh:D,showForm:s,metaData:f}),!1]}),O===Q.FORM&&t.jsx(i.Suspense,{fallback:t.jsx(Be,{title:w.loadingForm}),children:t.jsx(yt,{appId:e,primaryKey:I,formMode:ee,showTable:J,showForm:s,metaData:f})})]})};return t.jsxs(M,{className:"pp-component",sx:g?re:{},children:[F!==!0&&t.jsx(wt,{className:"pp-header",elevation:b,position:"relative",sx:{margin:"0 0 5px 0"},children:t.jsxs(Rt,{sx:{display:"grid",gridTemplateColumns:"auto auto",justifyContent:"space-between",alignItems:"center"},children:[t.jsx(M,{sx:{display:"block",whiteSpace:"nowrap",fontSize:"18px",lineHeight:"18px",fontWeight:"bold",textOverflow:"ellipsis",overflow:"hidden",marginRight:"10px"},children:x}),t.jsxs(M,{sx:{display:"flex",gap:"10px",justifyContent:"center",alignItems:"center"},children:[He(f)&&t.jsx(_t,{title:t.jsx(_n,{details:v,mode:O}),className:"pp-builder-button",children:t.jsx(be,{sx:{color:"inherit",padding:0},onClick:()=>{O===Q.FORM?o(Ft({appId:e})):o(sn({appId:e}))},children:t.jsx(Mt,{})})}),fe(),K&&t.jsx(_t,{title:w.close,children:t.jsx(be,{sx:{color:"inherit",padding:0},onClick:()=>{var j;(j=window.document.getElementById(N))==null||j.remove(),window.document.body.classList.remove("pp-fullscreen"),f.src.app_id?o(on({isActive:!1,appDbId:0})):o(rn({})),l(e),m(e),o(ln({}))},children:t.jsx(Ot,{})})})]})]})}),je(),((xe=_.builtins.alert)==null?void 0:xe.title)&&((he=_.builtins.alert)==null?void 0:he.message)&&t.jsx(Fn,{title:(ye=_.builtins.alert)==null?void 0:ye.title,message:t.jsx(bt,{html:(pe=_.builtins.alert)==null?void 0:pe.message}),open:!0,setOpen:()=>{o(an({}))}}),((X=_.builtins.confirm)==null?void 0:X.title)&&((Ee=_.builtins.confirm)==null?void 0:Ee.message)&&t.jsx(Tn,{title:(Ce=_.builtins.confirm)==null?void 0:Ce.title,message:t.jsx(bt,{html:(Fe=_.builtins.confirm)==null?void 0:Fe.message}),open:!0,setOpen:()=>{o(un({}))},onConfirm:()=>{var j;(j=_.builtins.confirm)!=null&&j.callback&&_.builtins.confirm.callback()}})]})},hs=Object.freeze(Object.defineProperty({__proto__:null,default:Hn},Symbol.toStringTag,{value:"Module"}));export{Ve as R,Hn as S,wn as a,Bn as b,Pt as c,Vt as d,Pe as e,Lt as f,Mn as g,On as h,Ne as i,hs as j,vn as u};
