import{l as m,j as e,du as V,r as P,ck as u,dv as ee,dw as se,dx as ie,_ as re,dy as te,cw as ne,k as h,dz as H,dA as oe,dB as le,dC as de,dD as ae,dE as pe}from"./main-1.0.23.js";import{a as w,u as Q}from"./RestApi-1.0.23-cc179eb9.js";import{u as Y,S as me,a as ue,I as _,b as ce,c as xe,d as z,D as ge,e as he,f as fe,g as je,h as be,T as ye,M as Se,P as ve}from"./useMetadataColumns-1.0.23-85b79404.js";import{v as E,ah as Ce,a5 as q,ai as we,a8 as Te,a9 as Fe,aa as Pe,ab as _e}from"./index.esm-1.0.23-ba0465a2.js";import{T as k,C as ke}from"./ConfirmDialog-1.0.23-f318040f.js";import{r as Le}from"./index.esm-1.0.23-da98f1a9.js";import{u as T}from"./useFormUpdates-1.0.23-2bcf2490.js";import{u as $}from"./useStoreTable-1.0.23-508477d7.js";import{g as Ee,h as Ae,d as Ne}from"./index.esm-1.0.23-9200891c.js";import{P as B}from"./PremiumFeature-1.0.23-8dd1a29b.js";import{E as U}from"./EnumTypeEnum-1.0.23-7ffcf33a.js";import{g as W,e as Re,D as Oe}from"./useTheme-1.0.23-55aea9bb.js";import{A,a as N}from"./AccordionSummary-1.0.23-078f8091.js";import{A as R}from"./AccordionDetails-1.0.23-ad785ba6.js";import{B as j}from"./Spinner-1.0.23-90ab83ff.js";import{F as f,a as b}from"./FormHelperText-1.0.23-83597bdf.js";import{F as c}from"./FormLabel-1.0.23-71a056b2.js";import{S as Ge}from"./Slider-1.0.23-75ca4c04.js";import{R as X}from"./RadioGroup-1.0.23-053476ee.js";import{R as C}from"./Radio-1.0.23-7006053b.js";import{T as y}from"./TextField-1.0.23-1657e9d4.js";import{F as Z}from"./FormControlLabel-1.0.23-1ad68af6.js";import{S as J}from"./Switch-1.0.23-86b06b05.js";import{L as K}from"./Link-1.0.23-48d9bdb4.js";import{I as L}from"./iconBase-1.0.23-43ac6f06.js";import"./useFormStore-1.0.23-90f12904.js";import"./CardContent-1.0.23-cd3f2c87.js";import"./Typography-1.0.23-19a0fd3e.js";import"./AdminTheme-1.0.23-7044caf5.js";import"./ActionsDml-1.0.23-e3901c9d.js";import"./MenuItem-1.0.23-0a5da249.js";import"./Menu-1.0.23-e889464a.js";import"./ThemeProvider-1.0.23-f3e5cbc1.js";import"./Popover-1.0.23-6c9c65a6.js";import"./Modal-1.0.23-3fe42627.js";import"./Grow-1.0.23-40b2ff68.js";import"./index-1.0.23-fea3ac27.js";import"./useTableUpdater-1.0.23-f1f702eb.js";import"./Stepper-1.0.23-3d0d410f.js";import"./createSvgIcon-1.0.23-f9410a01.js";import"./StepContent-1.0.23-0707671d.js";import"./Collapse-1.0.23-a92fc278.js";import"./Checkbox-1.0.23-e63c68aa.js";import"./SwitchBase-1.0.23-adccc77c.js";import"./useFormControl-1.0.23-a0ae6ce7.js";import"./useControlled-1.0.23-1e71c28b.js";import"./DialogContent-1.0.23-79893b13.js";import"./colorManipulator-1.0.23-e382be1d.js";import"./index-1.0.23-9af490ae.js";import"./useSlot-1.0.23-b9d48820.js";import"./createStyled-1.0.23-528f26c2.js";const Ve=({appId:r,columnIndex:o,tableColumn:s})=>{m.debug(r,o,s),w();const i=W(r),l=Re(r);T(r);const t=n=>[];return e.jsxs(A,{disableGutters:!0,children:[e.jsxs(N,{expandIcon:e.jsx(E,{}),sx:{fontSize:"1rem","& .MuiAccordionSummary-content":{padding:"1rem",alignItems:"center"}},children:[e.jsx(Ee,{}),e.jsx("span",{style:{paddingLeft:"0.5rem"},children:"Grid positioning"})]}),e.jsxs(R,{sx:{paddingTop:"0.5rem"},children:[e.jsxs(j,{children:[e.jsxs(f,{sx:{display:"grid"},children:[e.jsx(c,{children:"Grid cells"}),e.jsx(Ge,{value:s.cells,min:1,max:l.cellsPerRow,step:1,marks:t(l.cellsPerRow),valueLabelDisplay:"auto",disabled:!0,onChange:(n,g)=>{m.debug(n,g)},sx:{width:"calc(100% - 40px)",margin:"20px"}})]}),e.jsx(b,{children:"Number of grid cells used (can be changed in FORM > Grid)."}),e.jsxs(f,{sx:{width:"100%"},children:[e.jsx(c,{sx:{margin:"15px 0 5px 0"},children:"Grid positioning"}),e.jsx(X,{sx:{flexDirection:"column",alignContent:"flex-start",marginLeft:"10px",marginBottom:"5px"},children:e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",justifyContent:"center",alignItems:"center"},children:[e.jsxs(c,{className:"align-label-radio",children:[e.jsx(C,{checked:s.cellClass===V.AUTO,disabled:!0,onChange:n=>{n.stopPropagation()}}),"Auto"]}),e.jsxs(c,{className:"align-label-radio",children:[e.jsx(C,{checked:s.cellClass===V.START,disabled:!0,onChange:n=>{n.stopPropagation()}}),"Start"]}),e.jsxs(c,{className:"align-label-radio",children:[e.jsx(C,{checked:s.cellClass===V.END,disabled:!0,onChange:n=>{n.stopPropagation()}}),"End"]}),e.jsxs(c,{children:[e.jsx(C,{checked:typeof s.cellClass=="number",disabled:!0,onChange:n=>{n.stopPropagation()}}),"Add"]}),e.jsxs("div",{style:{marginLeft:"10px",gridColumn:"span 2",display:"grid",gridTemplateColumns:"auto auto",alignItems:"center"},children:[e.jsx(y,{id:"pp-cells-before",sx:{width:"60px"},className:"pp-cells-before",type:"number",defaultValue:1,InputProps:{inputProps:{min:1,max:l.cellsPerRow-1}},disabled:!0,InputLabelProps:{shrink:!0},onChange:n=>{n.stopPropagation()}}),e.jsx(c,{sx:{marginLeft:"10px"},children:"cell(s) before"})]})]})})]}),e.jsx(b,{children:"Grid positioning relative to surrounding cells."}),s.computedField&&o!==void 0&&(i==null?void 0:i.columns[o])!==void 0&&i.columns[o].data_type==="enum"&&e.jsxs(j,{sx:{marginTop:"20px"},children:[e.jsx(c,{children:"Show values in"}),e.jsxs(X,{sx:{flexDirection:"column",alignContent:"flex-start",margin:"10px 0 5px 10px"},children:[e.jsxs(c,{className:"align-label-radio",children:[e.jsx(C,{checked:s.updatableEnum===void 0||s.updatableEnum===U.LIST,disabled:!0,onChange:n=>{n.stopPropagation()}}),"Drop-down List"]}),e.jsxs(c,{className:"align-label-radio",children:[e.jsx(C,{checked:s.updatableEnum===U.RADIO_HORIZONTAL,disabled:!0,onChange:n=>{n.stopPropagation()}}),"Horizontal radio group"]}),e.jsxs(c,{className:"align-label-radio",children:[e.jsx(C,{checked:s.updatableEnum===U.RADIO_VERTICAL,disabled:!0,onChange:n=>{n.stopPropagation()}}),"Vertical radio group"]})]})]})]}),e.jsx(B,{single:!1})]})]})},He=({appId:r,columnIndex:o,tableColumn:s,columnMetaData:i})=>{m.debug(r,o,s),w(),T(r);const[l,t]=P.useState(!1);return s.computedField!==void 0||o===void 0||i===void 0||(i==null?void 0:i.data_type)!==void 0&&u(i.data_type)!=="number"?null:e.jsxs(A,{disableGutters:!0,children:[e.jsxs(N,{expandIcon:e.jsx(E,{}),sx:{fontSize:"1rem","& .MuiAccordionSummary-content":{padding:"1rem",alignItems:"center"}},children:[e.jsx(Ae,{}),e.jsx("span",{style:{paddingLeft:"0.5rem"},children:"Validation"})]}),e.jsxs(R,{sx:{paddingTop:"1rem"},children:[e.jsxs(f,{sx:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"10px"},children:[e.jsx(y,{error:l,type:"number",label:"Minimum value allowed",disabled:!0,value:s.numericMin??"",required:!1,InputLabelProps:{shrink:!0},onChange:n=>{m.debug(n)}}),e.jsx(y,{error:l,type:"number",label:"Maximum value allowed",disabled:!0,value:s.numericMax??"",required:!1,InputLabelProps:{shrink:!0},onChange:n=>{m.debug(n)}})]}),e.jsx(B,{})]})]})},ze=({appId:r,columnIndex:o,tableColumn:s,columnMetaData:i})=>{m.debug(r,o,s,i);const l=w(),t=T(r),[n,g]=P.useState(!1),a=Y(r),F={marginTop:"20px",marginLeft:"10px"};return e.jsxs(A,{disableGutters:!0,children:[e.jsxs(N,{expandIcon:e.jsx(E,{}),sx:{fontSize:"1rem","& .MuiAccordionSummary-content":{padding:"1rem",alignItems:"center"}},children:[e.jsx(Ne,{}),e.jsx("span",{style:{paddingLeft:"0.5rem"},children:"Column settings"})]}),e.jsxs(R,{sx:{display:"grid",gridGap:"2rem",paddingTop:"1rem"},children:[s.computedField!==void 0&&e.jsxs(f,{children:[e.jsx(Z,{control:e.jsx(J,{checked:s.allowMarkup??!1,onChange:(p,S)=>{l(ee({appId:r,index:o,allowMarkup:S})),t(!0),p.stopPropagation()}}),label:"Add as HTML",labelPlacement:"end"}),e.jsx(b,{children:"Adds computed field content as HTML instead of text field."})]}),(s.computedField||a[s.columnName]!==void 0&&(u(a[s.columnName].data_type)==="float"||u(a[s.columnName].data_type)==="number"||u(a[s.columnName].data_type)==="time"||u(a[s.columnName].data_type,!0)==="date"||u(a[s.columnName].data_type,!0)==="datetime"||u(a[s.columnName].data_type,!0)==="timestamp"||u(a[s.columnName].data_type,!0)==="time"))&&e.jsx(j,{children:e.jsxs(f,{children:[e.jsx(Z,{control:e.jsx(J,{checked:!1,disabled:!0,onClick:p=>{p.stopPropagation()}}),label:"Localize",labelPlacement:"end"}),e.jsx(b,{children:s.computedField||a[s.columnName]!==void 0&&(u(a[s.columnName].data_type)==="float"||u(a[s.columnName].data_type)==="number")?"Localizes decimal and thousands seperators.":"Localizes date and time fields."})]})}),e.jsxs(f,{children:[e.jsx(y,{type:"text",variant:"outlined",label:"Default value",value:s.defaultValue??"",placeholder:(i==null?void 0:i.column_default)??"",InputLabelProps:{shrink:!0},onChange:p=>{l(se({appId:r,index:o,defaultValue:p.target.value})),t(!0),p.stopPropagation()}}),e.jsxs(b,{component:"div",children:[e.jsx(e.Fragment,{children:(i==null?void 0:i.column_default)!==void 0&&(i==null?void 0:i.column_default)!==null&&(i==null?void 0:i.column_default)!==""&&e.jsx(j,{sx:{fontWeight:"bold"},children:"Leave empty to use column default constraint."})}),e.jsxs("div",{children:["Only applied on insert ",n?e.jsxs(e.Fragment,{children:[e.jsx("span",{children:e.jsx(K,{sx:{cursor:"pointer"},underline:"none",onClick:()=>{g(!1)},children:"(hide examples)"})}),e.jsxs("ul",{style:{listStyle:"disc",padding:"0 40px"},children:[e.jsx("li",{children:"Hello World"}),e.jsx("li",{children:"@wpda_wp_user_id"}),e.jsx("li",{children:"@now"})]}),e.jsx("div",{style:F,children:"Notes"}),e.jsxs("ul",{style:{listStyle:"disc",padding:"0 40px"},children:[e.jsx("li",{children:"@wpda_wp_user_id returns the WordPress user ID or 0 for anonymous requests"}),e.jsx("li",{children:"@now returns the current date/time and works with date/time fields only"}),e.jsxs("li",{children:["Column default constraints defined in the database are automatically applied",(i==null?void 0:i.column_default)!==void 0&&(i==null?void 0:i.column_default)!==null&&(i==null?void 0:i.column_default)!==""&&e.jsxs(e.Fragment,{children:[" (current value is ",e.jsx("strong",{children:i==null?void 0:i.column_default}),")"]})]})]})]}):e.jsx("span",{children:e.jsx(K,{sx:{cursor:"pointer"},underline:"none",onClick:()=>{g(!0)},children:"(show examples)"})})]})]})]}),((i==null?void 0:i.data_type)!==void 0&&i.data_type.toLowerCase()!=="text"&&i.data_type.toLowerCase()!=="enum"&&i.data_type.toLowerCase()!=="set"&&i.column_type.toLowerCase()!=="tinyint(1)"&&(u(i.data_type)==="string"||u(i.data_type)==="number")||s.computedField)&&e.jsxs(f,{children:[e.jsx(j,{sx:{display:"grid",gridTemplateColumns:"auto auto",gridGap:"10px",alignItems:"center"},children:e.jsxs(e.Fragment,{children:[e.jsx(y,{type:"text",variant:"outlined",label:"Prefix",value:s.prefix,disabled:!0,InputLabelProps:{shrink:!0},onChange:p=>{p.stopPropagation()}}),e.jsx(y,{type:"text",variant:"outlined",label:"Suffix",value:s.suffix,disabled:!0,InputLabelProps:{shrink:!0},onChange:p=>{p.stopPropagation()}})]})}),e.jsx(b,{children:"Adds a prefix and/or suffix to the column content."})]}),e.jsxs(f,{children:[e.jsx(y,{type:"text",variant:"outlined",label:"CSS classes",fullWidth:!0,value:s.classNames,disabled:!0,InputLabelProps:{shrink:!0},onChange:p=>{p.stopPropagation()}}),e.jsx(b,{children:"CSS classes (seperated by spaces) for custom styling."})]}),e.jsxs(f,{children:[e.jsx(y,{type:"text",variant:"outlined",label:"Hint",fullWidth:!0,value:s.hint,disabled:!0,InputLabelProps:{shrink:!0},onChange:p=>{p.stopPropagation()}}),e.jsx(b,{children:"Help text displayed below data entry field."})]}),e.jsx(B,{single:!1,margin:"0"})]})]})},Ue=({appId:r,columnIndex:o,tableColumn:s})=>{var p,S;m.debug(r,o,s);const i=w(),l=T(r),t=$(r),n=W(r),a=Y(r)[s.columnName],F=(O,G)=>{i(ie({appId:r,index:O,lookup:G})),l(!0)};return e.jsxs(e.Fragment,{children:[e.jsx(Ve,{appId:r,columnIndex:o,tableColumn:s}),e.jsx(ze,{appId:r,columnIndex:o,tableColumn:s,columnMetaData:a}),(((p=n==null?void 0:n.privs)==null?void 0:p.insert)||((S=n==null?void 0:n.privs)==null?void 0:S.update))&&(t.table.transactions.insert||t.table.transactions.update)&&e.jsx(He,{appId:r,columnIndex:o,tableColumn:s,columnMetaData:a}),e.jsx(me,{appId:r,columnIndex:o,tableColumn:s,columnMetaData:a,setLookup:F}),e.jsx(ue,{columnMetaData:a})]})};P.lazy(()=>re(()=>import("./ComputedFieldMore-1.0.23-b95ce309.js"),["./ComputedFieldMore-1.0.23-b95ce309.js","./main-1.0.23.js","./index.esm-1.0.23-ba0465a2.js","./Typography-1.0.23-19a0fd3e.js","./iconBase-1.0.23-43ac6f06.js","./ConfirmDialog-1.0.23-f318040f.js","./AdminTheme-1.0.23-7044caf5.js","./DialogContent-1.0.23-79893b13.js","./Modal-1.0.23-3fe42627.js","./CardContent-1.0.23-cd3f2c87.js","./ConfirmDialog-1.0.23-9bff3a93.css","./index.esm-1.0.23-da98f1a9.js","./Menu-1.0.23-e889464a.js","./ThemeProvider-1.0.23-f3e5cbc1.js","./Popover-1.0.23-6c9c65a6.js","./Grow-1.0.23-40b2ff68.js","./MenuItem-1.0.23-0a5da249.js"],import.meta.url));const Be=({appId:r,columnIndex:o})=>{m.debug(r,o);const s=w(),i=W(r),l=$(r),t=Q(d=>te(d,r,o));m.debug("tableColumn",t);const n=T(r),g=(d,x)=>{m.debug(d,x),s(oe({appId:r,index:d,visible:x})),n(!0)},a=(d,x)=>{m.debug(d,x),s(le({appId:r,index:d,more:x})),n(!0)},F=(d,x)=>{m.debug(d,x),s(de({appId:r,index:d,updatable:x})),n(!0)};ne.TEXT;const[p,S]=P.useState(!1),[O,G]=P.useState(void 0),I=d=>{d!==void 0&&(s(ae({appId:r,index:d})),n(!0))},M=(d,x,D)=>(m.debug(d,x,D),e.jsxs(e.Fragment,{children:[e.jsx(j,{children:e.jsx(ce,{id:d,enabled:!1})}),e.jsxs(j,{sx:{display:"inline-grid",gridTemplateColumns:t.computedField!==void 0?"auto auto":"auto",justifyContent:"start",alignItems:"center",gap:"10px","& svg":{opacity:"0.5"}},children:[t.computedField!==void 0&&e.jsx(Le,{}),e.jsx(c,{children:x})]})]})),v=!i.primary_key.includes(t.columnName);return e.jsxs(e.Fragment,{children:[e.jsxs(A,{disableGutters:!0,slotProps:{transition:{unmountOnExit:!0}},children:[e.jsxs(N,{className:"pp-column-settings",expandIcon:e.jsx(E,{}),sx:{justifyContent:"space-between"},children:[e.jsx(j,{sx:{display:"grid",gridTemplateColumns:"auto 1fr",alignItems:"center","& svg":{display:"flex"}},children:M(t.columnName,t.columnLabel,o)}),e.jsxs(j,{style:{display:"grid",gridTemplateColumns:"40px 40px 40px"},children:[e.jsx(k,{title:"Visibility",position:"bottom",children:e.jsx(L,{onClick:d=>{t.visible?t.more?(g(o,!1),a(o,!1)):a(o,!0):t.more?a(o,!1):g(o,!0),d.stopPropagation()},children:t.visible?e.jsx(e.Fragment,{children:t.more?e.jsx(_,{checked:!0,children:e.jsx(Ce,{})}):e.jsx(_,{checked:!0,children:e.jsx(q,{})})}):e.jsx(_,{checked:!1,children:e.jsx(q,{})})})}),t.computedField?e.jsx(e.Fragment,{children:e.jsx(k,{title:"Delete",position:"bottom",children:e.jsx(L,{onClick:d=>{S(!0),G(o),d.stopPropagation()},children:e.jsx(Te,{})})})}):e.jsx(k,{title:"Updatable",position:"bottom",disabled:!l.table.transactions.insert&&!l.table.transactions.update||!v||!t.visible,children:e.jsx(L,{disabled:!l.table.transactions.insert&&!l.table.transactions.update||!v||!t.visible,onClick:d=>{F(o,!t.updatable),d.stopPropagation()},children:e.jsx(_,{checked:t.updatable&&v&&(l.table.transactions.insert||l.table.transactions.update),disabled:!l.table.transactions.insert&&!l.table.transactions.update||!v,forceOff:!v||!t.visible,children:e.jsx(we,{})})})}),e.jsx(k,{title:"Alignment",position:"bottom",disabled:!v||!t.visible,children:e.jsxs(L,{disabled:!v||!t.visible,onClick:d=>{t.alignment===h.LEFT?s(H({appId:r,index:o,alignment:h.CENTER})):t.alignment===h.CENTER?s(H({appId:r,index:o,alignment:h.RIGHT})):t.alignment===h.RIGHT&&s(H({appId:r,index:o,alignment:h.LEFT})),n(!0),d.stopPropagation()},children:[t.alignment===h.LEFT&&e.jsx(Fe,{}),t.alignment===h.CENTER&&e.jsx(Pe,{}),t.alignment===h.RIGHT&&e.jsx(_e,{})]})})]})]}),e.jsx(R,{children:e.jsx(Ue,{appId:r,columnIndex:o,tableColumn:t})})]},o),e.jsx(ke,{title:"Delete computed field?",message:"Are you sure you want to delete this computed field? This action cannot be undone!",open:p,setOpen:S,onConfirm:()=>I(O)})]})},zs=({appId:r})=>{m.debug(r),w();const o=xe(z(ve),z(Se),z(ye));T(r);const s=l=>{const{active:t,over:n}=l;(t==null?void 0:t.id)!==(n==null?void 0:n.id)&&m.debug(t,n)},i=Q(l=>pe(l,r));return i===void 0||i.length===0?null:e.jsxs(e.Fragment,{children:[e.jsx(ge,{autoScroll:!0,sensors:o,collisionDetection:he,onDragEnd:s,children:e.jsx(fe,{items:i,children:i.map((l,t)=>e.jsx(je,{id:l,children:e.jsx(Be,{appId:r,columnIndex:t})},l))})}),e.jsx(be,{appId:r,target:Oe.FORM})]})};export{zs as default};
