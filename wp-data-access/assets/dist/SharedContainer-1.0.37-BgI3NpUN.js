const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./TableContainer-1.0.37-C-xGIJXi.js","./cm-1.0.37-CEr77VZi.js","./redux-1.0.37-C4JSQ-MG.js","./vendor-1.0.37-CN03Eozo.js","./AdminTheme-1.0.37-7PLndQ8H.js","./lib-1.0.37-Czwr-8r3.js","./loglevel-1.0.37-BZ7XahX3.js","./lodash-1.0.37-Dx3wKrSf.js","./moment-1.0.37-C5S46NFB.js","./Typography-1.0.37-DjtXWQnP.js","./main-1.0.37.js","./notistack-1.0.37-CEqipxDI.js","./tanstack-1.0.37-DP4-37CF.js","./FallbackSpinner-1.0.37-DAc7pvnM.js","./Spinner-1.0.37-CwhfSVqI.js","./hooks-1.0.37-DW0_oiBB.js","./ActionsSettings-1.0.37-DQdLIvID.js","./RestApi-1.0.37-CcjslynE.js","./TargetEnum-1.0.37-CIW1jlU5.js","./Tooltip-1.0.37-D_uDknxi.js","./iconBase-1.0.37-DRohixw7.js","./useEnhancedEffect-1.0.37-UwysO4qr.js","./Tooltip-1.0.37--D4jr2go.css","./ScopeEnum-1.0.37-B4DDvIDj.js","./index-1.0.37-LxgxH_yq.js","./index-1.0.37-B60ShF2d.js","./TabPanel-1.0.37-CPE-1h3v.js","./ConfirmDialog-1.0.37-BDQ_OfRf.js","./Menu-1.0.37-Ca8DeoO3.js","./ThemeProvider-1.0.37-Cyf1xy26.js","./MenuItem-1.0.37-JkRcsicb.js","./useThemeProps-1.0.37-CD9ZXLtG.js","./getThemeProps-1.0.37-BGc0S4YC.js","./useTableUpdater-1.0.37-CIKXY-oH.js","./DynamicModeEnum-1.0.37-BXuL5kgA.js","./useFormDetails-1.0.37-DnrKW97d.js","./useRemoveAppFromStore-1.0.37-HphIv4xo.js","./lang-1.0.37-CfHlhLgz.js","./settings-1.0.37-Bx2jvYL6.css","./Row-1.0.37-C51SKuTa.js","./useTableSettings-1.0.37-iiTTwobj.js","./useChartSettings-1.0.37-DyLw1xR9.js","./useStoreTable-1.0.37-Bzu2Dqnh.js","./ActionsDml-1.0.37-kzr7tHjI.js","./AppTheme-1.0.37-DOXnENpA.js","./index-1.0.37-D4zhytA1.js","./useStoreFormSettings-1.0.37-DetNzg9c.js","./useScreenSize-1.0.37-X1Uq-TFD.js","./dompurify-1.0.37-DhD2mIk-.js","./AlertDialog-1.0.37-DG1NZI4D.js","./SanitizeComponent-1.0.37-DM7FdeKd.js","./Tooltip-1.0.37-BLWvlO4a.js","./useControlled-1.0.37-DyimEgDk.js","./Popper-1.0.37-CSsNCozr.js","./Alert-1.0.37-DRzJfdQS.js","./AlertTitle-1.0.37-BCo6eK8b.js","./createSvgIcon-1.0.37-DXsAQOmB.js","./Close-1.0.37-Yr1E1-6A.js","./Settings-1.0.37-DA8LwkKP.js","./useFormStore-1.0.37-CtXk4vaU.js","./TableChartDock-1.0.37-DbWuuHJO.js","./Chart-1.0.37-BPm1pFP4.js"])))=>i.map(i=>d[i]);
import{_ as se}from"./main-1.0.37.js";import{j as t}from"./cm-1.0.37-CEr77VZi.js";import{r as i}from"./redux-1.0.37-C4JSQ-MG.js";import{l as r,bv as Et,bt as Ft,bu as Qt,ba as L,P as Xt,v as qt,bw as Zt,b4 as Re,S as ne,bx as Le,H as Kt,by as ct,bz as mt,bA as Me,bB as It,bC as Be,Z as We,bD as Oe,bE as en,A as Ae,bF as ke,W as Ct,b as tn,b0 as De,bb as dt,g as nn,X as sn,d as on,af as rn,_ as ln,bG as an,bH as un,bI as cn,bJ as mn}from"./lib-1.0.37-Czwr-8r3.js";import{u as q,a as _e}from"./hooks-1.0.37-DW0_oiBB.js";import{B as M,S as Ye}from"./Spinner-1.0.37-CwhfSVqI.js";import{a as dn}from"./AdminTheme-1.0.37-7PLndQ8H.js";import{u as ze}from"./useStoreTable-1.0.37-Bzu2Dqnh.js";import{s as fn,u as ft,i as gt}from"./ActionsDml-1.0.37-kzr7tHjI.js";import{e as k}from"./notistack-1.0.37-CEqipxDI.js";import{a as gn,u as He}from"./AppTheme-1.0.37-DOXnENpA.js";import"./moment-1.0.37-C5S46NFB.js";import{u as vt,a as xn}from"./useChartSettings-1.0.37-DyLw1xR9.js";import{A as wt,T as Rt,a8 as xt,Q as ht,f as Mt,M as Ot,F as hn}from"./index-1.0.37-B60ShF2d.js";import{u as kt}from"./useStoreFormSettings-1.0.37-DetNzg9c.js";import{u as Nt,C as pn,B as bn}from"./useFormDetails-1.0.37-DnrKW97d.js";import{a as Ge,u as _n}from"./useRemoveAppFromStore-1.0.37-HphIv4xo.js";import{u as jn}from"./useScreenSize-1.0.37-X1Uq-TFD.js";import{d as Sn,B as me,C as Tn}from"./ConfirmDialog-1.0.37-BDQ_OfRf.js";import"./dompurify-1.0.37-DhD2mIk-.js";import{g as yn}from"./vendor-1.0.37-CN03Eozo.js";import{r as En}from"./lang-1.0.37-CfHlhLgz.js";import{P as pt,I as be}from"./iconBase-1.0.37-DRohixw7.js";import{T as Fn}from"./ThemeProvider-1.0.37-Cyf1xy26.js";import{D as X}from"./DynamicModeEnum-1.0.37-BXuL5kgA.js";import{F as Ue}from"./FallbackSpinner-1.0.37-DAc7pvnM.js";import{A as Cn}from"./AlertDialog-1.0.37-DG1NZI4D.js";import{S as bt}from"./SanitizeComponent-1.0.37-DM7FdeKd.js";import{T as _t}from"./Tooltip-1.0.37-BLWvlO4a.js";const Pe=e=>{const o=q(m=>{var l,b;return(b=(l=m.forms[e])==null?void 0:l.state)==null?void 0:b.data});return r.debug("data",o,e),o};var Ve=(e=>(e[e.SELECT=0]="SELECT",e[e.INSERT=1]="INSERT",e[e.UPDATE=2]="UPDATE",e[e.DELETE=3]="DELETE",e[e.EXPORT=4]="EXPORT",e[e.IMPORT=5]="IMPORT",e[e.VIEW=6]="VIEW",e))(Ve||{});i.lazy(()=>se(()=>import("./TableContainer-1.0.37-C-xGIJXi.js").then(e=>e.T),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38]),import.meta.url));i.lazy(()=>se(()=>import("./TableContainer-1.0.37-C-xGIJXi.js").then(e=>e.T),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38]),import.meta.url));const Pt=e=>4,vn=e=>{const o=q(m=>{var l;return((l=m.forms[e])==null?void 0:l.columns)??[]});return r.debug("storeColumns",o),o},jt=e=>{const o=q(m=>m.forms[e]!==void 0?m.forms[e].columns.filter(l=>l.more).length>0:!1);return r.debug("hasMoreColumns",o),o},wn=e=>{const o=q(m=>{var l,b;return((b=(l=m.forms[e])==null?void 0:l.state)==null?void 0:b.more)??!1});return r.debug("moreState",o),o},Rn=e=>{const o=q(m=>{var l,b;return(b=(l=m.forms[e])==null?void 0:l.state)==null?void 0:b.initialData});return r.debug("initialData",o),o},Vt=e=>({}),Lt=e=>(Pe(e),m=>{}),Mn=e=>(_e(),(m,l)=>{}),On=(e,o)=>(_e(),(l,b)=>{}),kn=i.lazy(()=>se(()=>import("./Row-1.0.37-C51SKuTa.js"),__vite__mapDeps([39,10,1,2,3,11,5,6,7,8,15,40,41,36,37,14,9,4,42,43,17,44,45,32,21,25,20,46,35,34,47,27,48,29,13,49,50,51,52,53]),import.meta.url)),Nn=({appId:e,metaData:o,primaryKey:m,formMode:l,formUuid:b})=>{var W;r.debug(e,o,m,l,b);const v=kt(),H=Ge(e),_=Pe(e),w=Rn(e),N=Vt(),f=Lt(e),g=Mn(),P=On();i.useEffect(()=>{var x;Et(o)&&((x=N==null?void 0:N.onRowInit)==null?void 0:x.enabled)==!0&&Ft(N.onRowInit.code??"",Qt(o),!1,{mode:l,getColumnValue:f,setColumnValue:g,setColumnStyle:P})},[]);const[T,Z]=i.useState("30px");return i.useEffect(()=>{},[v.spacing]),t.jsx("form",{id:b,className:"pp-form-content",onSubmit:x=>(x.preventDefault(),!1),children:t.jsx(M,{className:"pp-form-grid",sx:{display:"grid",gridTemplateColumns:{lg:`repeat(${v.cellsPerRow}, 1fr)`,md:"repeat("+Math.min(v.cellsPerRow,2)+", 1fr)",xs:"1fr"},gap:T,marginBottom:0,background:v.showGrid?((W=gn)==null?void 0:W.palette.mode)===Xt.LIGHT?"repeating-linear-gradient( -45deg, transparent, transparent 10px, #eee 10px, #eee 20px )":"repeating-linear-gradient( -45deg, transparent, transparent 10px, #111 10px, #111 20px )":"","& p.MuiFormHelperText-root":{...l===L.VIEW&&!0&&{display:"none"}}},children:t.jsx(i.Suspense,{fallback:t.jsx(Ye,{}),children:t.jsx(kn,{appId:e,metaData:o,data:_,initialData:w,primaryKey:m,formMode:l,formSettings:v,language:H.language})})})})},Pn=e=>{const o=q(m=>{var l,b;return((b=(l=m.forms[e])==null?void 0:l.state)==null?void 0:b.m2mUpdate)??!1});return r.debug("m2mUpdate",o),o},Vn=({code:e,safeMode:o,isExpression:m,args:l})=>{const b=Ft(e,o,m,l);return window.jQuery&&b instanceof window.jQuery&&b.html(),null};var Ln=En();const Ne=yn(Ln),St=i.lazy(()=>se(()=>import("./Alert-1.0.37-DRzJfdQS.js"),__vite__mapDeps([54,1,2,3,24,20,9,5,6,7,8,21,55,56,57]),import.meta.url)),Tt=({appId:e,primaryKey:o,formMode:m,showTable:l,showForm:b,detailKey:v,children:H,relationAppId:_,relTab:w,joinTab:N,isEmbedded:f,masterAppId:g,isModal:P})=>{var Ke,Ie,et,tt,nt,st;r.debug(e,o,m,v,_,w,N,f,g,P);const T=_e(),Z=i.useRef(null),W=vn(e),x=vt(e),K=Pt(),O=ze(e),oe=Ge(e),D=Vt();Lt(e);const[G,$]=i.useState(m),J=i.useMemo(()=>qt(),[]),[I,Y]=i.useState(!1),[ee,de]=i.useState(""),s=He(e),re=Pe(e),C=Zt((Ke=s==null?void 0:s.app)==null?void 0:Ke.container[0]),fe=Pn(e),B=He(g??""),je=Pe(g??""),ge=Nt(e),[ie,le]=i.useState(null);i.useEffect(()=>{r.debug(fe,e),fe===!0&&(r.debug("setM2MUpdate: false"),Q(!1,()=>{},()=>{},()=>{T(ct({appId:e,update:!1}))}))},[fe]),i.useEffect(()=>{o===null?Te():Object.keys(o).length>0?Se():Y(!0)},[o]);const Se=()=>{fn(e,o,s==null?void 0:s.media,n=>{if(r.debug(n),(n==null?void 0:n.code)==="ok"){if(Array.isArray(n.data)&&n.data.length>0){const d={...n.data[0]},h={...n.context};delete h.debug,T(Le({appId:e,data:d,context:h})),n.data.length>1?le("Query returned more than one row. Check configuration."):le(null)}else{const d={...n.context};delete d.debug,T(Le({appId:e,data:{},context:d})),le("Invalid primary key. Check configuration.")}Y(!0)}else k(x.invalidResponse,{variant:"error"})},n=>{r.error("error",n),de(n??x.invalidResponse)},!1,w)},Te=()=>{var n,d;if(s.columns&&Array.isArray(s.columns)){const h={},y=Re.getSelectors().selectFormColumns(ne.getState().forms,e),a=Object.fromEntries(y.map(p=>[p.columnName,p.defaultValue]));r.debug("defaultValues",a);for(let p=0;p<s.columns.length;p++)h[s.columns[p].column_name]=null,a[s.columns[p].column_name]!==void 0&&(a[s.columns[p].column_name]==="@wpda_wp_user_id"?h[s.columns[p].column_name]=(d=(n=s==null?void 0:s.settings)==null?void 0:n.env)==null?void 0:d.id:a[s.columns[p].column_name]==="@now"?s.columns[p]==="date"?h[s.columns[p].column_name]=Ne(Date.now()).format("YYYY-MM-DD"):h[s.columns[p].column_name]=Ne(Date.now()).format("YYYY-MM-DD HH:mm:ss"):s.columns[p].column_default!==null&&s.columns[p].column_default!=="NULL"&&s.columns[p].column_default!==""?s.columns[p].column_default==="CURRENT_TIMESTAMP"?s.columns[p]==="date"?h[s.columns[p].column_name]=Ne(Date.now()).format("YYYY-MM-DD"):h[s.columns[p].column_name]=Ne(Date.now()).format("YYYY-MM-DD HH:mm:ss"):h[s.columns[p].column_name]=s.columns[p].column_default:h[s.columns[p].column_name]=a[s.columns[p].column_name]);r.debug(h),T(Le({appId:e,data:h,context:{media:{}}})),r.debug("init"),Y(!0)}},xe=()=>{let n="";for(const d in s.columns)s.columns[d].extra==="auto_increment"&&(n=s.columns[d].column_name);return r.debug(n),n},he=n=>{var p;const d=(p=Re.getSelectors().selectFormState(ne.getState().forms,e))==null?void 0:p.validation;r.debug("rowValidation",d);let h=!1;for(const u in d)if(d[u].error===!0&&d[u].type===Me.COLUMN){h=!0;break}if(h)return r.debug("validateForm returned errors"),!1;let y=!0;const a=xe();for(const u in n){const c=It(s,u);let E=!0;c.column_name!==a&&c.is_nullable==="NO"&&(n[u]===null||n[u]==="")&&(m===L.UPDATE||m===L.INSERT&&(c.column_default===null||c.column_default==="NULL"||c.column_default==="")||$e.preserveSpacesOnUpdate===!1&&n[u]==="")&&(T(Be({appId:e,columnName:u,columnError:!0,columnText:x.mandatoryField,columnType:Me.FORM})),E=!1,y=!1);const F=Re.getSelectors().selectFormColumns(ne.getState().forms,e);let U;for(let S=0;S<F.length;S++)F[S].columnName===u&&(U=F[S]);if(r.debug(U),E&&c.data_type==="time"){const S=n[u];if(S.length===6){let A=S.substring(2,3),V=S.substring(4,5);(Number(A)>5||Number(V)>5)&&(T(Be({appId:e,columnName:u,columnError:!0,columnText:x.mandatoryField,columnType:Me.FORM})),E=!1,y=!1)}}E&&T(Be({appId:e,columnName:u,columnError:!1,columnText:"",columnType:Me.FORM}))}return y},ye=()=>{},pe=n=>{},Q=(n,d,h,y)=>{var p;const a=(p=Re.getSelectors().selectFormState(ne.getState().forms,e))==null?void 0:p.data;if(r.debug(a),ye()!==!1)if(he(a)){if(o!==null){const u={};Object.keys(a).map(c=>{W.map(E=>{c===E.columnName&&E.updatable&&(u[c]=a[c])})}),r.debug(u),ft(e,o,u,c=>{var E;if(r.debug(c),c!=null&&c.code&&(c!=null&&c.message)){switch(c.code){case"ok":k(x.updatedSuccessful,{variant:"success"}),((E=c.context)==null?void 0:E.updated)!==void 0&&Object.keys(c.context.updated).map(F=>{T(dt({appId:e,columnName:F,columnValue:c.context.updated[F]}))}),n&&(d!==void 0&&d(o),setTimeout(()=>{l(!0,_)},1e3)),y&&y();break;case"info":k(x.nothingToUpdate,{variant:"info"}),n&&(d!==void 0&&d(o),setTimeout(()=>{l(!0,_)},1e3)),y&&y();break;default:r.error(c),k(c.message??x.invalidResponse,{variant:"error"}),n&&l(!0,_)}pe(c==null?void 0:c.code)}else r.error(c),k(x.invalidResponse,{variant:"error"})},c=>{r.error("error",c),k(c??x.invalidResponse,{variant:"error"})},!1,N,w)}else T(Kt({appId:e,property:{isRowCountUpdated:!0}})),gt(e,a,u=>{if(r.debug(u),u!=null&&u.code&&(u!=null&&u.message)){let c;const E={};switch(u.code){case"ok":k(x.insertSuccessful,{variant:"success"}),c=xe();for(let F=0;F<s.primary_key.length;F++){const U=nn(s,s.primary_key[F]);let S;U!==void 0&&(S=s==null?void 0:s.columns[U]),c!==""&&c===(S==null?void 0:S.column_name)?E[s.primary_key[F]]=u.context.insert_id:E[s.primary_key[F]]=a[s.primary_key[F]]}if((C==null?void 0:C.cardinality)===ke.ONE_TO_ONE){const F={};B!=null&&B.primary_key&&Array.isArray(B==null?void 0:B.primary_key)&&(B==null||B.primary_key.map(S=>F[S]=je[S]));const U={};if(C.join_condition!==void 0){const S=C.join_condition.split(",");for(let A=0;A<S.length;A++){const V=S[A].split("=");V.length===2&&(U[V[0]]=E[V[1]])}}ft(e,F,U,()=>{Object.keys(je).map(S=>{if(C.join_condition!==void 0){const A=C.join_condition.split(",");for(let V=0;V<A.length;V++){const ce=A[V].split("=");ce.length===2&&ce[0]===S&&g&&T(dt({appId:g,columnName:S,columnValue:re[ce[1]]}))}}})},()=>{})}if(n){d!==void 0&&d(E),l(!0,_);return}b(E,Ve.UPDATE),h&&h(),y&&y();break;default:r.error(u),k(u.message??x.invalidResponse,{variant:"error"})}pe(u==null?void 0:u.code)}else r.error(u),k(x.invalidResponse,{variant:"error"})},u=>{r.error("error",u),k(u??x.invalidResponse,{variant:"error"})},!1,N,w);r.debug(_),_!==void 0&&(r.debug("setM2MUpdate: true"),T(ct({appId:_,update:!0})))}else r.error("Validation failed: ",a)},Ee=()=>ie===null?null:t.jsx(i.Suspense,{children:t.jsx(M,{sx:{marginTop:"30px"},children:t.jsx(St,{severity:"error",message:ie,close:!1})})}),Fe=n=>{if(n!==null&&he(re)){const d=De.getSelectors().selectTableById(ne.getState().tables,e),h=d.state.relation.relation_join_condition.split(",").map(a=>a.split("=")),y={...d.state.detailKey};h.map(a=>{y[a[0]]=n[a[1]]}),gt(e,y,a=>{if(r.debug(a),a!=null&&a.code&&(a!=null&&a.message))switch(a.code){case"ok":r.debug("Added relation to join table",a);break;default:r.error(a),k(a.message??x.invalidResponse,{variant:"error"})}else r.error(a),k(x.invalidResponse,{variant:"error"})},a=>{r.error(a),k(a??x.invalidResponse,{variant:"error"})},!1,!0,!1)}},[Ce,j]=i.useState(void 0),R=()=>{try{Q(!1,()=>{},()=>{var d,h,y,a,p,u,c,E,F,U,S,A,V,ce,ot,rt,it,lt,at,ut;const n=JSON.parse((h=(d=s==null?void 0:s.app)==null?void 0:d.app[0])==null?void 0:h.app_settings);if(r.debug(n),((a=(y=n==null?void 0:n.settings)==null?void 0:y.app_registration)==null?void 0:a.showMessage)===!0&&((u=(p=n==null?void 0:n.settings)==null?void 0:p.app_registration)==null?void 0:u.message)!==void 0&&((E=(c=n==null?void 0:n.settings)==null?void 0:c.app_registration)==null?void 0:E.message)!==null&&((U=(F=n==null?void 0:n.settings)==null?void 0:F.app_registration)==null?void 0:U.message.trim())!==""&&j((A=(S=n==null?void 0:n.settings)==null?void 0:S.app_registration)==null?void 0:A.message),((ce=(V=n==null?void 0:n.settings)==null?void 0:V.app_registration)==null?void 0:ce.allowUpdates)!==!0&&($(L.VIEW),((rt=(ot=n==null?void 0:n.settings)==null?void 0:ot.app_registration)==null?void 0:rt.showUrl)===!0&&((lt=(it=n==null?void 0:n.settings)==null?void 0:it.app_registration)==null?void 0:lt.url)!=="")){const Jt=((ut=(at=n==null?void 0:n.settings)==null?void 0:at.app_registration)==null?void 0:ut.urlTime)??3;setTimeout(()=>{window.location.href=n.settings.app_registration.url},Jt)}})}catch(n){r.error("Invalid JSON - app settings"),r.error(n),k(tn.contactSupport,{variant:"error"})}},ve=()=>{Q(!1)},we=()=>{var d,h,y;const n=De.getSelectors().selectTableById(ne.getState().tables,e);r.debug((d=n==null?void 0:n.state)==null?void 0:d.relation),((y=(h=n==null?void 0:n.state)==null?void 0:h.relation)==null?void 0:y.cardinality)===ke.MANY_TO_MANY?Q(!0,Fe):Q(!0)},ae=()=>{l(!0,_)},$e=kt(),Bt=jt(e),Ut=jt(_??""),te=wn(e),z=i.useRef(null),At=jn(),[ue,Dt]=i.useState((Ie=z==null?void 0:z.current)==null?void 0:Ie.offsetWidth),[Ht,Wt]=i.useState({paddingTop:"50px",paddingBottom:"50px",paddingLeft:"50px",paddingRight:"50px"}),[Yt,Je]=i.useState("30px"),[zt,Qe]=i.useState("");if(i.useEffect(()=>{if(z.current!==null){Dt(z.current.offsetWidth);let n=ue<600?.3:ue<900?.6:1;(P??!1)===!0&&(n=1),Wt({paddingTop:`calc(${n} * 50px)`,paddingBottom:`calc(${n} * 50px)`,paddingLeft:`calc(${n} * 50px)`,paddingRight:`calc(${n} * 50px)`}),ue<600?(Je("10px"),Qe("10px")):ue<900&&(Je("20px"),Qe("20px"))}},[At.width,z.current,$e.spacing]),ee!=="")return t.jsx(i.Suspense,{children:t.jsx(St,{severity:"error",message:ee,close:!1})});const Xe=()=>t.jsx(Nn,{appId:e,metaData:s,primaryKey:o,formMode:G,formUuid:J}),Gt=()=>t.jsxs(t.Fragment,{children:[t.jsx(be,{color:"inherit",onClick:()=>{const n={appId:e};r.info(C),C!=null&&(n.hideThemeSettings=!0),_!==void 0&&(n.isRelationForm=!0),T(Ct(n))},children:t.jsx(Mt,{})}),t.jsx(be,{color:"inherit",onClick:()=>{ae()},children:t.jsx(Ot,{})})]}),$t=i.useMemo(()=>{var n,d,h,y,a;return(n=s==null?void 0:s.src)!=null&&n.app_id&&((h=(d=s==null?void 0:s.app)==null?void 0:d.app[0])==null?void 0:h.app_title)!==""?s.app.app[0].app_title:(y=s==null?void 0:s.src)!=null&&y.dbs&&((a=s==null?void 0:s.src)!=null&&a.tbl)?s.src.dbs+" - "+s.src.tbl:"WP Data Access"},[]),qe=(((tt=(et=O==null?void 0:O.table)==null?void 0:et.modal)==null?void 0:tt.maxHeight)??95)+(((st=(nt=O==null?void 0:O.table)==null?void 0:nt.modal)==null?void 0:st.maxHeightUnit)??"vh"),Ze=()=>{var n,d,h;return t.jsxs(pt,{elevation:K,ref:Z,children:[(P??!1)===!0&&t.jsx(wt,{sx:{position:"unset",borderBottomRightRadius:0,borderBottomLeftRadius:0,boxShadow:"none"},children:t.jsxs(Rt,{sx:{display:"grid",gridTemplateColumns:"auto auto",justifyContent:"space-between",alignItems:"center"},children:[t.jsx(M,{sx:{display:"flex",alignItems:"center",cursor:"move",gap:"2px","& svg":{width:"2em",height:"2em"}},id:mt(s,"title"),children:t.jsx(M,{sx:{display:"block",whiteSpace:"nowrap",fontSize:"18px",lineHeight:"18px",fontWeight:"bold",textOverflow:"ellipsis",overflow:"hidden",marginRight:"10px"},children:$t})}),t.jsx(M,{children:(P??!1)===!0&&We(s)&&t.jsx(t.Fragment,{children:Gt()})})]})}),t.jsxs(M,{style:Ht,sx:{...(P??!1)===!0&&ge!==void 0&&{maxHeight:`calc(${qe} - 240px)`,overflow:"auto",backgroundColor:"transparent",border:"none",borderRadius:0}},children:[t.jsxs(M,{sx:{margin:0,padding:"5px 0",...(P??!1)===!0&&ge===void 0&&{maxHeight:`calc(${qe} - 240px)`,overflow:"auto"}},children:[Xe(),H,Ee()]}),t.jsxs(M,{sx:{marginTop:{marginTop:Yt},paddingRight:{paddingRight:zt},padding:0,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[t.jsxs(M,{sx:{display:"flex",gap:"8px"},children:[!1,(Bt||Ut)&&t.jsx(t.Fragment,{children:ue<600?t.jsx(be,{color:"primary",onClick:()=>{T(Oe({appId:e,more:!te})),_!==void 0&&T(Oe({appId:_,more:!te}))},children:te?t.jsx(xt,{}):t.jsx(ht,{})}):t.jsx(me,{variant:"outlined",startIcon:te?t.jsx(xt,{}):t.jsx(ht,{}),onClick:()=>{T(Oe({appId:e,more:!te})),_!==void 0&&T(Oe({appId:_,more:!te}))},children:te?x.less:x.more})}),((n=D==null?void 0:D.customActionsBottom)==null?void 0:n.enabled)===!0&&Et(s)&&t.jsx(t.Fragment,{children:t.jsx(Vn,{code:D.customActionsBottom.code??"",safeMode:oe.safeMode,isExpression:!1,args:{row:re,mode:en[m]}})}),t.jsx(M,{className:"pp-registration-form-message",children:Ce})]}),t.jsx(M,{sx:{...ue<600&&{marginLeft:"0 !important","& button":{marginLeft:"2px",padding:"6px"}}},children:m!==L.VIEW?t.jsx(t.Fragment,{children:((h=(d=s==null?void 0:s.app)==null?void 0:d.app[0])==null?void 0:h.app_type)==Ae.REGISTRATION&&O.state.masterDetailConditions===void 0?t.jsx(t.Fragment,{children:(G===L.INSERT||G===L.UPDATE)&&t.jsx(me,{variant:"contained",onClick:R,type:"submit",form:J,sx:{marginLeft:"8px"},children:x.ok})}):t.jsxs(t.Fragment,{children:[t.jsx(me,{variant:"contained",onClick:ve,type:"submit",form:J,disabled:ie!==null,children:x.apply}),(C==null?void 0:C.cardinality)!==ke.ONE_TO_ONE&&t.jsxs(t.Fragment,{children:[t.jsx(me,{variant:"outlined",onClick:we,sx:{marginLeft:"8px"},children:x.ok}),t.jsx(me,{variant:"outlined",onClick:ae,sx:{marginLeft:"8px"},children:x.cancel})]})]})}):t.jsx(t.Fragment,{children:(C==null?void 0:C.cardinality)!==ke.ONE_TO_ONE&&t.jsx(me,{variant:"contained",onClick:ae,children:x.back})})})]}),t.jsx(t.Fragment,{children:!1})]})]})};return f?Xe():(i.useEffect(()=>{var n;z.current!==null&&((n=window.document.getElementById(`pp-app-${e}`))==null||n.scrollIntoView())},[z.current]),t.jsx("div",{className:`${e}_wrapper pp-form`,ref:z,style:{scrollMarginTop:"70px"},children:I&&re!==null?t.jsx(t.Fragment,{children:(P??!1)===!0?t.jsx(t.Fragment,{children:t.jsx(Sn,{handle:"#"+mt(s,"title"),nodeRef:Z,offsetParent:document.body,children:Ze()})}):t.jsx(t.Fragment,{children:Ze()})}):t.jsx(pt,{style:{padding:"50px"},elevation:K,children:t.jsx(Ye,{title:x.loadingData})})}))},Bn=i.lazy(()=>se(()=>import("./Settings-1.0.37-DA8LwkKP.js"),__vite__mapDeps([58,10,1,2,3,11,5,6,7,8,15,4,9,16,17,18,23,19,20,21,22,24,25,26,14,27,28,29,30,31,32,59,44,45,34,38]),import.meta.url)),yt=({appId:e,primaryKey:o,formMode:m,showTable:l,showForm:b,metaData:v,detailKey:H,selectionForm:_,masterAppId:w})=>{r.debug(e,o,m,v,H,_,w);const N=dn(),g=ze(e).table;r.debug("relationship",null);const T=i.useMemo(()=>{},[]);r.debug("relationAppId",T);const Z=()=>null,W=()=>null,x=()=>null,K=()=>{var oe,D,G,$,J,I,Y,ee;return t.jsx(hn,{open:!0,className:"pp-form-modal",sx:{zIndex:9999990},children:t.jsx(M,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",minWidth:(((oe=g==null?void 0:g.modal)==null?void 0:oe.minWidth)??60)+(((D=g==null?void 0:g.modal)==null?void 0:D.minWidthUnit)??"vw"),maxWidth:(((G=g==null?void 0:g.modal)==null?void 0:G.maxWidth)??90)+((($=g==null?void 0:g.modal)==null?void 0:$.maxWidthUnit)??"vw"),minHeight:(((J=g==null?void 0:g.modal)==null?void 0:J.minHeight)??0)+(((I=g==null?void 0:g.modal)==null?void 0:I.minHeightUnit)??"vh"),maxHeight:(((Y=g==null?void 0:g.modal)==null?void 0:Y.maxHeight)??95)+(((ee=g==null?void 0:g.modal)==null?void 0:ee.maxHeightUnit)??"vh"),backgroundColor:"transparent"},children:t.jsx(Tt,{appId:e,primaryKey:o,formMode:m,showTable:l,showForm:b,detailKey:H,relationAppId:T,masterAppId:w,isModal:!0,children:W()})})})},O=()=>t.jsx(Tt,{appId:e,primaryKey:o,formMode:m,showTable:l,showForm:b,detailKey:H,relationAppId:T,masterAppId:w,children:W()});return t.jsxs(t.Fragment,{children:[_===!0?t.jsx(t.Fragment,{children:Z()}):t.jsx(t.Fragment,{children:g.formModal===!0?t.jsx(t.Fragment,{children:K()}):t.jsx(t.Fragment,{children:O()})}),t.jsx(t.Fragment,{children:We(v)&&t.jsx(Fn,{theme:N,children:t.jsx(i.Suspense,{fallback:t.jsx(Ye,{}),children:t.jsx(Bn,{appId:e})})})}),x()]})},Un=e=>{const o=q(m=>{var l,b;return((b=(l=m.tables[e])==null?void 0:l.state)==null?void 0:b.fullScreen)??!1});return r.debug("fullScreen",o),o},An=()=>{const e=q(o=>o.ui);return r.debug("uiSetting",e),e},Dn=e=>(_e(),{builtinLog:e,builtinShowAlert:(b,v)=>{},builtinShowConfirm:(b,v,H)=>{},builtinShowSnackbar:(b,v)=>{}}),Hn=i.lazy(()=>se(()=>import("./TableContainer-1.0.37-C-xGIJXi.js").then(e=>e.T),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38]),import.meta.url));i.lazy(()=>se(()=>import("./TableChartDock-1.0.37-DbWuuHJO.js"),__vite__mapDeps([60,1,2,3,61,10,11,5,6,7,8,41,36,37,15,14,9,25,20,21,51,29,52,53,44,45,32]),import.meta.url));const Wn=({appId:e})=>{var ge,ie,le,Se,Te,xe,he,ye,pe,Q,Ee,Fe,Ce;r.debug(e);const o=_e(),m=_n(),l=pn(),b=Pt(),v=Nt(e);xn(e),ze(e).table;const _=An(),w=vt(e),N="pp-remove-body-vertical-scrollbar",f=He(e),g=i.useMemo(()=>{var j,R,ve,we,ae;return(j=f==null?void 0:f.src)!=null&&j.app_id&&((ve=(R=f==null?void 0:f.app)==null?void 0:R.app[0])==null?void 0:ve.app_title)!==""?f.app.app[0].app_title:(we=f==null?void 0:f.src)!=null&&we.dbs&&((ae=f==null?void 0:f.src)!=null&&ae.tbl)?f.src.dbs+" - "+f.src.tbl:"WP Data Access"},[]),{builtinLog:P,builtinShowAlert:T,builtinShowConfirm:Z,builtinShowSnackbar:W}=Dn(r);window.wpda={log:P,alert:T,confirm:Z,snackbar:W};const x=Un(e);i.useEffect(()=>(r.debug(x),()=>{var j;(j=window.document.getElementById(N))==null||j.remove(),window.document.body.classList.remove("pp-fullscreen")}),[x]);const K=i.useMemo(()=>De.getSelectors().selectTableExploring(ne.getState().tables,e),[e]);r.debug("tableExploring",K);const[O,oe]=i.useState(((ie=(ge=f==null?void 0:f.app)==null?void 0:ge.app[0])==null?void 0:ie.app_type)==Ae.REGISTRATION?X.FORM:X.TABLE),[D,G]=i.useState(!1),$=j=>{o(cn({appId:e,mode:j})),oe(j)};i.useEffect(()=>{window.ppShowForm=function(j){r.debug(j),Y(j),$(X.FORM)}},[e]);const J=(j,R)=>{r.debug(j,R),mn(e)&&(l(e),R!==void 0&&(m(R),l(R))),j&&G(!D),$(X.TABLE)},[I,Y]=i.useState(null),[ee,de]=i.useState(L.VIEW),s=(j,R)=>{switch(r.debug(j,R),R){case Ve.INSERT:de(L.INSERT);break;case Ve.UPDATE:de(L.UPDATE);break;default:de(L.VIEW)}Y(j),$(X.FORM)};let re={};Ge(e);const[C]=i.useState(((Te=window.PP_APP_CONFIG[(Se=(le=f==null?void 0:f.app)==null?void 0:le.app[0])==null?void 0:Se.app_id])==null?void 0:Te.hideTitleBar)===!0),fe=()=>null,B=()=>t.jsx(i.Suspense,{fallback:t.jsx(Ue,{title:w.loadingForm}),children:t.jsx(yt,{appId:e,primaryKey:I,formMode:L.INSERT,showTable:()=>{},showForm:s,metaData:f})}),je=()=>{var j,R;return((R=(j=f==null?void 0:f.app)==null?void 0:j.app[0])==null?void 0:R.app_type)==Ae.REGISTRATION?B():t.jsxs(t.Fragment,{children:[t.jsxs(i.Suspense,{fallback:t.jsx(Ue,{title:w.loadingTable}),children:[!1,t.jsx(Hn,{appId:e,display:O===X.TABLE,refresh:D,showForm:s,metaData:f}),!1]}),O===X.FORM&&t.jsx(i.Suspense,{fallback:t.jsx(Ue,{title:w.loadingForm}),children:t.jsx(yt,{appId:e,primaryKey:I,formMode:ee,showTable:J,showForm:s,metaData:f})})]})};return t.jsxs(M,{className:"pp-component",sx:x?re:{},children:[C!==!0&&t.jsx(wt,{className:"pp-header",elevation:b,position:"relative",sx:{margin:"0 0 5px 0"},children:t.jsxs(Rt,{sx:{display:"grid",gridTemplateColumns:"auto auto",justifyContent:"space-between",alignItems:"center"},children:[t.jsx(M,{sx:{display:"block",whiteSpace:"nowrap",fontSize:"18px",lineHeight:"18px",fontWeight:"bold",textOverflow:"ellipsis",overflow:"hidden",marginRight:"10px"},children:g}),t.jsxs(M,{sx:{display:"flex",gap:"10px",justifyContent:"center",alignItems:"center"},children:[We(f)&&t.jsx(_t,{title:t.jsx(bn,{details:v,mode:O}),className:"pp-builder-button",children:t.jsx(be,{sx:{color:"inherit",padding:0},onClick:()=>{O===X.FORM?o(Ct({appId:e})):o(sn({appId:e}))},children:t.jsx(Mt,{})})}),fe(),K&&t.jsx(_t,{title:w.close,children:t.jsx(be,{sx:{color:"inherit",padding:0},onClick:()=>{var j;(j=window.document.getElementById(N))==null||j.remove(),window.document.body.classList.remove("pp-fullscreen"),f.src.app_id?o(on({isActive:!1,appDbId:0})):o(rn()),l(e),m(e),o(ln())},children:t.jsx(Ot,{})})})]})]})}),je(),((xe=_.builtins.alert)==null?void 0:xe.title)&&((he=_.builtins.alert)==null?void 0:he.message)&&t.jsx(Cn,{title:(ye=_.builtins.alert)==null?void 0:ye.title,message:t.jsx(bt,{html:(pe=_.builtins.alert)==null?void 0:pe.message}),open:!0,setOpen:()=>{o(an())}}),((Q=_.builtins.confirm)==null?void 0:Q.title)&&((Ee=_.builtins.confirm)==null?void 0:Ee.message)&&t.jsx(Tn,{title:(Fe=_.builtins.confirm)==null?void 0:Fe.title,message:t.jsx(bt,{html:(Ce=_.builtins.confirm)==null?void 0:Ce.message}),open:!0,setOpen:()=>{o(un())},onConfirm:()=>{var j;(j=_.builtins.confirm)!=null&&j.callback&&_.builtins.confirm.callback()}})]})},bs=Object.freeze(Object.defineProperty({__proto__:null,default:Wn},Symbol.toStringTag,{value:"Module"}));export{Ve as R,Wn as S,wn as a,Un as b,Pt as c,Vt as d,Pe as e,Lt as f,Mn as g,On as h,Ne as i,bs as j,vn as u};
