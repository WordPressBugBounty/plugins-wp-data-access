const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./CodeField-1.0.40-DJCwyTXg.js","./cm-1.0.40-DO7MoydR.js","./redux-1.0.40-W_04YL6Z.js","./vendor-1.0.40-CN03Eozo.js","./index-1.0.40-DmMQghWt.js","./iconBase-1.0.40-CH6TO7hF.js","./Typography-1.0.40-oRKYqE3b.js","./lib-1.0.40-CJM-IO_o.js","./loglevel-1.0.40-BZ7XahX3.js","./lodash-1.0.40-yZQKpWII.js","./moment-1.0.40-C5S46NFB.js","./useEnhancedEffect-1.0.40-DvrM_gBo.js","./notistack-1.0.40-HUa4vT_u.js","./ConfirmDialog-1.0.40-DRjx8-xC.js","./AdminTheme-1.0.40-B669Ow89.js","./Spinner-1.0.40-Bmn0_C4u.js","./FormControlLabel-1.0.40-BH1qH5qy.js","./useFormControl-1.0.40-BL8koKXQ.js","./Switch-1.0.40-CJ3Ir4CS.js","./SwitchBase-1.0.40-BQrnL2Sx.js","./useControlled-1.0.40-B7yPDtn1.js","./Alert-1.0.40-Bz3Zj62D.js","./index-1.0.40-D3XFZfpM.js","./AlertTitle-1.0.40-BbdAhoXf.js","./createSvgIcon-1.0.40-DryBVjDb.js","./Close-1.0.40-DOQmTCBQ.js"])))=>i.map(i=>d[i]);
import{_ as wt}from"./main-1.0.40.js";import{j as e}from"./cm-1.0.40-DO7MoydR.js";import{r as l,R as Pt}from"./redux-1.0.40-W_04YL6Z.js";import{m as Qt,n as Ht,x as Pe,y as Qe,w as St,z as At,M as kt,e as Ft,B as zt,A as Ut,T as Zt,C as Vt,D as $t,E as Wt,F as Gt,k as Rt,G as Jt,H as Xt,l as Yt}from"./index-1.0.40-DmMQghWt.js";import{G as He,I as G,P as Se}from"./iconBase-1.0.40-CH6TO7hF.js";import{D as he,P as ge,a as me,b as je,c as be,d as ve,B as q,C as Kt}from"./ConfirmDialog-1.0.40-DRjx8-xC.js";import{u as qt,a as J}from"./hooks-1.0.40-DoKijNI1.js";import{l as I,C as ee,n as oe,H as ce,I as en,J as Tt,K as tn,L as nn,S as sn,M as Ae,N as Fe,O as ze,Q as rn,T as an}from"./lib-1.0.40-CJM-IO_o.js";import{R as te}from"./RestApi-1.0.40-Uj1ofskP.js";import{B as S,S as Ue}from"./Spinner-1.0.40-Bmn0_C4u.js";import{P as ln,b as on,a as cn}from"./index-1.0.40-5CXoWu3g.js";import{e as dn,f as pn,g as un,h as fn}from"./index-1.0.40-D3XFZfpM.js";import{S as xn}from"./SanitizeComponent-1.0.40-qpEC7QW6.js";import{F as re,a as ie}from"./FormHelperText-1.0.40-D6buAdoc.js";import{F as xe}from"./FormControlLabel-1.0.40-BH1qH5qy.js";import{C as Et}from"./Checkbox-1.0.40-DtDfmlS5.js";import{T as W}from"./Tooltip-1.0.40-Czv1q8N-.js";import{P as hn,M as ke}from"./Menu-1.0.40-BKp7UqHL.js";import{D as gn}from"./Divider-1.0.40-ckRk0tPv.js";import{T as ae}from"./TextField-1.0.40-CejEr0KU.js";import{I as mn}from"./InputAdornment-1.0.40-F1_P81Q_.js";import{T as Ze,a as de}from"./TabPanel-1.0.40-svpV7m9Q.js";import{T as Ve}from"./TabList-1.0.40-C_AGnAv8.js";import{T as pe}from"./Tabs-1.0.40-grE1d1iH.js";import{S as Ke}from"./Switch-1.0.40-CJ3Ir4CS.js";import{M as U}from"./MenuItem-1.0.40-UKMJrtYZ.js";import{A as ue,a as jn}from"./AdminTheme-1.0.40-B669Ow89.js";import{b as bn}from"./index-1.0.40-DlucSO_j.js";import{C as vn}from"./index-1.0.40-Beue_JiO.js";import{e as R}from"./notistack-1.0.40-HUa4vT_u.js";import{N as yn}from"./react-number-format.es-1.0.40-BdajC67w.js";import{T as Cn,a as qe}from"./ToggleButtonGroup-1.0.40-NUyVrBPO.js";import{S as wn}from"./Select-1.0.40-Db-Xnyoo.js";import{j as Sn,G as An,B as kn,L as Tn}from"./jstoxml-1.0.40-fks_jO3M.js";import{F as et}from"./FileSaver.min-1.0.40-Bd-_6utJ.js";/* empty css                    */import{l as En}from"./ActionsExplorer-1.0.40-BO8XAUDR.js";import{D as Ln}from"./DatabaseTypeEnum-1.0.40-DeJfpW1u.js";import{T as tt}from"./ThemeProvider-1.0.40-D9QtC9zH.js";import"./vendor-1.0.40-CN03Eozo.js";import"./loglevel-1.0.40-BZ7XahX3.js";import"./lodash-1.0.40-yZQKpWII.js";import"./moment-1.0.40-C5S46NFB.js";import"./Typography-1.0.40-oRKYqE3b.js";import"./useEnhancedEffect-1.0.40-DvrM_gBo.js";import"./index-1.0.40--1Cd81c-.js";import"./dompurify-1.0.40-DhD2mIk-.js";import"./utils-1.0.40-iop7lDec.js";import"./useFormControl-1.0.40-BL8koKXQ.js";import"./SwitchBase-1.0.40-BQrnL2Sx.js";import"./useControlled-1.0.40-B7yPDtn1.js";import"./createSvgIcon-1.0.40-DryBVjDb.js";import"./Popper-1.0.40-Jt4gcDMJ.js";import"./FormLabel-1.0.40-DLOepjQ0.js";import"./useThemeProps-1.0.40-CnqSFvnT.js";import"./getThemeProps-1.0.40-CtGZuG5N.js";import"./jstoxml-1.0.40-DkGlThlH.js";function Lt(t){return He({attr:{version:"1.1",viewBox:"0 0 17 17"},child:[{tag:"g",attr:{},child:[]},{tag:"path",attr:{d:"M16 3v2h-15v-2h15zM1 10h15v-2h-15v2zM1 15h15v-2h-15v2z"},child:[]}]})(t)}const fe=()=>{const t=qt(n=>n.sql);return I.debug("queryBuilder",t),t},nt=(t,n,r,s=!1)=>{te(ee.appUrlQbOpen,{access:t},n,r,s)},On=(t,n,r,s,i,o,a=!1)=>{te(ee.appUrlQbExecute,{dbs:t,query:n,limit:r,protect:s},i,o,a)},Ot=(t,n,r,s,i,o,a,c,p,d=!1)=>{te(ee.appUrlQbSave,{access:t,dbs:n,name:r,query:s,vqb:i,old_name:o,insert:a},c,p,d)},Dn=(t,n,r,s,i=!1)=>{te(ee.appUrlQbDelete,{access:t,name:n},r,s,i)},Mn=(t,n,r,s,i,o,a=!1)=>{te(ee.appUrlQbCopy,{access_from:t,from:n,access_to:r,to:s},i,o,a)},In=(t,n,r,s=!1)=>{te(ee.appUrlQbHints,{dbs:t},n,r,s)},Dt=(t,n,r,s=!1)=>{te(ee.appUrlQbAutoComplete,{enable:t},n,r,s)},_n=({queryName:t,query:n,checked:r,setChecked:s})=>e.jsxs(S,{sx:{position:"relative",display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(re,{sx:{marginLeft:"12px"},children:e.jsx(xe,{control:e.jsx(Et,{checked:r,onClick:i=>{s(!r),i.preventDefault(),i.stopPropagation()}}),label:t,sx:{textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden"}})}),e.jsx(S,{children:e.jsx(ln,{variant:"popover",children:i=>e.jsxs(e.Fragment,{children:[e.jsx(W,{title:"Preview query "+t,children:e.jsx(G,{...on(i),children:e.jsx(Qt,{})})}),e.jsxs(hn,{...cn(i),anchorOrigin:{vertical:"bottom",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"right"},sx:{boxShadow:"0px 5px 5px -3px rgba(0,0,0,0.2),0px 8px 10px 1px rgba(0,0,0,0.14),0px 3px 14px 2px rgba(0,0,0,0.12)","& > .MuiPaper-root":{resize:"both",minWidth:"400px",maxWidth:"80vw",maxHeight:"80vh",padding:"30px"}},children:[e.jsxs(S,{sx:{display:"flex",alignItems:"center",flexDirection:"row",gap:"5px"},children:[e.jsx(dn,{}),e.jsx("strong",{children:n.schemaName})]}),e.jsx(gn,{sx:{margin:"10px 0"}}),e.jsx(xn,{html:oe(n.query).replaceAll(`
`,"<br/>")})]})]})})})]});var Q=(t=>(t.GLOBAL="global",t.USER="user",t))(Q||{});const ne=()=>({createQueryKey:(r,s)=>(r===Q.GLOBAL?"G-":"U-")+s,getQueryKey:r=>r.substring(2)}),Bn=({open:t,setOpen:n})=>{const r=J(),s=fe(),{createQueryKey:i}=ne(),[o,a]=l.useState(!1),[c,p]=l.useState(!1),[d,u]=l.useState({}),[f,h]=l.useState([]),[g,x]=l.useState(!1),[m,b]=l.useState(!1),[y,D]=l.useState({}),[B,C]=l.useState([]),[w,L]=l.useState("");l.useEffect(()=>{nt(Q.USER,T=>{I.debug(T),u((T==null?void 0:T.data)??{}),a(!0)},()=>{I.error("Error loading Query Builder list."),p(!0),a(!0)}),nt(Q.GLOBAL,T=>{I.debug(T),D((T==null?void 0:T.data)??{}),x(!0)},()=>{I.error("Error loading Query Builder list."),b(!0),x(!0)})},[]);const A=(T,E,N,H,Z)=>T?E?e.jsx(S,{children:"Unable to read query list."}):Object.keys(N).length===0?e.jsx(S,{children:"No queries found."}):e.jsx(S,{sx:{height:"380px",overflowY:"auto",paddingRight:"10px"},children:Object.keys(N).map(k=>N[k]===void 0||N[k]===null||s.queries[i(Q.USER,k)]||s.queries[i(Q.GLOBAL,k)]||!k.toLowerCase().includes(w.toLowerCase())?null:e.jsx(_n,{queryName:k,query:N[k],checked:H.includes(k),setChecked:F=>{const O=[...H];if(F)O.push(k);else{const z=O.indexOf(k);z!==-1&&O.splice(z,1)}Z(O)}},k))}):e.jsx(Ue,{title:"Loading queries..."}),[j,P]=l.useState("user");return e.jsxs(he,{open:t,onClose:()=>n(!1),PaperComponent:ge,sx:{"& .MuiPaper-root":{width:"600px",height:"600px"}},"aria-labelledby":"open-query-dialog",closeAfterTransition:!1,children:[e.jsx(me,{style:{cursor:"move"},id:"draggable-dialog-title",children:e.jsxs(S,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("span",{children:"Open Query"}),e.jsx(ae,{type:"text",value:w,onChange:T=>{L(T.target.value)},sx:{width:"160px",backgroundColor:"#fff",fontSize:"1em",margin:0,padding:0,borderRadius:"4px","&.MuiFormControl-root.MuiTextField-root .MuiInputBase-root":{paddingRight:0},"&.MuiFormControl-root.MuiTextField-root input":{padding:"8px"}},slotProps:{input:{startAdornment:e.jsx(mn,{position:"end",sx:{fontSize:"1.5rem",padding:0,margin:0},children:e.jsx(Ht,{})})}}})]})}),e.jsx(je,{sx:{zIndex:1,overflow:"hidden"},children:e.jsx(be,{component:"div",sx:{"& div.MuiTabPanel-root":{paddingTop:"10px",paddingRight:0,paddingBottom:0,paddingLeft:0},"& svg":{height:"1.2em",width:"1.2em"}},children:e.jsxs(Ze,{value:j,children:[e.jsxs(Ve,{onChange:(T,E)=>{P(E)},children:[e.jsx(pe,{label:e.jsxs(S,{sx:{display:"flex",flexDirection:"row",alignItems:"center",gap:"5px"},children:[e.jsx(Pe,{}),e.jsx("span",{children:"My Queries"})]}),value:"user"}),e.jsx(pe,{label:e.jsxs(S,{sx:{display:"flex",flexDirection:"row",alignItems:"center",gap:"5px"},children:[e.jsx(Qe,{}),e.jsx("span",{children:"Global Queries"})]}),value:"global"})]}),e.jsx(de,{value:"user",children:A(o,c,d,f,h)}),e.jsx(de,{value:"global",children:A(g,m,y,B,C)})]})})}),e.jsxs(ve,{sx:{padding:"30px","& button":{width:"120px"}},children:[e.jsx(q,{autoFocus:!0,variant:"contained",disabled:f.length===0&&B.length===0,onClick:T=>{n(!1),f.map(E=>{r(ce({queryKey:i(Q.USER,E),query:{access:Q.USER,queryName:E,query:d[E].query,schemaName:d[E].schema_name,isVisual:d[E].is_visual}}))}),B.map(E=>{r(ce({queryKey:i(Q.GLOBAL,E),query:{access:Q.GLOBAL,queryName:E,query:y[E].query,schemaName:y[E].schema_name,isVisual:y[E].is_visual}}))}),T.stopPropagation()},children:"Open"}),e.jsx(q,{variant:"contained",onClick:T=>{n(!1),T.stopPropagation()},children:"Cancel"})]})]})},Nn=({open:t,setOpen:n})=>{const r=J(),s=fe();return e.jsxs(he,{open:t,onClose:()=>n(!1),PaperComponent:ge,"aria-labelledby":"open-query-dialog",closeAfterTransition:!1,children:[e.jsx(me,{style:{cursor:"move"},id:"draggable-dialog-title",children:e.jsx(S,{children:"Query Settings"})}),e.jsx(je,{sx:{zIndex:1,paddingTop:0,paddingBottom:0},children:e.jsxs(be,{component:"div",sx:{width:"480px"},children:[e.jsx("fieldset",{className:"pp-fieldset",children:e.jsxs(re,{fullWidth:!0,children:[e.jsx(xe,{control:e.jsx(Ke,{checked:s.protectWordPressTables,onChange:i=>{r(en({protectWordPressTables:!s.protectWordPressTables})),i.stopPropagation()}}),label:"WordPress Table Protection"}),e.jsxs(ie,{sx:{marginTop:"10px"},children:["By default, WordPress tables are protected to prevent accidental or harmful changes. While you can disable this protection under certain restrictions, it's important to note that ",e.jsx("strong",{children:"DROP"}),", ",e.jsx("strong",{children:"ALTER"}),", and ",e.jsx("strong",{children:"TRUNCATE"})," operations on WordPress tables are never allowed for safety reasons."]}),e.jsxs(ie,{sx:{marginTop:"10px"},children:["With protection disabled, the plugin permits ",e.jsx("strong",{children:"INSERT"}),", ",e.jsx("strong",{children:"UPDATE"}),", and ",e.jsx("strong",{children:"DELETE"})," actions on WordPress tables."]}),e.jsxs(ie,{sx:{marginTop:"10px",marginBottom:"10px"},children:[e.jsx("strong",{children:"Caution:"})," Modifying WordPress tables directly is not recommended unless you fully understand the risks."]})]})}),e.jsx("fieldset",{className:"pp-fieldset",style:{marginTop:"30px"},children:e.jsxs(re,{fullWidth:!0,children:[e.jsx(xe,{control:e.jsx(Ke,{checked:s.showSqlHints,onChange:i=>{Dt(!s.showSqlHints,o=>{I.debug(o)},o=>{console.info(o)}),r(Tt({showSqlHints:!s.showSqlHints})),i.stopPropagation()}}),label:"Show SQL hints"}),e.jsx(ie,{sx:{marginTop:"10px",marginBottom:"10px"},children:"Provides autocomplete support when writing queries. May require additional load time to fetch database, table, and column details."})]})})]})}),e.jsx(ve,{sx:{padding:"30px"},children:e.jsx(q,{variant:"contained",onClick:i=>{n(!1),i.stopPropagation()},children:"Done"})})]})},Pn=()=>{const t=J(),{createQueryKey:n}=ne(),[r,s]=l.useState(null),i=!!r,[o,a]=l.useState(!1),[c,p]=l.useState(!1),[d,u]=l.useState(0),[f,h]=l.useState(null),g=b=>{h(b.currentTarget)},x=()=>{h(null)},m=b=>{const y=nn.getSelectors().selectQueryBuilder(sn.getState().sql),D=d===0?"New Query":`New Query ${d}`;t(ce({queryKey:n(b,D),query:{access:b,queryName:D,query:"",schemaName:y.databases.defaultDatabase,isVisual:!1,isInserting:!0}})),u(d+1)};return e.jsxs(e.Fragment,{children:[e.jsxs(S,{children:[e.jsx(W,{title:"Queries",children:e.jsx(G,{onClick:b=>{s(b.currentTarget),b.stopPropagation()},children:e.jsx(Lt,{})})}),e.jsxs(ke,{anchorEl:r,open:i,onClose:()=>s(null),anchorOrigin:{vertical:"bottom",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"left"},children:[e.jsxs(U,{onClick:g,children:[e.jsx(St,{}),e.jsx("span",{style:{marginLeft:"10px"},children:"New"})]}),e.jsxs(ke,{id:"submenu",anchorEl:f,open:f!==null,onClose:x,anchorOrigin:{vertical:"top",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"left"},MenuListProps:{onMouseLeave:x},children:[e.jsx(U,{onClick:()=>{s(null),x(),m(Q.USER)},children:"Private query"}),e.jsx(U,{onClick:()=>{s(null),x(),m(Q.GLOBAL)},children:"Global query"})]}),e.jsxs(U,{onClick:()=>{s(null),a(!0)},children:[e.jsx(At,{}),e.jsx("span",{style:{marginLeft:"10px"},children:"Open"})]}),e.jsxs(U,{onClick:()=>{s(null),t(tn())},children:[e.jsx(kt,{}),e.jsx("span",{style:{marginLeft:"10px"},children:"Close All"})]}),e.jsxs(U,{onClick:()=>{s(null),p(!0)},children:[e.jsx(Ft,{}),e.jsx("span",{style:{marginLeft:"10px"},children:"Setting"})]}),e.jsxs(U,{onClick:()=>{window.open("https://wpdataaccess.com/docs/sql-query-builder/query-builder-getting-started/","_blank")},children:[e.jsx(zt,{}),e.jsx("span",{style:{marginLeft:"10px"},children:"Help"})]})]})]}),o&&e.jsx(Bn,{open:o,setOpen:a}),c&&e.jsx(Nn,{open:c,setOpen:p})]})},Qn=l.lazy(()=>wt(()=>import("./CodeField-1.0.40-DJCwyTXg.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20]),import.meta.url)),Hn=({queryKey:t,query:n})=>{const r=J(),s=fe(),{getQueryKey:i}=ne(),[o,a]=l.useState(oe(n.query)),[c,p]=l.useState(void 0);l.useEffect(()=>{s.showSqlHints&&d()},[s.showSqlHints,s.queries[t].schemaName]);const d=()=>{In(s.queries[t].schemaName,u=>{I.debug(u),(u==null?void 0:u.code)==="ok"&&p(u==null?void 0:u.data)},u=>{I.error(u)})};return e.jsx(S,{children:e.jsx(l.Suspense,{children:e.jsx(Qn,{code:o,setCode:u=>{a(u),r(Ae({queryKey:t,query:{...n,query:u}}))},dialogTitle:i(t),extension:"sql",sqlSchema:c,initialHeight:"270px"})})})};function Fn(t){return He({attr:{fill:"none",viewBox:"0 0 24 24",strokeWidth:"2",stroke:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{strokeLinecap:"round",strokeLinejoin:"round",d:"M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m0 0h2a2 2 0 012 2v3m2 4H10m0 0l3-3m-3 3l3 3"},child:[]}]})(t)}function zn(t){return He({attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M222,114.56a54,54,0,0,0-58.67-74.73,54,54,0,0,0-94,13.46A54,54,0,0,0,34,141.44a54,54,0,0,0,35.56,73.65A54.54,54.54,0,0,0,83.59,217a52.86,52.86,0,0,0,9.06-.78,54,54,0,0,0,94-13.46A54,54,0,0,0,222,114.56ZM183.37,52.5a42,42,0,0,1,29.21,53.14,54.84,54.84,0,0,0-5.08-3.33L163,76.62a6,6,0,0,0-6,0l-47,27.13V80.66l41.5-24A41.73,41.73,0,0,1,183.37,52.5ZM146,138.39l-18,10.39-18-10.39V117.61l18-10.39,18,10.39ZM78,72a42,42,0,0,1,72.92-28.43,56.18,56.18,0,0,0-5.42,2.74L101,72a6,6,0,0,0-3,5.19v54.27L78,119.92ZM39.13,85.93a41.75,41.75,0,0,1,27.22-20A55.09,55.09,0,0,0,66,72v51.38a6,6,0,0,0,3,5.2l47,27.13L96,167.26l-41.5-24A42,42,0,0,1,39.13,85.93ZM72.63,203.5a42,42,0,0,1-29.21-53.14,54.84,54.84,0,0,0,5.08,3.33L93,179.38a6,6,0,0,0,6,0l47-27.13v23.09l-41.5,24A41.73,41.73,0,0,1,72.63,203.5ZM178,184a42,42,0,0,1-72.92,28.43,56.18,56.18,0,0,0,5.42-2.74L155,184a6,6,0,0,0,3-5.19V124.54l20,11.54Zm38.87-13.93a41.75,41.75,0,0,1-27.22,20A55.09,55.09,0,0,0,190,184V132.62a6,6,0,0,0-3-5.2l-47-27.13,20-11.55,41.5,24A42,42,0,0,1,216.87,170.07Z"},child:[]}]})(t)}const Un=({queries:t,queryKey:n,copyDialog:r,setCopyDialog:s,newName:i,setNewName:o})=>{var u,f,h,g;const a=J(),{createQueryKey:c}=ne(),[p,d]=l.useState(t[n].access);return e.jsxs(he,{open:r,onClose:()=>s(!1),PaperComponent:ge,"aria-labelledby":"confirm-dialog",closeAfterTransition:!1,children:[e.jsx(me,{style:{color:(f=(u=ue)==null?void 0:u.palette)==null?void 0:f.primary.main,marginTop:"10px",cursor:"move"},id:"draggable-dialog-title",children:"Copy query"}),e.jsx(je,{children:e.jsx(be,{component:"div",sx:{color:(g=(h=ue)==null?void 0:h.palette)==null?void 0:g.primary.main},children:e.jsxs(S,{sx:{paddingTop:"5px",display:"flex",flexDirection:"column",gap:"20px"},children:[e.jsx(ae,{label:"Copy",disabled:!0,value:t[n].queryName}),e.jsx(ae,{label:"To",value:i,onChange:x=>{o(x.target.value)}}),e.jsxs(re,{fullWidth:!0,children:[e.jsxs(Cn,{sx:{display:"grid",gridTemplateColumns:"1fr 1fr","& svg":{marginRight:"5px",height:"1.2em",width:"1.2em"}},value:p,children:[e.jsxs(qe,{value:Q.USER,onClick:()=>{d(Q.USER)},children:[e.jsx(Pe,{})," Only Me"]}),e.jsxs(qe,{value:Q.GLOBAL,onClick:()=>{d(Q.GLOBAL)},children:[e.jsx(Qe,{})," Everyone"]})]}),e.jsx(ie,{children:"Define who can access this query."})]})]})})}),e.jsx(ve,{sx:{padding:0},children:e.jsxs(S,{sx:{width:"100%",margin:"0 20px 20px 20px",display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",gap:"10px"},children:[e.jsx(q,{autoFocus:!0,fullWidth:!0,variant:"contained",disabled:i.trim()==="",onClick:x=>{s(!1);const m=c(p,i);Mn(t[n].access,t[n].queryName,p,i,b=>{I.debug(b),(b==null?void 0:b.code)==="ok"&&(a(ce({queryKey:m,query:{access:p,queryName:i,query:t[n].query,schemaName:t[n].schemaName,isVisual:t[n].isVisual}})),a(Fe({tabIndex:m})),R("Query succesfully saved",{variant:"success"}))},b=>{I.error(b),R(b,{variant:"error"})}),x.stopPropagation()},children:"Copy"}),e.jsx(q,{fullWidth:!0,variant:"contained",onClick:x=>{s(!1),x.stopPropagation()},children:"Cancel"})]})})]})},Zn=({queries:t,queryKey:n,renameDialog:r,setRenameDialog:s,newName:i,setNewName:o})=>{var d,u,f,h;const a=J(),{createQueryKey:c}=ne(),p=g=>{a(ce({queryKey:g,query:{access:t[n].access,queryName:i,query:t[n].query,schemaName:t[n].schemaName,isVisual:t[n].isVisual,isInserting:t[n].isInserting}})),a(ze({queryKey:n})),a(Fe({tabIndex:g}))};return e.jsxs(he,{open:r,onClose:()=>s(!1),PaperComponent:ge,"aria-labelledby":"confirm-dialog",closeAfterTransition:!1,children:[e.jsx(me,{style:{color:(u=(d=ue)==null?void 0:d.palette)==null?void 0:u.primary.main,marginTop:"10px",cursor:"move"},id:"draggable-dialog-title",children:"Rename query"}),e.jsx(je,{children:e.jsx(be,{component:"div",sx:{color:(h=(f=ue)==null?void 0:f.palette)==null?void 0:h.primary.main},children:e.jsxs(S,{sx:{paddingTop:"5px",display:"flex",flexDirection:"column",gap:"20px"},children:[e.jsx(ae,{label:"Saved query name",disabled:!0,value:t[n].queryName}),e.jsx(ae,{label:"New query name",value:i,onChange:g=>{o(g.target.value)}})]})})}),e.jsx(ve,{sx:{padding:0},children:e.jsxs(S,{sx:{width:"100%",margin:"0 20px 20px 20px",display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",gap:"10px"},children:[e.jsx(q,{autoFocus:!0,fullWidth:!0,variant:"contained",disabled:i.trim()==="",onClick:g=>{s(!1);const x=c(t[n].access,i);t[n].isInserting!==!0?Ot(t[n].access,t[n].schemaName,i,oe(t[n].query),!1,t[n].queryName,!0,m=>{I.debug(m),(m==null?void 0:m.code)==="ok"&&(p(x),R("Query succesfully renamed",{variant:"success"}))},m=>{I.error(m),R(m,{variant:"error"})}):t[x]?R("Query name already exists",{variant:"error"}):p(x),g.stopPropagation()},children:"Rename"}),e.jsx(q,{fullWidth:!0,variant:"contained",onClick:g=>{s(!1),g.stopPropagation()},children:"Cancel"})]})})]})},Vn=({queries:t,queryKey:n,confirmDelete:r,setConfirmDelete:s})=>{const i=J();return e.jsx(Kt,{title:"Delete query",message:e.jsxs("div",{children:["Are you sure you want to delete query ",t[n].queryName,"?",e.jsx("br",{}),e.jsx("strong",{children:"This action cannot be undone!"})]}),open:r,setOpen:s,onConfirm:()=>{i(ze({queryKey:n})),Dn(t[n].access,t[n].queryName,o=>{I.debug(o),R("Query successfully deleted",{variant:"success"})},o=>{I.error(o),R(o,{variant:"error"})})}})},$n=({queries:t,queryKey:n,databases:r,setQueryResults:s})=>{var A;const i=J(),o=fe(),[a,c]=l.useState(null),p=!!a,[d,u]=l.useState(!0),[f,h]=l.useState(100),[g,x]=l.useState(!1),[m,b]=l.useState(!1),[y,D]=l.useState(!1),[B,C]=l.useState(""),[w,L]=l.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsx(Ut,{position:"relative",elevation:4,sx:{margin:"0 0 5px 0",borderRadius:"4px"},children:e.jsxs(Zt,{sx:{display:"flex",justifyContent:"space-between",paddingRight:"12px !important"},children:[e.jsxs(S,{sx:{display:"flex",alignItems:"center",gap:"12px"},children:[e.jsx(W,{title:"Choose the database to run your query against",children:e.jsx(re,{children:e.jsxs(wn,{value:t[n].schemaName,MenuProps:{id:"pp-select-database"},size:"small",sx:{width:"250px",backgroundColor:"#fff"},onChange:j=>{i(Ae({queryKey:n,query:{...t[n],schemaName:j.target.value}}))},children:[...r.databases.map(j=>e.jsx(U,{value:j.dbs,sx:{width:"250px"},children:j.dbs},j.dbs))]})})}),e.jsx(W,{title:"Set a maximum number of rows to retrieve",children:e.jsxs(S,{sx:{display:"flex",justifyContent:"start"},children:[e.jsx(re,{children:e.jsx(xe,{sx:{marginRight:"9px"},control:e.jsx(Et,{checked:d,onClick:j=>{u(!d),j.preventDefault(),j.stopPropagation()},color:"secondary",sx:{"& svg":{fill:"#fff"}}}),label:"Max rows: "})}),e.jsx(yn,{customInput:ae,value:f,disabled:!d,variant:"outlined",onValueChange:({value:j})=>{h(Number(j))},onInvalid:j=>{j.preventDefault()},sx:{"& input.MuiInputBase-input":{borderRadius:"4px",height:"8px",backgroundColor:"#fff",width:"55px"},"& fieldset":{borderRadius:"4px"}}})]})}),e.jsx(W,{title:"Execute query",children:e.jsx(G,{sx:{color:"inherit"},onClick:()=>{x(!0),On(o.queries[n].schemaName,oe(o.queries[n].query),d?f.toString():"",o.protectWordPressTables,j=>{I.debug(j),(j==null?void 0:j.code)==="ok"&&s(j==null?void 0:j.data),x(!1)},j=>{I.error(j),R(j,{variant:"error"}),x(!1)})},children:e.jsx(Vt,{})})}),g&&e.jsx(S,{sx:{"& span.MuiCircularProgress-root":{width:"20px !important",height:"20px !important"},"& svg":{color:"#fff"}},children:e.jsx(Ue,{})})]}),e.jsxs(S,{sx:{display:"flex",flexDirection:"row"},children:[e.jsx(W,{title:"Save query",children:e.jsx(G,{sx:{color:"inherit"},onClick:()=>{Ot(o.queries[n].access,o.queries[n].schemaName,o.queries[n].queryName,oe(o.queries[n].query),!1,"",o.queries[n].isInserting,j=>{I.debug(j),(j==null?void 0:j.code)==="ok"&&(i(Ae({queryKey:n,query:{...o.queries[n],isInserting:void 0}})),R("Query succesfully saved",{variant:"success"}))},j=>{I.error(j),R(j,{variant:"error"})})},children:e.jsx(bn,{})})}),e.jsx(W,{title:"Ask ChatGPT",children:e.jsx(G,{sx:{color:"inherit"},children:e.jsx(zn,{})})}),e.jsx(W,{title:"More actions",children:e.jsx(G,{sx:{color:"inherit"},onClick:j=>{c(j.currentTarget),j.stopPropagation()},children:e.jsx($t,{})})}),e.jsxs(ke,{anchorEl:a,open:p,onClose:()=>c(null),sx:{zIndex:9999999999},anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},children:[e.jsx(vn,{text:t[n].query,onCopy:()=>{R("Query successfully copied to your clipboard",{variant:"info"}),c(null)},children:e.jsxs(U,{children:[e.jsx(Fn,{}),e.jsx("span",{style:{marginLeft:"10px"},children:"Copy to clipboard"})]})}),e.jsxs(U,{onClick:()=>{c(null),b(!0)},disabled:t[n].isInserting===!0,children:[e.jsx(Wt,{}),e.jsx("span",{style:{marginLeft:"10px"},children:"Copy query"})]}),e.jsxs(U,{onClick:()=>{c(null),D(!0)},children:[e.jsx(Gt,{}),e.jsx("span",{style:{marginLeft:"10px"},children:"Rename query"})]}),e.jsxs(U,{onClick:()=>{c(null),L(!0)},sx:{color:(A=ue)==null?void 0:A.palette.error.main},disabled:t[n].isInserting===!0,children:[e.jsx(Rt,{}),e.jsx("span",{style:{marginLeft:"10px"},children:"Delete query"})]}),e.jsxs(U,{onClick:()=>{i(ze({queryKey:n}))},children:[e.jsx(kt,{}),e.jsx("span",{style:{marginLeft:"10px"},children:"Close query"})]})]})]})]})}),m&&e.jsx(Un,{queries:t,queryKey:n,copyDialog:m,setCopyDialog:b,newName:B,setNewName:C}),y&&e.jsx(Zn,{queries:t,queryKey:n,renameDialog:y,setRenameDialog:D,newName:B,setNewName:C}),w&&e.jsx(Vn,{queries:t,queryKey:n,confirmDelete:w,setConfirmDelete:L})]})},Wn=(t,n)=>{const r=()=>{var a;if(Array.isArray((a=n==null?void 0:n.status)==null?void 0:a.last_result)&&n.status.last_result.length>0){const c=An({filename:t,fieldSeparator:",",decimalSeparator:".",useKeysAsHeaders:!0}),p=kn(c)(o());Tn(c)(p)}},s=()=>{var a;Array.isArray((a=n==null?void 0:n.status)==null?void 0:a.last_result)&&n.status.last_result.length>0&&et(new Blob([JSON.stringify(o())],{type:"text/json;charset=utf-8"}),`${t}.json`)},i=()=>{var a;if(Array.isArray((a=n==null?void 0:n.status)==null?void 0:a.last_result)&&n.status.last_result.length>0){const c=n.status.last_result.map(d=>{const u={};return Object.keys(d).map(f=>{u[f]=d[f]}),{row:u}}),p=Sn.toXML({table:c});et(new Blob([p],{type:"text/plain;charset=utf-8"}),`${t}.xml`)}},o=()=>{const a=[];return Array.isArray(n==null?void 0:n.columns)&&n.columns.map(p=>{if(p.Field&&p.Type){const d=p.Type.indexOf("(")>0?p.Type.substring(0,p.Type.indexOf("(")).toLowerCase():p.Type;rn(d)==="number"&&a.push(p.Field)}}),n.status.last_result.map(p=>{const d={};return Object.keys(p).map(u=>{a.includes(u)?d[u]=Number(p[u]):d[u]=p[u]}),d})};return{downloadCsv:r,downloadJson:s,downloadXml:i}},Gn=l.memo(({queryResults:t})=>{var r,s,i,o;const n=(a,c,p)=>{const d=c[p]===null?"pp-data-value-null":"";return e.jsx("td",{className:d,children:c[p]},a+p)};return e.jsx(S,{sx:{"& table.pp-sql-query-builder-table":{width:"100%",marginBottom:"0 !important",borderCollapse:"collapse",borderTopLeftRadius:"4px",borderTopRightRadius:"4px",borderBottomLeftRadius:0,borderBottomRightRadius:0},"& table.pp-sql-query-builder-table thead":{display:"block",overflowY:"scroll",backgroundColor:"#f0f0f1",borderTopLeftRadius:"4px",borderTopRightRadius:"4px",borderBottomLeftRadius:0,borderBottomRightRadius:0},"& table.pp-sql-query-builder-table thead::-webkit-scrollbar":{borderTopRightRadius:"4px"},"& table.pp-sql-query-builder-table tbody":{display:"block",overflowY:"scroll",height:"240px",borderTop:"1px solid #ccc",backgroundColor:"#fff"},"& table.pp-sql-query-builder-table tr":{width:"calc(100% - 1px)",display:"table",tableLayout:"fixed"},"& table.pp-sql-query-builder-table tbody tr:hover":{backgroundColor:"#f5f5f5"},"& table.pp-sql-query-builder-table thead tr th":{borderRight:"1px dotted #ccc",height:"17px",lineHeight:"17px"},"& table.pp-sql-query-builder-table tbody tr td":{borderRight:"1px dotted #ccc",borderBottom:"1px dotted #ccc",borderLeft:0},"& table.pp-sql-query-builder-table tbody tr:first-of-type td":{borderTop:0},"& table.pp-sql-query-builder-table thead tr th, & table.pp-sql-query-builder-table tbody tr td":{overflowWrap:"anywhere",textAlign:"left",padding:"6px"},"& table.pp-sql-query-builder-table tbody td.pp-data-value-null":{fontStyle:"italic",color:"#2271b1"},"& table.pp-sql-query-builder-table tbody td.pp-data-value-null:before":{content:'"(null)"'}},children:Array.isArray((r=t==null?void 0:t.status)==null?void 0:r.last_result)&&e.jsxs("table",{className:"pp-sql-query-builder-table",children:[e.jsx("thead",{children:e.jsx("tr",{children:(s=t==null?void 0:t.columns)==null?void 0:s.map(a=>e.jsx("th",{children:a.Field},a.Field))},"header")}),e.jsx("tbody",{children:(o=(i=t==null?void 0:t.status)==null?void 0:i.last_result)==null?void 0:o.map((a,c)=>e.jsx("tr",{children:Object.keys(a).map(p=>n(c,a,p))},c))})]})})});function Rn(t,n,r,s){function i(o){return o instanceof r?o:new r(function(a){a(o)})}return new(r||(r=Promise))(function(o,a){function c(u){try{d(s.next(u))}catch(f){a(f)}}function p(u){try{d(s.throw(u))}catch(f){a(f)}}function d(u){u.done?o(u.value):i(u.value).then(c,p)}d((s=s.apply(t,[])).next())})}var Jn=function(){var t=document.getSelection();if(!t.rangeCount)return function(){};for(var n=document.activeElement,r=[],s=0;s<t.rangeCount;s++)r.push(t.getRangeAt(s));switch(n.tagName.toUpperCase()){case"INPUT":case"TEXTAREA":n.blur();break;default:n=null;break}return t.removeAllRanges(),function(){t.type==="Caret"&&t.removeAllRanges(),t.rangeCount||r.forEach(function(i){t.addRange(i)}),n&&n.focus()}},Xn=Jn,st={"text/plain":"Text","text/html":"Url",default:"Text"},Yn="Copy to clipboard: #{key}, Enter";function Kn(t){var n=(/mac os x/i.test(navigator.userAgent)?"âŒ˜":"Ctrl")+"+C";return t.replace(/#{\s*key\s*}/g,n)}function qn(t,n){var r,s,i,o,a,c,p=!1;n||(n={}),r=n.debug||!1;try{i=Xn(),o=document.createRange(),a=document.getSelection(),c=document.createElement("span"),c.textContent=t,c.ariaHidden="true",c.style.all="unset",c.style.position="fixed",c.style.top=0,c.style.clip="rect(0, 0, 0, 0)",c.style.whiteSpace="pre",c.style.webkitUserSelect="text",c.style.MozUserSelect="text",c.style.msUserSelect="text",c.style.userSelect="text",c.addEventListener("copy",function(u){if(u.stopPropagation(),n.format)if(u.preventDefault(),typeof u.clipboardData>"u"){r&&console.warn("unable to use e.clipboardData"),r&&console.warn("trying IE specific stuff"),window.clipboardData.clearData();var f=st[n.format]||st.default;window.clipboardData.setData(f,t)}else u.clipboardData.clearData(),u.clipboardData.setData(n.format,t);n.onCopy&&(u.preventDefault(),n.onCopy(u.clipboardData))}),document.body.appendChild(c),o.selectNodeContents(c),a.addRange(o);var d=document.execCommand("copy");if(!d)throw new Error("copy command was unsuccessful");p=!0}catch(u){r&&console.error("unable to copy using execCommand: ",u),r&&console.warn("trying IE specific stuff");try{window.clipboardData.setData(n.format||"text",t),n.onCopy&&n.onCopy(window.clipboardData),p=!0}catch(f){r&&console.error("unable to copy using clipboardData: ",f),r&&console.error("falling back to prompt"),s=Kn("message"in n?n.message:Yn),window.prompt(s,t)}}finally{a&&(typeof a.removeRange=="function"?a.removeRange(o):a.removeAllRanges()),c&&document.body.removeChild(c),i()}return p}var es=qn;function Y(t){return Object.prototype.toString.call(t)==="[object Object]"}function le(t){return Array.isArray(t)?t.length:Y(t)?Object.keys(t).length:0}function ts(t,n){if(typeof t=="string")return t;try{return JSON.stringify(t,(r,s)=>{switch(typeof s){case"bigint":return String(s)+"n";case"number":case"boolean":case"object":case"string":return s;default:return String(s)}},n)}catch(r){return`${r.name}: ${r.message}`||"JSON.stringify failed"}}function ns(t){return Rn(this,void 0,void 0,function*(){try{yield navigator.clipboard.writeText(t)}catch{es(t)}})}function rt(t,n,r,s,i,o){if(o&&o.collapsed!==void 0)return!!o.collapsed;if(typeof s=="boolean")return s;if(typeof s=="number"&&n>s)return!0;const a=le(t);if(typeof s=="function"){const c=$e(s,[{node:t,depth:n,indexOrName:r,size:a}]);if(typeof c=="boolean")return c}return!!(Array.isArray(t)&&a>i||Y(t)&&a>i)}function at(t,n,r,s,i,o){if(o&&o.collapsed!==void 0)return!!o.collapsed;if(typeof s=="boolean")return s;if(typeof s=="number"&&n>s)return!0;const a=Math.ceil(t.length/100);if(typeof s=="function"){const c=$e(s,[{node:t,depth:n,indexOrName:r,size:a}]);if(typeof c=="boolean")return c}return!!(Array.isArray(t)&&a>i||Y(t)&&a>i)}function se(t,n,r){return typeof t=="boolean"?t:!!(typeof t=="number"&&n>t||t==="collapsed"&&r||t==="expanded"&&!r)}function $e(t,n){try{return t(...n)}catch(r){reportError(r)}}function Mt(t){if(t===!0||Y(t)&&t.add===!0)return!0}function it(t){if(t===!0||Y(t)&&t.edit===!0)return!0}function We(t){if(t===!0||Y(t)&&t.delete===!0)return!0}function ss(t){return typeof t=="function"}function It(t){return!t||t.add===void 0||!!t.add}function lt(t){return!t||t.edit===void 0||!!t.edit}function Ge(t){return!t||t.delete===void 0||!!t.delete}function ye(t){return!t||t.enableClipboard===void 0||!!t.enableClipboard}function rs(t){return!t||t.matchesURL===void 0||!!t.matchesURL}function as(t,n){return t==="string"?n.trim().replace(/^\"([\s\S]+?)\"$/,"$1"):n}var ot;function Te(){return Te=Object.assign?Object.assign.bind():function(t){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},Te.apply(this,arguments)}var Re=function(n){return l.createElement("svg",Te({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none",viewBox:"0 0 16 16"},n),ot||(ot=l.createElement("path",{fill:"currentColor",d:"M12.473 5.806a.666.666 0 0 0-.946 0L8.473 8.86a.667.667 0 0 1-.946 0L4.473 5.806a.667.667 0 1 0-.946.94l3.06 3.06a2 2 0 0 0 2.826 0l3.06-3.06a.667.667 0 0 0 0-.94Z"})))},ct;function Ee(){return Ee=Object.assign?Object.assign.bind():function(t){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},Ee.apply(this,arguments)}var is=function(n){return l.createElement("svg",Ee({xmlns:"http://www.w3.org/2000/svg",width:24,height:24,fill:"none",viewBox:"0 0 24 24"},n),ct||(ct=l.createElement("path",{fill:"currentColor",d:"M17.542 2.5h-4.75a3.963 3.963 0 0 0-3.959 3.958v4.75a3.963 3.963 0 0 0 3.959 3.959h4.75a3.963 3.963 0 0 0 3.958-3.959v-4.75A3.963 3.963 0 0 0 17.542 2.5Zm2.375 8.708a2.378 2.378 0 0 1-2.375 2.375h-4.75a2.378 2.378 0 0 1-2.375-2.375v-4.75a2.378 2.378 0 0 1 2.375-2.375h4.75a2.378 2.378 0 0 1 2.375 2.375v4.75Zm-4.75 6.334a3.963 3.963 0 0 1-3.959 3.958h-4.75A3.963 3.963 0 0 1 2.5 17.542v-4.75a3.963 3.963 0 0 1 3.958-3.959.791.791 0 1 1 0 1.584 2.378 2.378 0 0 0-2.375 2.375v4.75a2.378 2.378 0 0 0 2.375 2.375h4.75a2.378 2.378 0 0 0 2.375-2.375.792.792 0 1 1 1.584 0Z"})))},dt,pt;function Le(){return Le=Object.assign?Object.assign.bind():function(t){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},Le.apply(this,arguments)}var ls=function(n){return l.createElement("svg",Le({xmlns:"http://www.w3.org/2000/svg",width:24,height:24,fill:"none",viewBox:"0 0 24 24"},n),dt||(dt=l.createElement("path",{fill:"currentColor",d:"M17.25 3H6.75A3.755 3.755 0 0 0 3 6.75v10.5A3.754 3.754 0 0 0 6.75 21h10.5A3.754 3.754 0 0 0 21 17.25V6.75A3.755 3.755 0 0 0 17.25 3Zm2.25 14.25a2.25 2.25 0 0 1-2.25 2.25H6.75a2.25 2.25 0 0 1-2.25-2.25V6.75A2.25 2.25 0 0 1 6.75 4.5h10.5a2.25 2.25 0 0 1 2.25 2.25v10.5Z"})),pt||(pt=l.createElement("path",{fill:"#14C786",d:"M10.312 14.45 7.83 11.906a.625.625 0 0 0-.896 0 .659.659 0 0 0 0 .918l2.481 2.546a1.264 1.264 0 0 0 .896.381 1.237 1.237 0 0 0 .895-.38l5.858-6.011a.658.658 0 0 0 0-.919.625.625 0 0 0-.896 0l-5.857 6.01Z"})))};function Ce({node:t,nodeMeta:n}){const{customizeCopy:r,CopyComponent:s,CopiedComponent:i}=l.useContext(K),[o,a]=l.useState(!1),c=p=>{p.stopPropagation();const d=r(t,n);typeof d=="string"&&d&&ns(d),a(!0),setTimeout(()=>a(!1),3e3)};return o?typeof i=="function"?e.jsx(i,{className:"json-view--copy",style:{display:"inline-block"}}):e.jsx(ls,{className:"json-view--copy",style:{display:"inline-block"}}):typeof s=="function"?e.jsx(s,{onClick:c,className:"json-view--copy"}):e.jsx(is,{onClick:c,className:"json-view--copy"})}function Oe({indexOrName:t,value:n,depth:r,deleteHandle:s,editHandle:i,parent:o,parentPath:a}){const{displayArrayIndex:c}=l.useContext(K),p=Array.isArray(o);return e.jsxs("div",Object.assign({className:"json-view--pair"},{children:[!p||p&&c?e.jsxs(e.Fragment,{children:[e.jsx("span",Object.assign({className:typeof t=="number"?"json-view--index":"json-view--property"},{children:t})),":"," "]}):e.jsx(e.Fragment,{}),e.jsx(Bt,{node:n,depth:r+1,deleteHandle:(d,u)=>s(d,u),editHandle:(d,u,f,h)=>i(d,u,f,h),parent:o,indexOrName:t,parentPath:a})]}))}var ut,ft;function De(){return De=Object.assign?Object.assign.bind():function(t){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},De.apply(this,arguments)}var Je=function(n){return l.createElement("svg",De({xmlns:"http://www.w3.org/2000/svg",width:24,height:24,fill:"none",viewBox:"0 0 24 24"},n),ut||(ut=l.createElement("path",{fill:"currentColor",d:"M18.75 6h-2.325a3.757 3.757 0 0 0-3.675-3h-1.5a3.757 3.757 0 0 0-3.675 3H5.25a.75.75 0 0 0 0 1.5H6v9.75A3.754 3.754 0 0 0 9.75 21h4.5A3.754 3.754 0 0 0 18 17.25V7.5h.75a.75.75 0 1 0 0-1.5Zm-7.5-1.5h1.5A2.255 2.255 0 0 1 14.872 6H9.128a2.255 2.255 0 0 1 2.122-1.5Zm5.25 12.75a2.25 2.25 0 0 1-2.25 2.25h-4.5a2.25 2.25 0 0 1-2.25-2.25V7.5h9v9.75Z"})),ft||(ft=l.createElement("path",{fill:"#DA0000",d:"M10.5 16.5a.75.75 0 0 0 .75-.75v-4.5a.75.75 0 1 0-1.5 0v4.5a.75.75 0 0 0 .75.75ZM13.5 16.5a.75.75 0 0 0 .75-.75v-4.5a.75.75 0 1 0-1.5 0v4.5a.75.75 0 0 0 .75.75Z"})))},xt,ht;function Me(){return Me=Object.assign?Object.assign.bind():function(t){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},Me.apply(this,arguments)}var _t=function(n){return l.createElement("svg",Me({xmlns:"http://www.w3.org/2000/svg",width:24,height:24,fill:"none",viewBox:"0 0 24 24"},n),xt||(xt=l.createElement("path",{fill:"currentColor",d:"M21 6.75v10.5A3.754 3.754 0 0 1 17.25 21H6.75A3.754 3.754 0 0 1 3 17.25V6.75A3.754 3.754 0 0 1 6.75 3h10.5A3.754 3.754 0 0 1 21 6.75Zm-1.5 0c0-1.24-1.01-2.25-2.25-2.25H6.75C5.51 4.5 4.5 5.51 4.5 6.75v10.5c0 1.24 1.01 2.25 2.25 2.25h10.5c1.24 0 2.25-1.01 2.25-2.25V6.75Z"})),ht||(ht=l.createElement("path",{fill:"#14C786",d:"M15 12.75a.75.75 0 1 0 0-1.5h-2.25V9a.75.75 0 1 0-1.5 0v2.25H9a.75.75 0 1 0 0 1.5h2.25V15a.75.75 0 1 0 1.5 0v-2.25H15Z"})))},gt,mt;function Ie(){return Ie=Object.assign?Object.assign.bind():function(t){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},Ie.apply(this,arguments)}var Xe=function(n){return l.createElement("svg",Ie({xmlns:"http://www.w3.org/2000/svg",width:24,height:24,fill:"none",viewBox:"0 0 24 24"},n),gt||(gt=l.createElement("path",{fill:"currentColor",d:"M12 3a9 9 0 1 0 9 9 9.01 9.01 0 0 0-9-9Zm0 16.5a7.5 7.5 0 1 1 7.5-7.5 7.509 7.509 0 0 1-7.5 7.5Z"})),mt||(mt=l.createElement("path",{fill:"#14C786",d:"m10.85 13.96-1.986-2.036a.5.5 0 0 0-.716 0 .527.527 0 0 0 0 .735l1.985 2.036a1.01 1.01 0 0 0 .717.305.99.99 0 0 0 .716-.305l4.686-4.808a.526.526 0 0 0 0-.735.5.5 0 0 0-.716 0l-4.687 4.809Z"})))},jt,bt;function _e(){return _e=Object.assign?Object.assign.bind():function(t){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},_e.apply(this,arguments)}var Ye=function(n){return l.createElement("svg",_e({xmlns:"http://www.w3.org/2000/svg",width:24,height:24,fill:"none",viewBox:"0 0 24 24"},n),jt||(jt=l.createElement("path",{fill:"#DA0000",d:"M15 9a.75.75 0 0 0-1.06 0L12 10.94 10.06 9A.75.75 0 0 0 9 10.06L10.94 12 9 13.94A.75.75 0 0 0 10.06 15L12 13.06 13.94 15A.75.75 0 0 0 15 13.94L13.06 12 15 10.06A.75.75 0 0 0 15 9Z"})),bt||(bt=l.createElement("path",{fill:"currentColor",d:"M12 3a9 9 0 1 0 9 9 9.01 9.01 0 0 0-9-9Zm0 16.5a7.5 7.5 0 1 1 7.5-7.5 7.509 7.509 0 0 1-7.5 7.5Z"})))};function os({originNode:t,node:n,depth:r,index:s,deleteHandle:i,customOptions:o,startIndex:a,parent:c,parentPath:p}){const{enableClipboard:d,src:u,onEdit:f,onChange:h,forceUpdate:g,displaySize:x,CustomOperation:m}=l.useContext(K),b=[...p,String(s)],[y,D]=l.useState(!0),B=l.useCallback((L,A,j)=>{t[L]=A,f&&f({newValue:A,oldValue:j,depth:r,src:u,indexOrName:L,parentType:"array",parentPath:p}),h&&h({type:"edit",depth:r,src:u,indexOrName:L,parentType:"array",parentPath:p}),g()},[n,f,h,g]),C=L=>{t.splice(L,1),i&&i(L,p),g()},w=e.jsxs(e.Fragment,{children:[!y&&e.jsxs("span",Object.assign({onClick:()=>D(!0),className:"jv-size-chevron"},{children:[se(x,r,y)&&e.jsxs("span",Object.assign({className:"jv-size"},{children:[le(n)," Items"]})),e.jsx(Re,{className:"jv-chevron"})]})),!y&&d&&ye(o)&&e.jsx(Ce,{node:n,nodeMeta:{depth:r,indexOrName:s,parent:c,parentPath:p,currentPath:b}}),typeof m=="function"?e.jsx(m,{node:n}):null]});return e.jsxs("div",{children:[e.jsx("span",{children:"["}),w,y?e.jsxs("button",Object.assign({onClick:()=>D(!1),className:"jv-button"},{children:[a," ... ",a+n.length-1]})):e.jsx("div",Object.assign({className:"jv-indent"},{children:n.map((L,A)=>e.jsx(Oe,{indexOrName:A+a,value:L,depth:r,parent:n,deleteHandle:C,editHandle:B,parentPath:p},String(s)+String(A)))})),e.jsx("span",{children:"]"})]})}function cs({node:t,depth:n,deleteHandle:r,indexOrName:s,customOptions:i,parent:o,parentPath:a}){const c=typeof s<"u"?[...a,String(s)]:a,p=[];for(let k=0;k<t.length;k+=100)p.push(t.slice(k,k+100));const{collapsed:d,enableClipboard:u,collapseObjectsAfterLength:f,editable:h,onDelete:g,src:x,onAdd:m,CustomOperation:b,onChange:y,forceUpdate:D,displaySize:B}=l.useContext(K),[C,w]=l.useState(at(t,n,s,d,f,i));l.useEffect(()=>{w(at(t,n,s,d,f,i))},[d,f]);const[L,A]=l.useState(!1),j=()=>{A(!1),r&&r(s,a),g&&g({value:t,depth:n,src:x,indexOrName:s,parentType:"array",parentPath:a}),y&&y({type:"delete",depth:n,src:x,indexOrName:s,parentType:"array",parentPath:a})},[P,T]=l.useState(!1),E=()=>{const k=t;k.push(null),m&&m({indexOrName:k.length-1,depth:n,src:x,parentType:"array",parentPath:a}),y&&y({type:"add",indexOrName:k.length-1,depth:n,src:x,parentType:"array",parentPath:a}),D()},N=L||P,H=()=>{A(!1),T(!1)},Z=e.jsxs(e.Fragment,{children:[!C&&!N&&e.jsxs("span",Object.assign({onClick:()=>w(!0),className:"jv-size-chevron"},{children:[se(B,n,C)&&e.jsxs("span",Object.assign({className:"jv-size"},{children:[t.length," Items"]})),e.jsx(Re,{className:"jv-chevron"})]})),N&&e.jsx(Xe,{className:"json-view--edit",style:{display:"inline-block"},onClick:P?E:j}),N&&e.jsx(Ye,{className:"json-view--edit",style:{display:"inline-block"},onClick:H}),!C&&!N&&u&&ye(i)&&e.jsx(Ce,{node:t,nodeMeta:{depth:n,indexOrName:s,parent:o,parentPath:a,currentPath:c}}),!C&&!N&&Mt(h)&&It(i)&&e.jsx(_t,{className:"json-view--edit",onClick:()=>{E()}}),!C&&!N&&We(h)&&Ge(i)&&r&&e.jsx(Je,{className:"json-view--edit",onClick:()=>A(!0)}),typeof b=="function"?e.jsx(b,{node:t}):null]});return e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"["}),Z,C?e.jsx("button",Object.assign({onClick:()=>w(!1),className:"jv-button"},{children:"..."})):e.jsx("div",Object.assign({className:"jv-indent"},{children:p.map((k,F)=>e.jsx(os,{originNode:t,node:k,depth:n,index:F,startIndex:F*100,deleteHandle:r,customOptions:i,parentPath:a},String(s)+String(F)))})),e.jsx("span",{children:"]"}),C&&se(B,n,C)&&e.jsxs("span",Object.assign({onClick:()=>w(!1),className:"jv-size"},{children:[t.length," Items"]}))]})}function ds({node:t,depth:n,indexOrName:r,deleteHandle:s,customOptions:i,parent:o,parentPath:a}){const{collapsed:c,onCollapse:p,enableClipboard:d,ignoreLargeArray:u,collapseObjectsAfterLength:f,editable:h,onDelete:g,src:x,onAdd:m,onEdit:b,onChange:y,forceUpdate:D,displaySize:B,CustomOperation:C}=l.useContext(K),w=typeof r<"u"?[...a,String(r)]:a;if(!u&&Array.isArray(t)&&t.length>100)return e.jsx(cs,{node:t,depth:n,indexOrName:r,deleteHandle:s,customOptions:i,parentPath:w});const L=Y(t),[A,j]=l.useState(rt(t,n,r,c,f,i)),P=v=>{p==null||p({isCollapsing:!v,node:t,depth:n,indexOrName:r}),j(v)};l.useEffect(()=>{P(rt(t,n,r,c,f,i))},[c,f]);const T=l.useCallback((v,M,we)=>{Array.isArray(t)?t[+v]=M:t&&(t[v]=M),b&&b({newValue:M,oldValue:we,depth:n,src:x,indexOrName:v,parentType:L?"object":"array",parentPath:w}),y&&y({type:"edit",depth:n,src:x,indexOrName:v,parentType:L?"object":"array",parentPath:w}),D()},[t,b,y,D]),E=v=>{Array.isArray(t)?t.splice(+v,1):t&&delete t[v],D()},[N,H]=l.useState(!1),Z=()=>{H(!1),s&&s(r,w),g&&g({value:t,depth:n,src:x,indexOrName:r,parentType:L?"object":"array",parentPath:w}),y&&y({type:"delete",depth:n,src:x,indexOrName:r,parentType:L?"object":"array",parentPath:w})},[k,F]=l.useState(!1),O=l.useRef(null),z=()=>{var v;if(L){const M=(v=O.current)===null||v===void 0?void 0:v.value;M&&(t[M]=null,O.current&&(O.current.value=""),F(!1),m&&m({indexOrName:M,depth:n,src:x,parentType:"object",parentPath:w}),y&&y({type:"add",indexOrName:M,depth:n,src:x,parentType:"object",parentPath:w}))}else if(Array.isArray(t)){const M=t;M.push(null),m&&m({indexOrName:M.length-1,depth:n,src:x,parentType:"array",parentPath:w}),y&&y({type:"add",indexOrName:M.length-1,depth:n,src:x,parentType:"array",parentPath:w})}D()},V=v=>{v.key==="Enter"?(v.preventDefault(),z()):v.key==="Escape"&&$()},_=N||k,$=()=>{H(!1),F(!1)},X=e.jsxs(e.Fragment,{children:[!A&&!_&&e.jsxs("span",Object.assign({onClick:()=>P(!0),className:"jv-size-chevron"},{children:[se(B,n,A)&&e.jsxs("span",Object.assign({className:"jv-size"},{children:[le(t)," Items"]})),e.jsx(Re,{className:"jv-chevron"})]})),k&&L&&e.jsx("input",{className:"json-view--input",placeholder:"property",ref:O,onKeyDown:V}),_&&e.jsx(Xe,{className:"json-view--edit",style:{display:"inline-block"},onClick:k?z:Z}),_&&e.jsx(Ye,{className:"json-view--edit",style:{display:"inline-block"},onClick:$}),!A&&!_&&d&&ye(i)&&e.jsx(Ce,{node:t,nodeMeta:{depth:n,indexOrName:r,parent:o,parentPath:a,currentPath:w}}),!A&&!_&&Mt(h)&&It(i)&&e.jsx(_t,{className:"json-view--edit",onClick:()=>{L?(F(!0),setTimeout(()=>{var v;return(v=O.current)===null||v===void 0?void 0:v.focus()})):z()}}),!A&&!_&&We(h)&&Ge(i)&&s&&e.jsx(Je,{className:"json-view--edit",onClick:()=>H(!0)}),typeof C=="function"?e.jsx(C,{node:t}):null]});return Array.isArray(t)?e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"["}),X,A?e.jsx("button",Object.assign({onClick:()=>P(!1),className:"jv-button"},{children:"..."})):e.jsx("div",Object.assign({className:"jv-indent"},{children:t.map((v,M)=>e.jsx(Oe,{indexOrName:M,value:v,depth:n,parent:t,deleteHandle:E,editHandle:T,parentPath:w},String(r)+String(M)))})),e.jsx("span",{children:"]"}),A&&se(B,n,A)&&e.jsxs("span",Object.assign({onClick:()=>P(!1),className:"jv-size"},{children:[le(t)," Items"]}))]}):L?e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"{"}),X,A?e.jsx("button",Object.assign({onClick:()=>P(!1),className:"jv-button"},{children:"..."})):e.jsx("div",Object.assign({className:"jv-indent"},{children:Object.entries(t).map(([v,M])=>e.jsx(Oe,{indexOrName:v,value:M,depth:n,parent:t,deleteHandle:E,editHandle:T,parentPath:w},String(r)+String(v)))})),e.jsx("span",{children:"}"}),A&&se(B,n,A)&&e.jsxs("span",Object.assign({onClick:()=>P(!1),className:"jv-size"},{children:[le(t)," Items"]}))]}):e.jsx("span",{children:String(t)})}const ps=Pt.forwardRef(({str:t,className:n,ctrlClick:r},s)=>{let{collapseStringMode:i,collapseStringsAfterLength:o,customizeCollapseStringUI:a}=l.useContext(K);const[c,p]=l.useState(!0),d=l.useRef(null);o=o>0?o:0;const u=t.replace(/\s+/g," "),f=typeof a=="function"?a(u,c):typeof a=="string"?a:"...",h=g=>{var x;if((g.ctrlKey||g.metaKey)&&r)r(g);else{const m=window.getSelection();if(m&&m.anchorOffset!==m.focusOffset&&((x=m.anchorNode)===null||x===void 0?void 0:x.parentElement)===d.current)return;p(!c)}};if(t.length<=o)return e.jsxs("span",Object.assign({ref:d,className:n,onClick:r},{children:['"',t,'"']}));if(i==="address")return t.length<=10?e.jsxs("span",Object.assign({ref:d,className:n,onClick:r},{children:['"',t,'"']})):e.jsxs("span",Object.assign({ref:d,onClick:h,className:n+" cursor-pointer"},{children:['"',c?[u.slice(0,6),f,u.slice(-4)]:t,'"']}));if(i==="directly")return e.jsxs("span",Object.assign({ref:d,onClick:h,className:n+" cursor-pointer"},{children:['"',c?[u.slice(0,o),f]:t,'"']}));if(i==="word"){let g=o,x=o+1,m=u,b=1;for(;;){if(/\W/.test(t[g])){m=t.slice(0,g);break}if(/\W/.test(t[x])){m=t.slice(0,x);break}if(b===6){m=t.slice(0,o);break}b++,g--,x++}return e.jsxs("span",Object.assign({ref:d,onClick:h,className:n+" cursor-pointer"},{children:['"',c?[m,f]:t,'"']}))}return e.jsxs("span",Object.assign({ref:d,className:n},{children:['"',t,'"']}))});var vt;function Be(){return Be=Object.assign?Object.assign.bind():function(t){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},Be.apply(this,arguments)}var us=function(n){return l.createElement("svg",Be({xmlns:"http://www.w3.org/2000/svg",width:24,height:24,fill:"none",viewBox:"0 0 24 24"},n),vt||(vt=l.createElement("path",{fill:"currentColor",d:"M17.25 3H6.75A3.754 3.754 0 0 0 3 6.75v10.5A3.754 3.754 0 0 0 6.75 21h10.5A3.754 3.754 0 0 0 21 17.25V6.75A3.754 3.754 0 0 0 17.25 3Zm2.25 14.25c0 1.24-1.01 2.25-2.25 2.25H6.75c-1.24 0-2.25-1.01-2.25-2.25V6.75c0-1.24 1.01-2.25 2.25-2.25h10.5c1.24 0 2.25 1.01 2.25 2.25v10.5Zm-6.09-9.466-5.031 5.03a2.981 2.981 0 0 0-.879 2.121v1.19c0 .415.336.75.75.75h1.19c.8 0 1.554-.312 2.12-.879l5.03-5.03a2.252 2.252 0 0 0 0-3.182c-.85-.85-2.331-.85-3.18 0Zm-2.91 7.151c-.28.28-.666.44-1.06.44H9v-.44c0-.4.156-.777.44-1.06l3.187-3.188 1.06 1.061-3.187 3.188Zm5.03-5.03-.782.783-1.06-1.061.782-.782a.766.766 0 0 1 1.06 0 .75.75 0 0 1 0 1.06Z"})))},yt,Ct;function Ne(){return Ne=Object.assign?Object.assign.bind():function(t){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},Ne.apply(this,arguments)}var fs=function(n){return l.createElement("svg",Ne({xmlns:"http://www.w3.org/2000/svg",width:24,height:24,fill:"none",viewBox:"0 0 24 24"},n),yt||(yt=l.createElement("path",{fill:"currentColor",d:"M6.75 3h5.5v1.5h-5.5C5.51 4.5 4.5 5.51 4.5 6.75v10.5c0 1.24 1.01 2.25 2.25 2.25h10.5c1.24 0 2.25-1.01 2.25-2.25v-5.5H21v5.5A3.754 3.754 0 0 1 17.25 21H6.75A3.754 3.754 0 0 1 3 17.25V6.75A3.754 3.754 0 0 1 6.75 3Z"})),Ct||(Ct=l.createElement("path",{fill:"currentColor",d:"M20.013 3h-3.946a.987.987 0 0 0 0 1.973h1.564l-6.342 6.342a1.004 1.004 0 0 0 0 1.396 1.004 1.004 0 0 0 1.396 0l6.342-6.342v1.564a.987.987 0 0 0 1.973 0V3.987A.987.987 0 0 0 20.013 3Z"})))};function Bt({node:t,depth:n,deleteHandle:r,indexOrName:s,parent:i,editHandle:o,parentPath:a}){const{collapseStringsAfterLength:c,enableClipboard:p,editable:d,src:u,onDelete:f,onChange:h,customizeNode:g,matchesURL:x,urlRegExp:m,EditComponent:b,DoneComponent:y,CancelComponent:D,CustomOperation:B}=l.useContext(K);let C;if(typeof g=="function"&&(C=$e(g,[{node:t,depth:n,indexOrName:s}])),C){if(l.isValidElement(C))return C;if(ss(C)){const w=C;return e.jsx(w,{node:t,depth:n,indexOrName:s})}}if(Array.isArray(t)||Y(t))return e.jsx(ds,{parent:i,node:t,depth:n,indexOrName:s,deleteHandle:r,parentPath:a,customOptions:typeof C=="object"?C:void 0});{const w=typeof t,L=typeof s<"u"?[...a,String(s)]:a,[A,j]=l.useState(!1),[P,T]=l.useState(!1),E=l.useRef(null),N=()=>{j(!0),setTimeout(()=>{var v,M;(v=window.getSelection())===null||v===void 0||v.selectAllChildren(E.current),(M=E.current)===null||M===void 0||M.focus()})},H=l.useCallback(()=>{let v=E.current.innerText;try{const M=JSON.parse(v);o&&o(s,M,t,a)}catch{const we=as(w,v);o&&o(s,we,t,a)}j(!1)},[o,s,t,a,w]),Z=()=>{j(!1),T(!1)},k=()=>{T(!1),r&&r(s,a),f&&f({value:t,depth:n,src:u,indexOrName:s,parentType:Array.isArray(i)?"array":"object",parentPath:a}),h&&h({depth:n,src:u,indexOrName:s,parentType:Array.isArray(i)?"array":"object",type:"delete",parentPath:a})},F=l.useCallback(v=>{v.key==="Enter"?(v.preventDefault(),H()):v.key==="Escape"&&Z()},[H]),O=A||P,z=!O&&it(d)&&lt(C)&&o?v=>{(v.ctrlKey||v.metaKey)&&N()}:void 0,V=e.jsxs(e.Fragment,{children:[O&&(typeof y=="function"?e.jsx(y,{className:"json-view--edit",style:{display:"inline-block"},onClick:P?k:H}):e.jsx(Xe,{className:"json-view--edit",style:{display:"inline-block"},onClick:P?k:H})),O&&(typeof D=="function"?e.jsx(D,{className:"json-view--edit",style:{display:"inline-block"},onClick:Z}):e.jsx(Ye,{className:"json-view--edit",style:{display:"inline-block"},onClick:Z})),!O&&p&&ye(C)&&e.jsx(Ce,{node:t,nodeMeta:{depth:n,indexOrName:s,parent:i,parentPath:a,currentPath:L}}),!O&&x&&w==="string"&&m.test(t)&&rs(C)&&e.jsx("a",Object.assign({href:t,target:"_blank",className:"json-view--link"},{children:e.jsx(fs,{})})),!O&&it(d)&&lt(C)&&o&&(typeof b=="function"?e.jsx(b,{className:"json-view--edit",onClick:N}):e.jsx(us,{className:"json-view--edit",onClick:N})),!O&&We(d)&&Ge(C)&&r&&e.jsx(Je,{className:"json-view--edit",onClick:()=>T(!0)}),typeof B=="function"?e.jsx(B,{node:t}):null]});let _="json-view--string";switch(w){case"number":case"bigint":_="json-view--number";break;case"boolean":_="json-view--boolean";break;case"object":_="json-view--null";break}typeof(C==null?void 0:C.className)=="string"&&(_+=" "+C.className),P&&(_+=" json-view--deleting");let $=String(t);w==="bigint"&&($+="n");const X=l.useMemo(()=>e.jsx("span",{contentEditable:!0,className:_,dangerouslySetInnerHTML:{__html:w==="string"?`"${$}"`:$},ref:E,onKeyDown:F}),[$,w,F]);return w==="string"?e.jsxs(e.Fragment,{children:[A?X:t.length>c?e.jsx(ps,{str:t,ref:E,className:_,ctrlClick:z}):e.jsxs("span",Object.assign({className:_,onClick:z},{children:['"',$,'"']})),V]}):e.jsxs(e.Fragment,{children:[A?X:e.jsx("span",Object.assign({className:_,onClick:z},{children:$})),V]})}}const Nt=/^(((ht|f)tps?):\/\/)?([^!@#$%^&*?.\s-]([^!@#$%^&*?.\s]{0,63}[^!@#$%^&*?.\s])?\.)+[a-z]{2,6}\/?/,K=l.createContext({src:void 0,collapseStringsAfterLength:99,collapseStringMode:"directly",customizeCollapseStringUI:void 0,collapseObjectsAfterLength:20,collapsed:!1,onCollapse:void 0,enableClipboard:!0,editable:!1,onEdit:void 0,onDelete:void 0,onAdd:void 0,onChange:void 0,forceUpdate:()=>{},customizeNode:void 0,customizeCopy:()=>{},displaySize:void 0,displayArrayIndex:!0,matchesURL:!1,urlRegExp:Nt,ignoreLargeArray:!1,CopyComponent:void 0,CopiedComponent:void 0,EditComponent:void 0,CancelComponent:void 0,DoneComponent:void 0,CustomOperation:void 0});function xs({src:t,collapseStringsAfterLength:n=99,collapseStringMode:r="directly",customizeCollapseStringUI:s,collapseObjectsAfterLength:i=99,collapsed:o,onCollapse:a,enableClipboard:c=!0,editable:p=!1,onEdit:d,onDelete:u,onAdd:f,onChange:h,dark:g=!1,theme:x="default",customizeNode:m,customizeCopy:b=Z=>ts(Z),displaySize:y,displayArrayIndex:D=!0,style:B,className:C,matchesURL:w=!1,urlRegExp:L=Nt,ignoreLargeArray:A=!1,CopyComponent:j,CopiedComponent:P,EditComponent:T,CancelComponent:E,DoneComponent:N,CustomOperation:H}){const[Z,k]=l.useState(0),F=l.useCallback(()=>k(V=>++V),[]),[O,z]=l.useState(t);return l.useEffect(()=>z(t),[t]),e.jsx(K.Provider,Object.assign({value:{src:O,collapseStringsAfterLength:n,collapseStringMode:r,customizeCollapseStringUI:s,collapseObjectsAfterLength:i,collapsed:o,onCollapse:a,enableClipboard:c,editable:p,onEdit:d,onDelete:u,onAdd:f,onChange:h,forceUpdate:F,customizeNode:m,customizeCopy:b,displaySize:y,displayArrayIndex:D,matchesURL:w,urlRegExp:L,ignoreLargeArray:A,CopyComponent:j,CopiedComponent:P,EditComponent:T,CancelComponent:E,DoneComponent:N,CustomOperation:H}},{children:e.jsx("code",Object.assign({className:"json-view"+(g?" dark":"")+(x&&x!=="default"?" json-view_"+x:"")+(C?" "+C:""),style:B},{children:e.jsx(Bt,{node:O,depth:1,editHandle:(V,_,$,X)=>{z(_),d&&d({newValue:_,oldValue:$,depth:1,src:O,indexOrName:V,parentType:null,parentPath:X}),h&&h({type:"edit",depth:1,src:O,indexOrName:V,parentType:null,parentPath:X})},deleteHandle:(V,_)=>{z(void 0),u&&u({value:O,depth:1,src:O,indexOrName:V,parentType:null,parentPath:_}),h&&h({depth:1,src:O,indexOrName:V,parentType:null,type:"delete",parentPath:_})},parentPath:[]})}))}))}const hs=l.memo(({queryResults:t})=>e.jsx(xs,{src:t,collapsed:1,displaySize:!0,displayArrayIndex:!0,editable:!1,enableClipboard:!1})),gs=({queryKey:t,queryResults:n})=>{const{getQueryKey:r}=ne(),{downloadCsv:s,downloadJson:i,downloadXml:o}=Wn(r(t),n),[a,c]=l.useState("table"),[p,d]=l.useState(!1),u=()=>{var h,g,x,m,b,y,D;return((h=n==null?void 0:n.status)==null?void 0:h.last_error)!==""?"ERROR: "+n.status.last_error:(((g=n==null?void 0:n.status)==null?void 0:g.rows_affected)??0)>0?((x=n==null?void 0:n.status)==null?void 0:x.rows_affected)+" rows affected":((m=n==null?void 0:n.status)==null?void 0:m.num_rows)+(((b=n==null?void 0:n.status)==null?void 0:b.num_rows)===1?" row":" rows")+" ("+((D=n==null?void 0:n.status)==null?void 0:D.queries[((y=n==null?void 0:n.status)==null?void 0:y.num_queries)-1][1].toFixed(5))+" sec)"},f=h=>e.jsxs(S,{sx:{display:"flex",flexDirection:"row",justifyContent:"center",alignItems:"center",fontSize:"11px",position:"absolute",top:h,left:0,right:0},children:[e.jsx(G,{size:"small",color:"primary",disableRipple:!0,onClick:()=>{d(!p)},children:e.jsx(Xt,{})}),e.jsx(S,{sx:{display:"inline-block",cursor:"pointer"},onClick:()=>{d(!p)},children:"full-screen"})]});return Object.keys(n).length===0?null:e.jsxs(Ze,{value:a,children:[e.jsxs(S,{sx:{marginBottom:"2px",display:"grid",gridTemplateColumns:"1fr 1fr 1fr",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs(Ve,{onChange:(h,g)=>{d(!1),c(g)},children:[e.jsx(pe,{label:"Query Result",value:"table"}),e.jsx(pe,{label:"Server Response",value:"response"})]}),e.jsxs(S,{sx:{display:"flex",flexDirection:"row",justifyContent:"center",alignItems:"center",fontSize:"11px"},children:[e.jsx(G,{size:"small",color:"primary",disableRipple:!0,onClick:()=>{d(!p)},children:e.jsx(Jt,{})}),e.jsx(S,{sx:{display:"inline-block",cursor:"pointer"},onClick:()=>{d(!p)},children:"full-screen"})]}),e.jsxs(S,{sx:{display:"flex",flexDirection:"row",justifyContent:"end",alignItems:"center"},children:[e.jsx(W,{title:"Export to CSV",children:e.jsx(G,{onClick:()=>{s()},children:e.jsx(pn,{})})}),e.jsx(W,{title:"Export to JSON",children:e.jsx(G,{onClick:()=>{i()},children:e.jsx(un,{})})}),e.jsx(W,{title:"Export to XML",children:e.jsx(G,{onClick:()=>{o()},children:e.jsx(fn,{})})})]})]}),e.jsx(de,{value:"table",keepMounted:!0,sx:{padding:0},children:e.jsxs(Se,{sx:{marginTop:"5px",padding:0,backgroundColor:"#ccc",display:"grid",gridTemplateRows:"1fr auto",borderRadius:"4px","&:hover":{boxShadow:"rgba(0, 0, 0, 1) 0px 0px 0px 1px, rgba(0, 0, 0, 1) 0px 0px 0px, rgba(0, 0, 0, 1) 0px 1px 1px"},...a==="table"&&p&&{width:"calc(100vw - 100px)",height:"calc(100vh - 100px)",position:"fixed",top:"49px",left:"49px","& table.pp-sql-query-builder-table tbody":{height:"calc(100vh - 160px)"}}},children:[p&&f("-40px"),e.jsx(Gn,{queryResults:n}),e.jsx(S,{sx:{display:"flex",alignItems:"center",height:"30px",paddingLeft:"5px",backgroundColor:"#eee",borderBottomLeftRadius:"4px",borderBottomRightRadius:"4px"},children:u()})]})}),e.jsx(de,{value:"response",keepMounted:!0,sx:{padding:0},children:e.jsxs(Se,{sx:{marginTop:"5px",padding:"30px",height:"240px","&:hover":{boxShadow:"rgba(0, 0, 0, 1) 0px 0px 0px 1px, rgba(0, 0, 0, 1) 0px 0px 0px, rgba(0, 0, 0, 1) 0px 1px 1px"},...a==="response"&&p&&{width:"calc(100vw - 200px)",height:"calc(100vh - 200px)",padding:"50px",position:"fixed",top:"50px",left:"50px",margin:0}},children:[p&&f("10px"),e.jsx(S,{sx:{height:"240px",overflow:"auto",...a==="response"&&p&&{height:"calc(100vh - 210px)"}},children:e.jsx(hs,{queryResults:n})})]})})]})},ms=({queries:t,queryKey:n,databases:r})=>{const[s,i]=l.useState({});return e.jsxs(de,{value:n,keepMounted:!0,sx:{padding:"5px 0"},children:[e.jsx($n,{queries:t,queryKey:n,databases:r,setQueryResults:o=>{i(o)}}),e.jsx(Hn,{queryKey:n,query:t[n]}),e.jsx(gs,{queryKey:n,queryResults:s})]})},js=({queryBuilderState:t})=>{const n=J(),{getQueryKey:r}=ne();return l.useEffect(()=>{Dt(void 0,s=>{I.debug(s),(s==null?void 0:s.code)==="ok"&&(s==null?void 0:s.message)=="1"&&n(Tt({showSqlHints:!0}))},s=>{console.info(s)})},[]),e.jsx(S,{children:e.jsxs(Ze,{value:t.tabIndex,children:[e.jsxs(S,{sx:{display:"grid",gridTemplateColumns:"auto 1fr",alignItems:"center"},children:[e.jsx(Pn,{}),e.jsxs(Ve,{orientation:"horizontal",variant:"scrollable",scrollButtons:!0,allowScrollButtonsMobile:!0,onChange:(s,i)=>{n(Fe({tabIndex:i}))},sx:{"& .MuiButtonBase-root.Mui-disabled":{opacity:1}},children:[...Object.keys(t.queries).map(s=>e.jsx(pe,{label:e.jsxs(S,{sx:{display:"flex",flexDirection:"row",alignItems:"center",alignSelf:"start",gap:"5px","& svg":{height:"1.2em",width:"1.2em"}},children:[t.queries[s].access===Q.GLOBAL?e.jsx(Qe,{}):e.jsx(Pe,{}),e.jsx(S,{sx:{textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden",maxWidth:"300px",textTransform:"none",fontWeight:"bold"},children:r(s)})]}),value:s}))]})]}),...Object.keys(t.queries).map(s=>e.jsx(ms,{queries:t.queries,queryKey:s,databases:t.databases},s)),Object.keys(t.queries).length===0&&e.jsxs(Se,{sx:{padding:"50px"},children:[e.jsxs(S,{sx:{display:"flex",alignItems:"center",gap:"5px"},children:[e.jsx(Yt,{}),e.jsx("span",{children:"Open"}),e.jsx(Lt,{}),e.jsx("strong",{children:"Queries"})," menu"]}),e.jsxs(S,{sx:{margin:"20px 0 0 20px",display:"flex",flexDirection:"column",gap:"5px"},children:[e.jsxs(S,{sx:{display:"flex",alignItems:"center",gap:"5px"},children:[e.jsx(St,{})," ",e.jsx("strong",{children:"New"})," to create new query"]}),e.jsxs(S,{sx:{display:"flex",alignItems:"center",gap:"5px"},children:[e.jsx(At,{})," ",e.jsx("strong",{children:"Open"})," to edit existing query"]})]})]})]})})},bs=()=>{const t=J(),[n,r]=l.useState(!1),[s,i]=l.useState(!1),[o,a]=l.useState({databases:[],defaultDatabase:"",wpDatabase:""});return I.debug("databases",o),l.useEffect(()=>{En(c=>{const p=c==null?void 0:c.data;I.debug("response data",p);const d=[];p.map(h=>{d.push({dbs:h.dbs,dbsType:h.dbs_type,pdsDbs:h.pds})}),d.sort((h,g)=>{var x,m,b,y;return((x=h==null?void 0:h.dbs)==null?void 0:x.toLocaleLowerCase())>((m=g==null?void 0:g.dbs)==null?void 0:m.toLocaleLowerCase())?1:((b=g==null?void 0:g.dbs)==null?void 0:b.toLocaleLowerCase())>((y=h==null?void 0:h.dbs)==null?void 0:y.toLocaleLowerCase())?-1:0}),I.debug(d);const u=d.filter(h=>h.dbsType===Ln.WP),f=u.length===1?u[0].dbs:"";a({databases:d,defaultDatabase:f,wpDatabase:f}),t(an({databases:{databases:d,defaultDatabase:f,wpDatabase:f}})),r(!0)},c=>{I.error("error",c),i(!0)})},[]),{isLoaded:n,hasErrors:s,databases:o}},vs=l.lazy(()=>wt(()=>import("./Alert-1.0.40-Bz3Zj62D.js"),__vite__mapDeps([21,1,2,3,22,5,6,7,8,9,10,11,23,24,25]),import.meta.url)),Sr=()=>{const t=fe(),{isLoaded:n,hasErrors:r}=bs(),s=jn();return n?r||n&&t.databases.databases.length===0?e.jsx(l.Suspense,{children:e.jsx(vs,{severity:"error",message:"Error loading databases",close:!0})}):e.jsx(tt,{theme:s,children:e.jsx(S,{children:e.jsx(js,{queryBuilderState:t})})}):e.jsx(tt,{theme:s,children:e.jsx(Ue,{title:"Loading databases..."})})};export{Sr as default};
