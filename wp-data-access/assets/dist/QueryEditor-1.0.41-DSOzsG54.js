const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./CodeField-1.0.41-CvaujvYv.js","./cm-1.0.41-DxZ4itL_.js","./redux-1.0.41-DJjpZqD1.js","./vendor-1.0.41-CN03Eozo.js","./index-1.0.41-CpXj521P.js","./iconBase-1.0.41-BNQFQdHp.js","./Typography-1.0.41-BIN1Ddvh.js","./lib-1.0.41-DFdWuh_n.js","./loglevel-1.0.41-BZ7XahX3.js","./lodash-1.0.41-Cd8grAqB.js","./moment-1.0.41-C5S46NFB.js","./useEnhancedEffect-1.0.41-BVsyj6AW.js","./notistack-1.0.41-Bq-EKqc7.js","./ConfirmDialog-1.0.41-NKESMhfW.js","./AdminTheme-1.0.41-4tiUoVeb.js","./Spinner-1.0.41-fWZy8imI.js","./FormControlLabel-1.0.41-OBCouq3I.js","./useFormControl-1.0.41-1E9QEnRo.js","./Switch-1.0.41-BrkxB2Jy.js","./SwitchBase-1.0.41-C_lqznV-.js","./useControlled-1.0.41-BEhJe3xs.js"])))=>i.map(i=>d[i]);
import{_ as Q}from"./main-1.0.41.js";import{j as n}from"./cm-1.0.41-DxZ4itL_.js";import{r as m}from"./redux-1.0.41-DJjpZqD1.js";import{l as p,c9 as N,n as h,c7 as a,c8 as v}from"./lib-1.0.41-DFdWuh_n.js";import{a as x}from"./hooks-1.0.41-sDnKeMy7.js";import{f as H,u as _,a as b}from"./QueryBuilder-1.0.41-hvN5SRs8.js";import{u as q}from"./MainQueryBuilder-1.0.41-M8KmYGqb.js";import{e as u}from"./notistack-1.0.41-Bq-EKqc7.js";import{B as E}from"./Spinner-1.0.41-fWZy8imI.js";import"./vendor-1.0.41-CN03Eozo.js";import"./loglevel-1.0.41-BZ7XahX3.js";import"./lodash-1.0.41-Cd8grAqB.js";import"./moment-1.0.41-C5S46NFB.js";import"./index-1.0.41-CpXj521P.js";import"./iconBase-1.0.41-BNQFQdHp.js";import"./Typography-1.0.41-BIN1Ddvh.js";import"./useEnhancedEffect-1.0.41-BVsyj6AW.js";import"./ConfirmDialog-1.0.41-NKESMhfW.js";import"./AdminTheme-1.0.41-4tiUoVeb.js";import"./RestApi-1.0.41-CZ_yORv3.js";import"./index-1.0.41-Wbyk3QBm.js";import"./index-1.0.41-Ca6zW1RM.js";import"./index-1.0.41-DGYaemnA.js";import"./SanitizeComponent-1.0.41-B18z6eJi.js";import"./dompurify-1.0.41-DhD2mIk-.js";import"./FormHelperText-1.0.41-BPSj83yP.js";import"./utils-1.0.41-iop7lDec.js";import"./useFormControl-1.0.41-1E9QEnRo.js";import"./FormControlLabel-1.0.41-OBCouq3I.js";import"./Checkbox-1.0.41-C_619ZQC.js";import"./SwitchBase-1.0.41-C_lqznV-.js";import"./useControlled-1.0.41-BEhJe3xs.js";import"./createSvgIcon-1.0.41-0lRWzB2Q.js";import"./Tooltip-1.0.41-g4uuOuci.js";import"./ThemeProvider-1.0.41-D1lNQgXT.js";import"./Popper-1.0.41-Dl4_0sfD.js";import"./Menu-1.0.41-DBfdBNVU.js";import"./Divider-1.0.41-CupjOoMR.js";import"./MenuItem-1.0.41-DCc8qvzQ.js";import"./TextField-1.0.41-CGPjmVeQ.js";import"./Select-1.0.41-aTzlc-HZ.js";import"./FormLabel-1.0.41-CgxisugM.js";import"./InputAdornment-1.0.41-BaGp3m3T.js";import"./TabPanel-1.0.41-BJuUpIHA.js";import"./useThemeProps-1.0.41-BJkkrkB6.js";import"./getThemeProps-1.0.41-BXG_2HDV.js";import"./TabList-1.0.41-WNj_9XSz.js";import"./Tabs-1.0.41-C8-7orxg.js";import"./Switch-1.0.41-BrkxB2Jy.js";/* empty css                    */import"./ActionsExplorer-1.0.41-DSAyrNr3.js";import"./DatabaseTypeEnum-1.0.41-DeJfpW1u.js";const I=()=>{const r=x(),s=q();return o=>{const e=s.queries[s.tabIndex];s.sqlSchemas[e==null?void 0:e.schemaName]===void 0&&H(o,i=>{p.debug(i),(i==null?void 0:i.code)==="ok"&&r(N({sqlSchemaName:o,sqlSchema:i==null?void 0:i.data}))},i=>{p.error(i)})}},j=m.lazy(()=>Q(()=>import("./CodeField-1.0.41-CvaujvYv.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20]),import.meta.url)),Ie=({queryKey:r,query:s,fullScreen:l})=>{const o=x(),e=q(),i=I(),{getQueryKey:S}=_(),[f,d]=m.useState(h(s.query)),c=m.useRef();c.current=f,m.useEffect(()=>{e.showSqlHints&&i(e.queries[r].schemaName)},[e.showSqlHints,e.queries[r].schemaName]),m.useEffect(()=>{e.copyQuery&&(d(e.copyQuery),o(a({queryKey:r,query:{access:s.access,queryName:s.queryName,query:e.copyQuery,schemaName:s.schemaName,isVisual:s.isVisual,isInserting:s.isInserting,params:s.params}})),o(v({copyQuery:void 0})))},[e.copyQuery]);const g=()=>{c.current?b(e.queries[r].access,e.queries[r].schemaName,e.queries[r].queryName,h(c.current),!1,"",e.queries[r].isInserting,e.queries[r].params,t=>{p.debug(t),(t==null?void 0:t.code)==="ok"&&(o(a({queryKey:r,query:{...e.queries[r],isInserting:void 0},isUpdated:!1})),u("Query succesfully saved",{variant:"success"}))},t=>{p.error(t),u(t,{variant:"error"})}):u("Invalid code reference",{variant:"error"})};return n.jsx(E,{className:"pp-sql-query-builder-editor",children:n.jsx(m.Suspense,{children:n.jsx(j,{code:f,setCode:t=>{d(t),o(a({queryKey:r,query:{...s,query:t}}))},dialogTitle:S(r),extension:"sql",sqlSchema:e.showSqlHints?e.sqlSchemas[e.queries[r].schemaName]:void 0,initialHeight:l?"calc(((100vh - 69px - 48px - 69px - 48px - 5px) / 2) - 28px - 5px)":"270px",saveCode:g})})})};export{Ie as default};
