const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./Alert-1.0.41-DzeUA8Nx.js","./cm-1.0.41-DxZ4itL_.js","./redux-1.0.41-DJjpZqD1.js","./vendor-1.0.41-CN03Eozo.js","./index-1.0.41-DGYaemnA.js","./iconBase-1.0.41-BNQFQdHp.js","./Typography-1.0.41-BIN1Ddvh.js","./lib-1.0.41-DFdWuh_n.js","./loglevel-1.0.41-BZ7XahX3.js","./lodash-1.0.41-Cd8grAqB.js","./moment-1.0.41-C5S46NFB.js","./useEnhancedEffect-1.0.41-BVsyj6AW.js","./AlertTitle-1.0.41-DjDM8Ttb.js","./createSvgIcon-1.0.41-0lRWzB2Q.js","./Close-1.0.41-Dkp5SdDZ.js"])))=>i.map(i=>d[i]);
import{_ as Y}from"./main-1.0.41.js";import{z as he,j as e,_ as D}from"./cm-1.0.41-DxZ4itL_.js";import{r as o}from"./redux-1.0.41-DJjpZqD1.js";import{a as ts,b as ss,c as ns,d as as,e as rs,f as os,g as is,h as ls,l as cs}from"./ActionsExplorer-1.0.41-DSAyrNr3.js";import{a as $,u as be}from"./hooks-1.0.41-sDnKeMy7.js";import{l as u,b as q,au as ds,av as ps,aw as us,ax as xs,ay as ms,az as gs,aA as we,k as se,aB as hs,aC as fs,aD as js,aE as ys,aF as ke,aG as ve,aH as xt,aI as mt,aJ as gt,aK as ht,aL as bs,aM as Ts,C as Cs,af as Ss,aN as Is,aO as ws,aP as ks}from"./lib-1.0.41-DFdWuh_n.js";import{B as d,S as vs}from"./Spinner-1.0.41-fWZy8imI.js";import{c as ft,j as We,l as Es,n as jt,o as Ee,f as Ps,T as De}from"./Typography-1.0.41-BIN1Ddvh.js";import{u as ce,M as de,B as at}from"./index.esm-1.0.41-Ko2zZhVm.js";import{T as X,u as $e,a as _s,b as Ls,c as Ms}from"./ActionsAdmin-1.0.41-X0ZI6JG8.js";import{g as yt,h as bt,i as Tt,e as As}from"./index-1.0.41-DGYaemnA.js";import{O as Pe,P as Ds,Q as Os,e as zs,m as Rs,R as Bs,n as Fs,A as He,T as Ge,S as Ks,U as Vs,V as Ct,W as St,M as Ns,X as Ws,Y as $s,x as rt,Z as Hs,t as Gs,u as qs,v as Qs,i as Us}from"./index-1.0.41-CpXj521P.js";import{b as Ys,c as Js}from"./index-1.0.41-bmWVeOdZ.js";import{u as It,h as Ke,a as Ve,T as Xs,b as Zs,c as en,d as tn,e as sn,f as nn,g as an,i as rn,j as on,k as ot,t as U,S as ln}from"./TreeItem2Provider-1.0.41-CvRVbaxa.js";import{C as J}from"./Checkbox-1.0.41-C_619ZQC.js";import{a as it,e as lt,r as ae,I as le,P as ct}from"./iconBase-1.0.41-BNQFQdHp.js";import{C as cn}from"./Collapse-1.0.41-QlMDtjRk.js";import{E as _e}from"./ExplorerActionEnum-1.0.41-eclZgKpy.js";import{A as te}from"./AdminTheme-1.0.41-4tiUoVeb.js";import{u as dn}from"./index-1.0.41-zQwWCc96.js";import{T as fe}from"./Tooltip-1.0.41-g4uuOuci.js";import{L as re}from"./Link-1.0.41-yhMF_PSg.js";import{D as O}from"./DatabaseTypeEnum-1.0.41-DeJfpW1u.js";import{u as Oe}from"./useExplorer-1.0.41-BZDb32GS.js";import{C as pn,a as un}from"./CardContent-1.0.41-Cwtu331C.js";import{C as xn}from"./CardHeader-1.0.41-DfJVb3rg.js";import{F as oe}from"./FormHelperText-1.0.41-BPSj83yP.js";import{F as Le}from"./FormLabel-1.0.41-CgxisugM.js";import{C as mn}from"./CardActions-1.0.41-CXPPUffK.js";import{B as Me,C as wt}from"./ConfirmDialog-1.0.41-NKESMhfW.js";import{T as kt,I as gn}from"./TextField-1.0.41-CGPjmVeQ.js";import{I as dt}from"./InputAdornment-1.0.41-BaGp3m3T.js";import{A as Ne}from"./AlertDialog-1.0.41-BPsbbiwH.js";import{S as vt}from"./Select-1.0.41-aTzlc-HZ.js";import{M as je}from"./MenuItem-1.0.41-DCc8qvzQ.js";import{T as Et,b as Ae,c as H,a as Pt}from"./TableRow-1.0.41-CTJevnEe.js";import{T as _t}from"./TableHead-1.0.41-R3d_gFkF.js";import{T as hn}from"./Tooltip-1.0.41-BQBkdKQ5.js";import{e as pt}from"./notistack-1.0.41-Bq-EKqc7.js";/* empty css                    */import"./vendor-1.0.41-CN03Eozo.js";import"./loglevel-1.0.41-BZ7XahX3.js";import"./lodash-1.0.41-Cd8grAqB.js";import"./moment-1.0.41-C5S46NFB.js";import"./RestApi-1.0.41-CZ_yORv3.js";import"./createSvgIcon-1.0.41-0lRWzB2Q.js";import"./Stack-1.0.41-g2eT-h-q.js";import"./useThemeProps-1.0.41-BJkkrkB6.js";import"./getThemeProps-1.0.41-BXG_2HDV.js";import"./Radio-1.0.41-S-npPzGQ.js";import"./SwitchBase-1.0.41-C_lqznV-.js";import"./useFormControl-1.0.41-1E9QEnRo.js";import"./useControlled-1.0.41-BEhJe3xs.js";import"./Menu-1.0.41-DBfdBNVU.js";import"./ThemeProvider-1.0.41-D1lNQgXT.js";import"./useEnhancedEffect-1.0.41-BVsyj6AW.js";import"./Chip-1.0.41-C0GI7jZZ.js";import"./AlertTitle-1.0.41-DjDM8Ttb.js";import"./Close-1.0.41-Dkp5SdDZ.js";import"./ListItemIcon-1.0.41-D1zPE5kJ.js";import"./Divider-1.0.41-CupjOoMR.js";import"./FormControlLabel-1.0.41-OBCouq3I.js";import"./Switch-1.0.41-BrkxB2Jy.js";import"./Autocomplete-1.0.41-82-5yXGC.js";import"./Popper-1.0.41-Dl4_0sfD.js";import"./Slider-1.0.41-eJAQRlhH.js";import"./visuallyHidden-1.0.41-Dan1xhjv.js";import"./TimePicker-1.0.41-CdMSQWSE.js";import"./useMobilePicker-1.0.41-Bl-98x2q.js";import"./index-1.0.41-Ca6zW1RM.js";import"./ListItem-1.0.41-CMjqURej.js";import"./timeViewRenderers-1.0.41-3MJVY4qK.js";import"./DateTimePicker-1.0.41-FGXdJ7he.js";import"./Tabs-1.0.41-C8-7orxg.js";import"./dateViewRenderers-1.0.41-Dd4MHWu8.js";import"./DatePicker-1.0.41-BRrjz6z9.js";import"./utils-1.0.41-iop7lDec.js";function Lt(t){const{instance:s,items:{onItemClick:n},selection:{multiSelect:a,checkboxSelection:i,disableSelection:c},expansion:{expansionTrigger:j}}=It(),b=s.isItemExpandable(t),T=s.isItemExpanded(t),p=s.isItemFocused(t),f=s.isItemSelected(t),l=s.isItemDisabled(t),m=s!=null&&s.isItemBeingEdited?s==null?void 0:s.isItemBeingEdited(t):!1,z=s.isItemEditable?s.isItemEditable(t):!1,R=g=>{if(!l){p||s.focusItem(g,t);const S=a&&(g.shiftKey||g.ctrlKey||g.metaKey);b&&!(S&&s.isItemExpanded(t))&&s.toggleItemExpansion(g,t)}},I=g=>{l||(p||s.focusItem(g,t),a&&(g.shiftKey||g.ctrlKey||g.metaKey)?g.shiftKey?s.expandSelectionRange(g,t):s.selectItem({event:g,itemId:t,keepExistingSelection:!0}):s.selectItem({event:g,itemId:t,shouldBeSelected:!0}))},C=g=>{if(c||l)return;const S=g.nativeEvent.shiftKey;a&&S?s.expandSelectionRange(g,t):s.selectItem({event:g,itemId:t,keepExistingSelection:a,shouldBeSelected:g.target.checked})},B=g=>{(g.shiftKey||g.ctrlKey||g.metaKey||l)&&g.preventDefault()},M=()=>{Ke(s,Ve)&&s.isItemEditable(t)&&(s.isItemBeingEdited(t)?s.setEditedItemId(null):s.setEditedItemId(t))};return{disabled:l,expanded:T,selected:f,focused:p,editable:z,editing:m,disableSelection:c,checkboxSelection:i,handleExpansion:R,handleSelection:I,handleCheckboxSelection:C,handleContentClick:n,preventSelection:B,expansionTrigger:j,toggleItemEditing:M,handleSaveItemLabel:(g,S)=>{Ke(s,Ve)&&s.isItemBeingEditedRef(t)&&(s.updateItemLabel(t,S),M(),s.focusItem(g,t))},handleCancelItemLabelEditing:g=>{Ke(s,Ve)&&s.isItemBeingEditedRef(t)&&(M(),s.focusItem(g,t))}}}const fn=["classes","className","displayIcon","expansionIcon","icon","label","itemId","onClick","onMouseDown","dragAndDropOverlayProps","labelInputProps"],Mt=o.forwardRef(function(s,n){const{classes:a,className:i,displayIcon:c,expansionIcon:j,icon:b,label:T,itemId:p,onClick:f,onMouseDown:l,dragAndDropOverlayProps:m,labelInputProps:z}=s,R=he(s,fn),{disabled:I,expanded:C,selected:B,focused:M,editing:E,editable:A,disableSelection:g,checkboxSelection:S,handleExpansion:F,handleSelection:y,handleCheckboxSelection:_,handleContentClick:k,preventSelection:L,expansionTrigger:r,toggleItemEditing:x}=Lt(p),h=b||j||c,P=o.useRef(null),v=V=>{L(V),l&&l(V)},K=V=>{var ee;k==null||k(V,p),!((ee=P.current)!=null&&ee.contains(V.target))&&(r==="content"&&F(V),S||y(V),f&&f(V))},Q=V=>{V.defaultMuiPrevented||x()};return e.jsxs("div",D({},R,{className:ft(a.root,i,C&&a.expanded,B&&a.selected,M&&a.focused,I&&a.disabled,E&&a.editing,A&&a.editable),onClick:K,onMouseDown:v,ref:n,children:[e.jsx("div",{className:a.iconContainer,children:h}),S&&e.jsx(J,{className:a.checkbox,checked:B,onChange:_,disabled:I||g,ref:P,tabIndex:-1}),E?e.jsx(Xs,D({},z,{className:a.labelInput})):e.jsx("div",D({className:a.label},A&&{onDoubleClick:Q},{children:T})),m&&e.jsx(Zs,D({},m))]}))}),jn=["children","className","slots","slotProps","ContentComponent","ContentProps","itemId","id","label","onClick","onMouseDown","onFocus","onBlur","onKeyDown"],yn=["ownerState"],bn=["ownerState"],Tn=["ownerState"],Cn=tn(),Sn=t=>{const{classes:s}=t;return Es({root:["root"],content:["content"],expanded:["expanded"],selected:["selected"],focused:["focused"],disabled:["disabled"],iconContainer:["iconContainer"],checkbox:["checkbox"],label:["label"],labelInput:["labelInput"],editing:["editing"],editable:["editable"],groupTransition:["groupTransition"]},on,s)},In=We("li",{name:"MuiTreeItem",slot:"Root",overridesResolver:(t,s)=>s.root})({listStyle:"none",margin:0,padding:0,outline:0}),wn=We(Mt,{name:"MuiTreeItem",slot:"Content",overridesResolver:(t,s)=>[s.content,s.iconContainer&&{[`& .${U.iconContainer}`]:s.iconContainer},s.label&&{[`& .${U.label}`]:s.label}],shouldForwardProp:t=>jt(t)&&t!=="indentationAtItemLevel"})(({theme:t})=>({padding:t.spacing(.5,1),borderRadius:t.shape.borderRadius,width:"100%",boxSizing:"border-box",position:"relative",display:"flex",alignItems:"center",gap:t.spacing(1),cursor:"pointer",WebkitTapHighlightColor:"transparent","&:hover":{backgroundColor:(t.vars||t).palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${U.disabled}`]:{opacity:(t.vars||t).palette.action.disabledOpacity,backgroundColor:"transparent"},[`&.${U.focused}`]:{backgroundColor:(t.vars||t).palette.action.focus},[`&.${U.selected}`]:{backgroundColor:t.vars?`rgba(${t.vars.palette.primary.mainChannel} / ${t.vars.palette.action.selectedOpacity})`:Ee(t.palette.primary.main,t.palette.action.selectedOpacity),"&:hover":{backgroundColor:t.vars?`rgba(${t.vars.palette.primary.mainChannel} / calc(${t.vars.palette.action.selectedOpacity} + ${t.vars.palette.action.hoverOpacity}))`:Ee(t.palette.primary.main,t.palette.action.selectedOpacity+t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:t.vars?`rgba(${t.vars.palette.primary.mainChannel} / ${t.vars.palette.action.selectedOpacity})`:Ee(t.palette.primary.main,t.palette.action.selectedOpacity)}},[`&.${U.focused}`]:{backgroundColor:t.vars?`rgba(${t.vars.palette.primary.mainChannel} / calc(${t.vars.palette.action.selectedOpacity} + ${t.vars.palette.action.focusOpacity}))`:Ee(t.palette.primary.main,t.palette.action.selectedOpacity+t.palette.action.focusOpacity)}},[`& .${U.iconContainer}`]:{width:16,display:"flex",flexShrink:0,justifyContent:"center","& svg":{fontSize:18}},[`& .${U.label}`]:D({width:"100%",boxSizing:"border-box",minWidth:0,position:"relative"},t.typography.body1),[`& .${U.checkbox}`]:{padding:0},variants:[{props:{indentationAtItemLevel:!0},style:{paddingLeft:`calc(${t.spacing(1)} + var(--TreeView-itemChildrenIndentation) * var(--TreeView-itemDepth))`}}]})),kn=We(cn,{name:"MuiTreeItem",slot:"GroupTransition",overridesResolver:(t,s)=>s.groupTransition,shouldForwardProp:t=>jt(t)&&t!=="indentationAtItemLevel"})({margin:0,padding:0,paddingLeft:"var(--TreeView-itemChildrenIndentation)",variants:[{props:{indentationAtItemLevel:!0},style:{paddingLeft:0}}]}),G=o.forwardRef(function(s,n){var Xe,Ze,et,tt;const{icons:a,runItemPlugins:i,items:{disabledItemsFocusable:c,indentationAtItemLevel:j},selection:{disableSelection:b},expansion:{expansionTrigger:T},treeId:p,instance:f}=It(),l=o.useContext(en),m=Cn({props:s,name:"MuiTreeItem"}),{children:z,className:R,slots:I,slotProps:C,ContentComponent:B=Mt,ContentProps:M,itemId:E,id:A,label:g,onClick:S,onMouseDown:F,onBlur:y,onKeyDown:_}=m,k=he(m,jn),{expanded:L,focused:r,selected:x,disabled:h,editing:P,handleExpansion:v,handleCancelItemLabelEditing:K,handleSaveItemLabel:Q}=Lt(E),{contentRef:V,rootRef:ee,propsEnhancers:N}=i(m),Te=o.useRef(null),qe=o.useRef(null),Ot=it(n,ee,Te),zt=it(M==null?void 0:M.ref,V,qe),xe={expandIcon:(I==null?void 0:I.expandIcon)??a.slots.expandIcon??nn,collapseIcon:(I==null?void 0:I.collapseIcon)??a.slots.collapseIcon??sn,endIcon:(I==null?void 0:I.endIcon)??a.slots.endIcon,icon:I==null?void 0:I.icon,groupTransition:I==null?void 0:I.groupTransition},Qe=w=>Array.isArray(w)?w.length>0&&w.some(Qe):!!w,Ce=Qe(z),ze=D({},m,{expanded:L,focused:r,selected:x,disabled:h,indentationAtItemLevel:j}),W=Sn(ze),Ue=xe.groupTransition??void 0,Rt=Pe({elementType:Ue,ownerState:{},externalSlotProps:C==null?void 0:C.groupTransition,additionalProps:D({unmountOnExit:!0,in:L,component:"ul",role:"group"},j?{indentationAtItemLevel:!0}:{}),className:W.groupTransition}),Bt=w=>{T==="iconContainer"&&v(w)},Re=L?xe.collapseIcon:xe.expandIcon,Ft=Pe({elementType:Re,ownerState:{},externalSlotProps:w=>L?D({},ae(a.slotProps.collapseIcon,w),ae(C==null?void 0:C.collapseIcon,w)):D({},ae(a.slotProps.expandIcon,w),ae(C==null?void 0:C.expandIcon,w)),additionalProps:{onClick:Bt}}),Kt=he(Ft,yn),Vt=Ce&&Re?e.jsx(Re,D({},Kt)):null,Be=Ce?void 0:xe.endIcon,Nt=Pe({elementType:Be,ownerState:{},externalSlotProps:w=>Ce?{}:D({},ae(a.slotProps.endIcon,w),ae(C==null?void 0:C.endIcon,w))}),Wt=he(Nt,bn),$t=Be?e.jsx(Be,D({},Wt)):null,Fe=xe.icon,Ht=Pe({elementType:Fe,ownerState:{},externalSlotProps:C==null?void 0:C.icon}),Gt=he(Ht,Tn),qt=Fe?e.jsx(Fe,D({},Gt)):null;let Se;x?Se=!0:b||h?Se=void 0:Se=!1;function Qt(w){!r&&(!h||c)&&w.currentTarget===w.target&&f.focusItem(w,E)}function Ut(w){var ne,me,st,nt;y==null||y(w),!(P||w.relatedTarget&&ot(w.relatedTarget,Te.current)&&(w.target&&((me=(ne=w.target)==null?void 0:ne.dataset)==null?void 0:me.element)==="labelInput"&&ot(w.target,Te.current)||((nt=(st=w.relatedTarget)==null?void 0:st.dataset)==null?void 0:nt.element)==="labelInput"))&&f.removeFocusedItem()}const Yt=w=>{var ne,me;_==null||_(w),((me=(ne=w.target)==null?void 0:ne.dataset)==null?void 0:me.element)!=="labelInput"&&f.handleItemKeyDown(w,E)},Jt=rn({itemId:E,treeId:p,id:A}),Xt=f.canItemBeTabbed(E)?0:-1,Ie={rootRefObject:Te,contentRefObject:qe,interactions:{handleSaveItemLabel:Q,handleCancelItemLabelEditing:K}},Zt=((Xe=N.root)==null?void 0:Xe.call(N,D({},Ie,{externalEventHandlers:lt(k)})))??{},es=((Ze=N.content)==null?void 0:Ze.call(N,D({},Ie,{externalEventHandlers:lt(M)})))??{},Ye=((et=N.dragAndDropOverlay)==null?void 0:et.call(N,D({},Ie,{externalEventHandlers:{}})))??{},Je=((tt=N.labelInput)==null?void 0:tt.call(N,D({},Ie,{externalEventHandlers:{}})))??{};return e.jsx(an,{itemId:E,children:e.jsxs(In,D({className:ft(W.root,R),role:"treeitem","aria-expanded":Ce?L:void 0,"aria-selected":Se,"aria-disabled":h||void 0,id:Jt,tabIndex:Xt},k,{ownerState:ze,onFocus:Qt,onBlur:Ut,onKeyDown:Yt,ref:Ot,style:j?D({},k.style,{"--TreeView-itemDepth":typeof l=="function"?l(E):l}):k.style},Zt,{children:[e.jsx(wn,D({as:B,classes:{root:W.content,expanded:W.expanded,selected:W.selected,focused:W.focused,disabled:W.disabled,editable:W.editable,editing:W.editing,iconContainer:W.iconContainer,label:W.label,labelInput:W.labelInput,checkbox:W.checkbox},label:g,itemId:E,onClick:S,onMouseDown:F,icon:qt,expansionIcon:Vt,displayIcon:$t,ownerState:ze},M,es,Ye.action==null?{}:{dragAndDropOverlayProps:Ye},Je.value==null?{}:{labelInputProps:Je},{ref:zt})),z&&e.jsx(kn,D({as:Ue},Rt,{children:z}))]}))})}),Z=()=>e.jsxs(d,{sx:{display:"grid",gridTemplateColumns:"auto auto",justifyContent:"start",alignItems:"center",gap:"10px",padding:"30px"},children:[e.jsx(Ps,{sx:{width:"1em !important",height:"1em !important"}}),e.jsx(De,{children:"Loading..."})]}),pe={columns:[],data:[],initialState:{},enableColumnActions:!1,enableColumnFilters:!1,enablePagination:!1,enableSorting:!1,enableBottomToolbar:!1,enableTopToolbar:!1,muiTablePaperProps:{sx:{display:"grid",boxShadow:"none"}},muiTableProps:{sx:{border:"unset","& th, td":{borderTop:"unset",borderRight:"unset",borderLeft:"unset"}}},muiTableHeadCellProps:{sx:{paddingTop:"1rem",paddingRight:"1rem",paddingBottom:"1rem",paddingLeft:"1rem"}},muiTableBodyRowProps:{hover:!0},muiTableBodyCellProps:{sx:{verticalAlign:"top"}}},ue=({msg:t})=>e.jsx(d,{sx:{padding:"1rem 0"},children:e.jsx(De,{children:t})}),vn=o.lazy(()=>Y(()=>import("./Alert-1.0.41-DzeUA8Nx.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14]),import.meta.url)),En=({dbs:t,tbl:s,database:n})=>{u.debug(t,s);const a=$(),i=n.columnsLoaded[s]??!1,c=o.useMemo(()=>(n==null?void 0:n.columns[s])??[],[n.columns]),[j,b]=o.useState("");o.useEffect(()=>{i||T()},[i]);const T=()=>{ts(t,s,l=>{const m=l==null?void 0:l.data;u.debug("response data",m),a(ds({dbs:t,tbl:s,cls:m}))},l=>{u.error("error",l),b(l??q.contactSupport)})},p=o.useMemo(()=>[{accessorKey:"ordinal_position",header:"#",size:40},{accessorKey:"column_name",header:"Column name",size:100},{accessorKey:"column_type",header:"Column type",size:100},{accessorKey:"is_nullable",header:"Nullable?",size:50},{accessorKey:"character_maximum_length",header:"Max length",size:70,muiTableHeadCellProps:{align:"right"},muiTableBodyCellProps:{align:"right"}},{accessorKey:"numeric_precision",header:"Precision",size:60,muiTableHeadCellProps:{align:"right"},muiTableBodyCellProps:{align:"right"}},{accessorKey:"numeric_scale",header:"Scale",size:60,muiTableHeadCellProps:{align:"right"},muiTableBodyCellProps:{align:"right"}},{accessorKey:"extra",header:"Extra",size:100},{accessorKey:"column_default",header:"Default value",size:100}],[]),f=ce({...pe,columns:p,data:c,initialState:{columnOrder:["ordinal_position","column_name","column_type","is_nullable","extra","column_default","character_maximum_length","numeric_precision","numeric_scale"],density:"comfortable"},muiTableProps:{className:"pp-explorer-table"}});return u.debug(f),j!==""?e.jsx(o.Suspense,{children:e.jsx(vn,{severity:"error",message:j,close:!1})}):i?i&&c.length===0?e.jsx(ue,{msg:"Table has no columns"}):(u.debug(c),e.jsx(de,{table:f})):e.jsx(Z,{})},Pn=o.lazy(()=>Y(()=>import("./Alert-1.0.41-DzeUA8Nx.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14]),import.meta.url)),_n=({dbs:t,tbl:s,database:n})=>{u.debug(t,s);const a=$(),i=n.indexesLoaded[s]??!1,c=o.useMemo(()=>(n==null?void 0:n.indexes[s])??[],[n.indexes]),[j,b]=o.useState("");o.useEffect(()=>{i||T()},[i]);const T=()=>{ss(t,s,l=>{const m=l==null?void 0:l.data;u.debug("response data",m),a(ps({dbs:t,tbl:s,idx:m}))},l=>{u.error("error",l),b(l??q.contactSupport)})},p=o.useMemo(()=>[{accessorKey:"index_name",header:"Index name",size:100},{accessorKey:"non_unique",header:"Unique",size:80},{accessorKey:"seq_in_name",header:"#",size:40,muiTableHeadCellProps:{align:"right"},muiTableBodyCellProps:{align:"right"}},{accessorKey:"column_name",header:"Column name",size:100},{accessorKey:"collation",header:"Collation",size:80},{accessorKey:"nullable",header:"Nullable?",size:80},{accessorKey:"index_type",header:"Index type",size:100},{accessorKey:"cardinality",header:"Cardinality",size:80,muiTableHeadCellProps:{align:"right"},muiTableBodyCellProps:{align:"right"}}],[]),f=ce({...pe,columns:p,data:c,initialState:{density:"comfortable"},muiTableProps:{className:"pp-explorer-table"}});return u.debug(f),j!==""?e.jsx(o.Suspense,{children:e.jsx(Pn,{severity:"error",message:j,close:!1})}):i?i&&c.length===0?e.jsx(ue,{msg:"Table has no indexes"}):e.jsx(de,{table:f}):e.jsx(Z,{})},Ln=o.lazy(()=>Y(()=>import("./Alert-1.0.41-DzeUA8Nx.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14]),import.meta.url)),Mn=({dbs:t,tbl:s,database:n})=>{u.debug(t,s);const a=$(),i=n.triggersLoaded[s]??!1,c=o.useMemo(()=>(n==null?void 0:n.triggers[s])??[],[n.triggers]),[j,b]=o.useState("");o.useEffect(()=>{i||T()},[i]);const T=()=>{ns(t,s,l=>{const m=l==null?void 0:l.data;u.debug("response data",m),a(us({dbs:t,tbl:s,trg:m}))},l=>{u.error("error",l),b(l??q.contactSupport)})},p=o.useMemo(()=>[{accessorKey:"trigger_name",header:"Trigger name",size:120},{accessorKey:"event_manipulation",header:"Event",size:80},{accessorKey:"action_timing",header:"Timin",size:80},{accessorKey:"action_statement",header:"SQL",size:200,Cell:({cell:l})=>e.jsx("pre",{style:{padding:0,margin:0},children:l.getValue()})}],[]),f=ce({...pe,columns:p,data:c,initialState:{density:"comfortable"},muiTableProps:{className:"pp-explorer-table"}});return u.debug(f),j!==""?e.jsx(o.Suspense,{children:e.jsx(Ln,{severity:"error",message:j,close:!1})}):i?i&&c.length===0?e.jsx(ue,{msg:"Table has no triggers"}):e.jsx(de,{table:f}):e.jsx(Z,{})},An=o.lazy(()=>Y(()=>import("./Alert-1.0.41-DzeUA8Nx.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14]),import.meta.url)),Dn=({dbs:t,tbl:s,database:n})=>{u.debug(t,s);const a=$(),i=n.foreignKeysLoaded[s]??!1,c=o.useMemo(()=>(n==null?void 0:n.foreignKeys[s])??[],[n.foreignKeys]),[j,b]=o.useState("");o.useEffect(()=>{i||T()},[i]);const T=()=>{as(t,s,l=>{const m=l==null?void 0:l.data;u.debug("response data",m),a(xs({dbs:t,tbl:s,frk:m}))},l=>{u.error("error",l),b(l)})},p=o.useMemo(()=>[{accessorKey:"constraint_name",header:"Constraint name",size:100},{accessorKey:"column_name",header:"Column name",size:100},{accessorKey:"referenced_table_name",header:"Referenced table",size:100},{accessorKey:"referenced_column_name",header:"Referenced column",size:100}],[]),f=ce({...pe,columns:p,data:c,initialState:{density:"comfortable"},muiTableProps:{className:"pp-explorer-table"}});return u.debug(f),j!==""?e.jsx(o.Suspense,{children:e.jsx(An,{severity:"error",message:j,close:!1})}):i?i&&c.length===0?e.jsx(ue,{msg:"Table contains no foreign keys"}):e.jsx(de,{table:f}):e.jsx(Z,{})},At=o.memo(({dbs:t,tbl:s,typ:n,database:a})=>(u.debug(t,s,n),e.jsxs(e.Fragment,{children:[e.jsx(G,{itemId:t+"-"+s+"-columns",label:e.jsxs(d,{sx:{display:"inline-grid",gridTemplateColumns:"auto auto",gap:"10px",alignItems:"center"},children:[e.jsx(Ds,{}),e.jsx("span",{children:"Columns"})]}),sx:{padding:0,minWidth:0},children:e.jsx(En,{dbs:t,tbl:s,database:a})}),n===X.TABLE&&e.jsxs(e.Fragment,{children:[e.jsx(G,{itemId:t+"-"+s+"-indexes",label:e.jsxs(d,{sx:{display:"inline-grid",gridTemplateColumns:"auto auto",gap:"10px",alignItems:"center"},children:[e.jsx(Os,{}),e.jsx("span",{children:"Indexes"})]}),sx:{padding:0,minWidth:0},children:e.jsx(_n,{dbs:t,tbl:s,database:a})}),e.jsx(G,{itemId:t+"-"+s+"-foreignkeys",label:e.jsxs(d,{sx:{display:"inline-grid",gridTemplateColumns:"auto auto",gap:"10px",alignItems:"center"},children:[e.jsx(Ys,{}),e.jsx("span",{children:"Foreign Keys"})]}),sx:{padding:0,minWidth:0},children:e.jsx(Dn,{dbs:t,tbl:s,database:a})}),e.jsx(G,{itemId:t+"-"+s+"-triggers",label:e.jsxs(d,{sx:{display:"inline-grid",gridTemplateColumns:"auto auto",gap:"10px",alignItems:"center"},children:[e.jsx(yt,{}),e.jsx("span",{children:"Triggers"})]}),sx:{padding:0,minWidth:0},children:e.jsx(Mn,{dbs:t,tbl:s,database:a})})]})]}))),Dt=o.memo(({dbs:t,tbl:s,typ:n,tableContext:a,database:i})=>{var f,l;u.debug(t,s,n);const c=$(),j=i.tablesSelected,b=i.viewsSelected,T=dn("(max-width:900px)"),p=o.useMemo(()=>(a==null?void 0:a.wp_tables)!==void 0&&a.wp_tables.filter(m=>m===s).length>0?" (WordPress Table)":(a==null?void 0:a.wpda_tables)!==void 0&&a.wpda_tables.filter(m=>m===s).length>0?" (Plugin Table)":"",[]);return e.jsxs(d,{color:"primary",sx:{display:"grid",gridTemplateColumns:"calc(100% - 110px) auto",justifyContent:"space-between",alignItems:"center",gridGap:"20px",marginLeft:"-10px","&:hover":{".pp-row-actions":{visibility:T?"hidden":"visible"}}},children:[e.jsxs(d,{sx:{display:"grid",gridTemplateColumns:"auto auto",justifyContent:"start",alignItems:"center",gridGap:"0",overflow:"hidden"},children:[e.jsx(d,{sx:{display:"grid",alignItems:"center"},children:e.jsx(J,{size:"small",checked:b.includes(s)||j.includes(s),onClick:m=>{n===X.VIEW?c(ms({dbs:t,vws:s,isSelected:!b.includes(s)})):c(gs({dbs:t,tbl:s,isSelected:!j.includes(s)})),m.stopPropagation()}})}),e.jsxs(d,{sx:{display:"grid",gridTemplateColumns:"auto auto",alignItems:"stretch"},children:[e.jsxs(d,{sx:{textOverflow:"ellipsis",whiteSpace:"nowrap"},children:[s," ",p]}),e.jsxs(d,{sx:{display:"grid",gridTemplateColumns:"auto auto auto auto",gridGap:"10px",marginLeft:"10px",alignItems:"center",visibility:"hidden"},className:"pp-row-actions",children:[e.jsx(d,{sx:{borderLeft:"1px solid black",height:"100%"}}),e.jsx(fe,{title:"Manage table `"+s+"`",placement:"bottom",children:e.jsx(re,{underline:"none",onClick:m=>{c(we({dbs:t,tbl:s,typ:n,explorerAction:_e.MANAGE})),m.preventDefault(),m.stopPropagation()},children:"Manage"})}),e.jsx(d,{sx:{borderLeft:"1px solid black",height:"100%"}}),e.jsx(fe,{title:"Explore table `"+s+"`",placement:"bottom",children:e.jsx(re,{underline:"none",onClick:m=>{c(we({dbs:t,tbl:s,typ:n,explorerAction:_e.EXPLORE})),m.preventDefault(),m.stopPropagation()},children:"Explore"})})]})]})]}),e.jsxs(d,{sx:{display:"grid",gridTemplateColumns:"auto auto",justifyContent:"space-evenly",alignItems:"center"},children:[e.jsx(fe,{title:"Manage table `"+s+"`",placement:"bottom",children:e.jsx(le,{sx:{color:(f=te)==null?void 0:f.palette.primary.main},onClick:m=>{c(we({dbs:t,tbl:s,typ:n,explorerAction:_e.MANAGE})),m.preventDefault(),m.stopPropagation()},children:e.jsx(zs,{})})}),e.jsx(fe,{title:"Explore table `"+s+"`",placement:"bottom",children:e.jsx(le,{sx:{color:(l=te)==null?void 0:l.palette.primary.main},onClick:m=>{c(we({dbs:t,tbl:s,typ:n,explorerAction:_e.EXPLORE})),m.preventDefault(),m.stopPropagation()},children:e.jsx(Rs,{})})})]})]})}),On=o.lazy(()=>Y(()=>import("./Alert-1.0.41-DzeUA8Nx.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14]),import.meta.url)),zn=o.memo(({dbs:t,search:s,database:n})=>{const a=$();u.debug(t,s);const i=n.tablesLoaded,c=n.tables,j=n.tablesContext,[b,T]=o.useState("");return o.useEffect(()=>{i||rs(t,function(p){const f=p==null?void 0:p.data;u.debug("response data",f),a(hs({dbs:t,tbl:f,context:p.context??void 0}))},p=>{u.error("error",p),T(p??q.contactSupport)})},[i]),b!==""?e.jsx(o.Suspense,{children:e.jsx(On,{severity:"error",message:b,close:!1})}):i?i&&c.length===0?e.jsx(d,{sx:{padding:"1rem"},children:e.jsx(De,{children:"Database contains no tables"})}):e.jsxs(e.Fragment,{children:[...c.map(p=>{const f=!se(p,s);return e.jsx(G,{itemId:t+"-"+p,label:e.jsx(Dt,{dbs:t,tbl:p,typ:X.TABLE,tableContext:j,database:n}),sx:{visibility:f?"hidden":"inherit",position:f?"fixed !important":"inherit"},children:e.jsx(At,{dbs:t,tbl:p,typ:X.TABLE,database:n})})})]}):e.jsx(Z,{})}),Rn=o.lazy(()=>Y(()=>import("./Alert-1.0.41-DzeUA8Nx.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14]),import.meta.url)),Bn=({dbs:t,search:s,database:n})=>{const a=$();u.debug(t,s);const i=n.viewsLoaded,c=n.views,[j,b]=o.useState("");o.useEffect(()=>{i||T()},[i]);const T=()=>{os(t,p=>{const f=p==null?void 0:p.data;u.debug("response data",f),a(fs({dbs:t,vws:f}))},p=>{u.error("error",p),b(p??q.contactSupport)})};return j!==""?e.jsx(o.Suspense,{children:e.jsx(Rn,{severity:"error",message:j,close:!1})}):i?i&&c.length===0?e.jsx(d,{sx:{padding:"1rem"},children:e.jsx(De,{children:"Database contains no views"})}):e.jsxs(e.Fragment,{children:[...c.map(p=>{const f=!se(p,s);return e.jsx(G,{itemId:t+"-"+p,label:e.jsx(Dt,{dbs:t,tbl:p,typ:X.VIEW,database:n}),sx:{visibility:f?"hidden":"unset",position:f?"fixed !important":"inherit"},children:e.jsx(At,{dbs:t,tbl:p,typ:X.VIEW,database:n})})})]}):e.jsx(Z,{})},Fn=o.lazy(()=>Y(()=>import("./Alert-1.0.41-DzeUA8Nx.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14]),import.meta.url)),Kn=({dbs:t,search:s,database:n})=>{u.debug(t,s);const a=$(),i=n.proceduresLoaded,c=n.procedures,[j,b]=o.useState("");o.useEffect(()=>{i||T()},[i]);const T=()=>{is(t,l=>{const m=l==null?void 0:l.data;u.debug("response data",m),a(js({dbs:t,prc:m}))},l=>{u.error("error",l),b(l??q.contactSupport)})},p=o.useMemo(()=>[{accessorKey:"routine_name",header:"Name",size:100},{accessorKey:"routine_definition",header:"Body",size:300,Cell:({cell:l})=>e.jsx("pre",{style:{padding:0,margin:0},children:l.getValue()})}],[]),f=ce({...pe,columns:p,data:c.filter(l=>se(l.routine_name,s)),initialState:{density:"comfortable"},muiTableProps:{className:"pp-explorer-table"}});return u.debug(f),j!==""?e.jsx(o.Suspense,{children:e.jsx(Fn,{severity:"error",message:j,close:!1})}):i?i&&c.length===0?e.jsx(ue,{msg:"Database contains no stored procedures"}):e.jsx(de,{table:f}):e.jsx(Z,{})},Vn=o.lazy(()=>Y(()=>import("./Alert-1.0.41-DzeUA8Nx.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14]),import.meta.url)),Nn=({dbs:t,search:s,database:n})=>{u.debug(t,s);const a=$(),i=n.functionsLoaded,c=n.functions,[j,b]=o.useState("");o.useEffect(()=>{i||T()},[i]);const T=()=>{ls(t,l=>{const m=l==null?void 0:l.data;u.debug("response data",m),a(ys({dbs:t,fnc:m}))},l=>{u.error("error",l),b(l??q.contactSupport)})},p=o.useMemo(()=>[{accessorKey:"routine_name",header:"Name",size:100},{accessorKey:"routine_definition",header:"Body",size:300,Cell:({cell:l})=>e.jsx("pre",{style:{padding:0,margin:0},children:l.getValue()})}],[]),f=ce({...pe,columns:p,data:c.filter(l=>se(l.routine_name,s)),initialState:{density:"comfortable"},muiTableProps:{className:"pp-explorer-table"}});return u.debug(f),j!==""?e.jsx(o.Suspense,{children:e.jsx(Vn,{severity:"error",message:j,close:!1})}):i?i&&c.length===0?e.jsx(ue,{msg:"Database contains no functions"}):e.jsx(de,{table:f}):e.jsx(Z,{})},Wn=({setShowFilter:t})=>{const s=$(),a=Oe().dbsTypes;return o.useEffect(()=>{try{localStorage.setItem("ppExplorerSearchDbsTypes",JSON.stringify(a))}catch(i){u.debug(i)}},[a]),e.jsxs(pn,{sx:{position:"absolute",top:"3em",right:"0",minWidth:"-webkit-fill-available",zIndex:9999999},children:[e.jsx(xn,{title:"Database filter",sx:{textAlign:"center"}}),e.jsx(un,{sx:{textAlign:"center",padding:0,borderTop:"1px solid #eee",borderBottom:"1px solid #eee"},children:e.jsxs(d,{sx:{display:"inline-grid",textAlign:"left",padding:"2em","& label":{display:"flex",alignItems:"center"}},children:[e.jsx(oe,{children:e.jsxs(Le,{children:[e.jsx(J,{size:"small",checked:a.includes(O.WP),onChange:(i,c)=>{s(c?ke({dbsType:O.WP}):ve({dbsType:O.WP}))}}),"WordPress database"]})}),e.jsx(oe,{children:e.jsxs(Le,{children:[e.jsx(J,{size:"small",checked:a.includes(O.LOCAL),onChange:(i,c)=>{s(c?ke({dbsType:O.LOCAL}):ve({dbsType:O.LOCAL}))}}),"Local databases"]})}),e.jsx(oe,{children:e.jsxs(Le,{children:[e.jsx(J,{size:"small",checked:a.includes(O.REMOTE),onChange:(i,c)=>{s(c?ke({dbsType:O.REMOTE}):ve({dbsType:O.REMOTE}))}}),"Remote databases"]})}),e.jsx(oe,{children:e.jsxs(Le,{children:[e.jsx(J,{size:"small",checked:a.includes(O.SYSTEM),onChange:(i,c)=>{s(c?ke({dbsType:O.SYSTEM}):ve({dbsType:O.SYSTEM}))}}),"System databases"]})})]})}),e.jsxs(mn,{sx:{display:"grid",gridTemplateColumns:"1fr 1fr"},children:[e.jsx(d,{}),e.jsx(Me,{variant:"contained",onClick:()=>t(!1),children:"OK"})]})]})},ie=({search:t,setSearch:s,addFilter:n})=>{u.debug(t,n);const[a,i]=o.useState(!1);return e.jsxs(d,{sx:{position:"relative"},children:[e.jsx(kt,{value:t,type:"search",onChange:c=>{s(c.target.value)},onClick:c=>{c.stopPropagation()},onKeyDown:c=>{c.stopPropagation()},sx:{backgroundColor:"#fff",fontSize:"1em",margin:0,padding:0,borderRadius:"4px","&.MuiFormControl-root.MuiTextField-root .MuiInputBase-root":{paddingRight:0},"&.MuiFormControl-root.MuiTextField-root input":{padding:"8px"}},slotProps:{input:{startAdornment:e.jsx(dt,{position:"end",sx:{fontSize:"1.5rem",padding:0,margin:0},children:e.jsx(Fs,{})}),endAdornment:e.jsx(e.Fragment,{children:n&&e.jsx(dt,{position:"end",sx:{fontSize:"1.5rem",padding:0,margin:0},children:e.jsx(le,{onClick:()=>{i(!a)},children:e.jsx(Bs,{})})})})}}}),a&&e.jsx(Wn,{setShowFilter:i})]})},$n=(t,s)=>{const n=be(a=>a.explorer.database===void 0||a.explorer.database===null||a.explorer.database[t].tables.length===0?!1:a.explorer.database[t].tables.filter(c=>se(c,s)).length===a.explorer.database[t].tablesSelected.length);return u.debug("allTablesSelected",n),n},Hn=(t,s)=>{const n=be(a=>a.explorer.database===void 0||a.explorer.database===null||a.explorer.database[t].views.length===0?!1:a.explorer.database[t].views.filter(c=>se(c,s)).length===a.explorer.database[t].viewsSelected.length);return u.debug("allViewsSelected",n),n},ye=t=>{let s="";try{s=localStorage.getItem(t)??""}catch(c){u.debug(c)}const[n,a]=o.useState(s),i=c=>{a(c);try{localStorage.setItem(t,c)}catch(j){u.debug(j)}};return u.debug(n),{search:n,setSearch:i}},Gn=o.memo(({dbs:t})=>{u.debug(t);const s=$(),[n,a]=o.useState(!1),{search:i,setSearch:c}=ye(`ppExplorerSearchTables-${t}`);u.debug(n,i);const[j,b]=o.useState(!1),{search:T,setSearch:p}=ye(`ppExplorerSearchViews-${t}`);u.debug(j,T);const[f,l]=o.useState(!1),{search:m,setSearch:z}=ye(`ppExplorerSearchProcedures-${t}`);u.debug(f,m);const[R,I]=o.useState(!1),{search:C,setSearch:B}=ye(`ppExplorerSearchFunctions-${t}`);u.debug(R,C);const M=$n(t,i),E=Hn(t,T),[A,g]=o.useState("");u.debug(A);const S=$e(),F=S[t];return e.jsxs(e.Fragment,{children:[e.jsx(G,{itemId:t+"-tables",className:"pp-data-exporer-table-tree-item "+A,onClickCapture:y=>{var _,k;!(y.target instanceof HTMLInputElement)&&!(y.target instanceof HTMLAnchorElement)&&!((_=y.target.closest("span"))!=null&&_.classList.contains("pp-select-all-tables"))&&((k=y.target.closest("li"))!=null&&k.classList.contains("pp-data-exporer-table-tree-item"))&&(g(A===""?"hide-details":""),n?y.stopPropagation():(a(!0),g("")))},sx:{padding:0,minWidth:0,"&.hide-details > ul":{visibility:"hidden",position:"fixed"}},label:e.jsxs(d,{sx:{display:"grid",gridTemplateColumns:"auto auto",gap:"20px",justifyContent:"space-between",alignItems:"center","&:hover":{".pp-row-actions":{display:"grid"}}},children:[e.jsxs(d,{sx:{display:"grid",gridTemplateColumns:"auto auto",gap:"10px",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs(d,{sx:{display:"grid",gridTemplateColumns:"auto auto",gap:n&&A===""?0:"10px",justifyContent:"space-between",alignItems:"center",margin:"0 8px 0 4px"},children:[n&&A===""?e.jsx(J,{size:"small",className:"pp-select-all-tables",checked:M,onClick:y=>{s(xt({dbs:t,isSelected:!M,search:i})),y.stopPropagation()},sx:{marginLeft:"-12px"}}):e.jsx(bt,{}),e.jsxs("span",{style:{display:"grid",gridTemplateColumns:"auto auto",alignItems:"center",gap:"5px"},children:[e.jsx("span",{children:"Tables"}),e.jsx("span",{style:{fontSize:"90%"},children:S[t].tablesLoaded===!0?"("+S[t].tables.length+"/"+S[t].tablesSelected.length+")":""})]})]}),e.jsxs(d,{className:"pp-row-actions",sx:{display:"none",gridTemplateColumns:"auto auto",gridGap:"10px",alignItems:"center"},children:[e.jsx(d,{sx:{borderLeft:"1px solid black",height:"100%"}}),e.jsx(re,{underline:"none",onClick:y=>{s(mt({dbs:t})),y.preventDefault(),y.stopPropagation()},children:"Refresh"})]})]}),e.jsx(d,{children:n&&A===""&&e.jsx(ie,{search:i,setSearch:c})})]}),children:e.jsx(zn,{dbs:t,search:i,database:F})}),e.jsx(G,{itemId:t+"-views",onClick:()=>{b(!j)},label:e.jsxs(d,{sx:{display:"grid",gridTemplateColumns:"auto auto",gap:"20px",justifyContent:"space-between",alignItems:"center","&:hover":{".pp-row-actions":{display:"grid"}}},children:[e.jsxs(d,{sx:{display:"grid",gridTemplateColumns:"auto auto",gap:"10px",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs(d,{sx:{display:"grid",gridTemplateColumns:"auto auto",gap:j?0:"10px",justifyContent:"space-between",alignItems:"center",margin:"0 8px 0 4px"},children:[j?e.jsx(J,{size:"small",checked:E,onClick:y=>{s(gt({dbs:t,isSelected:!E,search:T})),y.stopPropagation()},sx:{marginLeft:"-12px"}}):e.jsx(Tt,{}),e.jsxs("span",{style:{display:"grid",gridTemplateColumns:"auto auto",alignItems:"center",gap:"5px"},children:[e.jsx("span",{children:"Views"}),e.jsx("span",{style:{fontSize:"90%"},children:S[t].viewsLoaded===!0?"("+S[t].views.length+"/"+S[t].viewsSelected.length+")":""})]})]}),e.jsxs(d,{className:"pp-row-actions",sx:{display:"none",gridTemplateColumns:"auto auto",gridGap:"10px",alignItems:"center"},children:[e.jsx(d,{sx:{borderLeft:"1px solid black",height:"100%"}}),e.jsx(re,{underline:"none",onClick:y=>{s(ht({dbs:t})),y.preventDefault(),y.stopPropagation()},children:"Refresh"})]})]}),e.jsx(d,{children:j&&e.jsx(ie,{search:T,setSearch:p})})]}),sx:{padding:0,minWidth:0},children:e.jsx(Bn,{dbs:t,search:T,database:F})}),e.jsx(G,{itemId:t+"-procedures",onClick:()=>{l(!f)},label:e.jsxs(d,{sx:{display:"grid",gridTemplateColumns:"auto auto",gap:"20px",justifyContent:"space-between",alignItems:"center","&:hover":{".pp-row-actions":{display:"grid"}}},children:[e.jsxs(d,{sx:{display:"grid",gridTemplateColumns:"auto auto",gap:"10px",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs(d,{sx:{display:"grid",gridTemplateColumns:"auto auto",gap:"10px",justifyContent:"space-between",alignItems:"center",margin:"0 8px 0 4px"},children:[e.jsx(yt,{}),e.jsxs("span",{style:{display:"grid",gridTemplateColumns:"auto auto",alignItems:"center",gap:"5px"},children:[e.jsx("span",{children:"Stored Procedures"}),e.jsx("span",{style:{fontSize:"90%"},children:S[t].proceduresLoaded===!0?"("+S[t].procedures.length+")":""})]})]}),e.jsxs(d,{className:"pp-row-actions",sx:{display:"none",gridTemplateColumns:"auto auto",gridGap:"10px",alignItems:"center"},children:[e.jsx(d,{sx:{borderLeft:"1px solid black",height:"100%"}}),e.jsx(re,{underline:"none",onClick:y=>{s(bs({dbs:t})),y.preventDefault(),y.stopPropagation()},children:"Refresh"})]})]}),e.jsx(d,{children:f&&e.jsx(ie,{search:m,setSearch:z})})]}),sx:{padding:0,minWidth:0},children:e.jsx(Kn,{dbs:t,search:m,database:F})}),e.jsx(G,{itemId:t+"-functions",onClick:()=>{I(!R)},label:e.jsxs(d,{sx:{display:"grid",gridTemplateColumns:"auto auto",gap:"20px",justifyContent:"space-between",alignItems:"center","&:hover":{".pp-row-actions":{display:"grid"}}},children:[e.jsxs(d,{sx:{display:"grid",gridTemplateColumns:"auto auto",gap:"10px",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs(d,{sx:{display:"grid",gridTemplateColumns:"auto auto",gap:"10px",justifyContent:"space-between",alignItems:"center",margin:"0 8px 0 4px"},children:[e.jsx(Js,{}),e.jsxs("span",{style:{display:"grid",gridTemplateColumns:"auto auto",alignItems:"center",gap:"5px"},children:[e.jsx("span",{children:"Functions"}),e.jsx("span",{style:{fontSize:"90%"},children:S[t].functionsLoaded===!0?"("+S[t].functions.length+")":""})]})]}),e.jsxs(d,{className:"pp-row-actions",sx:{display:"none",gridTemplateColumns:"auto auto",gridGap:"10px",alignItems:"center"},children:[e.jsx(d,{sx:{borderLeft:"1px solid black",height:"100%"}}),e.jsx(re,{underline:"none",onClick:y=>{s(Ts({dbs:t})),y.preventDefault(),y.stopPropagation()},children:"Refresh"})]})]}),e.jsx(d,{children:R&&e.jsx(ie,{search:C,setSearch:B})})]}),sx:{padding:0,minWidth:0},children:e.jsx(Nn,{dbs:t,search:C,database:F})})]})}),qn=()=>{const t=be(s=>s.explorer.database===void 0||s.explorer.database===null?0:Object.keys(s.explorer.database).map(n=>s.explorer.database[n].tablesSelected).flat().length);return u.debug("countSelectedTables",t),t},Qn=()=>{const t=be(s=>s.explorer.database===void 0||s.explorer.database===null?!1:Object.keys(s.explorer.database).filter(n=>s.explorer.database[n].tablesSelected.length>0||s.explorer.database[n].viewsSelected.length>0).length>0);return u.debug("hasBulkActions",t),t},Un=()=>{const t=be(s=>s.explorer.database===void 0||s.explorer.database===null?0:Object.keys(s.explorer.database).map(n=>s.explorer.database[n].viewsSelected).flat().length);return u.debug("countSelectedViews",t),t},ge={export:"Export table(s)",truncate:"Truncate table(s)",drop:"Drop table(s)/view(s)"},Yn=()=>{const t=$(),s=Qn(),n=Oe(),a=$e(),i=qn(),c=Un(),j=n.context,[b,T]=o.useState({}),[p,f]=o.useState("*"),[l,m]=o.useState(null),[z,R]=o.useState(!1),[I,C]=o.useState(!1),[B,M]=o.useState(!1);o.useEffect(()=>{i===0&&(p==="export"||p==="truncate")&&f("*")},[i]);const E={vertical:"top",horizontal:"right"},A=()=>{const r={};return a==null?{}:(Object.keys(a).map(x=>{a[x].tablesSelected.map(h=>{r[x]===void 0&&(r[x]={}),r[x][h]={status:null,typ:X.TABLE}}),p==="drop"&&a[x].viewsSelected.map(h=>{r[x]===void 0&&(r[x]={}),r[x][h]={status:null,typ:X.VIEW}})}),r)},g=(r,x,h)=>{const P={...b};x==="*"?Object.keys(P[r]).map(v=>P[r][v].status=h):P[r][x].status=h,T(P)},S=()=>{Object.keys(b).length>0&&Object.keys(b).map(r=>{window.document.getElementById(`pp-export-tables-${r}`).submit(),g(r,"*",!0)})},F=()=>{Object.keys(b).length>0&&Object.keys(b).map(r=>{Object.keys(b[r]).map(x=>{Ls(r,x,h=>{u.debug(h),(h==null?void 0:h.code)==="ok"&&(h==null?void 0:h.message)!==void 0?g(r,x,!0):g(r,x,!1)},h=>{u.error("error",r,x,h),g(r,x,!1)})})})},y=()=>{Object.keys(b).length>0&&Object.keys(b).map(r=>{Object.keys(b[r]).map(x=>{_s(r,x,b[r][x].typ,h=>{u.debug(h),(h==null?void 0:h.code)==="ok"&&(h==null?void 0:h.message)!==void 0?g(r,x,!0):g(r,x,!1)},h=>{u.error("error",h),g(r,x,!1)})})})},_=r=>e.jsxs(Et,{sx:{"& th":{fontWeight:"bold",padding:"4px 6px"},"& td":{padding:"4px 6px",border:"none"}},children:[e.jsx(_t,{children:e.jsxs(Ae,{children:[e.jsx(H,{children:"Database"}),e.jsx(H,{children:"Table | View"}),e.jsx(H,{children:"Status"})]})}),e.jsx(Pt,{children:Object.keys(r).map(x=>Object.keys(r[x]).map((h,P)=>{var v,K;return e.jsxs(Ae,{children:[e.jsx(H,{children:P===0?x:null}),e.jsx(H,{children:h}),e.jsxs(H,{children:[r[x][h]===null&&e.jsx(Vs,{style:{display:"block",margin:"0 auto"}}),r[x][h].status===!0&&e.jsx(Ct,{color:(v=te)==null?void 0:v.palette.success.main,style:{display:"block",margin:"0 auto"}}),r[x][h].status===!1&&e.jsx(St,{color:(K=te)==null?void 0:K.palette.error.main,style:{display:"block",margin:"0 auto"}})]})]},P)}))})]}),k=()=>e.jsx(d,{children:_(b)}),L=()=>{const r=A();return T(r),e.jsxs(d,{children:[_(r),(p==="truncate"||p==="drop")&&e.jsxs(e.Fragment,{children:[e.jsx("hr",{style:{marginTop:"20px"}}),e.jsx(d,{sx:{marginTop:"20px",marginBottom:"20px"},children:p==="drop"?e.jsx("span",{children:"Deletes views and tables with all data permanently."}):e.jsx("span",{children:"Deletes all data permanently."})}),e.jsx(d,{children:e.jsx("strong",{children:"This actions cannot be undone!"})}),e.jsxs(d,{children:["'",e.jsx("strong",{children:"NO"}),"' to stop, '",e.jsx("strong",{children:"YES"}),"' to continue."]}),e.jsxs(d,{sx:{marginTop:"20px",fontSize:"80%",display:"inline-grid",gridTemplateColumns:"auto auto",justifyContent:"space-between",alignItems:"center",gap:"5px"},children:[e.jsx(Ks,{}),e.jsxs("span",{children:["Does not ",p," WordPress tables"]})]})]})]})};return s?e.jsxs(e.Fragment,{children:[e.jsx(He,{className:"pp-bulk-actions-container",color:"inherit",position:"relative",elevation:4,sx:{margin:"0 0 5px 0"},children:e.jsxs(Ge,{sx:{display:"grid",gridTemplateColumns:"auto auto",gap:"12px",justifyContent:"space-between"},children:[e.jsxs(d,{sx:{display:"grid",gridTemplateColumns:"auto auto",gap:"12px",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(oe,{variant:"standard",sx:{minWidth:200},children:e.jsxs(vt,{MenuProps:{id:"pp-select-menu"},value:p,onChange:r=>{f(r.target.value)},children:[e.jsx(je,{value:"*",children:"Bulk actions"}),e.jsx(je,{value:"export",disabled:i===0,children:ge.export}),e.jsx(je,{value:"truncate",disabled:i===0,children:ge.truncate}),e.jsx(je,{value:"drop",children:ge.drop})]})}),e.jsx(Me,{variant:"contained",onClick:()=>{p!=="*"?(m(L()),R(!0)):C(!0)},children:"Apply"})]}),e.jsxs(d,{sx:{display:"grid",gridTemplateColumns:"auto auto",gap:"12px",justifyContent:"space-between"},children:[e.jsx(at,{badgeContent:i,color:"info",anchorOrigin:E,children:e.jsx(bt,{color:"action",size:20})}),e.jsx(at,{badgeContent:c,color:"info",anchorOrigin:E,children:e.jsx(Tt,{color:"action",size:20})})]})]})}),p==="export"&&Object.keys(b).map(r=>e.jsxs("form",{id:"pp-export-tables-"+r,action:j.wp.home+"?action=wpda_export",method:"post",target:"_blank",children:[e.jsx("input",{type:"hidden",name:"type",value:"table"}),e.jsx("input",{type:"hidden",name:"wpdaschema_name",value:r}),Object.keys(b[r]).map(x=>e.jsx("input",{type:"hidden",name:"table_names[]",value:x},x)),e.jsx("input",{type:"hidden",name:"_wpnonce",value:j.wp.nonce.split("-")[0]})]},"pp-export-tables-"+r)),e.jsx(Ne,{title:"Apply bulk action",message:"No bulk action selected",open:I,setOpen:C}),e.jsx(wt,{title:ge[p],message:l,open:z,setOpen:R,onConfirm:()=>{switch(M(!0),p){case"export":S();break;case"truncate":F();break;case"drop":y()}}}),e.jsx(Ne,{title:ge[p],message:k(),open:B,setOpen:M,onConfirm:()=>{Object.keys(b).map(r=>{t(mt({dbs:r})),t(xt({dbs:r,isSelected:!1,search:""})),t(ht({dbs:r})),t(gt({dbs:r,isSelected:!1,search:""}))})}})]}):null},Jn=({setCanImport:t})=>{var _,k,L;const s=Oe(),n=$e(),a=s.context,[i,c]=o.useState(""),[j,b]=o.useState("");o.useEffect(()=>{if(n!=null&&Object.keys(n).length>0){const r=Object.keys(n).filter(x=>n[x].dbsType===O.WP);(r==null?void 0:r.length)>0&&c(r[0])}},[n]);const T=o.useRef(null),[p,f]=o.useState(null),l=(_=a==null?void 0:a.wp)!=null&&_.zip?".sql,.zip":".sql",m=(k=a==null?void 0:a.wp)!=null&&k.zip?"SQL and ZIP":"SQL",z=(L=a==null?void 0:a.wp)==null?void 0:L.upload,[R,I]=o.useState(!1),[C,B]=o.useState(null),[M,E]=o.useState(!1),[A,g]=o.useState(""),[S,F]=o.useState(null),y=r=>e.jsx(e.Fragment,{children:e.jsxs(Et,{sx:{"& th":{fontWeight:"bold",padding:"4px 6px"},"& td":{padding:"4px 6px",border:"none"}},children:[e.jsx(_t,{children:e.jsxs(Ae,{children:[e.jsx(H,{children:"Import file"}),e.jsx(H,{children:"Message"}),e.jsx(H,{children:"Status"})]})}),e.jsx(Pt,{children:r.map(x=>Object.keys(x).map(h=>{var P,v;return e.jsxs(Ae,{children:[e.jsx(H,{sx:{verticalAlign:"text-top"},children:h}),e.jsxs(H,{sx:{verticalAlign:"text-top"},children:[x[h].msg,x[h].errors.map(K=>{var Q;return e.jsx("ul",{style:{listStyle:"disc",padding:"0 40px"},children:e.jsx("li",{style:{color:(Q=te)==null?void 0:Q.palette.error.main},children:K})})})]}),e.jsx(H,{sx:{verticalAlign:"text-top"},children:x[h].status==="error"?e.jsx(St,{color:(P=te)==null?void 0:P.palette.error.main,style:{display:"block",margin:"0 auto"}}):e.jsx(Ct,{color:(v=te)==null?void 0:v.palette.success.main,style:{display:"block",margin:"0 auto"}})})]},h)}))})]})});return e.jsxs(e.Fragment,{children:[e.jsxs(d,{className:"pp-import-container",sx:{position:"relative","& > .tooltip":{position:"absolute !important",top:"10px",right:"10px",zIndex:999}},children:[e.jsx(hn,{title:"Close",position:"bottom",children:e.jsx(le,{onClick:()=>{T.current&&(T.current.value=""),b(""),t(!1)},size:"large",color:"inherit",sx:{fontSize:"1.4em"},children:e.jsx(Ns,{})})}),e.jsx(He,{className:"pp-import-container",color:"inherit",position:"relative",elevation:4,sx:{display:"grid",alignItems:"center",margin:"0 0 5px 0"},children:e.jsxs(Ge,{sx:{display:"grid",gap:"10px",alignItems:"center",height:"max-content",paddingTop:"50px",paddingBottom:"30px"},children:[e.jsx(e.Fragment,{children:e.jsxs(d,{sx:{display:"flex",flexWrap:"wrap",justifyContent:"start",alignItems:"center",gap:"15px"},children:[e.jsx(d,{children:e.jsxs(oe,{sx:{minWidth:"300px"},children:[e.jsx(gn,{variant:"outlined",children:"Select destination database"}),e.jsx(vt,{MenuProps:{id:"pp-select-menu"},label:"Select destination database",value:i,onChange:r=>{c(r.target.value)},children:n!=null&&Object.keys(n).map(r=>{const x=n[r].dbsType===O.WP?r+" (WordPress database)":r;return e.jsx(je,{value:r,children:x},r)})})]})}),e.jsx(d,{children:e.jsx("form",{children:e.jsxs(Me,{component:"label",variant:"outlined",startIcon:e.jsx(Ws,{}),children:["Select file(s)",e.jsx(kt,{type:"file",slotProps:{input:{inputRef:T},htmlInput:{accept:l,multiple:!0}},onChange:r=>{const x=r.target.files;f(x);const h=Object.keys(x).map(P=>x[P].name).toString();b(h)},sx:{display:"none"}})]})})}),j!==""&&e.jsx(e.Fragment,{children:e.jsx(d,{children:e.jsx(Me,{component:"label",variant:"contained",startIcon:e.jsx($s,{}),onClick:()=>{B(e.jsxs(d,{children:[e.jsxs(d,{sx:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:["Selected file(s): ",e.jsx("strong",{children:j})]}),e.jsxs(d,{children:["Selected database: ",e.jsx("strong",{children:i})]}),e.jsxs(d,{sx:{marginTop:"20px",fontSize:"80%"},children:[e.jsx("strong",{children:"NOTE"}),"  You can work on other tasks while your import is performed in the background."]})]})),I(!0)},children:"Import file(s)"})})})]})}),j!==""&&e.jsxs(d,{sx:{marginTop:"20px",marginBottom:"10px",minWidth:0,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",textAlign:"left",fontWeight:"bold"},children:["Selected file(s): ",j]}),e.jsxs("fieldset",{className:"pp-fieldset",style:{marginTop:"5px",minWidth:0},children:[e.jsx("legend",{children:"IMPORTANT"}),e.jsxs("ul",{style:{paddingLeft:"15px",listStyle:"disc",padding:"0 40px"},children:[e.jsx("li",{children:"Supports multiple file uploads simultaneously."}),e.jsxs("li",{children:["Server supports ",m," file types."]}),e.jsxs("li",{children:["Maximum supported file size on this server is ",z,"."]}),e.jsx("li",{children:"Add a ; and a new line character at the end of every SQL statement."})]})]})]})})]}),e.jsx(wt,{title:"Import selected file(s)?",message:C,open:R,setOpen:I,onConfirm:()=>{Ms(i,p,r=>{var x;if(r!=null&&r.message&&((x=r==null?void 0:r.context)!=null&&x.imported)&&Array.isArray(r.context.imported)){const h=r.context.imported;E(!0),g(r.message),F(y(h))}else pt(q.contactSupport,{variant:"error"})},r=>{u.error("error",r),pt(q.contactSupport,{variant:"error"})})}}),e.jsx(Ne,{title:A,message:S,open:M,setOpen:E,onConfirm:()=>{b(""),t(!1)}})]})},ut=o.lazy(()=>Y(()=>import("./Alert-1.0.41-DzeUA8Nx.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14]),import.meta.url)),Tr=()=>{var F;const t=$(),s=o.useRef(null),{search:n,setSearch:a}=ye("ppExplorerSearch"),i=Oe(),c=i.database,j=i.error,b=i.selected,T=i.dbsTypes,[p,f]=o.useState("");o.useEffect(()=>{window.ppActionEnableImport=(y=!0)=>{B(y)},l()},[]);const l=()=>{let y=[],_="";try{_=localStorage.getItem("ppExplorerSearchDbsTypes")}catch(k){u.debug(k)}_!=null&&_!==""?y=JSON.parse(_):y=[O.WP,O.LOCAL,O.REMOTE],cs(k=>{const L=k==null?void 0:k.data;u.debug("response data",L);const r=[],x={};L.map(v=>{r.push({dbs:v.dbs,dbsType:v.dbs_type,pdsDbs:v.pds}),x[v.dbs]=!1}),z(x),r.sort((v,K)=>{var Q,V,ee,N;return((Q=v==null?void 0:v.dbs)==null?void 0:Q.toLocaleLowerCase())>((V=K==null?void 0:K.dbs)==null?void 0:V.toLocaleLowerCase())?1:((ee=K==null?void 0:K.dbs)==null?void 0:ee.toLocaleLowerCase())>((N=v==null?void 0:v.dbs)==null?void 0:N.toLocaleLowerCase())?-1:0}),u.debug(r),t(Is({dbs:r,dbsTypes:y}));const h={};L.map(v=>{h[v.dbs]=v.dbs_type}),t(ws({dbs:h}));const P=k.context;u.debug("context",P),t(ks({context:P}))},k=>{u.error("error",k),f(k??q.contactSupport)})},[m,z]=o.useState({}),[R,I]=o.useState(!0),[C,B]=o.useState(!1),M=()=>e.jsx(fe,{title:"Import data or execute scripts",children:e.jsx(le,{sx:{color:"inherit"},onClick:()=>{B(!C)},children:e.jsx(Us,{})})}),E=()=>e.jsx(le,{onClick:()=>{S(g==="large"?"medium":g==="medium"?"small":"large")},sx:{color:"#fff"},children:g==="small"?e.jsx(Gs,{}):g==="medium"?e.jsx(qs,{}):e.jsx(Qs,{})});let A="";try{A=localStorage.getItem("ppDataExplorerDensity")}catch(y){u.debug(y)}const[g,S]=o.useState(A==="large"||A==="medium"?A:"small");return o.useEffect(()=>{try{localStorage.setItem("ppDataExplorerDensity",g)}catch(y){u.debug(y)}},[g]),p!==""?e.jsx(o.Suspense,{children:e.jsx(ut,{severity:"error",message:p,close:!1})}):e.jsxs(d,{className:"pp-sub-container-explorer",sx:{width:"100%"},children:[e.jsx(He,{className:"pp-explorer-header",elevation:4,position:"relative",sx:{margin:"0 0 5px 0"},children:e.jsx(Ge,{sx:{display:"grid",gridTemplateColumns:"1fr auto",gap:"12px",justifyContent:"space-between",paddingRight:"0 !important"},children:((F=Cs.appOrig)==null?void 0:F.appTarget)==="backend"?e.jsxs(d,{sx:{display:"grid",gridTemplateColumns:"auto auto auto",justifyContent:"end",alignItems:"center",gridGap:"10px"},children:[E(),e.jsx(d,{sx:{textAlign:"right"},children:"Search & Filter"}),e.jsx(ie,{search:n,setSearch:a,addFilter:!0})]}):e.jsxs(d,{sx:{display:"grid",gridTemplateColumns:"auto auto 1fr",justifyContent:"space-between",alignItems:"center",gridGap:"10px"},children:[e.jsx(d,{sx:{fontSize:"18px",lineHeight:"18px",fontWeight:"bold",whiteSpace:"nowrap"},children:"Data Explorer"}),e.jsx(d,{children:M()}),e.jsxs(d,{sx:{display:"grid",gridTemplateColumns:"auto auto",justifyContent:"end",alignItems:"center",gap:"10px"},children:[E(),e.jsx(ie,{search:n,setSearch:a,addFilter:!0})]})]})})}),e.jsx(Yn,{}),C&&e.jsx(Jn,{setCanImport:B}),c==null?e.jsx(d,{sx:{padding:"30px"},children:e.jsx(vs,{title:"Loading..."})}):e.jsxs(e.Fragment,{children:[j!==""&&e.jsx(ct,{sx:{marginBottom:"5px"},elevation:4,children:e.jsx(o.Suspense,{children:e.jsx(ut,{severity:"error",message:j,close:!0,setClose:()=>{t(Ss({error:""}))}})})}),e.jsx(ct,{className:"pp-data-exporer",elevation:4,children:e.jsx(ln,{className:"pp-data-exporer-database-tree pp-density-"+g,"aria-label":"Data Explorer",sx:{display:"grid",gridGap:"0","& li.MuiTreeItem-root:first-of-type li.MuiTreeItem-root:first-of-type":{borderTopLeftRadius:0,borderTopRightRadius:0}},children:Object.keys(c).map(y=>{var k;if(T.includes(b[y])===!1||n!==""&&!se(y,n))return null;const _=((k=b[y])==null?void 0:k.toLocaleLowerCase())==="wp"?y+" (WordPress database)":y;return e.jsx(G,{ref:s,slots:{expandIcon:rt,collapseIcon:R?rt:Hs},itemId:y,className:"pp-data-exporer-database-tree-item hide-details",onClickCapture:L=>{var r,x,h,P;if((r=L.target.closest("li"))!=null&&r.classList.contains("pp-data-exporer-database-tree-item"))if((x=L.target.closest("li"))!=null&&x.classList.contains("hide-details")?((h=L.target.closest("li"))==null||h.classList.remove("hide-details"),I(!1)):((P=L.target.closest("li"))==null||P.classList.add("hide-details"),I(!0)),m[y])L.stopPropagation();else{const v=m;v[y]=!0,z(v)}},sx:{padding:"0","&:first-of-type":{borderTopLeftRadius:"4px",borderTopRightRadius:"4px",overflow:"hidden"},"&.hide-details > ul":{visibility:"hidden",position:"fixed"}},label:e.jsxs(d,{sx:{display:"grid",gridTemplateColumns:"auto auto",justifyContent:"start",alignItems:"center",gap:"10px"},children:[e.jsx(As,{}),_]}),children:e.jsx(Gn,{dbs:y})},y)})})})]})]})};export{Tr as default};
