import{j as t}from"./cm-1.0.41-DxZ4itL_.js";import{l as h,h as C,R as S,A as y,cv as E}from"./lib-1.0.41-DFdWuh_n.js";import{u as F}from"./useStoreTable-1.0.41-B5fmNNPS.js";import{a as T}from"./hooks-1.0.41-sDnKeMy7.js";import{u as k}from"./useTableUpdater-1.0.41-B3-EY98i.js";import{u as B}from"./useMetadata-1.0.41-DKmF8A3i.js";import{c as D,d as L,e as R}from"./BuilderMenu-1.0.41-CI6mFW4W.js";import{P as v}from"./PremiumFeature-1.0.41-CNKLpmFu.js";import{M as w,C as P}from"./MapsApiKey-1.0.41-GmC7QRk2.js";import{u as K}from"./useApp-1.0.41-rJY2RiUW.js";import{r as f}from"./redux-1.0.41-DJjpZqD1.js";import{A as U,a as z}from"./AccordionSummary-1.0.41-CY9CEWZQ.js";import{A as H}from"./AccordionDetails-1.0.41-DlUbOAS0.js";import{F as b,a as M}from"./FormHelperText-1.0.41-BPSj83yP.js";import{F as N}from"./FormControlLabel-1.0.41-OBCouq3I.js";import{S as _}from"./Switch-1.0.41-BrkxB2Jy.js";import{B as x}from"./Spinner-1.0.41-fWZy8imI.js";import{T as q,a as j}from"./ToggleButtonGroup-1.0.41-CS_43ZCw.js";import{u as G,S as O,a as W,b as J,c as Z}from"./SettingsMapMarkers-1.0.41-BAfgAkW1.js";import"./vendor-1.0.41-CN03Eozo.js";import"./loglevel-1.0.41-BZ7XahX3.js";import"./lodash-1.0.41-Cd8grAqB.js";import"./moment-1.0.41-C5S46NFB.js";import"./iconBase-1.0.41-BNQFQdHp.js";import"./Typography-1.0.41-BIN1Ddvh.js";import"./useEnhancedEffect-1.0.41-BVsyj6AW.js";import"./index-1.0.41-CpXj521P.js";import"./notistack-1.0.41-Bq-EKqc7.js";import"./ConfirmDialog-1.0.41-NKESMhfW.js";import"./AdminTheme-1.0.41-4tiUoVeb.js";import"./Menu-1.0.41-DBfdBNVU.js";import"./ThemeProvider-1.0.41-D1lNQgXT.js";import"./MenuItem-1.0.41-DCc8qvzQ.js";import"./index-1.0.41-B2jO0d0P.js";import"./FormLabel-1.0.41-CgxisugM.js";import"./useFormControl-1.0.41-1E9QEnRo.js";import"./TextField-1.0.41-CGPjmVeQ.js";import"./Select-1.0.41-aTzlc-HZ.js";import"./utils-1.0.41-iop7lDec.js";import"./useControlled-1.0.41-BEhJe3xs.js";import"./createSvgIcon-1.0.41-0lRWzB2Q.js";import"./Link-1.0.41-yhMF_PSg.js";import"./Collapse-1.0.41-QlMDtjRk.js";import"./SwitchBase-1.0.41-C_lqznV-.js";import"./useMapUpdater-1.0.41-Dr_1GfF5.js";import"./CssUnitTextField-1.0.41-DumeFWVt.js";import"./RadioGroup-1.0.41-BzP_AWOa.js";import"./Radio-1.0.41-S-npPzGQ.js";import"./Slider-1.0.41-eJAQRlhH.js";import"./visuallyHidden-1.0.41-Dan1xhjv.js";import"./main-1.0.41.js";import"./react-number-format.es-1.0.41-KmyU8zGo.js";const Q=({appId:s,tableStore:d,updateTableSettings:l,setUpdateStatus:r})=>{var n;const p=B(s),c=f.useMemo(()=>{var a,m,u;let e=[];try{e=JSON.parse((u=(m=(a=p==null?void 0:p.app)==null?void 0:a.container)==null?void 0:m[0])==null?void 0:u.cnt_cls)}catch(A){h.error(A)}return e},[]);f.useEffect(()=>{g(C({appDbId:0,appId:s,appName:"",appTitle:"",appType:y.MAP,appCntId:0,appCntSeqNr:0,appDatabase:null,appTable:null,appColumns:c,appRelationTable:null,appRelationColumns:[],appRestApi:{authorization:S.AUTHORIZED,authorized_roles:[],authorized_users:[]},appAddToMenu:!1,appMenuTitle:"",appMetaData:void 0,mapApiKey:o.maps.apiKey,mapColumnLatitude:o.maps.columnLatitude,mapColumnLongitude:o.maps.columnLongitude}))},[]);const g=T(),i=K(),o=d.table;return f.useEffect(()=>{const e={...o.maps};e.apiKey=i.appMap.apiKey,e.columnLatitude=i.appMap.columnLatitude,e.columnLongitude=i.appMap.columnLongitude,l("maps",e)},[i.appMap]),t.jsxs(U,{disableGutters:!0,children:[t.jsx(z,{children:"Enable Map Integration"}),t.jsxs(H,{children:[t.jsxs(b,{fullWidth:!0,sx:{marginBottom:0},children:[t.jsx(N,{control:t.jsx(_,{checked:o.maps.enabled,onChange:e=>{const a={...o.maps};a.enabled=!o.maps.enabled,l("maps",a),e.stopPropagation()}}),label:"Enable"}),t.jsx(M,{component:"div",children:"Enable this feature to add a map to the table header or footer."})]}),((n=o==null?void 0:o.maps)==null?void 0:n.enabled)===!0&&t.jsxs(x,{sx:{display:"grid",gap:"20px",marginTop:"30px"},children:[t.jsxs("fieldset",{className:"pp-fieldset",children:[t.jsx("legend",{children:"Map Configuration"}),t.jsxs(x,{sx:{display:"grid",gap:"30px",marginTop:"5px"},children:[t.jsx(w,{app:i}),t.jsx(x,{sx:{"& .MuiFormHelperText-root > div":{marginBottom:"5px"}},children:t.jsx(P,{app:i})}),t.jsxs(x,{sx:{marginTop:"-10px"},children:[t.jsxs(q,{color:"primary",exclusive:!0,fullWidth:!0,value:"undocked",disabled:!0,onChange:(e,a)=>{const m={...o.maps};m.docked=a,l("maps",m),r(!0),e.stopPropagation()},children:[t.jsxs(j,{value:"top",disabled:d.state.masterDetailConditions!==void 0,children:[t.jsx(D,{})," Header"]}),t.jsxs(j,{value:"bottom",disabled:d.state.masterDetailConditions!==void 0,children:[t.jsx(L,{})," Footer"]}),t.jsxs(j,{value:"undocked",children:[t.jsx(R,{})," Undocked"]})]}),t.jsx(b,{children:t.jsx(M,{children:"Choose where the chart should be positioned: header, footer, or undocked. Charts for detail tables cannot be docked."})})]})]})]}),t.jsx(v,{title:"Some map configuration features require a premium license.",margin:"0"})]})]})]})},Zt=({appId:s})=>{var i,o;h.debug(s);const d=T(),l=k(s),r=F(s),p=G(s),c=(n,e,a)=>{const[m,...u]=e.split(".");return{...n,[m]:u.length?c(n[m],u.join("."),a):a}},g=(n,e)=>{h.debug(n,e);const a=c(r==null?void 0:r.table,n,e);h.debug(a),d(E({appId:s,tableSettings:a})),l(!0)};return t.jsxs(t.Fragment,{children:[t.jsx(Q,{appId:s,tableStore:r,updateTableSettings:g,setUpdateStatus:l}),((o=(i=r==null?void 0:r.table)==null?void 0:i.maps)==null?void 0:o.enabled)===!0&&t.jsxs(t.Fragment,{children:[t.jsx(O,{appId:s,mapSettings:p}),t.jsx(W,{appId:s,mapSettings:p}),t.jsx(J,{appId:s,mapSettings:p,disableRadiusSearch:!0}),t.jsx(Z,{appId:s,mapSettings:p})]})]})};export{Zt as default};
