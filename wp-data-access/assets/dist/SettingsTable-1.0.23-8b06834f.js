import{r as B,j as e,aL as V,ct as Z,aM as ce,l as h,cL as le,cD as q,cE as H,a1 as Y,aT as S,cC as O,cM as ee,cN as X,y as U,C as ue}from"./main-1.0.23.js";import{a as de}from"./RestApi-1.0.23-cc179eb9.js";import{u as pe}from"./useStoreTable-1.0.23-508477d7.js";import{v as y,k as z,f as he}from"./index.esm-1.0.23-ba0465a2.js";import{u as te}from"./useTableUpdater-1.0.23-f1f702eb.js";import{c as xe}from"./index-1.0.23-fea3ac27.js";import{A as k,a as T}from"./AccordionSummary-1.0.23-078f8091.js";import{A}from"./AccordionDetails-1.0.23-ad785ba6.js";import{F as d,a as p}from"./FormHelperText-1.0.23-83597bdf.js";import{R as J}from"./RadioGroup-1.0.23-053476ee.js";import{F as a}from"./FormControlLabel-1.0.23-1ad68af6.js";import{R as L}from"./Radio-1.0.23-7006053b.js";import{S as x}from"./Switch-1.0.23-86b06b05.js";import{B as w}from"./Spinner-1.0.23-90ab83ff.js";import{L as D}from"./Link-1.0.23-48d9bdb4.js";import{D as me,U as je,S as fe}from"./SettingsFormRelationships-1.0.23-07f5e36e.js";import{T as K,S as se}from"./TextField-1.0.23-1657e9d4.js";import{h as ge,i as we}from"./index.esm-1.0.23-da98f1a9.js";import{M as G}from"./MenuItem-1.0.23-0a5da249.js";import{I as be}from"./iconBase-1.0.23-43ac6f06.js";import{M as ve}from"./Menu-1.0.23-e889464a.js";import{u as Ce}from"./useFormStore-1.0.23-90f12904.js";import{P as $}from"./PremiumFeature-1.0.23-8dd1a29b.js";import{A as Ee}from"./AdminTheme-1.0.23-7044caf5.js";import{C as Q}from"./CssUnitTextField-1.0.23-f591a83d.js";import{T as ae,a as N}from"./ToggleButtonGroup-1.0.23-fd9018f0.js";import{L as ye}from"./ListItem-1.0.23-64a79cf3.js";import{C as ke}from"./Autocomplete-1.0.23-a5bc1209.js";import{T as re}from"./Tooltip-1.0.23-1b58a848.js";import{B as ne}from"./CardContent-1.0.23-cd3f2c87.js";import{F as oe}from"./FormLabel-1.0.23-71a056b2.js";import"./Typography-1.0.23-19a0fd3e.js";import"./index-1.0.23-9af490ae.js";import"./useSlot-1.0.23-b9d48820.js";import"./useControlled-1.0.23-1e71c28b.js";import"./Collapse-1.0.23-a92fc278.js";import"./useFormControl-1.0.23-a0ae6ce7.js";import"./createStyled-1.0.23-528f26c2.js";import"./SwitchBase-1.0.23-adccc77c.js";import"./createSvgIcon-1.0.23-f9410a01.js";import"./Modal-1.0.23-3fe42627.js";import"./ComponentColumn-1.0.23-13c86662.js";import"./ActionsExplorer-1.0.23-02905de3.js";import"./ActionsApp-1.0.23-18ccdb55.js";import"./Checkbox-1.0.23-e63c68aa.js";import"./useFormUpdates-1.0.23-2bcf2490.js";import"./FallbackSpinner-1.0.23-96931408.js";import"./Stepper-1.0.23-3d0d410f.js";import"./StepContent-1.0.23-0707671d.js";import"./useTheme-1.0.23-55aea9bb.js";import"./colorManipulator-1.0.23-e382be1d.js";import"./ConfirmDialog-1.0.23-f318040f.js";import"./DialogContent-1.0.23-79893b13.js";import"./ThemeProvider-1.0.23-f3e5cbc1.js";import"./Popover-1.0.23-6c9c65a6.js";import"./Grow-1.0.23-40b2ff68.js";import"./Close-1.0.23-ea28bfa6.js";import"./Popper-1.0.23-4a0d0616.js";const Te=({appId:r,tableSettings:n,metaData:s,updateTableSettings:c})=>{var l,m,F,R,W,_;const t=de(),o=te(r),i=(P,I)=>{const M=xe(n);M.largeTableSupport.saved=P,M.largeTableSupport.actual=I,h.debug(M),t(le({appId:r,tableSettings:M})),o(!0)},[j,g]=B.useState(!1),[C,b]=B.useState(!1),u=((l=s==null?void 0:s.src)==null?void 0:l.dbs)??((F=(m=s==null?void 0:s.app)==null?void 0:m.container[0])==null?void 0:F.cnt_dbs)??"DATABASE",f=((R=s==null?void 0:s.src)==null?void 0:R.tbl)??((_=(W=s==null?void 0:s.app)==null?void 0:W.container[0])==null?void 0:_.cnt_tbl)??"TABLE";return e.jsxs(k,{disableGutters:!0,children:[e.jsx(T,{expandIcon:e.jsx(y,{}),children:"Large table support"}),e.jsxs(A,{children:[e.jsx(d,{children:e.jsxs(J,{sx:{flexDirection:"column"},children:[e.jsx(a,{control:e.jsx(L,{checked:(n==null?void 0:n.largeTableSupport.saved)===V.DISABLED,onChange:P=>{i(V.DISABLED,Z.DISABLED),P.stopPropagation()}}),value:"disable",label:"Disable large table support"},"disable"),e.jsx(a,{control:e.jsx(L,{checked:(n==null?void 0:n.largeTableSupport.saved)===V.ENABLED,onChange:P=>{i(V.ENABLED,Z.ENABLED),P.stopPropagation()}}),value:"enable",label:"Enable large table support"},"enable"),e.jsx(a,{control:e.jsx(L,{checked:(n==null?void 0:n.largeTableSupport.saved)===V.AUTO,onChange:P=>{const I=ce(s);i(V.AUTO,I),P.stopPropagation()}}),value:"auto",label:"Let the server decide (default)"},"auto")]})}),n.largeTableSupport.saved===V.ENABLED&&e.jsxs("fieldset",{className:"pp-fieldset",style:{marginTop:"20px",marginBottom:"40px",padding:"20px"},children:[e.jsx("legend",{children:"Additional settings"}),e.jsxs(d,{fullWidth:!0,children:[e.jsx(a,{control:e.jsx(x,{checked:n.largeTableSupport.skipCount,onChange:(P,I)=>{c("largeTableSupport.skipCount",I),P.stopPropagation()}}),label:"Skip row count on filter updates"}),e.jsx(p,{children:"Skips all SQL count statements. Can boost performance for large tables dramatically. Results in a poorer user feedback."})]})]}),e.jsxs(p,{component:"div",sx:{marginTop:"20px","& ul":{margin:0,padding:"0 0 0 20px"}},children:[e.jsx(w,{children:e.jsxs(D,{sx:{textDecoration:"none",cursor:"pointer",display:"inline-flex","& svg":{fontSize:"1rem",marginRight:"2px"}},onClick:()=>g(!j),children:[e.jsx(z,{}),"What does large table support do?"]})}),j&&e.jsxs("ul",{style:{marginTop:"20px",marginBottom:"30px",listStyle:"disc",padding:"0 40px"},children:[e.jsx("li",{children:"Enables row count estimation"}),e.jsx("li",{children:"Requires the user to press enter on search"}),e.jsx("li",{children:"Sets pagination to compact"}),e.jsx("li",{children:"Removes the last page pagination button"}),e.jsx("li",{children:"Reduces network traffic and server load"})]})]}),e.jsxs(p,{component:"div",sx:{marginBottom:"10px","& ul":{margin:0,padding:"0 0 0 20px"}},children:[e.jsx(w,{children:e.jsxs(D,{sx:{textDecoration:"none",cursor:"pointer",display:"inline-flex","& svg":{fontSize:"1rem",marginRight:"2px"}},onClick:()=>b(!C),children:[e.jsx(z,{}),"Experiencing a slow initial table load? Follow stese steps to improve performance..."]})}),C&&e.jsxs("ol",{style:{marginTop:"20px",marginBottom:"30px",padding:"0 40px"},children:[e.jsxs("li",{children:["Start the ",e.jsx("strong",{children:"Query Builder"})]}),e.jsxs("li",{children:["Select database ",e.jsx("strong",{children:u})]}),e.jsxs("li",{children:["Enter ",e.jsxs("strong",{children:["ANALYZE TABLE ",f]})]}),e.jsx("li",{children:"Press the Execute button"})]})]}),e.jsx(p,{children:"Please reload the table or page after adjusting large table support settings to ensure the correct row count is applied."})]})]})},Ae=({tableSettings:r,updateTableSettings:n})=>{var s,c;return e.jsxs(k,{disableGutters:!0,defaultExpanded:!1,children:[e.jsx(T,{expandIcon:e.jsx(y,{}),children:"Responsiveness"}),e.jsx(A,{children:e.jsxs(d,{children:[e.jsxs(J,{sx:{flexDirection:"row"},children:[e.jsx(a,{control:e.jsx(L,{checked:((s=r==null?void 0:r.design)==null?void 0:s.overflow)===q.RESPONSIVE,onChange:t=>{n("design.overflow",q.RESPONSIVE),t.stopPropagation()}}),value:"responsive",label:"Auto column hiding"},"responsive"),e.jsx(a,{control:e.jsx(L,{checked:((c=r==null?void 0:r.design)==null?void 0:c.overflow)!==q.RESPONSIVE,onChange:t=>{n("design.overflow",q.SCROLL),t.stopPropagation()}}),value:"scroll",label:"Horizontal scrollbar"},"scroll")]}),e.jsx(p,{children:"Behaviour when table content overflows available space."})]})})]})},Pe=({tableSettings:r,updateTableSettings:n})=>e.jsxs(k,{disableGutters:!0,defaultExpanded:!1,children:[e.jsx(T,{expandIcon:e.jsx(y,{}),children:"Density"}),e.jsxs(A,{children:[e.jsxs(d,{children:[e.jsxs(J,{sx:{display:"grid",gridTemplateColumns:"auto auto auto",alignItems:"center"},children:[e.jsx(a,{control:e.jsx(L,{checked:(r==null?void 0:r.design.density.default)===H.COMPACT,onChange:s=>{n("design.density.default",H.COMPACT),s.stopPropagation()}}),value:"compact",label:"Compact"},"compact"),e.jsx(a,{control:e.jsx(L,{checked:(r==null?void 0:r.design.density.default)===H.COMFORTABLE,onChange:s=>{n("design.density.default",H.COMFORTABLE),s.stopPropagation()}}),value:"comfortable",label:"Comfortable"},"comfortable"),e.jsx(a,{control:e.jsx(L,{checked:(r==null?void 0:r.design.density.default)===H.SPACIOUS,onChange:s=>{n("design.density.default",H.SPACIOUS),s.stopPropagation()}}),value:"spacious",label:"Spacious"},"spacious")]}),e.jsx(p,{children:"Default spacing on page load."})]}),e.jsx(d,{fullWidth:!0,sx:{marginTop:"20px"},children:e.jsx(a,{control:e.jsx(x,{checked:r==null?void 0:r.design.density.userCanChange,onChange:(s,c)=>{n("design.density.userCanChange",c),s.stopPropagation()}}),label:"Allow user to change density"})})]})]}),Be=({hasPrimaryKey:r,tableSettings:n,metaData:s,updateTableSettings:c})=>{var i,j,g,C,b,u,f;h.debug(r,n,s);const[t,o]=B.useState(!1);return e.jsxs(k,{disableGutters:!0,children:[e.jsx(T,{expandIcon:e.jsx(y,{}),children:"Row actions"}),e.jsxs(A,{children:[e.jsxs(w,{sx:{display:"grid"},children:[e.jsxs(d,{children:[e.jsx(a,{control:e.jsx(x,{disabled:!((i=s==null?void 0:s.privs)!=null&&i.insert)||!r,checked:(j=n==null?void 0:n.transactions)==null?void 0:j.insert,onChange:(l,m)=>{c("transactions.insert",m),l.stopPropagation()}}),label:"Allow insert"}),e.jsx(p,{children:"Adds an insert button to the table toolbar."})]}),e.jsxs(d,{children:[e.jsx(a,{control:e.jsx(x,{checked:n==null?void 0:n.viewLink,onChange:(l,m)=>{c("viewLink",m),l.stopPropagation()}}),label:"Allow viewing"}),e.jsx(p,{children:"Adds a view icon to each row."})]}),e.jsxs(w,{sx:{display:"grid",gridTemplateColumns:"auto auto",alignItems:"center"},children:[e.jsx(d,{children:e.jsx(a,{control:e.jsx(x,{checked:n==null?void 0:n.detailLink,disabled:((g=n==null?void 0:n.design)==null?void 0:g.overflow)!==q.RESPONSIVE,onChange:(l,m)=>{c("detailLink",m),l.stopPropagation()}}),label:"Allow detail panel viewing"})}),e.jsx(d,{children:e.jsx(a,{control:e.jsx(x,{checked:!1,disabled:!0,onChange:(l,m)=>{c("detailPdf",m),l.stopPropagation()}}),label:"Add PDF export icon"})})]}),e.jsx(d,{children:e.jsxs(p,{children:["Adds an expand icon to each row, allowing users to view columns in a detail panel. This feature only functions when responsiveness is set to auto column hiding.",e.jsx(e.Fragment,{children:"The PDF export is a premium feature."})]})}),e.jsxs(d,{children:[e.jsx(a,{control:e.jsx(x,{disabled:!((C=s==null?void 0:s.privs)!=null&&C.update)||!r,checked:(b=n==null?void 0:n.transactions)==null?void 0:b.update,onChange:(l,m)=>{c("transactions.update",m),l.stopPropagation()}}),label:"Allow update"}),e.jsx(p,{children:"Adds an update icon to each table row."})]}),e.jsxs(d,{children:[e.jsx(a,{control:e.jsx(x,{disabled:!((u=s==null?void 0:s.privs)!=null&&u.delete)||!r,checked:(f=n==null?void 0:n.transactions)==null?void 0:f.delete,onChange:(l,m)=>{c("transactions.delete",m),l.stopPropagation()}}),label:"Allow delete"}),e.jsx(p,{children:"Adds a delete icon to each table row."})]})]}),e.jsxs(p,{component:"div",sx:{marginTop:"30px"},children:[e.jsxs(D,{sx:{textDecoration:"none",cursor:"pointer",display:"inline-flex","& svg":{fontSize:"1rem",marginRight:"2px"}},onClick:()=>o(!t),children:[e.jsx(z,{}),"What are row actions?"]}),t&&e.jsxs(w,{sx:{marginTop:"20px"},children:["Row actions enable users to perform specific actions on individual rows. The ",e.jsx("strong",{children:"view"})," action is always available. To perform transactions such as ",e.jsx("strong",{children:"insert"}),", ",e.jsx("strong",{children:"update"}),", and ",e.jsx("strong",{children:"delete"}),", the server requires a valid primary key. If these actions are not selectable, ensure that your table has a primary key defined. Note that transactions are not available for views."]})]})]})]})},Le=({appId:r,tableSettings:n,metaData:s,updateTableSettings:c})=>{var i,j,g,C,b,u;const[t,o]=B.useState(!1);return e.jsxs(k,{disableGutters:!0,children:[e.jsx(T,{expandIcon:e.jsx(y,{}),children:"Bulk actions"}),e.jsxs(A,{children:[e.jsxs(w,{sx:{display:"grid"},children:[e.jsx(d,{children:e.jsx(a,{control:e.jsx(x,{checked:!1,disabled:!0,onChange:(f,l)=>{f.stopPropagation()}}),label:"Export to PDF (premium feature)"})}),e.jsx(d,{children:e.jsx(a,{control:e.jsx(x,{checked:(i=n==null?void 0:n.bulkActions)==null?void 0:i.csv,onChange:(f,l)=>{c("bulkActions.csv",l),f.stopPropagation()}}),label:"Export to CSV"})}),e.jsx(d,{children:e.jsx(a,{control:e.jsx(x,{checked:(j=n==null?void 0:n.bulkActions)==null?void 0:j.json,onChange:(f,l)=>{c("bulkActions.json",l),f.stopPropagation()}}),label:"Export to JSON"})}),e.jsx(d,{children:e.jsx(a,{control:e.jsx(x,{checked:!1,disabled:!0,onChange:(f,l)=>{f.stopPropagation()}}),label:"Export to Excel (premium feature)"})}),e.jsx(d,{children:e.jsx(a,{control:e.jsx(x,{checked:(g=n==null?void 0:n.bulkActions)==null?void 0:g.xml,onChange:(f,l)=>{c("bulkActions.xml",l),f.stopPropagation()}}),label:"Export to XML"})}),e.jsx(d,{children:e.jsx(a,{control:e.jsx(x,{checked:!Y(r)&&!S(s)&&((C=n==null?void 0:n.bulkActions)==null?void 0:C.sql),disabled:Y(r)||S(s),onChange:(f,l)=>{Y(r)||c("bulkActions.sql",l),f.stopPropagation()}}),label:"Export to SQL"})}),e.jsx(d,{children:e.jsx(a,{control:e.jsx(x,{checked:(b=n==null?void 0:n.bulkActions)==null?void 0:b.delete,disabled:!((u=s==null?void 0:s.privs)!=null&&u.delete),onChange:(f,l)=>{c("bulkActions.delete",l),f.stopPropagation()}}),label:"Delete"})}),e.jsx(d,{children:e.jsx(p,{children:"Added to BULK ACTIONS button."})})]}),e.jsxs(p,{component:"div",sx:{marginTop:"30px"},children:[e.jsxs(D,{sx:{textDecoration:"none",cursor:"pointer",display:"inline-flex","& svg":{fontSize:"1rem",marginRight:"2px"}},onClick:()=>o(!t),children:[e.jsx(z,{}),"What are bulk actions?"]}),t&&e.jsx(w,{sx:{marginTop:"20px"},children:"Bulk actions allow users to perform tasks on multiple rows simultaneously. Enabling this feature requires selecting at least one bulk action. Once enabled, row selection is added to the table, and a bulk actions button is included in the toolbar."})]})]})]})},Fe=({tableSettings:r,updateTableSettings:n})=>e.jsxs(k,{disableGutters:!0,children:[e.jsx(T,{expandIcon:e.jsx(y,{}),children:"Default where"}),e.jsx(A,{children:e.jsxs(d,{fullWidth:!0,children:[e.jsx(K,{value:r==null?void 0:r.defaultWhere,multiline:!0,fullWidth:!0,minRows:5,variant:"outlined",onClick:s=>{s.stopPropagation()},onChange:s=>{n("defaultWhere",s.target.value)}}),e.jsx(me,{})]})})]}),ie=({tableColumns:r,orderByColumn:n,addActions:s,enableAddAction:c,onUpdate:t,onActions:o})=>{h.debug(r,n,s,c);const[i,j]=B.useState(null),g=!!i,C=u=>{j(u.currentTarget),u.stopPropagation()},b=()=>{j(null)};return e.jsxs(w,{sx:{display:"grid",gridTemplateColumns:s?"auto 100px 50px":"auto 100px",gridGap:"5px",marginBottom:"5px"},children:[e.jsxs(se,{MenuProps:{id:"pp-select-menu"},value:n.columnName,onChange:u=>{t({...n,columnName:u.target.value})},children:[e.jsx(G,{value:"",children:" "}),...r.map(u=>u.computedField!==void 0?null:e.jsx(G,{value:u.columnName,children:u.columnName}))]}),e.jsxs(se,{MenuProps:{id:"pp-select-menu"},value:n.order,onChange:u=>{t({...n,order:u.target.value==="desc"?"desc":"asc"})},children:[e.jsx(G,{value:"asc",children:"Asc"}),e.jsx(G,{value:"desc",children:"Desc"})]}),s&&e.jsxs(e.Fragment,{children:[e.jsx(be,{color:"primary",onClick:C,children:e.jsx(he,{})}),e.jsxs(ve,{anchorEl:i,open:g,onClose:b,sx:{zIndex:9999999999},anchorOrigin:{vertical:"top",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"left"},children:[c&&e.jsxs(G,{onClick:()=>{o("add"),b()},children:[e.jsx(ge,{}),e.jsx("span",{style:{marginLeft:"10px"},children:"Add column"})]}),e.jsxs(G,{onClick:()=>{o("delete"),b()},children:[e.jsx(we,{}),e.jsx("span",{style:{marginLeft:"10px"},children:"Delete column"})]})]})]})]})},Oe=({tableSettings:r,tableColumns:n,updateTableSettings:s})=>{const[c,t]=B.useState(r.defaultOrderBy.length===0);return e.jsxs(k,{disableGutters:!0,children:[e.jsx(T,{expandIcon:e.jsx(y,{}),children:"Default order by"}),e.jsxs(A,{children:[Array.isArray(r.defaultOrderBy)&&e.jsxs(e.Fragment,{children:[...r.defaultOrderBy.map((o,i)=>e.jsx(ie,{tableColumns:n,orderByColumn:r.defaultOrderBy[i],addActions:!0,enableAddAction:r.defaultOrderBy.length===i+1&&!c,onUpdate:j=>{const g=[...r.defaultOrderBy];g[i]=j,s("defaultOrderBy",g)},onActions:j=>{if(j==="add")t(!0);else if(j==="delete"){const g=[...r.defaultOrderBy];g.splice(i,1),s("defaultOrderBy",g),t(g.length===0)}}},i))]}),c&&e.jsx(ie,{tableColumns:n,orderByColumn:{columnName:"",order:"asc"},addActions:r.defaultOrderBy.length>0,enableAddAction:!1,onUpdate:o=>{const i=[...r.defaultOrderBy];i.push({columnName:o.columnName,order:o.order}),s("defaultOrderBy",i),t(!1)},onActions:o=>{o==="delete"&&t(!1)}}),e.jsx(d,{fullWidth:!0,children:e.jsx(p,{children:"Defines the default ordering. The user can change the default ordering if sorting is enabled for one or more columns."})})]})]})},Re=({tableStore:r,updateTableSettings:n})=>{var C,b,u,f,l,m,F,R,W,_,P,I,M;const s=r.table,t=r.state.masterDetailConditions!==void 0,[o,i]=B.useState(!1),[j,g]=B.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsxs(k,{disableGutters:!0,defaultExpanded:!1,children:[e.jsx(T,{expandIcon:e.jsx(y,{}),children:"Global filter"}),e.jsxs(A,{children:[e.jsxs(w,{children:[e.jsxs(d,{fullWidth:!0,children:[e.jsx(a,{control:e.jsx(x,{checked:(C=s==null?void 0:s.searchSettings)==null?void 0:C.enableGlobalSearch,disabled:!0,onChange:(v,E)=>{h.debug(E),v.stopPropagation()}}),label:"Enable global filter"}),e.jsx(p,{children:"Adds a search box to the table header."})]}),e.jsxs(d,{fullWidth:!0,children:[e.jsx(a,{control:e.jsx(x,{checked:(b=s==null?void 0:s.searchSettings)==null?void 0:b.forceSearch,disabled:!0,onChange:(v,E)=>{h.debug(E),v.stopPropagation()}}),label:"Show empty table on startup"}),e.jsx(p,{children:"Forces user to perform a search on page load."})]}),e.jsxs(d,{fullWidth:!0,children:[e.jsx(a,{control:e.jsx(x,{checked:(u=s==null?void 0:s.searchSettings)==null?void 0:u.highlightMatches,disabled:!0,onChange:(v,E)=>{h.debug(E),v.stopPropagation()}}),label:"Highlight matches"}),e.jsx(p,{children:"Filter match highlighting."})]})]}),e.jsxs(p,{component:"div",sx:{marginTop:"30px"},children:[e.jsxs(D,{sx:{textDecoration:"none",cursor:"pointer",display:"inline-flex","& svg":{fontSize:"1rem",marginRight:"2px"}},onClick:()=>i(!o),children:[e.jsx(z,{}),"What is a global filter?"]}),o&&e.jsx(w,{sx:{marginTop:"20px"},children:"The global filter enables users to perform wildcard searches across all searchable columns. It can be disabled entirely or selectively for specific columns. To disable the global filter for specific columns, navigate to the Table Builder's columns menu and deselect the searchable option."})]}),e.jsx($,{single:!1})]})]}),e.jsxs(k,{disableGutters:!0,defaultExpanded:!1,children:[e.jsx(T,{expandIcon:e.jsx(y,{}),children:"Column filters"}),e.jsxs(A,{children:[e.jsxs(d,{fullWidth:!0,children:[e.jsx(a,{control:e.jsx(x,{checked:(f=s==null?void 0:s.searchSettings)==null?void 0:f.searchForm,disabled:!0,onChange:(v,E)=>{h.debug(E),v.stopPropagation()}}),label:"Enable column filters"}),e.jsx(p,{children:"Disable to hide all column filters."})]}),((l=s==null?void 0:s.searchSettings)==null?void 0:l.searchForm)===!0&&e.jsxs(e.Fragment,{children:[e.jsxs(d,{fullWidth:!0,children:[e.jsx(a,{control:e.jsx(x,{checked:((m=s==null?void 0:s.searchSettings)==null?void 0:m.searchFormAlwaysOpen)||((F=s==null?void 0:s.searchSettings)==null?void 0:F.forceInline),disabled:!0,onChange:(v,E)=>{h.debug(E),v.stopPropagation()}}),label:"Show column filters on startup"}),e.jsx(p,{children:"Effective after next page load."})]}),e.jsxs(d,{fullWidth:!0,children:[e.jsx(a,{control:e.jsx(x,{checked:(R=s==null?void 0:s.searchSettings)==null?void 0:R.searchFormAlwaysOpen,disabled:!0,onChange:(v,E)=>{h.debug(E),v.stopPropagation()}}),label:"Always show column filters"}),e.jsx(p,{children:"Disables the user's possibility to toggle column filtering."})]}),e.jsxs(d,{fullWidth:!0,children:[e.jsx(a,{control:e.jsx(x,{checked:(W=s==null?void 0:s.searchSettings)==null?void 0:W.cascade,disabled:!0,onChange:(v,E)=>{h.debug(E),v.stopPropagation()}}),label:"Cascade drop-down lists"}),e.jsxs(p,{children:["Updates drop-down lists on search changes. ",e.jsx("span",{style:{...((_=s==null?void 0:s.searchSettings)==null?void 0:_.cascade)===!0&&{color:((I=(P=Ee)==null?void 0:P.palette)==null?void 0:I.error.main)??"red"}},children:"Enabling this feature may negatively impact performance, increase server load, and generate additional network traffic."})]})]}),e.jsx(w,{sx:{marginTop:"20px"},children:e.jsxs(d,{fullWidth:!0,children:[e.jsxs(ae,{fullWidth:!0,color:"primary",exclusive:!0,value:t?O.HEADER:(M=s==null?void 0:s.searchSettings)==null?void 0:M.searchFormPosition,onChange:(v,E)=>{v.stopPropagation()},children:[e.jsx(N,{value:O.TOP,disabled:t,children:"Above"},O.TOP),e.jsx(N,{value:O.RIGHT,disabled:t,children:"Right"},O.RIGHT),e.jsx(N,{value:O.BOTTOM,disabled:t,children:"Below"},O.BOTTOM),e.jsx(N,{value:O.LEFT,disabled:t,children:"Left"},O.LEFT),e.jsx(N,{value:O.HEADER,children:"Header"},O.HEADER)]}),e.jsx(p,{children:"Position of the column filters relative to the data table."})]})}),e.jsxs(w,{sx:{marginTop:"30px","& .MuiFormControl-root":{width:"100%"}},children:[e.jsx(Q,{label:"Column filters width",textField:{cssValue:s==null?void 0:s.searchSettings.searchFormWidth,cssUnit:s==null?void 0:s.searchSettings.searchFormWidthUnit},defaultValue:{cssValue:ee.searchFormWidth,cssUnit:ee.searchFormWidthUnit},updateSettings:v=>{h.debug(v)}}),e.jsx(d,{children:e.jsx(p,{children:"Exact filter width if column filters position is LEFT or RIGHT. Minimum filter width if column filters position is ABOVE or BELOW. Does not affect column filters width in HEADER."})})]})]}),e.jsxs(p,{component:"div",sx:{marginTop:"30px"},children:[e.jsxs(D,{sx:{textDecoration:"none",cursor:"pointer",display:"inline-flex","& svg":{fontSize:"1rem",marginRight:"2px"}},onClick:()=>g(!j),children:[e.jsx(z,{}),"What are column filters?"]}),j&&e.jsx(w,{sx:{marginTop:"20px"},children:"Column filters empower users to search within specific columns. You can activate these filters from the Table Builder's columns menu. Click on a column, open column actions, enable column filtering, and choose your preferred filter type."})]})]})]})]})},We=({tableSettings:r,updateTableSettings:n})=>{const[s,c]=B.useState(void 0),t=o=>()=>{const i=r.pagination.rowsPerPage.filter(j=>j!==o);n("pagination.rowsPerPage",i)};return e.jsxs(k,{disableGutters:!0,children:[e.jsx(T,{expandIcon:e.jsx(y,{}),children:"Pagination"}),e.jsxs(A,{children:[e.jsxs(d,{fullWidth:!0,sx:{marginBottom:"30px"},children:[e.jsxs(ae,{fullWidth:!0,color:"primary",exclusive:!0,value:r.pagination.position,onChange:(o,i)=>{i!==null&&n("pagination.position",i)},children:[e.jsx(N,{value:"bottom",children:"bottom"}),e.jsx(N,{value:"top",children:"top"}),e.jsx(N,{value:"both",children:"both"})]}),e.jsx(p,{children:"Pagination position."})]}),e.jsx(K,{fullWidth:!0,type:"number",label:"Default page size",value:r.pagination.defaultPageSize,disabled:!0,onChange:o=>{h.debug(o)},sx:{marginBottom:"30px"},helperText:"Effective after next table load."}),e.jsxs("fieldset",{className:"pp-fieldset",style:{width:"100%",margin:0,padding:0,marginBottom:"30px"},children:[e.jsx(d,{sx:{marginBottom:"10px"},children:e.jsx(p,{children:"Rows per page"})}),e.jsx(w,{sx:{width:"100%",display:"grid",gridTemplateColumns:"repeat(4, 25%)",justifyContent:"center",alignItems:"center",margin:0,padding:0,"& li":{margin:"0 10px 10px 10px",padding:0},"& li .MuiChip-label":{width:"40px",textAlign:"right",overflow:"visible"}},component:"ul",children:r.pagination.rowsPerPage.map((o,i)=>e.jsx(ye,{children:e.jsx(ke,{disabled:!0,label:o,onDelete:t(o)})},i))}),e.jsx(d,{fullWidth:!0,children:e.jsx(p,{children:"Click the delete icon to remove a value or add a new values below."})}),e.jsxs(w,{sx:{margin:"10px",display:"grid",gridTemplateColumns:"auto auto auto",gap:"5px"},children:[e.jsx(K,{type:"number",label:"New value",value:s??"",disabled:!0,onChange:o=>{h.debug(o)}}),e.jsx(re,{title:"Add new value to list",children:e.jsx("span",{children:e.jsx(ne,{color:"primary",variant:"contained",disabled:!0,onClick:()=>{},children:"Add"})})}),e.jsx(re,{title:"Reset to default values",children:e.jsx("span",{children:e.jsx(ne,{color:"primary",variant:"outlined",disabled:!0,onClick:()=>{},children:"Reset"})})})]})]}),e.jsx(d,{fullWidth:!0,children:e.jsx(a,{control:e.jsx(x,{disabled:!0,checked:r.pagination.showFirstButton,onChange:(o,i)=>{h.debug(o,i)}}),label:"Show first button"})}),e.jsxs(d,{fullWidth:!0,children:[e.jsx(a,{control:e.jsx(x,{disabled:!0,checked:r.pagination.showLastButton&&(r.largeTableSupport.actual===Z.DISABLED||r.largeTableSupport.skipCount===!1),onChange:(o,i)=>{h.debug(o,i)}}),label:"Show last button"}),e.jsx(p,{children:"By default disabled with large table support and row count skipping."})]}),e.jsxs(d,{fullWidth:!0,children:[e.jsx(a,{control:e.jsx(x,{disabled:!0,checked:r.pagination.showCompactButtons||r.largeTableSupport.actual===Z.ENABLED,onChange:(o,i)=>{h.debug(o,i)}}),label:"Show compact buttons"}),e.jsx(p,{children:"By default enabled when large table support is enabled."})]}),e.jsx($,{single:!1})]})]})},Ie=({tableSettings:r,updateTableSettings:n})=>e.jsxs(k,{sx:{display:"none"},disableGutters:!0,children:[e.jsx(T,{expandIcon:e.jsx(y,{}),children:"Processing"}),e.jsx(A,{children:e.jsxs(d,{children:[e.jsxs(J,{sx:{flexDirection:"row"},children:[e.jsx(a,{control:e.jsx(L,{checked:(r==null?void 0:r.processing)===X.SERVERSIDE,onChange:s=>{n("processing",X.SERVERSIDE),s.stopPropagation()}}),value:"serverside",label:"Server-side"},"serverside"),e.jsx(a,{control:e.jsx(L,{checked:(r==null?void 0:r.processing)===X.CLIENTSIDE,onChange:s=>{n("processing",X.CLIENTSIDE),s.stopPropagation()}}),value:"clientside",label:"Client-side"},"clientside")]}),e.jsx(p,{children:"Use server-side for large tables and views, use client-side for quick analyses of small tables and views"})]})})]}),Ue=({tableSettings:r,tableColumns:n,metaData:s,updateTableSettings:c})=>{var t;return!((t=s==null?void 0:s.privs)!=null&&t.update)||s.primary_key.length===0||(n==null?void 0:n.filter(o=>o.inlineEditing===!0).length)===0?null:e.jsxs(k,{defaultExpanded:!1,disableGutters:!0,children:[e.jsx(T,{expandIcon:e.jsx(y,{}),children:"Inline editing settings"}),e.jsxs(A,{sx:{display:"grid"},children:[e.jsxs(w,{component:"fieldset",sx:{border:"1px solid #ddd",borderRadius:"4px",marginInline:"0 !important",padding:"20px","& legend":{textAlign:"left",color:"rgba(0, 0, 0, 0.6)"},marginBottom:"30px"},children:[e.jsx("legend",{children:"Save"}),e.jsxs(J,{sx:{display:"grid",justifyContent:"start",alignItems:"center"},children:[e.jsxs(oe,{sx:{cursor:"pointer",whiteSpace:"nowrap"},children:[e.jsx(L,{checked:r.inlineEditing.addColumnButton===!0,onChange:o=>{c("inlineEditing.addColumnButton",!0),o.stopPropagation()}}),"Add inline icon buttons to columns"]}),e.jsxs(oe,{sx:{cursor:"pointer",whiteSpace:"nowrap"},children:[e.jsx(L,{checked:r.inlineEditing.addColumnButton!==!0,onChange:o=>{c("inlineEditing.addColumnButton",!1),o.stopPropagation()}}),"Add save button to table header"]})]})]}),e.jsxs(d,{children:[e.jsxs(w,{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"8px",marginBottom:"10px"},children:[e.jsx(Q,{label:"Padding top",textField:{cssValue:r.inlineEditing.spacing.fieldTop,cssUnit:r.inlineEditing.spacing.fieldTopUnit},defaultValue:{cssValue:U.table.inlineEditing.spacing.fieldTop,cssUnit:U.table.inlineEditing.spacing.fieldTopUnit},updateSettings:o=>{h.debug(o)}}),e.jsx(Q,{label:"Padding bottom",textField:{cssValue:r.inlineEditing.spacing.fieldBottom,cssUnit:r.inlineEditing.spacing.fieldBottomUnit},defaultValue:{cssValue:U.table.inlineEditing.spacing.fieldBottom,cssUnit:U.table.inlineEditing.spacing.fieldBottomUnit},updateSettings:o=>{h.debug(o)}}),e.jsx(Q,{label:"Padding left",textField:{cssValue:r.inlineEditing.spacing.fieldLeft,cssUnit:r.inlineEditing.spacing.fieldLeftUnit},defaultValue:{cssValue:U.table.inlineEditing.spacing.fieldLeft,cssUnit:U.table.inlineEditing.spacing.fieldLeftUnit},updateSettings:o=>{h.debug(o)}}),e.jsx(Q,{label:"Padding right",textField:{cssValue:r.inlineEditing.spacing.fieldRight,cssUnit:r.inlineEditing.spacing.fieldRightUnit},defaultValue:{cssValue:U.table.inlineEditing.spacing.fieldRight,cssUnit:U.table.inlineEditing.spacing.fieldRightUnit},updateSettings:o=>{h.debug(o)}})]}),e.jsx(p,{children:"Space added to inline fields."})]}),e.jsx($,{single:!1})]})]})},Ne=({tableSettings:r,updateTableSettings:n})=>e.jsxs(k,{disableGutters:!0,children:[e.jsx(T,{expandIcon:e.jsx(y,{}),children:"Column actions"}),e.jsx(A,{children:e.jsxs(d,{children:[e.jsx(a,{control:e.jsx(x,{checked:!1,disabled:!0,onChange:(s,c)=>{n("enableColumnHiding",c),s.stopPropagation()}}),label:"Enable column hiding"}),e.jsx(p,{children:"Allow user to show | hide columns."})]})})]}),Me=({tableSettings:r,updateTableSettings:n})=>e.jsxs(k,{disableGutters:!0,children:[e.jsx(T,{expandIcon:e.jsx(y,{}),children:"Charts"}),e.jsx(A,{children:e.jsxs(d,{fullWidth:!0,children:[e.jsx(a,{control:e.jsx(x,{checked:r.charts.enabled,onChange:s=>{n("charts.enabled",!r.charts.enabled),s.stopPropagation()}}),label:"Enable chart support"}),e.jsxs(p,{component:"div",children:["Enabling this feature allows users to create charts directly from table data, with the option to dock the charts at the top or bottom of the table. Chart settings cannot be saved yet, but this functionality will be available soon.",e.jsx("br",{}),e.jsx("br",{}),e.jsx(w,{sx:{color:"#000"},children:e.jsx("strong",{children:"Please note, this feature is currently in beta."})})]})]})})]}),Ds=({appId:r,metaData:n})=>{h.debug(r);const s=de(),c=te(r),t=pe(r),o=t==null?void 0:t.table,i=t==null?void 0:t.columns,j=Ce(r),g=B.useMemo(()=>i.filter(l=>l.computedField!==void 0),[i]);h.debug("storeColumnSettings",g);const C=B.useMemo(()=>{const l=i.map(m=>m.columnName);return h.debug(l),n.primary_key.length>0&&n.primary_key.filter(m=>l.includes(m)).length===n.primary_key.length},[i,n.primary_key]);h.debug("hasPrimaryKey",C);const b=(l,m,F)=>{const[R,...W]=m.split(".");return{...l,[R]:W.length?b(l[R],W.join("."),F):F}},u=(l,m)=>{h.debug(l,m);const F=b(o,l,m);h.debug(F),s(le({appId:r,tableSettings:F})),c(!0)},f=je(r);return B.useEffect(()=>{var l;(j.state.details===void 0||((l=j.state.details)==null?void 0:l.length)===0)&&Y(r)&&f(n,()=>{h.error("Error updating detail containers from Table Builder"),h.error(ue.contactSupport)})},[r]),e.jsxs(e.Fragment,{children:[e.jsx(fe,{appId:r,updateSettings:()=>{c(!0)}}),e.jsx(Te,{appId:r,tableSettings:o,metaData:n,updateTableSettings:u}),e.jsx(Me,{tableSettings:o,updateTableSettings:u}),e.jsx(We,{tableSettings:o,updateTableSettings:u}),e.jsx(Re,{tableStore:t,updateTableSettings:u}),e.jsx(Ie,{tableSettings:o,updateTableSettings:u}),e.jsx(Be,{hasPrimaryKey:C,tableSettings:o,metaData:n,updateTableSettings:u}),e.jsx(Ne,{tableSettings:o,updateTableSettings:u}),e.jsx(Le,{appId:r,tableSettings:o,metaData:n,updateTableSettings:u}),Y(r)&&e.jsxs(e.Fragment,{children:[e.jsx(Fe,{tableSettings:o,updateTableSettings:u}),e.jsx(Oe,{tableSettings:o,tableColumns:i,updateTableSettings:u})]}),e.jsx(Ae,{tableSettings:o,updateTableSettings:u}),e.jsx(Pe,{tableSettings:o,updateTableSettings:u}),e.jsx(Ue,{tableSettings:o,updateTableSettings:u,tableColumns:i,metaData:n})]})};export{Ds as default};
