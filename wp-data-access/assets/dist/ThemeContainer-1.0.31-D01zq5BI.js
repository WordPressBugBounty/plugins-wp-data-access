const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./TableContainer-1.0.31-D5nXSZNu.js","./cm-1.0.31-BzgG35ZX.js","./redux-1.0.31-CuzmJMK6.js","./vendor-1.0.31-BmpNFhoq.js","./AdminTheme-1.0.31-QbwKcRV7.js","./Typography-1.0.31-BdhCS1KD.js","./lib-1.0.31-BbX3jq4e.js","./loglevel-1.0.31-BZ7XahX3.js","./lodash-1.0.31-BtCjXqrS.js","./moment-1.0.31-C5S46NFB.js","./main-1.0.31.js","./notistack-1.0.31-CuGQWCbt.js","./tanstack-1.0.31-DxTNlTkm.js","./FallbackSpinner-1.0.31-B4qqxHwC.js","./Spinner-1.0.31-Be7r01J6.js","./RestApi-1.0.31-C4KxgDIV.js","./ActionsSettings-1.0.31-Cf56Toxs.js","./TargetEnum-1.0.31-DPFnTxiX.js","./ConfirmDialog-1.0.31-bZDmgpd0.js","./iconBase-1.0.31-C37NsRUm.js","./cjs-1.0.31-B-_HdexB.js","./DialogContent-1.0.31-_6ykng6a.js","./ConfirmDialog-1.0.31--D4jr2go.css","./ScopeEnum-1.0.31-B4DDvIDj.js","./index-1.0.31-ujFQUobk.js","./TabPanel-1.0.31-CQFpWPRX.js","./useTableUpdater-1.0.31-BVeL37Z7.js","./settings-1.0.31-zyRrYuee.js","./Menu-1.0.31-BOTBPSPr.js","./MenuItem-1.0.31-CTowyoSp.js","./settings-1.0.31-Bx2jvYL6.css","./useTheme-1.0.31-BXg8i2QZ.js","./index-1.0.31-DboOrfK9.js","./Row-1.0.31-O8EicBOa.js","./useStoreTable-1.0.31-CksmwD3u.js","./ActionsDml-1.0.31-DnIQKtBi.js","./useScreenSize-1.0.31-DKas25yF.js","./dompurify-1.0.31-CCJo14B2.js","./Tooltip-1.0.31-crORCg22.js","./Popper-1.0.31-QmfursjS.js","./useControlled-1.0.31-27-LkxG9.js","./Alert-1.0.31-CW3F7gbN.js","./AlertTitle-1.0.31-Zosaacrw.js","./createSvgIcon-1.0.31-BC4iq9Gi.js","./Close-1.0.31-BTPwVQpD.js","./Settings-1.0.31-BB3LonPi.js","./useFormStore-1.0.31-DLiNtGR5.js","./TableChartDock-1.0.31-Bkdf9QFU.js","./Chart-1.0.31-BJ9n7v4e.js"])))=>i.map(i=>d[i]);
import{j as t}from"./cm-1.0.31-BzgG35ZX.js";import{_ as te}from"./main-1.0.31.js";import{r as l}from"./redux-1.0.31-CuzmJMK6.js";import{l as o,P as $t,K as U,L as ft,v as Gt,M as Jt,N as me,S as ee,O as Te,Q as Ke,T as Ie,U as fe,V as Qt,W as Ee,X as et,Y as Xt,Z as ge,_ as Me,$ as xe,a0 as qt,A as Fe,b as Zt,a1 as Re,a2 as gt,a3 as Kt,d as It,a4 as en,a5 as tn,a6 as nn,a7 as sn,a8 as on}from"./lib-1.0.31-BbX3jq4e.js";import{u as ne,a as xt}from"./RestApi-1.0.31-C4KxgDIV.js";import{B as w,S as Se}from"./Spinner-1.0.31-Be7r01J6.js";import{a as rn,T as ht}from"./AdminTheme-1.0.31-QbwKcRV7.js";import{u as we}from"./useStoreTable-1.0.31-CksmwD3u.js";import{s as ln,u as tt,i as nt}from"./ActionsDml-1.0.31-DnIQKtBi.js";import{e as k}from"./notistack-1.0.31-CuGQWCbt.js";import{u as Oe,A as an,a as ke,r as cn,b as pt,c as pe,d as _t,R as un,C as dn,e as mn,D as W,B as fn,f as gn,g as xn,h as hn}from"./useTheme-1.0.31-BXg8i2QZ.js";import"./moment-1.0.31-C5S46NFB.js";import{G as pn,A as jt,T as bt,H as st,I as ot,B as ce,e as vt,M as Tt,F as _n}from"./cjs-1.0.31-B-_HdexB.js";import{u as jn}from"./useScreenSize-1.0.31-DKas25yF.js";import"./dompurify-1.0.31-CCJo14B2.js";import{g as bn}from"./vendor-1.0.31-BmpNFhoq.js";import{P as rt,I as de}from"./iconBase-1.0.31-C37NsRUm.js";import{F as ye}from"./FallbackSpinner-1.0.31-B4qqxHwC.js";import{T as it}from"./Tooltip-1.0.31-crORCg22.js";const Ce=e=>{const r=ne(m=>{var a,h;return(h=(a=m.forms[e])==null?void 0:a.state)==null?void 0:h.data});return o.debug("data",r,e),r};var _e=(e=>(e[e.SELECT=0]="SELECT",e[e.INSERT=1]="INSERT",e[e.UPDATE=2]="UPDATE",e[e.DELETE=3]="DELETE",e[e.EXPORT=4]="EXPORT",e[e.IMPORT=5]="IMPORT",e[e.VIEW=6]="VIEW",e))(_e||{});l.lazy(()=>te(()=>import("./TableContainer-1.0.31-D5nXSZNu.js").then(e=>e.T),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32]),import.meta.url));l.lazy(()=>te(()=>import("./TableContainer-1.0.31-D5nXSZNu.js").then(e=>e.T),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32]),import.meta.url));const Et=e=>4,vn=e=>{const r=ne(m=>{var a;return((a=m.forms[e])==null?void 0:a.columns)??[]});return o.debug("storeColumns",r),r},lt=e=>{const r=ne(m=>m.forms[e]!==void 0?m.forms[e].columns.filter(a=>a.more).length>0:!1);return o.debug("hasMoreColumns",r),r},Tn=e=>{const r=ne(m=>{var a,h;return((h=(a=m.forms[e])==null?void 0:a.state)==null?void 0:h.more)??!1});return o.debug("moreState",r),r},En=e=>{const r=ne(m=>{var a,h;return(h=(a=m.forms[e])==null?void 0:a.state)==null?void 0:h.initialData});return o.debug("initialData",r),r},yn=l.lazy(()=>te(()=>import("./Row-1.0.31-O8EicBOa.js"),__vite__mapDeps([33,10,1,2,3,11,6,7,8,9,15,31,32,5,20,19,14,4,34,35,36,37,13,38,39,40]),import.meta.url)),Fn=({appId:e,metaData:r,primaryKey:m,formMode:a,formUuid:h})=>{var d;o.debug(e,r,m,a,h);const O=ke(),b=Oe(e),T=Ce(e),R=En(e);return t.jsx("form",{id:h,className:"pp-form-content",onSubmit:c=>(c.preventDefault(),!1),children:t.jsx(w,{className:"pp-form-grid",sx:{display:"grid",gridTemplateColumns:{lg:`repeat(${O.cellsPerRow}, 1fr)`,md:"repeat("+Math.min(O.cellsPerRow,2)+", 1fr)",xs:"1fr"},gap:"30px",marginBottom:0,background:O.showGrid?((d=an)==null?void 0:d.palette.mode)===$t.LIGHT?"repeating-linear-gradient( -45deg, transparent, transparent 10px, #eee 10px, #eee 20px )":"repeating-linear-gradient( -45deg, transparent, transparent 10px, #111 10px, #111 20px )":"","& p.MuiFormHelperText-root":{...a===U.VIEW&&!0&&{display:"none"}}},children:t.jsx(l.Suspense,{fallback:t.jsx(Se,{}),children:t.jsx(yn,{appId:e,metaData:r,data:T,initialData:R,primaryKey:m,formMode:a,formSettings:O,language:b.language})})})})},Rn=e=>({}),Cn=e=>{const r=ne(m=>{var a,h;return((h=(a=m.forms[e])==null?void 0:a.state)==null?void 0:h.m2mUpdate)??!1});return o.debug("m2mUpdate",r),r},Mn=({code:e,safeMode:r,isExpression:m,args:a})=>{const h=ft(e,r,m,a);return window.jQuery&&h instanceof window.jQuery&&h.html(),null};var Sn=cn();const he=bn(Sn),at=l.lazy(()=>te(()=>import("./Alert-1.0.31-CW3F7gbN.js"),__vite__mapDeps([41,1,2,3,24,19,5,6,7,8,9,42,43,44]),import.meta.url)),ct=({appId:e,primaryKey:r,formMode:m,showTable:a,showForm:h,detailKey:O,children:b,relationAppId:T,relTab:R,joinTab:L,isEmbedded:d,masterAppId:c,isModal:P})=>{var Ae,He,We,Ye,ze,$e;o.debug(e,r,m,O,T,R,L,d,c,P);const F=xt(),V=l.useRef(null),se=vn(e),_=pt(e),oe=Et(),N=we(e),Y=Rn(),X=Oe(e),[z,re]=l.useState(m),H=l.useMemo(()=>Gt(),[]),[$,G]=l.useState(!1),[q,je]=l.useState(""),s=pe(e),Z=Ce(e),C=Jt((Ae=s==null?void 0:s.app)==null?void 0:Ae.container[0]),j=Cn(e),y=pe(c??""),J=Ce(c??""),Q=_t(e),[ie,be]=l.useState(null);l.useEffect(()=>{o.debug(j,e),j===!0&&(o.debug("setM2MUpdate: false"),ue(!1,()=>{},()=>{},()=>{F(Ke({appId:e,update:!1}))}))},[j]),l.useEffect(()=>{r===null?Ft():Object.keys(r).length>0?yt():G(!0)},[r]);const yt=()=>{ln(e,r,s==null?void 0:s.media,n=>{if(o.debug(n),(n==null?void 0:n.code)==="ok"){if(Array.isArray(n.data)&&n.data.length>0){const u={...n.data[0]},p={...n.context};delete p.debug,F(Te({appId:e,data:u,context:p})),n.data.length>1?be("Query returned more than one row. Check configuration."):be(null)}else{const u={...n.context};delete u.debug,F(Te({appId:e,data:{},context:u})),be("Invalid primary key. Check configuration.")}G(!0)}else k(_.invalidResponse,{variant:"error"})},n=>{o.error("error",n),je(n??_.invalidResponse)},!1,R)},Ft=()=>{var n,u;if(s.columns&&Array.isArray(s.columns)){const p={},E=me.getSelectors().selectFormColumns(ee.getState().forms,e),i=Object.fromEntries(E.map(x=>[x.columnName,x.defaultValue]));o.debug("defaultValues",i);for(let x=0;x<s.columns.length;x++)p[s.columns[x].column_name]=null,i[s.columns[x].column_name]!==void 0&&(i[s.columns[x].column_name]==="@wpda_wp_user_id"?p[s.columns[x].column_name]=(u=(n=s==null?void 0:s.settings)==null?void 0:n.env)==null?void 0:u.id:i[s.columns[x].column_name]==="@now"?s.columns[x]==="date"?p[s.columns[x].column_name]=he(Date.now()).format("YYYY-MM-DD"):p[s.columns[x].column_name]=he(Date.now()).format("YYYY-MM-DD HH:mm:ss"):s.columns[x].column_default!==null&&s.columns[x].column_default!=="NULL"&&s.columns[x].column_default!==""?s.columns[x].column_default==="CURRENT_TIMESTAMP"?s.columns[x]==="date"?p[s.columns[x].column_name]=he(Date.now()).format("YYYY-MM-DD"):p[s.columns[x].column_name]=he(Date.now()).format("YYYY-MM-DD HH:mm:ss"):p[s.columns[x].column_name]=s.columns[x].column_default:p[s.columns[x].column_name]=i[s.columns[x].column_name]);o.debug(p),F(Te({appId:e,data:p,context:{media:{}}})),o.debug("init"),G(!0)}},Ne=()=>{let n="";for(const u in s.columns)s.columns[u].extra==="auto_increment"&&(n=s.columns[u].column_name);return o.debug(n),n},Le=n=>{var x;const u=(x=me.getSelectors().selectFormState(ee.getState().forms,e))==null?void 0:x.validation;o.debug("rowValidation",u);let p=!1;for(const f in u)if(u[f].error===!0&&u[f].type===fe.COLUMN){p=!0;break}if(p)return o.debug("validateForm returned errors"),!1;let E=!0;const i=Ne();for(const f in n){const g=Qt(s,f);let M=!0;g.column_name!==i&&g.is_nullable==="NO"&&(n[f]===null||n[f]==="")&&(m===U.UPDATE||m===U.INSERT&&(g.column_default===null||g.column_default==="NULL"||g.column_default==="")||Nt.preserveSpacesOnUpdate===!1&&n[f]==="")&&(F(Ee({appId:e,columnName:f,columnError:!0,columnText:_.mandatoryField,columnType:fe.FORM})),M=!1,E=!1);const S=me.getSelectors().selectFormColumns(ee.getState().forms,e);let D;for(let v=0;v<S.length;v++)S[v].columnName===f&&(D=S[v]);if(o.debug(D),M&&g.data_type==="time"){const v=n[f];if(v.length===6){let A=v.substring(2,3),B=v.substring(4,5);(Number(A)>5||Number(B)>5)&&(F(Ee({appId:e,columnName:f,columnError:!0,columnText:_.mandatoryField,columnType:fe.FORM})),M=!1,E=!1)}}M&&F(Ee({appId:e,columnName:f,columnError:!1,columnText:"",columnType:fe.FORM}))}return E},ue=(n,u,p,E)=>{var x;const i=(x=me.getSelectors().selectFormState(ee.getState().forms,e))==null?void 0:x.data;if(o.debug(i),Le(i)){if(r!==null){const f={};Object.keys(i).map(g=>{se.map(M=>{g===M.columnName&&M.updatable&&(f[g]=i[g])})}),o.debug(f),tt(e,r,f,g=>{var M;if(o.debug(g),g!=null&&g.code&&(g!=null&&g.message))switch(g.code){case"ok":k(_.updatedSuccessful,{variant:"success"}),((M=g.context)==null?void 0:M.updated)!==void 0&&Object.keys(g.context.updated).map(S=>{F(et({appId:e,columnName:S,columnValue:g.context.updated[S]}))}),n&&(u!==void 0&&u(r),setTimeout(()=>{a(!0,T)},1e3)),E&&E();break;case"info":k(_.nothingToUpdate,{variant:"info"}),n&&(u!==void 0&&u(r),setTimeout(()=>{a(!0,T)},1e3)),E&&E();break;default:o.error(g),k(g.message??_.invalidResponse,{variant:"error"}),n&&a(!0,T)}else o.error(g),k(_.invalidResponse,{variant:"error"})},g=>{o.error("error",g),k(g??_.invalidResponse,{variant:"error"})},!1,L,R)}else nt(e,i,f=>{if(o.debug(f),f!=null&&f.code&&(f!=null&&f.message)){let g;const M={};switch(f.code){case"ok":k(_.insertSuccessful,{variant:"success"}),g=Ne();for(let S=0;S<s.primary_key.length;S++){const D=Xt(s,s.primary_key[S]);let v;D!==void 0&&(v=s==null?void 0:s.columns[D]),g!==""&&g===(v==null?void 0:v.column_name)?M[s.primary_key[S]]=f.context.insert_id:M[s.primary_key[S]]=i[s.primary_key[S]]}if((C==null?void 0:C.cardinality)===ge.ONE_TO_ONE){const S={};y!=null&&y.primary_key&&Array.isArray(y==null?void 0:y.primary_key)&&(y==null||y.primary_key.map(v=>S[v]=J[v]));const D={};if(C.join_condition!==void 0){const v=C.join_condition.split(",");for(let A=0;A<v.length;A++){const B=v[A].split("=");B.length===2&&(D[B[0]]=M[B[1]])}}tt(e,S,D,()=>{Object.keys(J).map(v=>{if(C.join_condition!==void 0){const A=C.join_condition.split(",");for(let B=0;B<A.length;B++){const ae=A[B].split("=");ae.length===2&&ae[0]===v&&F(et({appId:c,columnName:v,columnValue:Z[ae[1]]}))}}})},()=>{})}if(n){u!==void 0&&u(M),a(!0,T);return}h(M,_e.UPDATE),p&&p(),E&&E();break;default:o.error(f),k(f.message??_.invalidResponse,{variant:"error"})}}else o.error(f),k(_.invalidResponse,{variant:"error"})},f=>{o.error("error",f),k(f??_.invalidResponse,{variant:"error"})},!1,L,R);o.debug(T),T!==void 0&&(o.debug("setM2MUpdate: true"),F(Ke({appId:T,update:!0})))}else o.error("Validate failed: ",i)},Rt=()=>ie===null?null:t.jsx(l.Suspense,{children:t.jsx(w,{sx:{marginTop:"30px"},children:t.jsx(at,{severity:"error",message:ie,close:!1})})}),Ct=n=>{if(n!==null&&Le(Z)){const u=Re.getSelectors().selectTableById(ee.getState().tables,e),p=u.state.relation.relation_join_condition.split(",").map(i=>i.split("=")),E={...u.state.detailKey};p.map(i=>{E[i[0]]=n[i[1]]}),nt(e,E,i=>{if(o.debug(i),i!=null&&i.code&&(i!=null&&i.message))switch(i.code){case"ok":o.debug("Added relation to join table",i);break;default:o.error(i),k(i.message??_.invalidResponse,{variant:"error"})}else o.error(i),k(_.invalidResponse,{variant:"error"})},i=>{o.error(i),k(i??_.invalidResponse,{variant:"error"})},!1,!0,!1)}},[Mt,St]=l.useState(void 0),wt=()=>{try{ue(!1,()=>{},()=>{var u,p,E,i,x,f,g,M,S,D,v,A,B,ae,Ge,Je,Qe,Xe,qe,Ze;const n=JSON.parse((p=(u=s==null?void 0:s.app)==null?void 0:u.app[0])==null?void 0:p.app_settings);if(o.debug(n),((i=(E=n==null?void 0:n.settings)==null?void 0:E.app_registration)==null?void 0:i.showMessage)===!0&&((f=(x=n==null?void 0:n.settings)==null?void 0:x.app_registration)==null?void 0:f.message)!==void 0&&((M=(g=n==null?void 0:n.settings)==null?void 0:g.app_registration)==null?void 0:M.message)!==null&&((D=(S=n==null?void 0:n.settings)==null?void 0:S.app_registration)==null?void 0:D.message.trim())!==""&&St((A=(v=n==null?void 0:n.settings)==null?void 0:v.app_registration)==null?void 0:A.message),((ae=(B=n==null?void 0:n.settings)==null?void 0:B.app_registration)==null?void 0:ae.allowUpdates)!==!0&&(re(U.VIEW),((Je=(Ge=n==null?void 0:n.settings)==null?void 0:Ge.app_registration)==null?void 0:Je.showUrl)===!0&&((Xe=(Qe=n==null?void 0:n.settings)==null?void 0:Qe.app_registration)==null?void 0:Xe.url)!=="")){const zt=((Ze=(qe=n==null?void 0:n.settings)==null?void 0:qe.app_registration)==null?void 0:Ze.urlTime)??3;setTimeout(()=>{window.location.href=n.settings.app_registration.url},zt)}})}catch(n){o.error("Invalid JSON - app settings"),o.error(n),k(Zt.contactSupport,{variant:"error"})}},Ot=()=>{ue(!1)},kt=()=>{var u,p,E;const n=Re.getSelectors().selectTableById(ee.getState().tables,e);o.debug((u=n==null?void 0:n.state)==null?void 0:u.relation),((E=(p=n==null?void 0:n.state)==null?void 0:p.relation)==null?void 0:E.cardinality)===ge.MANY_TO_MANY?ue(!0,Ct):ue(!0)},ve=()=>{a(!0,T)},Nt=ke(),Lt=lt(e),Pt=lt(T??""),K=Tn(e),I=l.useRef(null),Bt=jn(),[le,Ut]=l.useState((He=I==null?void 0:I.current)==null?void 0:He.offsetWidth),[Vt,Dt]=l.useState({paddingTop:"50px",paddingBottom:"50px",paddingLeft:"50px",paddingRight:"50px"}),[At,Pe]=l.useState("30px"),[Ht,Be]=l.useState("");if(l.useEffect(()=>{if(I.current!==null){Ut(I.current.offsetWidth);let n=le<600?.3:le<900?.6:1;(P??!1)===!0&&(n=1),Dt({paddingTop:`calc(${n} * 50px)`,paddingBottom:`calc(${n} * 50px)`,paddingLeft:`calc(${n} * 50px)`,paddingRight:`calc(${n} * 50px)`}),le<600?(Pe("10px"),Be("10px")):le<900&&(Pe("20px"),Be("20px"))}},[Bt.width,I.current]),q!=="")return t.jsx(l.Suspense,{children:t.jsx(at,{severity:"error",message:q,close:!1})});const Ue=()=>t.jsx(Fn,{appId:e,metaData:s,primaryKey:r,formMode:z,formUuid:H}),Wt=()=>t.jsxs(t.Fragment,{children:[t.jsx(de,{color:"inherit",onClick:()=>{const n={appId:e};o.info(C),C!=null&&(n.hideThemeSettings=!0),T!==void 0&&(n.isRelationForm=!0),F(gt(n))},children:t.jsx(vt,{})}),t.jsx(de,{color:"inherit",onClick:()=>{ve()},children:t.jsx(Tt,{})})]}),Yt=l.useMemo(()=>{var n,u,p,E,i;return(n=s==null?void 0:s.src)!=null&&n.app_id&&((p=(u=s==null?void 0:s.app)==null?void 0:u.app[0])==null?void 0:p.app_title)!==""?s.app.app[0].app_title:(E=s==null?void 0:s.src)!=null&&E.dbs&&((i=s==null?void 0:s.src)!=null&&i.tbl)?s.src.dbs+" - "+s.src.tbl:"WP Data Access"},[]),Ve=(((Ye=(We=N==null?void 0:N.table)==null?void 0:We.modal)==null?void 0:Ye.maxHeight)??95)+((($e=(ze=N==null?void 0:N.table)==null?void 0:ze.modal)==null?void 0:$e.maxHeightUnit)??"vh"),De=()=>{var n,u;return t.jsxs(rt,{elevation:oe,ref:V,children:[(P??!1)===!0&&t.jsx(jt,{sx:{position:"unset",borderBottomRightRadius:0,borderBottomLeftRadius:0,boxShadow:"none"},children:t.jsxs(bt,{sx:{display:"grid",gridTemplateColumns:"auto auto",justifyContent:"space-between",alignItems:"center"},children:[t.jsx(w,{sx:{display:"flex",alignItems:"center",cursor:"move",gap:"2px","& svg":{width:"2em",height:"2em"}},id:Ie(s,"title"),children:t.jsx(w,{sx:{display:"block",whiteSpace:"nowrap",fontSize:"18px",lineHeight:"18px",fontWeight:"bold",textOverflow:"ellipsis",overflow:"hidden",marginRight:"10px"},children:Yt})}),t.jsx(w,{children:(P??!1)===!0&&Me(s)&&t.jsx(t.Fragment,{children:Wt()})})]})}),t.jsxs(w,{style:Vt,sx:{...(P??!1)===!0&&Q!==void 0&&{maxHeight:`calc(${Ve} - 240px)`,overflow:"auto",backgroundColor:"transparent",border:"none",borderRadius:0}},children:[t.jsxs(w,{sx:{margin:0,padding:"5px 0",...(P??!1)===!0&&Q===void 0&&{maxHeight:`calc(${Ve} - 240px)`,overflow:"auto"}},children:[Ue(),b,Rt()]}),t.jsxs(w,{sx:{marginTop:{marginTop:At},paddingRight:{paddingRight:Ht},padding:0,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[t.jsxs(w,{sx:{display:"flex",gap:"8px"},children:[!1,(Lt||Pt)&&t.jsx(t.Fragment,{children:le<600?t.jsx(de,{color:"primary",onClick:()=>{F(xe({appId:e,more:!K})),T!==void 0&&F(xe({appId:T,more:!K}))},children:K?t.jsx(st,{}):t.jsx(ot,{})}):t.jsx(ce,{variant:"outlined",startIcon:K?t.jsx(st,{}):t.jsx(ot,{}),onClick:()=>{F(xe({appId:e,more:!K})),T!==void 0&&F(xe({appId:T,more:!K}))},children:K?_.less:_.more})}),(Y==null?void 0:Y.customActionsBottom)!==void 0&&t.jsx(t.Fragment,{children:t.jsx(Mn,{code:Y.customActionsBottom.code??"",safeMode:X.safeMode,isExpression:!1,args:{log:o,row:Z,mode:qt[m]}})}),t.jsx(w,{className:"pp-registration-form-message",children:Mt})]}),t.jsx(w,{sx:{...le<600&&{marginLeft:"0 !important","& button":{marginLeft:"2px",padding:"6px"}}},children:m!==U.VIEW?t.jsx(t.Fragment,{children:((u=(n=s==null?void 0:s.app)==null?void 0:n.app[0])==null?void 0:u.app_type)==Fe.REGISTRATION&&N.state.masterDetailConditions===void 0?t.jsx(t.Fragment,{children:(z===U.INSERT||z===U.UPDATE)&&t.jsx(ce,{variant:"contained",onClick:wt,type:"submit",form:H,sx:{marginLeft:"8px"},children:_.ok})}):t.jsxs(t.Fragment,{children:[t.jsx(ce,{variant:"contained",onClick:Ot,type:"submit",form:H,disabled:ie!==null,children:_.apply}),(C==null?void 0:C.cardinality)!==ge.ONE_TO_ONE&&t.jsxs(t.Fragment,{children:[t.jsx(ce,{variant:"outlined",onClick:kt,sx:{marginLeft:"8px"},children:_.ok}),t.jsx(ce,{variant:"outlined",onClick:ve,sx:{marginLeft:"8px"},children:_.cancel})]})]})}):t.jsx(t.Fragment,{children:(C==null?void 0:C.cardinality)!==ge.ONE_TO_ONE&&t.jsx(ce,{variant:"contained",onClick:ve,children:_.back})})})]}),t.jsx(t.Fragment,{children:!1})]})]})};return d?Ue():t.jsx("div",{className:`${e}_wrapper pp-form`,ref:I,children:$&&Z!==null?t.jsx(t.Fragment,{children:(P??!1)===!0?t.jsx(t.Fragment,{children:t.jsx(pn,{handle:"#"+Ie(s,"title"),nodeRef:V,offsetParent:document.body,children:De()})}):t.jsx(t.Fragment,{children:De()})}):t.jsx(rt,{style:{padding:"50px"},elevation:oe,children:t.jsx(Se,{title:_.loadingData})})})},wn=l.lazy(()=>te(()=>import("./Settings-1.0.31-BB3LonPi.js"),__vite__mapDeps([45,10,1,2,3,11,6,7,8,9,15,4,5,16,17,23,18,19,20,21,22,24,25,46,14,27,28,29,30,31,32]),import.meta.url)),ut=({appId:e,primaryKey:r,formMode:m,showTable:a,showForm:h,metaData:O,detailKey:b,selectionForm:T,masterAppId:R})=>{o.debug(e,r,m,O,b,T,R);const L=rn(),c=we(e).table;o.debug("relationship",null);const F=l.useMemo(()=>{},[]);o.debug("relationAppId",F);const V=()=>null,se=()=>null,_=()=>null,oe=()=>{var Y,X,z,re,H,$,G,q;return t.jsx(_n,{open:!0,className:"pp-form-modal",sx:{zIndex:9999990},children:t.jsx(w,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",minWidth:(((Y=c==null?void 0:c.modal)==null?void 0:Y.minWidth)??60)+(((X=c==null?void 0:c.modal)==null?void 0:X.minWidthUnit)??"vw"),maxWidth:(((z=c==null?void 0:c.modal)==null?void 0:z.maxWidth)??90)+(((re=c==null?void 0:c.modal)==null?void 0:re.maxWidthUnit)??"vw"),minHeight:(((H=c==null?void 0:c.modal)==null?void 0:H.minHeight)??0)+((($=c==null?void 0:c.modal)==null?void 0:$.minHeightUnit)??"vh"),maxHeight:(((G=c==null?void 0:c.modal)==null?void 0:G.maxHeight)??95)+(((q=c==null?void 0:c.modal)==null?void 0:q.maxHeightUnit)??"vh"),backgroundColor:"transparent"},children:t.jsx(ct,{appId:e,primaryKey:r,formMode:m,showTable:a,showForm:h,detailKey:b,relationAppId:F,masterAppId:R,isModal:!0,children:se()})})})},N=()=>t.jsx(ct,{appId:e,primaryKey:r,formMode:m,showTable:a,showForm:h,detailKey:b,relationAppId:F,masterAppId:R,children:se()});return t.jsxs(t.Fragment,{children:[T===!0?t.jsx(t.Fragment,{children:V()}):t.jsx(t.Fragment,{children:c.formModal===!0?t.jsx(t.Fragment,{children:oe()}):t.jsx(t.Fragment,{children:N()})}),t.jsx(t.Fragment,{children:Me(O)&&t.jsx(ht,{theme:L,children:t.jsx(l.Suspense,{fallback:t.jsx(Se,{}),children:t.jsx(wn,{appId:e})})})}),_()]})},On=e=>{const r=ne(m=>{var a,h;return((h=(a=m.tables[e])==null?void 0:a.state)==null?void 0:h.fullScreen)??!1});return o.debug("fullScreen",r),r},kn=l.lazy(()=>te(()=>import("./TableContainer-1.0.31-D5nXSZNu.js").then(e=>e.T),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32]),import.meta.url)),dt=l.lazy(()=>te(()=>import("./TableChartDock-1.0.31-Bkdf9QFU.js"),__vite__mapDeps([47,1,2,3,48,10,11,6,7,8,9,31,15,32,5,20,19,14,38,4,39,40]),import.meta.url)),mt=({appId:e})=>{var Z,C;o.debug(e);const r=xt(),m=un(),a=dn(),h=Et(),O=_t(e),b=mn(e);we(e).table;const R=pt(e),L="pp-remove-body-vertical-scrollbar",d=pe(e),c=l.useMemo(()=>{var j,y,J,Q,ie;return(j=d==null?void 0:d.src)!=null&&j.app_id&&((J=(y=d==null?void 0:d.app)==null?void 0:y.app[0])==null?void 0:J.app_title)!==""?d.app.app[0].app_title:(Q=d==null?void 0:d.src)!=null&&Q.dbs&&((ie=d==null?void 0:d.src)!=null&&ie.tbl)?d.src.dbs+" - "+d.src.tbl:"WP Data Access"},[]),P=On(e);l.useEffect(()=>(o.debug(P),()=>{var j;(j=window.document.getElementById(L))==null||j.remove(),window.document.body.classList.remove("pp-fullscreen")}),[P]);const F=l.useMemo(()=>Re.getSelectors().selectTableExploring(ee.getState().tables,e),[e]);o.debug("tableExploring",F);const[V,se]=l.useState(((C=(Z=d==null?void 0:d.app)==null?void 0:Z.app[0])==null?void 0:C.app_type)==Fe.REGISTRATION?W.FORM:W.TABLE),[_,oe]=l.useState(!1),N=j=>{r(nn({appId:e,mode:j})),se(j)};l.useEffect(()=>{window.ppShowForm=function(j){o.debug(j),z(j),N(W.FORM)}},[e]);const Y=(j,y)=>{o.debug(j,y),sn(e)&&(a(e),y!==void 0&&(m(y),a(y))),j&&oe(!_),N(W.TABLE)},[X,z]=l.useState(null),[re,H]=l.useState(U.VIEW),$=(j,y)=>{switch(o.debug(j,y),y){case _e.INSERT:H(U.INSERT);break;case _e.UPDATE:H(U.UPDATE);break;default:H(U.VIEW)}z(j),N(W.FORM)};let G={};Oe(e);const q=()=>null,je=()=>t.jsx(l.Suspense,{fallback:t.jsx(ye,{title:R.loadingForm}),children:t.jsx(ut,{appId:e,primaryKey:X,formMode:U.INSERT,showTable:()=>{},showForm:$,metaData:d})}),s=()=>{var j,y,J,Q;return((y=(j=d==null?void 0:d.app)==null?void 0:j.app[0])==null?void 0:y.app_type)==Fe.REGISTRATION?je():t.jsxs(t.Fragment,{children:[t.jsxs(l.Suspense,{fallback:t.jsx(ye,{title:R.loadingTable}),children:[V===W.TABLE&&(b==null?void 0:b.docked)==="top"&&((J=b==null?void 0:b.data)==null?void 0:J.length)>0&&t.jsx(dt,{appId:e}),t.jsx(kn,{appId:e,display:V===W.TABLE,refresh:_,showForm:$,metaData:d}),V===W.TABLE&&(b==null?void 0:b.docked)==="bottom"&&((Q=b==null?void 0:b.data)==null?void 0:Q.length)>0&&t.jsx(w,{sx:{marginTop:"5px"},children:t.jsx(dt,{appId:e})})]}),V===W.FORM&&t.jsx(l.Suspense,{fallback:t.jsx(ye,{title:R.loadingForm}),children:t.jsx(ut,{appId:e,primaryKey:X,formMode:re,showTable:Y,showForm:$,metaData:d})})]})};return t.jsxs(w,{className:"pp-component",sx:P?G:{},children:[t.jsx(jt,{className:"pp-header",elevation:h,position:"relative",sx:{margin:"0 0 5px 0"},children:t.jsxs(bt,{sx:{display:"grid",gridTemplateColumns:"auto auto",justifyContent:"space-between",alignItems:"center"},children:[t.jsx(w,{sx:{display:"block",whiteSpace:"nowrap",fontSize:"18px",lineHeight:"18px",fontWeight:"bold",textOverflow:"ellipsis",overflow:"hidden",marginRight:"10px"},children:c}),t.jsxs(w,{sx:{display:"flex",gap:"10px",justifyContent:"center",alignItems:"center"},children:[Me(d)&&t.jsx(it,{title:t.jsx(fn,{details:O,mode:V}),className:"pp-builder-button",children:t.jsx(de,{sx:{color:"inherit",padding:0},onClick:()=>{V===W.FORM?r(gt({appId:e})):r(Kt({appId:e}))},children:t.jsx(vt,{})})}),q(),F&&t.jsx(it,{title:R.close,children:t.jsx(de,{sx:{color:"inherit",padding:0},onClick:()=>{var j;(j=window.document.getElementById(L))==null||j.remove(),window.document.body.classList.remove("pp-fullscreen"),d.src.app_id?r(It({isActive:!1,appDbId:0})):r(en({})),a(e),m(e),r(tn({}))},children:t.jsx(Tt,{})})})]})]})}),s()]})},Nn=e=>({}),Ln=({appId:e})=>{o.debug(e);const r=gn(e),m=ke(),a=hn(),h=pe(e);let O;h.appRootId===void 0&&(O=xn(a,r,m));const b=Nn(),T=`pp-global-code-${e}`;return l.useEffect(()=>{o.debug("open app")},[]),l.useEffect(()=>()=>{var R;o.debug("close app"),ft(((R=b.onAppClose)==null?void 0:R.code)??"",on(h),!1)},[]),l.useEffect(()=>{var R,L,d;if(b!==void 0){(R=window.document.getElementById(T))==null||R.remove();const c=window.document.createElement("script");c.id=T,c.innerHTML=((L=b.global)==null?void 0:L.code)??"",(d=window.document.getElementById(`pp-app-${e}`))==null||d.appendChild(c)}},[b]),O!==void 0?t.jsx(ht,{theme:O,children:t.jsx(mt,{appId:e})}):t.jsx(mt,{appId:e})},es=Object.freeze(Object.defineProperty({__proto__:null,default:Ln},Symbol.toStringTag,{value:"Module"}));export{_e as R,es as T,Tn as a,On as b,Et as c,Nn as d,Rn as e,Ce as f,he as g,vn as u};
