import{j as t}from"./cm-1.0.37-CEr77VZi.js";import{r as m}from"./redux-1.0.37-C4JSQ-MG.js";import{u as f,a as C}from"./hooks-1.0.37-DW0_oiBB.js";import{l as u,A as D,V as R,W,X as z,Y as H,S as L,v as G,H as I,Z as U,d as V,_ as X,$ as Y}from"./lib-1.0.37-Czwr-8r3.js";import{A as Z}from"./AppContainerSelector-1.0.37-CLAiGRN4.js";import{B as x,S as $}from"./Spinner-1.0.37-CwhfSVqI.js";import{u as q,a as J}from"./useChartSettings-1.0.37-DyLw1xR9.js";import{u as v,A as K}from"./AppTheme-1.0.37-DOXnENpA.js";import{u as Q}from"./useRemoveAppFromStore-1.0.37-HphIv4xo.js";import{u as ee,B as te,C as se}from"./useFormDetails-1.0.37-DnrKW97d.js";import{f as pe,G as oe,A as ne,T as re,M as ie}from"./index-1.0.37-B60ShF2d.js";import{D as y}from"./DynamicModeEnum-1.0.37-BXuL5kgA.js";import{T as M}from"./Tooltip-1.0.37-BLWvlO4a.js";import{I as g}from"./iconBase-1.0.37-DRohixw7.js";import{M as ae}from"./MenuItem-1.0.37-JkRcsicb.js";import{M as le}from"./Menu-1.0.37-Ca8DeoO3.js";import{u as ce}from"./useTableSettings-1.0.37-iiTTwobj.js";import{u as me}from"./useStoreFormSettings-1.0.37-DetNzg9c.js";import{u as ue}from"./useTheme-1.0.37-D4xQQypV.js";import{T as de}from"./ThemeProvider-1.0.37-Cyf1xy26.js";import"./vendor-1.0.37-CN03Eozo.js";import"./loglevel-1.0.37-BZ7XahX3.js";import"./lodash-1.0.37-Dx3wKrSf.js";import"./moment-1.0.37-C5S46NFB.js";import"./main-1.0.37.js";import"./notistack-1.0.37-CEqipxDI.js";import"./FallbackSpinner-1.0.37-DAc7pvnM.js";import"./useLoadAppMetaData-1.0.37-_NoyHHQ3.js";import"./RestApi-1.0.37-CcjslynE.js";import"./StoreTypeEnum-1.0.37-Cx2hXwas.js";import"./Typography-1.0.37-DjtXWQnP.js";import"./index-1.0.37-D4zhytA1.js";import"./getThemeProps-1.0.37-BGc0S4YC.js";import"./useEnhancedEffect-1.0.37-UwysO4qr.js";import"./lang-1.0.37-CfHlhLgz.js";import"./useControlled-1.0.37-DyimEgDk.js";import"./Popper-1.0.37-CSsNCozr.js";const xe=()=>{const e=f(s=>s.appData);return u.debug("appData",e),e},he=({appRootId:e,appId:s,appDbId:r,isVisible:a,fullScreen:o})=>{const[p,l]=m.useState(!1);return m.useEffect(()=>{a&&!p&&l(!0)},[a]),p?t.jsx(x,{className:"pp-apps-root"+(a?"":" pp-element-hide"),sx:{"& .pp-app-container .pp-component header.pp-header":{margin:0,visibility:"hidden",position:"absolute",left:-99999,top:-99999}},children:t.jsx(Z,{appId:s,appDbId:r,fullScreen:o,appRootId:e})}):null},fe=e=>{const s=f(r=>r.appApps[e]!==void 0?r.appApps[e].activeAppId??r.appApps[e].apps[0]:0);return u.debug("activeAppId",s,e),s},ge=e=>{const s=f(r=>r.appData[e]);return u.debug("appData",s),s},Ae=({appId:e})=>{const s=C(),r=ee(e),a=v(e),o=ge(e);return t.jsx(M,{title:t.jsx(te,{details:r,mode:o==null?void 0:o.mode}),className:"pp-builder-button",children:t.jsx(g,{sx:{color:"inherit",padding:0},onClick:()=>{var p,l;((l=(p=a==null?void 0:a.app)==null?void 0:p.app[0])==null?void 0:l.app_type)==D.CHART?s(R({appId:e})):(o==null?void 0:o.mode)===y.FORM?s(W({appId:e})):s(z({appId:e}))},children:t.jsx(pe,{})})})},je=({appDbId:e,appTitle:s,setActiveApp:r,handleClose:a})=>t.jsx(ae,{onClick:()=>{r(e),a()},children:t.jsx("span",{children:s})}),Se=({apps:e,setActiveApp:s})=>{const[r,a]=m.useState(null),o=!!r,p=n=>{a(n.currentTarget),n.stopPropagation()},l=()=>{a(null)};return t.jsxs(x,{sx:{position:"relative"},children:[t.jsx(g,{sx:{color:"inherit",padding:0},onClick:p,children:t.jsx(oe,{})}),t.jsxs(le,{anchorEl:r,open:o,onClose:l,anchorOrigin:{vertical:"bottom",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"left"},sx:{marginTop:"8px","& ul":{padding:"0 !important"},"& ul li":{padding:"12px 24px 12px 18px !important"}},children:[...e.apps.map(n=>e.titles[n]===void 0?null:t.jsx(je,{appDbId:n,appTitle:e.titles[n],setActiveApp:s,handleClose:l}))]})]})},nt=({appId:e})=>{var j,S,b,T;u.debug(e);const s=C(),r=Q(),a=se(),o=H.getSelectors().selectApps(L.getState().appApps,e),p=m.useMemo(()=>{const i={};return Array.isArray(o.apps)&&o.apps.length>0&&o.apps.map(h=>{i[h]=G()}),i},[]),l=q(e),n=v(e),F=m.useMemo(()=>{var i,h;return((h=(i=n==null?void 0:n.app)==null?void 0:i.app[0])==null?void 0:h.app_title)!==""?n.app.app[0].app_title:"WP Data Access"},[]),c=fe(e),E=i=>{s(Y({appId:e,activeAppId:i}))};J(p[c]);const B=ce(p[c]),k=me(p[c]),w=ue(p[c]),O=K(w,B,k),[d,be]=m.useState(((b=window.PP_APP_CONFIG[(S=(j=n==null?void 0:n.app)==null?void 0:j.app[0])==null?void 0:S.app_id])==null?void 0:b.appFullscreen)===!0);u.debug("appFullScreen",d);const A=xe();m.useEffect(()=>{u.debug("setFullScreen",p,d),Object.keys(p).map(i=>{s(I({appId:p[Number(i)],property:{fullScreen:d??!1}}))})},[A,d]);const P=((T=A[p[c]])==null?void 0:T.mode)??y.TABLE;u.debug("mode",P);let N={};const _=()=>null;return o===void 0||Object.keys(p).length===0?t.jsx($,{}):t.jsx(de,{theme:O,children:t.jsxs(x,{className:"pp-apps-container",sx:{...d?N:{},"& .pp-element-hide":{visibility:"hidden",position:"absolute",left:-99999,top:-99999}},children:[t.jsx(ne,{className:"pp-apps-header",position:"relative",sx:{margin:"0 0 5px 0"},children:t.jsxs(re,{sx:{display:"grid",gridTemplateColumns:"auto auto",justifyContent:"space-between",alignItems:"center"},children:[t.jsxs(x,{sx:{display:"grid",gridTemplateColumns:"auto auto",justifyContent:"space-between",alignItems:"center",gap:"5px","& span":{whiteSpace:"nowrap",fontSize:"18px",lineHeight:"18px",fontWeight:"bold"},"& span.pp-header-title":{minWidth:0,textOverflow:"ellipsis",overflow:"hidden",marginRight:"10px"}},children:[t.jsx("span",{children:t.jsx(Se,{apps:o,setActiveApp:E})}),t.jsxs("span",{className:"pp-header-title",children:[F," - ",o.titles[c]]})]}),t.jsxs(x,{sx:{display:"flex",gap:"10px",justifyContent:"center",alignItems:"center"},children:[U(n)&&t.jsx(Ae,{appId:p[c]}),_(),(n==null?void 0:n.isExploring)&&t.jsx(M,{title:l.close,children:t.jsx(g,{sx:{color:"inherit",padding:0},onClick:()=>{s(V({isActive:!1,appDbId:0})),a(e),r(e),s(X()),Object.keys(p).map(i=>{a(p[i]),r(p[i])})},children:t.jsx(ie,{})})})]})]})}),...o.apps.map(i=>t.jsx(he,{appRootId:e,appId:p[i],appDbId:i,isVisible:i===c,fullScreen:d}))]})})};export{nt as default};
