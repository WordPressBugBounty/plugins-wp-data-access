import{dI as M,$ as J,r as u,j as i,d0 as re,l as ne,an as ie,aE as oe}from"./main-1.0.18.js";import{P as ae,b as W,a as se}from"./index-1.0.18-d0588796.js";import{c as G,M as ce}from"./index.esm-1.0.18-12f13c4a.js";import{a as le}from"./RestApi-1.0.18-cb72bd79.js";import{u as ue}from"./useTableSortableColumns-1.0.18-89de4e60.js";import{C as de}from"./ChartTypeSelection-1.0.18-2203eb3b.js";import{C as me}from"./Chart-1.0.18-142bb265.js";import{a as fe}from"./useTheme-1.0.18-c1f3f722.js";import{t as pe,u as be}from"./index.esm-1.0.18-32f5cee0.js";import{T as he}from"./Tooltip-1.0.18-5f32f0fd.js";import{I as A}from"./iconBase-1.0.18-3c21f5e2.js";import{B}from"./CardContent-1.0.18-3d5e5525.js";import{P as xe}from"./Popover-1.0.18-54868205.js";import{B as I}from"./Spinner-1.0.18-de8df990.js";import{F as ge}from"./FormHelperText-1.0.18-8b4ce85f.js";import{I as ve,S as je,T as Te}from"./TextField-1.0.18-cf148b4e.js";import{M as Ce}from"./MenuItem-1.0.18-0088f2a2.js";import{A as ye,C as Se}from"./Autocomplete-1.0.18-a264f80a.js";import"./DialogContent-1.0.18-5570cba4.js";import"./Typography-1.0.18-dc3c0740.js";import"./Modal-1.0.18-870f459d.js";import"./ChartTypes-1.0.18-62bfd1db.js";import"./ListItemIcon-1.0.18-7ee6feae.js";import"./Menu-1.0.18-e8cb0649.js";import"./ThemeProvider-1.0.18-247b72cc.js";import"./colorManipulator-1.0.18-95bf61ec.js";import"./Popper-1.0.18-20544c9b.js";import"./useControlled-1.0.18-12a74006.js";import"./Grow-1.0.18-4ebc2ce8.js";import"./useFormControl-1.0.18-87a8487d.js";import"./FormLabel-1.0.18-47dbe87d.js";import"./createSvgIcon-1.0.18-dcf0276e.js";import"./Close-1.0.18-d90e9fa7.js";import"./index-1.0.18-ff546563.js";function we(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var L=we,Oe=typeof M=="object"&&M&&M.Object===Object&&M,$e=Oe,ke=$e,Ee=typeof self=="object"&&self&&self.Object===Object&&self,_e=ke||Ee||Function("return this")(),K=_e,Ie=K,Re=function(){return Ie.Date.now()},ze=Re,Me=/\s/;function Pe(e){for(var t=e.length;t--&&Me.test(e.charAt(t)););return t}var Ae=Pe,Be=Ae,Fe=/^\s+/;function Le(e){return e&&e.slice(0,Be(e)+1).replace(Fe,"")}var We=Le,Ge=K,Ne=Ge.Symbol,Q=Ne,N=Q,V=Object.prototype,Ue=V.hasOwnProperty,Xe=V.toString,R=N?N.toStringTag:void 0;function De(e){var t=Ue.call(e,R),n=e[R];try{e[R]=void 0;var a=!0}catch{}var o=Xe.call(e);return a&&(t?e[R]=n:delete e[R]),o}var He=De,qe=Object.prototype,Je=qe.toString;function Ke(e){return Je.call(e)}var Qe=Ke,U=Q,Ve=He,Ye=Qe,Ze="[object Null]",et="[object Undefined]",X=U?U.toStringTag:void 0;function tt(e){return e==null?e===void 0?et:Ze:X&&X in Object(e)?Ve(e):Ye(e)}var rt=tt;function nt(e){return e!=null&&typeof e=="object"}var it=nt,ot=rt,at=it,st="[object Symbol]";function ct(e){return typeof e=="symbol"||at(e)&&ot(e)==st}var lt=ct,ut=We,D=L,dt=lt,H=0/0,mt=/^[-+]0x[0-9a-f]+$/i,ft=/^0b[01]+$/i,pt=/^0o[0-7]+$/i,bt=parseInt;function ht(e){if(typeof e=="number")return e;if(dt(e))return H;if(D(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=D(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=ut(e);var n=ft.test(e);return n||pt.test(e)?bt(e.slice(2),n?2:8):mt.test(e)?H:+e}var xt=ht,gt=L,F=ze,q=xt,vt="Expected a function",jt=Math.max,Tt=Math.min;function Ct(e,t,n){var a,o,l,p,r,h,v=0,b=!1,j=!1,T=!0;if(typeof e!="function")throw new TypeError(vt);t=q(t)||0,gt(n)&&(b=!!n.leading,j="maxWait"in n,l=j?jt(q(n.maxWait)||0,t):l,T="trailing"in n?!!n.trailing:T);function k(s){var x=a,$=o;return a=o=void 0,v=s,p=e.apply($,x),p}function w(s){return v=s,r=setTimeout(S,t),b?k(s):p}function _(s){var x=s-h,$=s-v,z=t-x;return j?Tt(z,l-$):z}function C(s){var x=s-h,$=s-v;return h===void 0||x>=t||x<0||j&&$>=l}function S(){var s=F();if(C(s))return d(s);r=setTimeout(S,_(s))}function d(s){return r=void 0,T&&a?k(s):(a=o=void 0,p)}function O(){r!==void 0&&clearTimeout(r),v=0,a=h=o=r=void 0}function g(){return r===void 0?p:d(F())}function m(){var s=F(),x=C(s);if(a=arguments,o=this,h=s,x){if(r===void 0)return w(h);if(j)return clearTimeout(r),r=setTimeout(S,t),k(h)}return r===void 0&&(r=setTimeout(S,t)),p}return m.cancel=O,m.flush=g,m}var Y=Ct;const yt=J(Y);var St=Y,wt=L,Ot="Expected a function";function $t(e,t,n){var a=!0,o=!0;if(typeof e!="function")throw new TypeError(Ot);return wt(n)&&(a="leading"in n?!!n.leading:a,o="trailing"in n?!!n.trailing:o),St(e,t,{leading:a,maxWait:t,trailing:o})}var kt=$t;const Et=J(kt),_t=(e,t,n,a)=>{switch(t){case"debounce":return yt(e,n,a);case"throttle":return Et(e,n,a);default:return e}},It=e=>{const t=u.useRef(e);return u.useEffect(()=>{t.current=e}),u.useMemo(()=>(...n)=>{var a;return(a=t.current)===null||a===void 0?void 0:a.call(t,...n)},[])},Rt=e=>{const[t,n]=u.useState((e==null?void 0:e.current)||null);return e&&setTimeout(()=>{e.current!==t&&n(e.current)},0),{refProxy:u.useMemo(()=>new Proxy(o=>{o!==t&&n(o)},{get(o,l){return l==="current"?t:o[l]},set(o,l,p){return l==="current"?n(p):o[l]=p,!0}}),[t]),refElement:t,setRefElement:n}},zt=(e,t)=>t==="border-box"?{width:e.borderBoxSize[0].inlineSize,height:e.borderBoxSize[0].blockSize}:t==="content-box"?{width:e.contentBoxSize[0].inlineSize,height:e.contentBoxSize[0].blockSize}:{width:e.contentRect.width,height:e.contentRect.height};function Mt({skipOnMount:e=!1,refreshMode:t,refreshRate:n=1e3,refreshOptions:a,handleWidth:o=!0,handleHeight:l=!0,targetRef:p,observerOptions:r,onResize:h}={}){const v=u.useRef(e),b=It(h),[j,T]=u.useState({width:void 0,height:void 0}),{refProxy:k,refElement:w}=Rt(p),{box:_}=r||{},C=u.useCallback(d=>{if(!o&&!l)return;if(v.current){v.current=!1;return}const O=(g,m)=>o&&g.width!==m.width||l&&g.height!==m.height;d.forEach(g=>{const m=zt(g,_);T(s=>O(s,m)?(b==null||b({width:m.width,height:m.height,entry:g}),m):s)})},[o,l,v,_]),S=u.useCallback(_t(C,t,n,a),[C,t,n,a]);return u.useEffect(()=>{let d;return w?(d=new window.ResizeObserver(S),d.observe(w,r)):(j.width||j.height)&&(b==null||b({width:null,height:null,entry:null}),T({width:void 0,height:void 0})),()=>{var O,g,m;(O=d==null?void 0:d.disconnect)===null||O===void 0||O.call(d),(m=(g=S).cancel)===null||m===void 0||m.call(g)}},[S,w]),Object.assign({ref:k},j)}const br=({appId:e,componentWidth:t,table:n,tableStore:a,metaData:o,appLanguage:l})=>{const p=le(),r=fe(e),h=ue(e),v=u.useMemo(()=>{const f=[];return h.map(y=>{var E;const c=(E=o==null?void 0:o.columns)==null?void 0:E.findIndex(P=>P.column_name===y);if(c!==-1)switch(o.columns[c].data_type.toLowerCase()){case"decimal":case"double":case"double precision":case"float":case"real":case"bit":case"tinyint":case"smallint":case"int":case"integer":case"mediumint":case"bigint":f.push({columnName:y,dataType:"number"});break}}),f},[h]),[b,j]=u.useState(""),[T,k]=u.useState([]),[w,_]=u.useState("BarChart"),[C,S]=u.useState(!1),d=u.useRef(null),O=u.useCallback(()=>{d.current&&s(d.current.offsetWidth)},[d]),{width:g}=Mt({targetRef:d,onResize:O}),[m,s]=u.useState(),x=f=>{const y=a.columns.filter(c=>c.columnName===f);return y.length===1?y[0].columnLabel:f},$=()=>{var y;const f=re(n,b,T,C,a.columns,o);ne.debug(f),((y=r==null?void 0:r.data)==null?void 0:y.length)>0?p(ie({appId:e,property:{majorAxisColumn:b,minorAxisColumns:T,data:f,chartType:w,grouped:C}})):p(oe({appId:e,chartState:{majorAxisColumn:b,minorAxisColumns:T,data:f,chartType:w,grouped:C}}))},z=f=>null;return i.jsx(ae,{variant:"popover",popupId:e,children:f=>{var y;return i.jsxs(i.Fragment,{children:[t<600?i.jsx(he,{title:"Charts",children:i.jsx(A,{...W(f),children:i.jsx(G,{})})}):i.jsx(B,{variant:"contained",endIcon:i.jsx(G,{}),...W(f),onClickCapture:()=>{r!==void 0&&$()},children:"CHARTS"}),i.jsx(xe,{...se(f),anchorOrigin:{vertical:"bottom",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"left"},sx:{boxShadow:"0px 5px 5px -3px rgba(0,0,0,0.2),0px 8px 10px 1px rgba(0,0,0,0.14),0px 3px 14px 2px rgba(0,0,0,0.12)","& > .MuiPaper-root":{resize:"horizontal",minWidth:"380px",width:m+"px"}},children:i.jsxs(I,{sx:{display:"grid",gap:"20px",padding:"20px"},ref:d,children:[i.jsxs(I,{sx:{display:"grid",gridTemplateColumns:"1fr auto auto",alignItems:"center"},children:[i.jsx(I,{sx:{marginRight:"12px"},children:i.jsxs(ge,{fullWidth:!0,sx:{marginTop:"5px"},children:[i.jsx(ve,{variant:"outlined",children:"Major Axis"}),i.jsx(je,{label:"Major Axis",variant:"outlined",value:b,onChange:c=>{j(c.target.value??"")},className:"pp-chart-category-column",sx:{"&.pp-chart-category-column .MuiSelect-select, &.pp-chart-category-column input":{padding:"16.5px 14px"}},children:(()=>h.map(function(c){if(x(c)!=="")return i.jsx(Ce,{"data-id":"ppChartCategoryColumn",value:c,children:x(c)},c)}))()})]})}),i.jsx(A,{color:"primary",onClick:()=>{S(!C)},children:C?i.jsx(pe,{}):i.jsx(be,{})}),i.jsx(A,{color:"primary",onClick:()=>{f.close()},children:i.jsx(ce,{})})]}),i.jsx(ye,{multiple:!0,options:v.map(c=>c.columnName),getOptionLabel:c=>x(c),value:T,disableCloseOnSelect:!0,onChange:(c,E)=>{k(E)},renderInput:c=>i.jsx(Te,{...c,label:"Minor Axis",variant:"outlined"}),renderTags:(c,E)=>c.map((P,Z)=>{const{key:ee,...te}=E({index:Z});return i.jsx(Se,{variant:"outlined",label:x(P),...te},ee)}),className:"pp-chart-category-column",sx:{"&.pp-chart-category-column .MuiInputBase-root":{backgroundColor:"transparent"}}}),i.jsx(de,{chartType:w,setChartType:_,chartTypes:(r==null?void 0:r.chartTypes)??[],isTableChart:!0}),i.jsxs(I,{sx:{display:"grid",gridTemplateColumns:"1fr 100px 100px",gap:"0.5rem"},children:[i.jsx(I,{sx:{whiteSpace:"nowrap"},children:a.state.masterDetailConditions===void 0&&i.jsx(i.Fragment,{children:z()})}),i.jsx(B,{variant:"contained",onClick:()=>{f.close()},children:l.cancel}),i.jsx(B,{variant:"contained",onClick:()=>{$()},children:l.ok})]}),(r==null?void 0:r.docked)==="undocked"&&((y=r==null?void 0:r.data)==null?void 0:y.length)>0&&(r==null?void 0:r.majorAxisColumn)!==""&&(r==null?void 0:r.minorAxisColumns.length)>0&&i.jsx(me,{appId:e,isBuilderEnabled:!1,isToolbarEnabled:!1,chartWidth:g,isTableChart:!0})]})})]})}})};export{br as default};
