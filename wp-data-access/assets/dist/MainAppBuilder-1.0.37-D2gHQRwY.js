const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./SettingsApp-1.0.37--WP7aCtN.js","./cm-1.0.37-CEr77VZi.js","./redux-1.0.37-C4JSQ-MG.js","./vendor-1.0.37-CN03Eozo.js","./index-1.0.37-B60ShF2d.js","./iconBase-1.0.37-DRohixw7.js","./Typography-1.0.37-DjtXWQnP.js","./lib-1.0.37-Czwr-8r3.js","./loglevel-1.0.37-BZ7XahX3.js","./lodash-1.0.37-Dx3wKrSf.js","./moment-1.0.37-C5S46NFB.js","./useEnhancedEffect-1.0.37-UwysO4qr.js","./notistack-1.0.37-CEqipxDI.js","./TargetEnum-1.0.37-CIW1jlU5.js","./ConfirmDialog-1.0.37-BDQ_OfRf.js","./AdminTheme-1.0.37-7PLndQ8H.js","./ActionsSettings-1.0.37-DQdLIvID.js","./RestApi-1.0.37-CcjslynE.js","./AccordionSummary-1.0.37-Dp-yE6bD.js","./useControlled-1.0.37-DyimEgDk.js","./Collapse-1.0.37-DaP8rsgI.js","./AccordionDetails-1.0.37-CWpLs4PS.js","./FormHelperText-1.0.37-ylnS0Km6.js","./utils-1.0.37-iop7lDec.js","./useFormControl-1.0.37-BcUwa2qz.js","./hooks-1.0.37-DW0_oiBB.js","./PremiumFeature-1.0.37-BKt66-Fr.js","./index-1.0.37-CK0QxOhD.js","./FormLabel-1.0.37-BQP5Nx_Z.js","./FormControlLabel-1.0.37-BLp4PuCc.js","./Switch-1.0.37-D8L-tSJ8.js","./SwitchBase-1.0.37-Bwy1aBhJ.js","./TextField-1.0.37-CCe4G0U1.js","./Select-1.0.37-B5ZKqjeL.js","./Menu-1.0.37-Ca8DeoO3.js","./ThemeProvider-1.0.37-Cyf1xy26.js","./createSvgIcon-1.0.37-DXsAQOmB.js","./Spinner-1.0.37-CwhfSVqI.js","./MenuItem-1.0.37-JkRcsicb.js","./main-1.0.37.js","./Tooltip-1.0.37-D_uDknxi.js","./Tooltip-1.0.37--D4jr2go.css","./TabPanel-1.0.37-CPE-1h3v.js","./useThemeProps-1.0.37-CD9ZXLtG.js","./getThemeProps-1.0.37-BGc0S4YC.js","./index-1.0.37-LxgxH_yq.js","./ComponentColumn-1.0.37-dxZBqVrm.js","./ActionsExplorer-1.0.37-2IOZFLVH.js","./Autocomplete-1.0.37-5_yZAyWV.js","./Close-1.0.37-Yr1E1-6A.js","./Popper-1.0.37-CSsNCozr.js","./useLoadAppMetaData-1.0.37-_NoyHHQ3.js","./StoreTypeEnum-1.0.37-Cx2hXwas.js","./Checkbox-1.0.37-LjGLlM3B.js","./Tooltip-1.0.37-BLWvlO4a.js","./Link-1.0.37-B0loYHQn.js","./FileSaver.min-1.0.37-Mmc9tWhG.js","./index-1.0.37-Ds3X5e5v.js","./index-1.0.37-D4zhytA1.js","./DynamicModeEnum-1.0.37-BXuL5kgA.js","./RadioGroup-1.0.37-CARB8om5.js","./Radio-1.0.37-C5rUTiNk.js","./lang-1.0.37-CfHlhLgz.js","./CardHeader-1.0.37-D5MnKXM1.js","./Divider-1.0.37-PDNfV3Nd.js","./Stepper-1.0.37-0J4mX0Mf.js","./ListItemIcon-1.0.37-CVeLs3zr.js","./ListItemText-1.0.37-BQ7ZEg4d.js","./TableRow-1.0.37-BL0M_io2.js","./AppContainerSelector-1.0.37-CLAiGRN4.js","./FallbackSpinner-1.0.37-DAc7pvnM.js","./index-1.0.37-CgPwljr5.js","./InputAdornment-1.0.37-Bm1BNe28.js","./settings-1.0.37-Bx2jvYL6.css","./main-1.0.37-LBsY5zsP.css","./SettingApps-1.0.37-CDJ6HUNx.js","./SettingsData-1.0.37-I6ZVDQfh.js","./SettingsAuthorization-1.0.37-Dr_TUtAd.js","./ResizableDrawer-1.0.37-C5w2uIZI.js","./useScreenSize-1.0.37-X1Uq-TFD.js","./CodeField-1.0.37-7TTa6LIP.js"])))=>i.map(i=>d[i]);
import{j as e}from"./cm-1.0.37-CEr77VZi.js";import{r as x}from"./redux-1.0.37-C4JSQ-MG.js";import{l as i,P as Mt,A as h,a as rt,s as wt,u as ct,b as I,c as be,d as at,e as ut,f as Dt,S as Lt,h as it,i as nt,R as se,j as _t,k as pt,m as E,C as ve,n as ot,o as Nt,p as Et,q as kt,r as Pt,t as xt,v as Ot,w as te,x as zt,y as Ie,z as Bt}from"./lib-1.0.37-Czwr-8r3.js";import{A as oe,a as Ft}from"./AdminTheme-1.0.37-7PLndQ8H.js";import{u as q,a as z}from"./hooks-1.0.37-DW0_oiBB.js";import{_ as de}from"./main-1.0.37.js";import{T as Me,C as ue,a as xe}from"./Tooltip-1.0.37-D_uDknxi.js";import{B as qt,a as Qt,b as Wt,T as Gt,c as we}from"./TabPanel-1.0.37-CPE-1h3v.js";import{A as mt,T as ht,M as _e,a as gt,b as ft,c as jt,d as bt,e as Ht,f as Vt,g as Kt,h as Yt,i as yt,j as Ut,k as $t,l as Se,m as Ne,n as Jt,o as Zt,p as Xt,q as es,r as ts,s as ss,t as rs,u as as,v as is}from"./index-1.0.37-B60ShF2d.js";import{a as ns,b as ps,c as os,d as ls,e as ds}from"./index-1.0.37-LxgxH_yq.js";import{e as u}from"./notistack-1.0.37-CEqipxDI.js";import{u as Re,C as cs,a as us,b as xs}from"./ComponentColumn-1.0.37-dxZBqVrm.js";import{a as ms,b as hs,c as gs,d as fs,e as js,f as bs,g as ys,h as As,i as Ts,j as Cs}from"./useLoadAppMetaData-1.0.37-_NoyHHQ3.js";import{B as $,C as le}from"./ConfirmDialog-1.0.37-BDQ_OfRf.js";import{B as p,S as pe}from"./Spinner-1.0.37-CwhfSVqI.js";/* empty css                        */import{T as De}from"./Typography-1.0.37-DjtXWQnP.js";import{I as G,P as vs}from"./iconBase-1.0.37-DRohixw7.js";import{F as At,a as Tt}from"./index-1.0.37-CK0QxOhD.js";import{F as Ss}from"./FileSaver.min-1.0.37-Mmc9tWhG.js";import{C as Rs}from"./index-1.0.37-Ds3X5e5v.js";import{u as ye}from"./index-1.0.37-D4zhytA1.js";import{T as F}from"./Tooltip-1.0.37-BLWvlO4a.js";import{L as Z}from"./Link-1.0.37-B0loYHQn.js";import{M as Is}from"./Menu-1.0.37-Ca8DeoO3.js";import{M as U}from"./MenuItem-1.0.37-JkRcsicb.js";import{F as H,a as J}from"./FormHelperText-1.0.37-ylnS0Km6.js";import{F as Ct}from"./FormControlLabel-1.0.37-BLp4PuCc.js";import{C as Ms}from"./Checkbox-1.0.37-LjGLlM3B.js";import{D as B}from"./DynamicModeEnum-1.0.37-BXuL5kgA.js";import{I as Ae,T as K}from"./TextField-1.0.37-CCe4G0U1.js";import{S as me}from"./Select-1.0.37-B5ZKqjeL.js";import{R as ws}from"./RadioGroup-1.0.37-CARB8om5.js";import{F as Le}from"./FormLabel-1.0.37-BQP5Nx_Z.js";import{R as lt}from"./Radio-1.0.37-C5rUTiNk.js";import{A as Te,C as Ce}from"./Autocomplete-1.0.37-5_yZAyWV.js";import{S as Ds}from"./Switch-1.0.37-D8L-tSJ8.js";import{l as Ls}from"./lang-1.0.37-CfHlhLgz.js";import{P as _s}from"./PremiumFeature-1.0.37-BKt66-Fr.js";import{R as Ns}from"./RestApi-1.0.37-CcjslynE.js";import{C as Ee}from"./CardHeader-1.0.37-D5MnKXM1.js";import{D as Es}from"./Divider-1.0.37-PDNfV3Nd.js";import{S as ks,a as Ps,b as Os}from"./Stepper-1.0.37-0J4mX0Mf.js";import{L as zs}from"./ListItemIcon-1.0.37-CVeLs3zr.js";import{L as Bs}from"./ListItemText-1.0.37-BQ7ZEg4d.js";import{T as Fs,a as qs,b as ne,c as N}from"./TableRow-1.0.37-BL0M_io2.js";import{A as Qs}from"./AppContainerSelector-1.0.37-CLAiGRN4.js";import{T as Ws}from"./index-1.0.37-CgPwljr5.js";/* empty css                    */import{T as Gs}from"./ThemeProvider-1.0.37-Cyf1xy26.js";import{I as Hs}from"./InputAdornment-1.0.37-Bm1BNe28.js";const Vs=()=>{const t=q(r=>r.apps.appApps);return i.debug("appApps",t),t},Ks=x.lazy(()=>de(()=>import("./SettingsApp-1.0.37--WP7aCtN.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74]),import.meta.url)),Ys=x.lazy(()=>de(()=>import("./SettingApps-1.0.37-CDJ6HUNx.js"),__vite__mapDeps([75,1,2,3,18,6,7,8,9,10,5,11,19,20,4,12,15,25,39,40,41,42,37,14,34,35,38,43,44,45,46,47,17,22,23,24,48,33,36,49,50,32,28,51,52,29,53,31,54,55,27,56,57,58,59,60,61,30,62,26,63,64,65,66,67,68,69,70,71,72,73,74]),import.meta.url)),Us=x.lazy(()=>de(()=>import("./SettingsData-1.0.37-I6ZVDQfh.js"),__vite__mapDeps([76,1,2,3,46,25,7,8,9,10,12,47,17,22,6,23,24,48,33,34,35,11,4,5,19,36,49,50,32,28,15,51,52,37,29,53,31,54,55,26,27,18,20,21,60,61,38,39,40,41,42,14,43,44,45,56,57,58,59,30,62,63,64,65,66,67,68,69,70,71,72,73,74]),import.meta.url)),$s=x.lazy(()=>de(()=>import("./SettingsAuthorization-1.0.37-Dr_TUtAd.js"),__vite__mapDeps([77,1,2,3,25,7,8,9,10,4,5,6,11,12,37,29,24,30,31,19,22,23,55,32,33,34,35,36,28,57,54,50,18,20,21,15,39,40,41,42,14,38,43,44,45,46,47,17,48,49,51,52,53,27,56,58,59,60,61,62,26,63,64,65,66,67,68,69,70,71,72,73,74]),import.meta.url)),Js=x.lazy(()=>de(()=>import("./ResizableDrawer-1.0.37-C5w2uIZI.js"),__vite__mapDeps([78,1,2,3,79,7,8,9,10,25,6,35,11,5,4,12,34]),import.meta.url)),Zs=({appDbId:t})=>{var Q,W;i.debug(t);const r=z(),s=Re(),o=((Q=oe)==null?void 0:Q.palette.mode)===Mt.LIGHT?(W=oe)==null?void 0:W.palette.primary.main:"",[g,c]=x.useState(!1);i.debug(g);const[d,b]=x.useState(!1);i.debug(d);const T=()=>{r(ct())},a=()=>{g?b(!0):T()},l=()=>{if(!s.appName)return u("App name is required",{variant:"error"}),!1;if(!s.appTitle)return u("App title is required",{variant:"error"}),!1;if(s.appType==h.APPCONTAINER)s.appApps.length===0&&u("No apps added",{variant:"info"});else{if(!s.appDatabase)return u("Database is required",{variant:"error"}),!1;if(s.appType==h.CHART){if(!s.appQuery)return u("SQL query is required",{variant:"error"}),!1}else{if(!s.appTable)return u("Table is required",{variant:"error"}),!1;if(s.appColumns.filter(C=>C.isSelected).length===0)return u("At least one column must be selected",{variant:"error"}),!1}if(s.appType==h.MAP){if(s.appMap.columnLatitude==="")return u("Latitude column is required for maps",{variant:"error"}),!1;if(s.appMap.columnLongitude==="")return u("Longitude column is required for maps",{variant:"error"}),!1}}return!0},j=()=>{l()&&ms(s,C=>{if(i.debug(C),C!=null&&C.code&&(C==null?void 0:C.message)!==void 0)switch(C.code){case"ok":u(C.message,{variant:"success"}),r(be());break;case"info":u(C.message,{variant:"info"});break;default:i.error(C),u(C.message??I.contactSupport,{variant:"error"})}else i.error(C),u(I.contactSupport,{variant:"error"})},C=>{i.error("error",C),u(C??I.contactSupport,{variant:"error"})})},R=()=>{l()&&(j(),T())},L=C=>{r(wt({anchor:C}))},[w,y]=x.useState(0),S=x.useMemo(()=>[{title:"App Info",icon:e.jsx(ns,{})},{title:s.appType==h.APPCONTAINER?"Apps":"Data Source",icon:s.appType==h.APPCONTAINER?e.jsx(ps,{}):e.jsx(os,{})},{title:"Access",icon:e.jsx(ls,{})}],[]);return e.jsxs(e.Fragment,{children:[e.jsx(x.Suspense,{fallback:e.jsx(pe,{}),children:e.jsxs(Js,{closeDrawer:a,children:[e.jsxs(mt,{position:"static",elevation:4,sx:{borderRadius:0},children:[e.jsxs(ht,{className:"pp-setting-toolbar",sx:{borderRadius:0},children:[e.jsxs(p,{sx:{flexGrow:1},children:[e.jsx(De,{variant:"h5",noWrap:!0,component:"div",className:"unselectable",sx:{paddingLeft:"6px"},children:"Manage App"}),e.jsx(De,{sx:{fontSize:"10px",paddingLeft:"10px"},children:s.appName})]}),e.jsx(Me,{title:"Dock to left",position:"bottom",children:e.jsx(G,{onClick:()=>{L(rt.LEFT)},size:"large",color:"inherit",sx:{fontSize:"1em"},children:e.jsx(qt,{})})}),e.jsx(Me,{title:"Dock to right",position:"bottom",children:e.jsx(G,{onClick:()=>{L(rt.RIGHT)},size:"large",color:"inherit",sx:{fontSize:"1em"},children:e.jsx(Qt,{})})}),e.jsx(Me,{title:"Close",position:"bottom",children:e.jsx(G,{onClick:a,size:"large",color:"inherit",sx:{fontSize:"1.4em"},children:e.jsx(_e,{})})})]}),e.jsx(Wt,{menuItems:S,menuIndex:w,setMenu:y})]}),e.jsx(ue,{className:"pp-settings-container",children:e.jsx(xe,{sx:{padding:0,margin:0},children:e.jsx(Gt,{value:w,children:e.jsxs(p,{sx:{margin:0,padding:0,overflowX:"hidden",overflowY:"auto",height:"calc(100vh - 232px)","& > div.MuiTabPanel-root":{padding:0}},children:[e.jsx(we,{value:0,children:e.jsx(x.Suspense,{fallback:e.jsx(pe,{}),children:e.jsx(Ks,{app:s,setIsUpdated:c})})}),e.jsx(we,{value:1,children:s.appType==h.APPCONTAINER?e.jsx(x.Suspense,{fallback:e.jsx(pe,{}),children:e.jsx(Ys,{app:s,setIsUpdated:c})}):e.jsx(x.Suspense,{fallback:e.jsx(pe,{}),children:e.jsx(Us,{app:s,setIsUpdated:c})})}),e.jsx(we,{value:2,children:e.jsx(x.Suspense,{fallback:e.jsx(pe,{}),children:e.jsx($s,{app:s,setIsUpdated:c})})})]})})})}),e.jsx(ue,{className:"pp-setting-footer",sx:{borderRadius:0,backgroundColor:o},children:e.jsxs(xe,{className:"pp-setting-footer-buttons",sx:{borderRadius:0},children:[e.jsx($,{variant:"outlined",className:"footer_action_button_apply",onClick:j,children:"Apply"}),e.jsx($,{variant:"outlined",className:"footer_action_button",onClick:R,children:"OK"}),e.jsx($,{variant:"outlined",className:"footer_action_button",onClick:a,children:"Cancel"})]})})]})}),e.jsx(le,{title:"Close App Manager?",message:"All uncommitted changes will be lost!",open:d,setOpen:b,onConfirm:()=>{T()},onKeep:()=>{T()}})]})},Xs=()=>{const t=q(r=>r.apps.showAppStructure);return i.debug("showAppStructure",t),t},vt=({appType:t})=>t==h.APPCONTAINER?e.jsx(p,{sx:{fontSize:"26px",display:"flex",width:"28px",justifyContent:"center",alignContent:"center",marginRight:"5px"},children:e.jsx(gt,{})}):t==h.DATAENTRY?e.jsx(p,{sx:{fontSize:"22px",display:"flex",width:"28px",justifyContent:"center",alignContent:"center",marginRight:"5px"},children:e.jsx(ft,{})}):t==h.CHART?e.jsx(p,{sx:{fontSize:"22px",display:"flex",width:"28px",justifyContent:"center",alignContent:"center",marginRight:"5px"},children:e.jsx(jt,{})}):t==h.REGISTRATION?e.jsx(p,{sx:{fontSize:"22px",display:"flex",width:"28px",justifyContent:"center",alignContent:"center",marginRight:"5px"},children:e.jsx(At,{})}):t==h.MAP?e.jsx(p,{sx:{fontSize:"22px",display:"flex",width:"28px",justifyContent:"center",alignContent:"center",marginRight:"5px"},children:e.jsx(bt,{})}):e.jsx(p,{sx:{fontSize:"20px",display:"flex",width:"28px",justifyContent:"center",alignContent:"center",marginRight:"5px"},children:e.jsx(Tt,{})}),dt=({app:t,density:r})=>{var ee,V,he,ge;i.debug(t);const s=z(),[o,g]=x.useState(!1),[c,d]=x.useState(!1),[b,T]=x.useState(!1),[a,l]=x.useState(!1),j=n=>{let A={};try{A=JSON.parse(n.app_settings)}catch(D){A.rest_api={authorization:se.AUTHORIZED,authorized_roles:[],authorized_users:[]},i.error("Invalid JSON - app settings"),i.error(D),u("Invalid JSON, check console",{variant:"error"})}return A},R=n=>{hs(n,A=>{var re,f,v,O,Y,ae,_,fe,ie,je,ke,Pe,Oe,ze,Be,Fe,qe,Qe,We,Ge,He,Ve,Ke,Ye,Ue,$e,Je,Ze,Xe,et,tt,st;const D=A==null?void 0:A.data;if(i.debug("response data",D),D.app&&D.app.app&&Array.isArray(D.app.app)&&D.app.container&&Array.isArray(D.app.container)&&D.app.apps&&Array.isArray(D.app.apps)){const P=D.app.app[0];if(i.debug(P),P.app_type==h.APPCONTAINER){const M=j(P),ce=D.app.apps;i.debug(ce,M),s(it({appDbId:n,appId:nt(n),appName:P.app_name,appTitle:P.app_title,appType:P.app_type,appCntId:0,appCntSeqNr:0,appDatabase:null,appTable:null,appColumns:[],appQuery:"",appRelationTable:null,appRelationColumns:[],appRestApi:M==null?void 0:M.rest_api,appAddToMenu:P.app_add_to_menu!=="0",appMenuTitle:((re=M==null?void 0:M.settings)==null?void 0:re.app_menu_title)??P.app_title,appMetaData:D,appLanguage:(f=M==null?void 0:M.settings)==null?void 0:f.app_language,fullScreen:((v=M==null?void 0:M.settings)==null?void 0:v.app_fullscreen)??!0,safeMode:((O=M==null?void 0:M.settings)==null?void 0:O.app_safe_mode)??!1,appApps:ce}))}else{const M=D.app.container[0];i.debug(M);let ce=[];try{ce=JSON.parse(M.cnt_cls)}catch(It){i.error("Invalid JSON - app columns"),i.error(It),u("Invalid JSON, check console",{variant:"error"})}const m=j(P);s(it({appDbId:n,appId:nt(n),appName:P.app_name,appTitle:P.app_title,appType:P.app_type,appCntId:M.cnt_id,appCntSeqNr:M.cnt_seq_nr,appDatabase:M.cnt_dbs,appTable:M.cnt_tbl,appColumns:ce,appQuery:M.cnt_query??"",appRelationTable:null,appRelationColumns:[],appRestApi:m==null?void 0:m.rest_api,appAddToMenu:P.app_add_to_menu!=="0",appMenuTitle:((Y=m==null?void 0:m.settings)==null?void 0:Y.app_menu_title)??P.app_title,appMetaData:D,appLanguage:(ae=m==null?void 0:m.settings)==null?void 0:ae.app_language,fullScreen:((_=m==null?void 0:m.settings)==null?void 0:_.app_fullscreen)??!0,safeMode:((fe=m==null?void 0:m.settings)==null?void 0:fe.app_safe_mode)??!1,registrationMessage:((je=(ie=m==null?void 0:m.settings)==null?void 0:ie.app_registration)==null?void 0:je.message)??void 0,registrationShowMessage:((Pe=(ke=m==null?void 0:m.settings)==null?void 0:ke.app_registration)==null?void 0:Pe.showMessage)??!1,registrationUrl:((ze=(Oe=m==null?void 0:m.settings)==null?void 0:Oe.app_registration)==null?void 0:ze.url)??"",registrationShowUrl:((Fe=(Be=m==null?void 0:m.settings)==null?void 0:Be.app_registration)==null?void 0:Fe.showUrl)??!1,registrationUrlTime:((Qe=(qe=m==null?void 0:m.settings)==null?void 0:qe.app_registration)==null?void 0:Qe.urlTime)??3,registrationAllowUpdates:((Ge=(We=m==null?void 0:m.settings)==null?void 0:We.app_registration)==null?void 0:Ge.allowUpdates)??!0,cacheData:((Ve=(He=m==null?void 0:m.settings)==null?void 0:He.app_chart)==null?void 0:Ve.cacheData)??!1,updateValue:((Ye=(Ke=m==null?void 0:m.settings)==null?void 0:Ke.app_chart)==null?void 0:Ye.updateValue)??12,updateUnit:(($e=(Ue=m==null?void 0:m.settings)==null?void 0:Ue.app_chart)==null?void 0:$e.updateUnit)??"h",mapApiKey:((Ze=(Je=m==null?void 0:m.settings)==null?void 0:Je.app_map)==null?void 0:Ze.api_key)??"",mapColumnLatitude:((et=(Xe=m==null?void 0:m.settings)==null?void 0:Xe.app_map)==null?void 0:et.column_latitude)??"",mapColumnLongitude:((st=(tt=m==null?void 0:m.settings)==null?void 0:tt.app_map)==null?void 0:st.column_longitude)??""}))}}else u(I.contactSupport,{variant:"error"})},A=>{i.error("error",A),u(A??I.contactSupport,{variant:"error"})})},L=()=>{gs(t.appId,n=>{if(i.debug(n),n!=null&&n.code&&(n==null?void 0:n.message)!==void 0)switch(n.code){case"ok":u(n.message,{variant:"success"}),s(be());break;case"info":u(n.message,{variant:"info"});break;default:i.error(n),u(n.message??I.contactSupport,{variant:"error"})}else i.error(n),u(I.contactSupport,{variant:"error"});g(!1)},n=>{i.error("error",n),u(n??I.contactSupport,{variant:"error"}),g(!1)})},w=()=>{fs(t.appId,n=>{i.debug(n),n!=null&&n.code&&(n==null?void 0:n.message)!==void 0?n.data.data?Ss(new Blob([n.data.data],{type:"text/json;charset=utf-8"}),"wpda-export-"+t.appName+".sql"):(i.error(n),u(n.message??I.contactSupport,{variant:"error"})):(i.error(n),u(I.contactSupport,{variant:"error"})),g(!1)},n=>{i.error("error",n),u(n??I.contactSupport,{variant:"error"}),g(!1)})},y=n=>{js(n,A=>{if(i.debug(A),A!=null&&A.code&&(A==null?void 0:A.message)!==void 0)switch(A.code){case"ok":u(A.message,{variant:"success"}),s(be());break;case"info":u(A.message,{variant:"info"});break;default:i.error(A),u(A.message??I.contactSupport,{variant:"error"})}else i.error(A),u(I.contactSupport,{variant:"error"});T(!1)},A=>{i.error("error",A),u(A??I.contactSupport,{variant:"error"}),T(!1)})},S=()=>{if(y(t.appId),t.appType==h.APPCONTAINER&&a===!0){const n=Dt.getSelectors().selectAppAppsList(Lt.getState().apps);n[t.appId]!==void 0&&Array.isArray(n[t.appId])&&(i.debug("start deleting detail apps",n[t.appId]),n[t.appId].map(A=>{i.debug("delete detail app",A),y(A)}))}},Q=ye("(max-width:700px)"),W=ye("(max-width:900px)"),[C,k]=x.useState(null),X=!!C;return e.jsxs(e.Fragment,{children:[e.jsxs(p,{"data-testid":t.appName+"-"+t.appType,sx:{display:"grid",gridTemplateColumns:"auto auto",justifyContent:"space-between",alignItems:"center",padding:r==="small"?"8px 8px 8px 12px":r==="medium"?"16px":"24px",...W&&{".pp-row-actions":{width:0}},"&:hover":{".pp-row-title":{display:W?"inline-block":"none"},".pp-row-actions":{visibility:W?"hidden":"visible"}}},children:[e.jsxs(p,{sx:{display:"grid",gridTemplateColumns:"auto auto",alignItems:"center"},children:[e.jsxs(p,{sx:{width:"100%",display:"grid",gridTemplateColumns:"auto 1fr",gridGap:r==="small"?"3px":r==="medium"?"6px":"9px",justifyContent:"center",alignItems:"center"},children:[e.jsx(vt,{appType:t.appType}),e.jsxs(p,{sx:{textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden"},children:[t.appName,e.jsxs(p,{className:"pp-row-title",sx:{display:"inline-block",marginLeft:"5px",fontSize:"80%"},children:["−",e.jsx(p,{sx:{display:"inline-block",width:"5px"}}),`${t.appTitle} (App ID: ${t.appId})`]})]})]}),e.jsxs(p,{sx:{display:"grid",visibility:"hidden",gridTemplateColumns:"auto auto auto auto",gridGap:"10px",marginLeft:"10px",alignItems:"center"},className:"pp-row-actions",children:[e.jsx(p,{sx:{borderLeft:"1px solid black",height:"100%"}}),e.jsx(F,{title:"Manage App",children:e.jsx(Z,{sx:{cursor:"pointer"},underline:"none",onClick:n=>{R(t.appId),n.preventDefault(),n.stopPropagation()},children:"Manage"})}),e.jsx(p,{sx:{borderLeft:"1px solid black",height:"100%"}}),e.jsx(F,{title:"Run & Build App",children:e.jsx(Z,{sx:{cursor:"pointer"},underline:"none",onClick:n=>{s(at({isActive:!0,appDbId:t.appId})),n.preventDefault(),n.stopPropagation()},children:"Run & Build"})})]})]}),e.jsxs(p,{sx:{display:"grid",gridTemplateColumns:"auto auto auto auto auto auto auto",justifyContent:Q?"end":"space-evenly",alignItems:"center"},children:[e.jsx(p,{sx:{paddingRight:"10px"},children:Q?"":ut(t.appType)}),e.jsx(F,{title:"Manage App",children:e.jsx(G,{sx:{color:(ee=oe)==null?void 0:ee.palette.primary.main},onClick:n=>{R(t.appId),n.preventDefault(),n.stopPropagation()},children:e.jsx(Ht,{})})}),e.jsx(F,{title:"Run & Build App",children:e.jsx(G,{sx:{color:(V=oe)==null?void 0:V.palette.primary.main},onClick:n=>{s(at({isActive:!0,appDbId:t.appId})),n.preventDefault(),n.stopPropagation()},children:e.jsx(Vt,{})})}),e.jsx(F,{title:"More App actions",children:e.jsx(G,{sx:{color:(he=oe)==null?void 0:he.palette.primary.main},onClick:n=>{k(n.currentTarget),n.preventDefault(),n.stopPropagation()},children:e.jsx(Kt,{})})}),e.jsxs(Is,{id:"pp-app-builder-more-actions",anchorEl:C,open:X,onClose:()=>{k(null)},MenuListProps:{"aria-labelledby":"pp-app-builder-more-actions"},sx:{zIndex:9999999999},anchorOrigin:{vertical:"top",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"right"},children:[e.jsxs(U,{onClick:n=>{k(null),g(!0),n.preventDefault(),n.stopPropagation()},children:[e.jsx(Yt,{}),e.jsx("span",{style:{margin:"0 10px"},children:"Copy"})]}),e.jsxs(U,{onClick:n=>{k(null),d(!0),n.preventDefault(),n.stopPropagation()},children:[e.jsx(yt,{}),e.jsx("span",{style:{margin:"0 10px"},children:"Export"})]}),e.jsx(Rs,{text:`[wpda_app app_id="${t.appId}"]`,onCopy:()=>{u(`Shortcode [wpda_app app_id="${t.appId}"] was copied to your clipboard`,{variant:"info"})},children:e.jsxs(U,{onClick:n=>{k(null),n.preventDefault(),n.stopPropagation()},children:[e.jsx(Ut,{}),e.jsx("span",{style:{margin:"0 10px"},children:"Shortcode"})]})}),e.jsxs(U,{onClick:n=>{k(null),T(!0),l(!1),n.preventDefault(),n.stopPropagation()},sx:{color:(ge=oe)==null?void 0:ge.palette.error.main},children:[e.jsx($t,{}),e.jsx("span",{style:{margin:"0 10px"},children:"Delete"})]})]})]})]}),o&&e.jsx(le,{title:"Please confirm",message:t.appType==h.APPCONTAINER?"Copy app including detail apps?":"Copy app?",open:o,setOpen:g,onConfirm:()=>L()}),c&&e.jsx(le,{title:"Please confirm",message:t.appType==h.APPCONTAINER?"Export app including detail apps?":"Export app?",open:c,setOpen:d,onConfirm:()=>w()}),b&&e.jsx(le,{title:"Delete App?",message:e.jsxs("div",{children:["Are you sure you want to delete app ",t.appName,"?",e.jsx("br",{}),e.jsx("strong",{children:"This action cannot be undone!"}),t.appType==h.APPCONTAINER&&e.jsxs(e.Fragment,{children:[e.jsx("br",{}),e.jsx("br",{}),e.jsx(H,{children:e.jsx(Ct,{control:e.jsx(Ms,{checked:a,onChange:(n,A)=>{l(A)}}),label:"Delete detail app?"})})]})]}),open:b,setOpen:T,onConfirm:()=>S()})]})},er=({apps:t,appApps:r,search:s,types:o,isLoading:g,density:c})=>{i.debug(t,r,s,o);const d=Xs(),b=l=>{if(o.length===0&&s.trim()==="")return!0;if(d&&r[l.appId]){let j=!1;if(r[l.appId].map(R=>{const L=t.filter(w=>w.appId==R)[0];L?(s.trim()!==""&&pt(L.appName+" "+L.appTitle,s)&&(j=!0),o.filter(w=>w.id===Number(L.appType)).length>0&&(j=!0)):i.error(`Detail app lost? Data App ${l.appId} cannot find detail app ${R}!`)}),j)return!0}return!(!pt(l.appName+" "+l.appTitle,s)||o.length>0&&o.filter(j=>j.id===Number(l.appType)).length===0)},T=t.filter(l=>b(l)?l:null),a=l=>r[l]?e.jsxs(p,{sx:{marginLeft:c==="small"?"48px":c==="medium"?"56px":"64px","& > div":{borderTop:"1px solid #ddd",borderRadius:"0 !important"}},children:[...r[l].map(j=>{const R=t.filter(L=>L.appId==j);return R.length>0?e.jsx(dt,{app:R[0],density:c}):null})]}):null;return e.jsx(vs,{elevation:4,children:e.jsxs(p,{sx:{backgroundColor:"#fff",borderRadius:"4px",overflow:"hidden","& .MuiBox-root:first-of-type":{borderTopLeftRadius:"4px",borderTopRightRadius:"4px"},"& .MuiBox-root:hover":{backgroundColor:"rgb(242, 242, 242)"},"& .pp-app-details:nth-of-type(odd)":{backgroundColor:"#f9f9f9"}},children:[...t.map(l=>{const j=b(l);return d&&Object.keys(r).filter(R=>r[R].includes(Number(l.appId))).length>0?null:e.jsxs(p,{className:"pp-app-details"+(j?" pp-app-details-visible":""),sx:{visibility:j?"visible":"hidden",position:j?"relative":"fixed",borderTop:"1px solid #ddd","&:first-of-type":{borderTop:"unset"}},children:[e.jsx(dt,{app:l,density:c}),d&&a(l.appId)]})}),T.length===0&&e.jsx(p,{sx:{padding:"35px",borderRadius:"4px"},children:g?e.jsx(pe,{title:"Loading apps...",align:_t.LEFT}):e.jsx(p,{children:"No apps found"})})]})})},St=()=>{const t=q(r=>r.apps.appList);return i.debug("apps",t),t},tr=()=>{const t=q(r=>r.apps.app.appDbId);return i.debug("appDbId",t),t},sr=()=>{const t=q(r=>r.apps.dbSearch);return i.debug("dbSearch",t),t},rr=()=>{const t=q(r=>r.apps.dbTypes);return i.debug("dbTypes",t),t},ar=()=>{const t=q(r=>r.apps.designMode);return i.debug("designMode",t),t},ir=()=>{const t=q(r=>r.apps.reload);return i.debug("reload",t),t},nr=({app:t,setIsUpdated:r})=>{i.debug(t);const s=z(),o=x.useMemo(()=>t.appColumns.map(d=>d.columnName),[t.appColumns]),[g,c]=x.useState(!1);return e.jsxs(p,{sx:{width:"100%",display:"grid",gap:"20px"},children:[e.jsxs(H,{fullWidth:!0,children:[e.jsx(Ae,{variant:"outlined",children:"Latitude Column *"}),e.jsx(me,{MenuProps:{id:"pp-select-menu"},label:"Latitude Column *",value:t.appMap.columnLatitude,variant:"outlined",onChange:d=>{s(E({property:{appMap:{apiKey:t.appMap.apiKey,columnLatitude:d.target.value,columnLongitude:t.appMap.columnLongitude}}})),r&&r(!0)},children:o.map(d=>e.jsx(U,{"data-id":d,value:d,children:d},d))}),e.jsx(J,{children:"Select the column that contains the latitude values for your locations."})]}),e.jsxs(H,{fullWidth:!0,children:[e.jsx(Ae,{variant:"outlined",children:"Longitude Column *"}),e.jsx(me,{MenuProps:{id:"pp-select-menu"},label:"Longitude Column *",value:t.appMap.columnLongitude,variant:"outlined",onChange:d=>{s(E({property:{appMap:{apiKey:t.appMap.apiKey,columnLatitude:t.appMap.columnLatitude,columnLongitude:d.target.value}}})),r&&r(!0)},children:o.map(d=>e.jsx(U,{"data-id":d,value:d,children:d},d))}),e.jsx(J,{children:"Select the column that contains the longitude values for your locations."})]}),e.jsx(H,{fullWidth:!0,children:e.jsxs(J,{component:"div",sx:{marginLeft:0},children:[e.jsxs(Z,{sx:{textDecoration:"none",cursor:"pointer",display:"inline-flex",marginBottom:0,"& svg":{fontSize:"1rem",marginRight:"2px"}},onClick:()=>c(!g),children:[e.jsx(Se,{}),"Using GEOMETRY and POINT Data Types"]}),g&&e.jsx(p,{sx:{marginTop:"20px",marginBottom:"25px",marginLeft:"4px"},children:"If your locations are stored in a GEOMETRY or POINT column, simply select the same column for both latitude and longitude. The plugin will automatically extract the required values."})]})})]})},Rt=()=>{const t=q(r=>r.apps.appMetaData);return i.debug("appMetaData",t),t},pr=({setIsUpdated:t})=>{const r=z(),s=Re(),o=Rt(),g=x.useMemo(()=>{const l=[];if((o==null?void 0:o.roles)!==void 0)for(const j in o.roles)l.push({key:j,value:o.roles[j]});return l},[o.roles]);i.debug(g);const c=x.useMemo(()=>{const l=[];if((o==null?void 0:o.users)!==void 0)for(const j in o.users)l.push({key:j,value:o.users[j]});return l},[o.users]);i.debug(c);const d=x.useMemo(()=>g.filter(l=>s.appRestApi.authorized_roles.includes(l.key)),[s.appRestApi.authorized_roles,g]),b=x.useMemo(()=>c.filter(l=>s.appRestApi.authorized_users.includes(l.key)),[s.appRestApi.authorized_users,c]),[T,a]=x.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsxs("fieldset",{className:"pp-fieldset",children:[e.jsx("legend",{children:"Authorization"}),e.jsx(H,{sx:{width:"100%"},children:e.jsxs(ws,{children:[e.jsxs(Le,{className:"align-label-radio",sx:{cursor:"pointer"},children:[e.jsx(lt,{checked:s.appRestApi.authorization===se.AUTHORIZED,onChange:l=>{r(E({property:{appRestApi:{...s.appRestApi,authorization:se.AUTHORIZED}}})),t&&t(!0),l.stopPropagation()}}),"Authorized access only"]}),e.jsxs(p,{sx:{display:"grid",gridGap:"10px",margin:"20px 20px 15px 42px"},children:[e.jsx(Te,{multiple:!0,options:g,disableCloseOnSelect:!0,getOptionLabel:l=>l.value,value:d,onChange:(l,j)=>{r(E({property:{appRestApi:{...s.appRestApi,authorized_roles:j.map(R=>R.key)}}})),t&&t(!0),l.stopPropagation()},renderInput:l=>e.jsx(K,{...l,label:"Roles"}),renderTags:(l,j)=>l.map((R,L)=>{const{key:w,...y}=j({index:L});return e.jsx(Ce,{variant:"outlined",label:R.value,...y},w)})}),e.jsx(Te,{multiple:!0,options:c,disableCloseOnSelect:!0,getOptionLabel:l=>l.value,value:b,onChange:(l,j)=>{r(E({property:{appRestApi:{...s.appRestApi,authorized_users:j.map(R=>R.key)}}})),t&&t(!0),l.stopPropagation()},renderInput:l=>e.jsx(K,{...l,label:"Users"}),renderTags:(l,j)=>l.map((R,L)=>{const{key:w,...y}=j({index:L});return e.jsx(Ce,{variant:"outlined",label:R.value,...y},w)})})]}),e.jsxs(Le,{className:"align-label-radio",sx:{cursor:"pointer"},children:[e.jsx(lt,{checked:s.appRestApi.authorization===se.ANONYMOUS,onChange:l=>{r(E({property:{appRestApi:{...s.appRestApi,authorization:se.ANONYMOUS}}})),t&&t(!0),l.stopPropagation()}}),"Anonymous access"]})]})})]}),e.jsx(H,{children:e.jsxs(J,{component:"div",sx:{marginLeft:0},children:[e.jsx(p,{sx:{marginTop:"25px"},children:e.jsxs(Z,{sx:{textDecoration:"none",cursor:"pointer",display:"inline-flex","& svg":{fontSize:"1rem",marginRight:"2px"}},onClick:()=>a(!T),children:[e.jsx(Se,{}),"What is the difference between authorized and anonymous access?"]})}),T&&e.jsxs(e.Fragment,{children:[e.jsxs(p,{sx:{marginTop:"20px"},children:[e.jsx("strong",{children:"Authorized access:"}),e.jsxs("ul",{style:{listStyle:"disc",padding:"0 40px"},children:[e.jsx("li",{children:"Users with the selected roles can access this app"}),e.jsx("li",{children:"Selected users can access this app"}),e.jsx("li",{children:"Other registered users cannot access this app"}),e.jsx("li",{children:"Anonymous users cannot access this app"})]})]}),e.jsxs(p,{sx:{marginTop:"20px"},children:[e.jsx("strong",{children:"Anonymous access:"}),e.jsx("ul",{style:{listStyle:"disc",padding:"0 40px"},children:e.jsx("li",{children:"Any user can access this app"})})]}),e.jsx(p,{sx:{marginTop:"20px"},children:"App authorization is applied to both back-end and front-end usage. Back-end access is restricted to registered users only. A Data Table app displayed on the front-end typically allows anonymous access, enabling visitors to view the table. In contrast, Data Management apps usually require authorized access to prevent unauthorized users from altering table data."})]})]})})]})},or=({app:t,setIsUpdated:r})=>{const s=z(),[o,g]=x.useState(!1),c=St(),d=c.filter(a=>t.appDbId!==a.appId&&a.appType!=h.APPCONTAINER),b=[];t.appApps.map(a=>{const l=c.filter(j=>j.appId===a);l.length===1&&b.push(l[0])});const T=a=>a.appName+(o?" ("+a.appTitle+")":"");return e.jsxs(H,{sx:{width:"100%",marginTop:"8px"},children:[e.jsx(Te,{multiple:!0,options:d,value:b,disableCloseOnSelect:!0,getOptionLabel:a=>T(a),onChange:(a,l)=>{s(E({property:{appApps:l.map(j=>j.appId)}})),r&&r(!0),a.stopPropagation()},renderInput:a=>e.jsx(K,{...a,label:"Apps"}),renderTags:(a,l)=>a.map((j,R)=>{const{key:L,...w}=l({index:R});return e.jsx(Ce,{variant:"outlined",label:T(j),...w},L)})}),e.jsxs(J,{component:"div",sx:{display:"grid",gridTemplateColumns:"auto auto",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("span",{children:"Apps will be added in the order they are entered here."}),e.jsx(Ct,{sx:{"& span.MuiFormControlLabel-label":{fontSize:"0.75rem"}},control:e.jsx(Ds,{checked:o,onChange:a=>{g(!o),a.stopPropagation()}}),label:"Show title",labelPlacement:"end"})]})]})},lr=({app:t,hasErrors:r,setIsUpdated:s})=>{i.debug(t,r);const o=z();return e.jsx(K,{type:"text",label:"App Name",error:r,fullWidth:!0,required:!0,helperText:"App name must be unique.",value:t.appName,autoFocus:!0,autoComplete:"off",onChange:g=>{o(E({property:{appName:g.target.value}})),s&&s(!0)}})},dr=({app:t,hasErrors:r,setIsUpdated:s})=>{i.debug(t,r);const o=z();return e.jsx(K,{type:"text",label:"App Title",error:r,fullWidth:!0,required:!0,helperText:"App title describes the purpose of the app.",value:t.appTitle,autoComplete:"off",onChange:g=>{o(E({property:{appTitle:g.target.value}})),s&&s(!0)}})},cr=()=>{const t=q(r=>ve.defaultLanguage.code);return i.debug("appLanguage",t),t},ur=({app:t,setIsUpdated:r})=>{i.debug(t);const s=z();Rt();const o=cr(),g=q(b=>{var T,a;return(a=(T=b==null?void 0:b.apps)==null?void 0:T.app)==null?void 0:a.updateSiteLanguage});i.debug("updateSiteLanguage",g),x.useEffect(()=>{const b={appLanguage:ve.defaultLanguage.code};s(E({property:{appLanguage:b.appLanguage}}))},[]);const[c,d]=x.useState(!1);return e.jsxs(p,{sx:{width:"100%"},children:[e.jsxs(H,{fullWidth:!0,disabled:!0,children:[e.jsx(Ae,{variant:"outlined",children:"App Language"}),e.jsxs(me,{MenuProps:{id:"pp-select-menu"},label:"App Language",value:o,onChange:b=>{},children:[...Ls.map(b=>e.jsx(U,{value:b.code,children:b.language},b.code))]}),e.jsx(J,{children:"Selected app language is applied to all (master and detail) tables and forms."})]}),!1,e.jsx(H,{children:e.jsxs(J,{component:"div",sx:{marginLeft:0},children:[e.jsx(p,{sx:{marginTop:"20px"},children:e.jsxs(Z,{sx:{textDecoration:"none",cursor:"pointer",display:"inline-flex","& svg":{fontSize:"1rem",marginRight:"2px"}},onClick:()=>d(!c),children:[e.jsx(Se,{}),"Which app information is localized?"]})}),c&&e.jsxs(e.Fragment,{children:[e.jsxs(p,{sx:{marginTop:"20px"},children:[e.jsx("strong",{children:"Information provided in the selected app language:"}),e.jsxs("ul",{style:{listStyle:"disc",padding:"0 40px"},children:[e.jsx("li",{children:"Tooltips"}),e.jsx("li",{children:"Field labels"}),e.jsx("li",{children:"Field hints"}),e.jsx("li",{children:"Info and success messages"}),e.jsx("li",{children:"Most error messages"})]})]}),e.jsxs(p,{sx:{marginTop:"20px"},children:[e.jsx("strong",{children:"Information not provided in the selected language:"}),e.jsxs("ul",{style:{listStyle:"disc",padding:"0 40px"},children:[e.jsx("li",{children:"Builders, Wizards and Managers are provided in English"}),e.jsx("li",{children:"Database and server errors are not translated"})]})]}),e.jsx(p,{sx:{marginTop:"20px"},children:"If you discover any translation errors, please let us know. We are committed to improving our translations."})]})]})}),e.jsx(_s,{})]})},xr=()=>{const t=q(r=>r.apps.app.appQuery);return i.debug("appQuery",t),t},mr=x.lazy(()=>de(()=>import("./CodeField-1.0.37-7TTa6LIP.js"),__vite__mapDeps([80,1,2,3,4,5,6,7,8,9,10,11,12,14,15,37,29,24,30,31,19]),import.meta.url)),hr=({setIsUpdated:t})=>{const r=z(),s=xr(),[o,g]=x.useState({}),[c,d]=x.useState(!1),b=()=>{o!=null&&Object.keys(o).length===0?Ns(ve.appUrlQueryBuilderList,{},a=>{i.debug(a),a.data!==void 0&&Array.isArray(a.data)?(g(a.data[0]),d(!0)):g({})},()=>{i.error("Error loading Query Builder list."),g({})}):d(!0)},T=a=>{r(Nt({appDatabase:o[a].schema_name})),r(E({property:{appQuery:ot(o[a].query)}})),t&&t(!0)};return e.jsxs(p,{sx:{width:"100%"},children:[e.jsxs(p,{sx:{display:"flex",justifyContent:"flex-end",marginBottom:"5px",position:"relative"},children:[e.jsxs($,{variant:"contained",onClick:()=>{b()},children:["Import from Query Builder  ",e.jsx(yt,{})]}),c===!0&&o!==void 0&&o!==null&&Object.keys(o).length>0&&e.jsx(p,{sx:{position:"absolute",top:0,right:0},children:e.jsxs(me,{MenuProps:{id:"pp-qb-list"},value:"",variant:"standard",open:c===!0,onClose:()=>{d(!1)},children:[...Object.keys(o).map(a=>e.jsx(U,{value:a,onClick:()=>{d(!1)},sx:{maxWidth:"600px"},children:e.jsxs(ue,{sx:{width:"100%",position:"relative"},children:[e.jsx(Ee,{title:e.jsxs(p,{sx:{width:"100%"},children:[e.jsx("span",{children:a}),e.jsxs($,{variant:"contained",color:"primary",sx:{position:"absolute",top:"13px",right:"20px",fontWeight:"bold"},onClick:()=>{T(a)},children:["Select  ",e.jsx(Ne,{})]})]})}),e.jsxs(xe,{children:[e.jsxs(De,{variant:"subtitle1",sx:{display:"grid",gridTemplateColumns:"auto auto",justifyContent:"start",alignItems:"center",gap:"5px",fontWeight:"bold"},children:[e.jsx(ds,{}),e.jsx("span",{children:o[a].schema_name})]}),e.jsx(Es,{sx:{margin:"20px 0"}}),e.jsx(p,{sx:{whiteSpace:"pre-wrap"},children:ot(o[a].query)})]})]})}))]})})]}),e.jsx(x.Suspense,{children:e.jsx(mr,{code:s,setCode:a=>{r(E({property:{appQuery:a}})),t&&t(!0)},dialogTitle:"SQL Query",extension:"sql"})}),e.jsx(H,{children:e.jsx(J,{children:"Enter a valid SQL query. Test your query in Query Builder before submitting."})})]})},gr=({app:t,setIsUpdated:r})=>{const s=z();return e.jsx(K,{type:"text",label:"API Key",fullWidth:!0,required:!0,helperText:e.jsxs(e.Fragment,{children:["Enter a valid Google Maps API Key. ",e.jsx("strong",{children:I.requiresReload})]}),value:t.appMap.apiKey,autoComplete:"off",onChange:o=>{s(E({property:{appMap:{apiKey:o.target.value,columnLatitude:t.appMap.columnLatitude,columnLongitude:t.appMap.columnLongitude}}})),r&&r(!0),o.stopPropagation()}})},fr=({setMode:t})=>{const r=z(),s=Re(),o=()=>s.appType==h.APPCONTAINER,g=o()?["App info","Apps","Authorization"]:["App info","Data source","Authorization"],[c,d]=x.useState(0);x.useEffect(()=>{let y=null;switch(s.appType){case h.DATATABLE:case h.CHART:case h.MAP:y=se.ANONYMOUS;break;case h.DATAENTRY:case h.REGISTRATION:case h.UPDATEFORM:case h.APPCONTAINER:y=se.AUTHORIZED;break}y!==null?r(E({property:{appRestApi:Et(y)}})):u(I.contactSupport,{variant:"error"})},[s.appType]);const[b,T]=x.useState({appName:!1,appTitle:!1,appDatabase:!1,appTable:!1,appColumns:!1});i.debug(b);const a=()=>{const y=kt(Pt);y.table.transactions.insert=Number(s.appType)===h.DATAENTRY||Number(s.appType)===h.REGISTRATION,y.table.transactions.update=Number(s.appType)===h.DATAENTRY||Number(s.appType)===h.UPDATEFORM||Number(s.appType)===h.REGISTRATION,y.table.transactions.delete=Number(s.appType)===h.DATAENTRY,bs(s,y,S=>{if(i.debug(S),S!=null&&S.code&&(S==null?void 0:S.message)!==void 0)switch(S.code){case"ok":u(S.message,{variant:"success"}),t(B.TABLE),r(be());break;case"info":u(S.message,{variant:"info"});break;default:i.error(S),u(S.message??I.contactSupport,{variant:"error"})}else i.error(S),u(I.contactSupport,{variant:"error"})},S=>{i.error("error",S),u(S??I.contactSupport,{variant:"error"})}),s.updateSiteLanguage&&s.appLanguage!==void 0&&ys(s.appLanguage,()=>{},()=>{})},l=()=>{var S,Q,W;let y=!0;if(c===0){let C=!1,k=!1;s.appName.trim()===""&&(u("App name is required",{variant:"error"}),C=!0,y=!1),s.appTitle.trim()===""&&(u("App title is required",{variant:"error"}),k=!0,y=!1),T({...b,appName:C,appTitle:k})}if(c===1){let C=!1,k=!1,X=!1,ee=!1;if(o())s.appApps.length===0&&u("No apps added",{variant:"info"});else if(((S=s.appDatabase)==null?void 0:S.trim())===""&&(u("Database is required",{variant:"error"}),C=!0,y=!1),s.appType==h.CHART?((Q=s.appQuery)==null?void 0:Q.trim())===""&&(u("SQL query is required",{variant:"error"}),ee=!0,y=!1):(((W=s.appTable)==null?void 0:W.trim())===""&&(u("Table is required",{variant:"error"}),k=!0,y=!1),s.appColumns.filter(V=>V.isSelected===!0).length===0&&(u("No columns selected",{variant:"error"}),X=!0,y=!1)),s.appType==h.MAP){if(s.appMap.columnLatitude==="")return u("Latitude column is required for maps",{variant:"error"}),!1;if(s.appMap.columnLongitude==="")return u("Longitude column is required for maps",{variant:"error"}),!1}T({...b,appDatabase:C,appTable:k,appQuery:ee,appColumns:X})}return c===g.length-1&&a(),i.debug(y),y},j=()=>e.jsxs(p,{sx:{textAlign:"right",display:"grid",gridTemplateColumns:"auto auto",justifyContent:"space-between",alignItems:"center"},children:[c>0?e.jsx($,{variant:"outlined",size:"medium",sx:{width:"160px",marginRight:"10px"},onClick:()=>{d(c-1)},startIcon:e.jsx(Jt,{}),children:e.jsx(p,{children:"Back"})}):e.jsx(p,{}),e.jsx($,{variant:"contained",size:"medium",sx:{width:"160px"},onClick:()=>{l()&&c<g.length-1&&d(c+1)},startIcon:c>=g.length-1&&e.jsx(Zt,{}),endIcon:c<g.length-1&&e.jsx(Ne,{}),children:e.jsx(p,{children:c<g.length-1?"Next":"Finish"})})]}),R=()=>e.jsxs(e.Fragment,{children:[e.jsx(lr,{app:s,hasErrors:b.appName}),e.jsx(dr,{app:s,hasErrors:b.appName}),e.jsx(ur,{app:s}),j()]}),L=()=>o()?e.jsxs(e.Fragment,{children:[e.jsx(or,{app:s}),j()]}):e.jsxs(e.Fragment,{children:[e.jsx(cs,{}),e.jsx(p,{sx:{display:s.appDatabase?"block":"none"},children:s.appType==h.CHART?e.jsx(hr,{}):e.jsx(us,{})}),s.appType!=h.CHART&&e.jsx(p,{sx:{display:s.appTable?"block":"none"},children:e.jsx(xs,{app:s})}),s.appType==h.MAP&&s.appColumns.length>0&&e.jsxs("fieldset",{className:"pp-fieldset",style:{marginTop:"-10px"},children:[e.jsx("legend",{children:e.jsx(Le,{sx:{fontSize:"13px"},children:"Spatial Columns"})}),e.jsx(p,{style:{marginTop:"5px"},children:e.jsx(nr,{app:s})})]}),j()]}),w=()=>e.jsxs(e.Fragment,{children:[e.jsx(p,{children:e.jsx(pr,{})}),s.appType==h.MAP&&e.jsx(p,{children:e.jsx(gr,{app:s})}),j()]});return e.jsxs(e.Fragment,{children:[e.jsx(ks,{activeStep:c,sx:{margin:"10px 0 30px 0"},children:g.map((y,S)=>(i.debug(y,S),e.jsx(Ps,{children:e.jsx(Os,{children:y})},y)))}),e.jsxs("form",{onSubmit:y=>(y.preventDefault(),l()&&d(c+1),!1),style:{display:"grid",gridGap:"30px"},children:[c===0&&R(),c===1&&L(),c===2&&w(),e.jsx("input",{type:"submit",style:{display:"none"}})]})]})},jr=({app:t,isNew:r,setIsUpdated:s})=>{i.debug(t);const o=z(),g=xt(),c=r?"Select App Type *":"App Type *";return e.jsxs(p,{sx:{width:"100%"},children:[e.jsx(p,{sx:{width:"100%"},children:e.jsxs(H,{fullWidth:!0,children:[e.jsx(Ae,{variant:"outlined",children:c}),e.jsxs(me,{MenuProps:{id:"pp-select-menu"},label:c,value:t.appType,disabled:r!==!0&&(t.appType==h.APPCONTAINER||t.appType==h.REGISTRATION||t.appType==h.CHART),onChange:d=>{o(E({property:{appType:d.target.value}})),s&&s(!0)},sx:{"& .MuiSelect-select":{display:"flex",alignItems:"center"}},children:[...g.map(d=>{let b=d.id==h.DATATABLE||d.id==h.DATAENTRY||d.id==h.REGISTRATION||d.id==h.APPCONTAINER||d.id==h.CHART||d.id==h.MAP;return r!==!0&&(d.id==h.APPCONTAINER||d.id==h.REGISTRATION||d.id==h.CHART||d.id==h.MAP)&&(b=!1),e.jsxs(U,{value:d.id,disabled:!b,children:[e.jsx(zs,{sx:{minWidth:"unset"},children:e.jsx(vt,{appType:d.id})}),e.jsx(Bs,{children:d.text})]})})]})]})}),r&&e.jsx(Fs,{sx:{marginTop:"30px",width:"auto","& td":{border:"none",padding:"12px 0 0 12px"},"& td:first-of-type":{textAlign:"center",paddingTop:"10px"},"& td:first-of-type svg":{display:"inline-block",verticalAlign:"middle"},"& td:nth-of-type(2)":{fontWeight:"bold",whiteSpace:"nowrap"}},children:e.jsxs(qs,{children:[e.jsxs(ne,{children:[e.jsx(N,{sx:{"& svg":{fontSize:"18px"}},children:e.jsx(jt,{})}),e.jsx(N,{children:"Chart"}),e.jsx(N,{children:"Create interactive charts with SQL queries using Google Charts"})]}),e.jsxs(ne,{children:[e.jsx(N,{sx:{"& svg":{fontSize:"18px"}},children:e.jsx(ft,{})}),e.jsx(N,{children:"Data Administration"}),e.jsx(N,{children:"Manage data with full transaction support through entry forms"})]}),e.jsxs(ne,{children:[e.jsx(N,{sx:{"& svg":{fontSize:"20px"}},children:e.jsx(gt,{})}),e.jsx(N,{children:"Data App"}),e.jsx(N,{children:"Bundle multiple apps into one with a dedicated menu"})]}),e.jsxs(ne,{children:[e.jsx(N,{children:e.jsx(Tt,{})}),e.jsx(N,{children:"Data Table"}),e.jsx(N,{children:"Display a read-only table with detailed views or inline details"})]}),e.jsxs(ne,{children:[e.jsx(N,{sx:{"& svg":{fontSize:"20px"}},children:e.jsx(bt,{})}),e.jsx(N,{children:"Map"}),e.jsx(N,{children:"Visualize location data on Google Maps using SQL queries"})]}),e.jsxs(ne,{children:[e.jsx(N,{children:e.jsx(At,{})}),e.jsx(N,{children:"Registration Form"}),e.jsx(N,{children:"Allow users to submit new entries to a table via a form"})]})]})})]})},br=({setMode:t})=>{const r=Re();i.debug(r);const[s,o]=x.useState(!1),[g,c]=x.useState(!1),d=s?`Add new ${ut(r.appType)} app`:"Add new app";return e.jsxs(e.Fragment,{children:[e.jsxs(ue,{sx:{padding:"50px 70px 40px 70px",display:"grid",gridGap:"40px"},elevation:4,children:[e.jsxs(p,{sx:{display:"grid",gridTemplateColumns:"auto auto",justifyContent:"space-between",alignItems:"start"},children:[e.jsx(Ee,{title:"App Wizard",subheader:d,sx:{padding:0}}),e.jsx(p,{children:e.jsx(F,{title:"Close",children:e.jsx(Z,{sx:{cursor:"pointer"},underline:"none",onClick:b=>{c(!0),b.preventDefault(),b.stopPropagation()},children:e.jsx(p,{sx:{fontSize:"1.5rem",color:"#000"},children:e.jsx(_e,{})})})})})]}),e.jsx(xe,{sx:{padding:0,display:"grid",gridGap:"30px"},children:s?e.jsx(fr,{setMode:t}):e.jsxs(p,{sx:{display:"grid",gap:"10px"},children:[e.jsx(jr,{app:r,isNew:!0}),e.jsx(p,{sx:{textAlign:"end"},children:e.jsx($,{variant:"contained",size:"medium",endIcon:e.jsx(Ne,{}),onClick:()=>{o(!0)},sx:{width:"160px"},children:"Start Wizard"})})]})})]}),e.jsx(le,{title:"Close App Wizard?",message:"All uncommitted changes will be lost!",open:g,setOpen:c,onConfirm:()=>{t(B.TABLE)}})]})},yr=({close:t})=>{const[r,s]=x.useState(""),[o,g]=x.useState(""),[c,d]=x.useState(!1),[b,T]=x.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsxs(ue,{sx:{padding:"50px 70px 40px 70px",display:"grid",gridGap:"40px"},elevation:4,children:[e.jsxs(p,{sx:{display:"grid",gridTemplateColumns:"auto auto",justifyContent:"space-between",alignItems:"start"},children:[e.jsx(Ee,{title:"Rename Database",sx:{padding:0}}),e.jsx(p,{children:e.jsx(F,{title:"Close",children:e.jsx(Z,{sx:{cursor:"pointer"},underline:"none",onClick:a=>{t(),a.preventDefault(),a.stopPropagation()},children:e.jsx(p,{sx:{fontSize:"1.5rem",color:"#000"},children:e.jsx(_e,{})})})})})]}),e.jsxs(xe,{sx:{padding:0,display:"grid",gridGap:"30px"},children:[e.jsx(K,{type:"text",label:"Old Database Name",fullWidth:!0,required:!0,value:r,onChange:a=>{s(a.target.value)}}),e.jsx(K,{type:"text",label:"New Database Name",fullWidth:!0,required:!0,value:o,onChange:a=>{g(a.target.value)}}),e.jsxs(p,{sx:{display:"grid",gridTemplateColumns:"auto auto",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs(Z,{sx:{textDecoration:"none",cursor:"pointer",display:"inline-flex","& svg":{fontSize:"1rem",marginRight:"2px"}},onClick:()=>d(!c),children:[e.jsx(Se,{}),"When is this feature recommended for use?"]}),e.jsx($,{disabled:r.trim()===""||o.trim()==="",variant:"contained",sx:{width:"120px"},onClick:()=>{T(!0)},children:"Rename"})]}),c&&e.jsxs(p,{children:[e.jsx(p,{children:"When databases or tables are renamed or transferred using external tools, the stored database name in the repository may need updating. The Rename Database feature automatically updates all instances of the old database name to the new one across all app types and legacy tools."}),e.jsxs(p,{sx:{"& ul":{listStyleType:"disc",paddingLeft:"30px"}},children:[e.jsx("h3",{children:"Usage"}),e.jsxs("ul",{children:[e.jsx("li",{children:"After exporting a WordPress website to a new server"}),e.jsx("li",{children:"After renaming or moving databases or tables with external tools"})]})]})]})]})]}),b&&e.jsx(le,{title:"Rename Database?",message:e.jsxs(p,{children:["Are you sure you want to replace all occurrences of ",e.jsxs("strong",{children:["`",r,"`"]})," with ",e.jsxs("strong",{children:["`",o,"`"]}),"?",e.jsx("br",{}),e.jsx("br",{}),e.jsx("strong",{children:"This action cannot be undone!"})]}),open:b,setOpen:T,onConfirm:()=>As(r,o,a=>{if(a!=null&&a.code&&(a==null?void 0:a.message)!==void 0)switch(a.code){case"ok":u(a.message,{variant:"success"});break;case"info":u(a.message,{variant:"info"});break;default:i.error(a),u(a.message??I.contactSupport,{variant:"error"})}else i.error(a),u(I.contactSupport,{variant:"error"})},a=>{i.error(a),u(a??I.contactSupport,{variant:"error"})})})]})},Ar=()=>{const t=z(),r=x.useMemo(()=>Ot(),[]),[s,o]=x.useState(B.TABLE);i.debug(s),x.useEffect(()=>{try{const f=localStorage.getItem("ppAppsDbsSearch");f!==null&&t(te({property:"dbSearch",propertyValue:f}));const v=localStorage.getItem("ppAppsDbsSearchType");if(v!==null){const Y=JSON.parse(v);t(te({property:"dbTypes",propertyValue:Y}))}localStorage.getItem("ppAppsShowStructure")==="false"&&t(te({property:"showAppStructure",propertyValue:!1}))}catch(f){i.debug(f)}window.ppActionRenameDatabase=function(){y(!0)}},[]);const g=St(),c=Vs(),d=tr(),b=sr(),T=rr(),a=ar(),l=ir(),j=f=>{f?(window.document.documentElement.style.setProperty("--addRenameDatabaseVisibility","visible"),window.document.documentElement.style.setProperty("--addAppIconVisibility","visible")):(window.document.documentElement.style.setProperty("--addRenameDatabaseVisibility","hidden"),window.document.documentElement.style.setProperty("--addAppIconVisibility","hidden"))},[R,L]=x.useState(!0),[w,y]=x.useState(!1);x.useEffect(()=>{j(!w)},[w]),x.useEffect(()=>{Q(),S()},[l]);const S=()=>{Ts(function(f){const v=f==null?void 0:f.data;i.debug("response data",v);const O=f==null?void 0:f.context;if(i.debug("response context",O),Array.isArray(v)){const Y=[];for(let _=0;_<v.length;_++)Y.push({appId:v[_].app_id,appName:v[_].app_name,appTitle:v[_].app_title,appType:v[_].app_type,appSettings:v[_].app_settings,appAddToMenu:v[_].app_add_to_menu});const ae=O.reduce((_,fe)=>{const{app_id:ie,app_id_detail:je}=fe;return _[ie]=_[ie]??[],_[ie].push(Number(je)),_},{});t(Ie({appList:Y,appApps:ae}))}else i.error(v),u((v==null?void 0:v.message)??I.contactSupport,{variant:"error"}),t(Ie({appList:[],appApps:{}}));L(!1)},f=>{i.error("error",f),u(f??I.contactSupport,{variant:"error"}),t(Ie({appList:[],appApps:{}})),L(!1)})},Q=()=>{Cs(function(f){const v=f==null?void 0:f.data;i.debug("response data",v),t(Bt({appMetaData:v}))},f=>{i.error("error",f),u(f??I.contactSupport,{variant:"error"})})};x.useEffect(()=>{s===B.TABLE&&Q()},[s]),x.useEffect(()=>{ve.appPlugin&&(window.ppActionCreateApp=function(){s===0&&!(a.isActive===!0&&a.appDbId>0)&&o(B.FORM)},j(!(s===1||a.isActive===!0&&a.appDbId>0)))},[s,a]);const W=ye("(max-width: 600px)"),C=ye("(max-width: 900px)"),k=Ft(),X=xt();i.debug(X);const ee=x.useRef(),V=()=>a.isActive===!0&&a.appDbId>0,he=()=>e.jsx(F,{title:"Add new app",children:e.jsx(G,{sx:{color:"inherit"},onClick:()=>{t(ct()),o(B.FORM)},children:e.jsx(is,{})})}),ge=()=>e.jsx(F,{title:"Rename Database",children:e.jsx(G,{sx:{color:"inherit"},onClick:()=>{y(!w)},children:e.jsx(Ws,{})})}),n={};V()&&(n.visibility="hidden");let A="smell";try{A=localStorage.getItem("ppAppsDensity")}catch(f){i.debug(f)}const[D,re]=x.useState(A==="large"||A==="medium"?A:"small");return x.useEffect(()=>{try{localStorage.setItem("ppAppsDensity",D)}catch(f){i.debug(f)}},[D]),e.jsxs(Gs,{theme:k,children:[e.jsxs(p,{className:"pp-applist",sx:{width:"100%",visibility:V()?"hidden":"visible",position:V()?"fixed":"auto",height:V()?0:"auto",...V()&&{visibility:"hidden",position:"absolute",left:-99999,top:-99999},"& .pp-app-details":{...n}},children:[e.jsx(mt,{position:"relative",elevation:4,sx:{margin:"0 0 5px 0"},children:e.jsxs(ht,{className:"pp-applist-toolbar",sx:{display:"grid",gap:"12px",paddingRight:"12px !important",...W?{gap:0,paddingRight:"10px",paddingBottom:"10px",paddingLeft:"10px","& .pp-applist-search":{gridTemplateColumns:"1fr",gridGap:"2px"}}:{...C?{gap:0,paddingRight:"10px",paddingBottom:"10px",paddingLeft:"10px","& .pp-applist-search":{justifyContent:"end",gridTemplateColumns:"auto auto auto"}}:{justifyContent:"space-between",gridTemplateColumns:"auto 1fr"}}},children:[e.jsxs(p,{className:"pp-applist-title",sx:{display:"inline-grid",gridTemplateColumns:"auto auto auto",justifyContent:"start",alignItems:"center",gridGap:"10px"},children:[e.jsx(p,{sx:{fontSize:"18px",lineHeight:"18px",fontWeight:"bold",whiteSpace:"nowrap"},children:"Apps"}),e.jsxs(p,{sx:{display:"inline-grid",gridTemplateColumns:"auto auto",justifyContent:"start",alignItems:"center"},children:[e.jsx(p,{children:s===B.TABLE&&!w&&e.jsx(e.Fragment,{children:he()})}),e.jsx(p,{children:s===B.TABLE&&!w&&e.jsx(e.Fragment,{children:ge()})})]})]}),e.jsxs(p,{className:"pp-applist-search",sx:{display:"grid",gridTemplateColumns:"auto auto auto",gridGap:"10px",justifyContent:"end",alignItems:"center"},children:[e.jsxs(p,{children:[e.jsx(F,{title:"App View",children:e.jsx(G,{onClick:()=>{t(te({property:"showAppStructure",propertyValue:!0}));try{localStorage.setItem("ppAppsShowStructure","true")}catch(f){i.debug(f)}},sx:{color:"#fff"},children:e.jsx(Xt,{})})}),e.jsx(F,{title:"List View",children:e.jsx(G,{onClick:()=>{t(te({property:"showAppStructure",propertyValue:!1}));try{localStorage.setItem("ppAppsShowStructure","false")}catch(f){i.debug(f)}},sx:{color:"#fff"},children:e.jsx(es,{})})}),e.jsx(F,{title:"Toggle density",children:e.jsx(G,{onClick:()=>{re(D==="large"?"medium":D==="medium"?"small":"large")},sx:{color:"#fff"},children:D==="small"?e.jsx(ts,{}):D==="medium"?e.jsx(ss,{}):e.jsx(rs,{})})})]}),e.jsx(K,{value:b,type:"search",placeholder:"Search",disabled:s===B.FORM,onChange:f=>{t(te({property:"dbSearch",propertyValue:f.target.value}));try{localStorage.setItem("ppAppsDbsSearch",f.target.value)}catch(v){i.debug(v)}},sx:{backgroundColor:"#fff",fontSize:"1em",margin:0,padding:0,borderRadius:"4px","&.MuiFormControl-root.MuiTextField-root .MuiInputBase-root":{paddingRight:0},"&.MuiFormControl-root.MuiTextField-root input":{padding:"8px"}},slotProps:{input:{startAdornment:e.jsx(Hs,{position:"end",sx:{fontSize:"1.5rem",padding:0,margin:0},children:e.jsx(as,{})})}}}),e.jsx(Te,{multiple:!0,size:"small",options:X,getOptionLabel:f=>f.text,isOptionEqualToValue:(f,v)=>f.id===v.id,value:T,disableCloseOnSelect:!0,disabled:s===B.FORM,onChange:(f,v)=>{t(te({property:"dbTypes",propertyValue:v.map(O=>({id:O.id,text:Object.values(zt)[O.id]}))}));try{localStorage.setItem("ppAppsDbsSearchType",JSON.stringify(v))}catch(O){i.debug(O)}},renderInput:f=>e.jsx(p,{ref:ee,children:e.jsx(K,{...f,sx:{minWidth:"250px","& .MuiInputBase-root":{backgroundColor:"#fff",padding:"0",maxHeight:"39px",overflow:"hidden"},"& .MuiButtonBase-root.MuiChip-root.MuiAutocomplete-tag":{height:"auto"}},placeholder:T.length===0?"Select app types":""})}),renderTags:(f,v)=>f.map((O,Y)=>{const{key:ae,..._}=v({index:Y});return e.jsx(Ce,{variant:"outlined",label:O.text,..._},ae)})})]})]})}),w?e.jsx(yr,{close:()=>y(!1)}):e.jsxs(e.Fragment,{children:[s===B.TABLE&&e.jsx(er,{apps:g,appApps:c,search:b,types:T,isLoading:R,density:D}),s===B.FORM&&e.jsx(br,{setMode:o}),d!==0&&d!==void 0&&e.jsx(Zs,{appDbId:d})]})]}),a.isActive===!0&&a.appDbId>0&&e.jsx(Qs,{appId:r,appDbId:a.appDbId,designMode:!0,isExploring:!0})]})},ba=Object.freeze(Object.defineProperty({__proto__:null,default:Ar},Symbol.toStringTag,{value:"Module"}));export{lr as A,hr as C,gr as M,dr as a,jr as b,ur as c,or as d,nr as e,pr as f,ba as g};
