import{j as t}from"./cm-1.0.36-c_d2YVSf.js";import{r as m}from"./redux-1.0.36-Dw38apwx.js";import{u as g,a as C}from"./hooks-1.0.36-DVpFeylj.js";import{l as u,A as R,Q as _,T as W,U as z,V as L,S as H,v as U,E as G,W as I,d as Q,X as V,Y as X}from"./lib-1.0.36-RK2jtnD_.js";import{A as Y}from"./AppContainerSelector-1.0.36-BfValeBK.js";import{B as x,S as q}from"./Spinner-1.0.36-BfGTD4Gb.js";import{u as J,a as K,b as Z}from"./useChartSettings-1.0.36-DKli_4MO.js";import{u as v,A as $}from"./AppTheme-1.0.36-BB9LBkIC.js";import{u as ee,B as te,C as se}from"./useFormDetails-1.0.36-Bik4Yf-M.js";import{e as pe,F as oe,A as ne,T as re,M as ie}from"./index-1.0.36-Cdz_jNzK.js";import{D as y}from"./LanguagesSupport-1.0.36-CNwr1suX.js";import{T as M}from"./Tooltip-1.0.36-BmrJt8sK.js";import{I as f}from"./iconBase-1.0.36-Cg_-P7_6.js";import{M as ae}from"./MenuItem-1.0.36-BUF9VZzL.js";import{M as le}from"./Menu-1.0.36-BJc4ujw0.js";import{u as ce}from"./useTableSettings-1.0.36-CsJX39Me.js";import{u as me}from"./useStoreFormSettings-1.0.36-DjvLmz7r.js";import{u as ue}from"./useTheme-1.0.36-BoaurWjH.js";import{T as de}from"./ThemeProvider-1.0.36-BePdakPr.js";import"./vendor-1.0.36-CN03Eozo.js";import"./loglevel-1.0.36-BZ7XahX3.js";import"./lodash-1.0.36-DFhYoGis.js";import"./moment-1.0.36-C5S46NFB.js";import"./main-1.0.36.js";import"./notistack-1.0.36-BWLrSPn1.js";import"./FallbackSpinner-1.0.36-D7KlMhQ_.js";import"./useLoadAppMetaData-1.0.36-V1rR8IcL.js";import"./RestApi-1.0.36-XUqEDvWp.js";import"./StoreTypeEnum-1.0.36-7-S8NaGy.js";import"./Typography-1.0.36-CpRCY5e-.js";import"./index-1.0.36-xGqEIHxf.js";import"./getThemeProps-1.0.36-R5fuQQuM.js";import"./useEnhancedEffect-1.0.36-CTzd5Szc.js";import"./useControlled-1.0.36-DU9XYnsb.js";import"./Popper-1.0.36-B2EKBEPA.js";import"./dividerClasses-1.0.36-cwzIcK9n.js";import"./isHostComponent-1.0.36-DVu5iVWx.js";import"./debounce-1.0.36-Be36O1Ab.js";const xe=()=>{const e=g(s=>s.appData);return u.debug("appData",e),e},he=({appRootId:e,appId:s,appDbId:r,isVisible:a,fullScreen:o})=>{const[p,l]=m.useState(!1);return m.useEffect(()=>{a&&!p&&l(!0)},[a]),p?t.jsx(x,{className:"pp-apps-root"+(a?"":" pp-element-hide"),sx:{"& .pp-app-container .pp-component header.pp-header":{margin:0,visibility:"hidden",position:"absolute",left:-99999,top:-99999}},children:t.jsx(Y,{appId:s,appDbId:r,fullScreen:o,appRootId:e})}):null},ge=e=>{const s=g(r=>r.appApps[e]!==void 0?r.appApps[e].activeAppId??r.appApps[e].apps[0]:0);return u.debug("activeAppId",s,e),s},fe=e=>{const s=g(r=>r.appData[e]);return u.debug("appData",s),s},Ae=({appId:e})=>{const s=C(),r=ee(e),a=v(e),o=fe(e);return t.jsx(M,{title:t.jsx(te,{details:r,mode:o==null?void 0:o.mode}),className:"pp-builder-button",children:t.jsx(f,{sx:{color:"inherit",padding:0},onClick:()=>{var p,l;((l=(p=a==null?void 0:a.app)==null?void 0:p.app[0])==null?void 0:l.app_type)==R.CHART?s(_({appId:e})):(o==null?void 0:o.mode)===y.FORM?s(W({appId:e})):s(z({appId:e}))},children:t.jsx(pe,{})})})},je=({appDbId:e,appTitle:s,setActiveApp:r,handleClose:a})=>t.jsx(ae,{onClick:()=>{r(e),a()},children:t.jsx("span",{children:s})}),Se=({apps:e,setActiveApp:s})=>{const[r,a]=m.useState(null),o=!!r,p=n=>{a(n.currentTarget),n.stopPropagation()},l=()=>{a(null)};return t.jsxs(x,{sx:{position:"relative"},children:[t.jsx(f,{sx:{color:"inherit",padding:0},onClick:p,children:t.jsx(oe,{})}),t.jsxs(le,{anchorEl:r,open:o,onClose:l,anchorOrigin:{vertical:"bottom",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"left"},sx:{marginTop:"8px","& ul":{padding:"0 !important"},"& ul li":{padding:"12px 24px 12px 18px !important"}},children:[...e.apps.map(n=>e.titles[n]===void 0?null:t.jsx(je,{appDbId:n,appTitle:e.titles[n],setActiveApp:s,handleClose:l}))]})]})},rt=({appId:e})=>{var j,S,b,T;u.debug(e);const s=C(),r=J(),a=se(),o=L.getSelectors().selectApps(H.getState().appApps,e),p=m.useMemo(()=>{const i={};return Array.isArray(o.apps)&&o.apps.length>0&&o.apps.map(h=>{i[h]=U()}),i},[]),l=K(e),n=v(e),F=m.useMemo(()=>{var i,h;return((h=(i=n==null?void 0:n.app)==null?void 0:i.app[0])==null?void 0:h.app_title)!==""?n.app.app[0].app_title:"WP Data Access"},[]),c=ge(e),E=i=>{s(X({appId:e,activeAppId:i}))};Z(p[c]);const B=ce(p[c]),k=me(p[c]),w=ue(p[c]),O=$(w,B,k),[d,be]=m.useState(((b=window.PP_APP_CONFIG[(S=(j=n==null?void 0:n.app)==null?void 0:j.app[0])==null?void 0:S.app_id])==null?void 0:b.appFullscreen)===!0);u.debug("appFullScreen",d);const A=xe();m.useEffect(()=>{u.debug("setFullScreen",p,d),Object.keys(p).map(i=>{s(G({appId:p[Number(i)],property:{fullScreen:d??!1}}))})},[A,d]);const P=((T=A[p[c]])==null?void 0:T.mode)??y.TABLE;u.debug("mode",P);let N={};const D=()=>null;return o===void 0||Object.keys(p).length===0?t.jsx(q,{}):t.jsx(de,{theme:O,children:t.jsxs(x,{className:"pp-apps-container",sx:{...d?N:{},"& .pp-element-hide":{visibility:"hidden",position:"absolute",left:-99999,top:-99999}},children:[t.jsx(ne,{className:"pp-apps-header",position:"relative",sx:{margin:"0 0 5px 0"},children:t.jsxs(re,{sx:{display:"grid",gridTemplateColumns:"auto auto",justifyContent:"space-between",alignItems:"center"},children:[t.jsxs(x,{sx:{display:"grid",gridTemplateColumns:"auto auto",justifyContent:"space-between",alignItems:"center",gap:"5px","& span":{whiteSpace:"nowrap",fontSize:"18px",lineHeight:"18px",fontWeight:"bold"},"& span.pp-header-title":{minWidth:0,textOverflow:"ellipsis",overflow:"hidden",marginRight:"10px"}},children:[t.jsx("span",{children:t.jsx(Se,{apps:o,setActiveApp:E})}),t.jsxs("span",{className:"pp-header-title",children:[F," - ",o.titles[c]]})]}),t.jsxs(x,{sx:{display:"flex",gap:"10px",justifyContent:"center",alignItems:"center"},children:[I(n)&&t.jsx(Ae,{appId:p[c]}),D(),(n==null?void 0:n.isExploring)&&t.jsx(M,{title:l.close,children:t.jsx(f,{sx:{color:"inherit",padding:0},onClick:()=>{s(Q({isActive:!1,appDbId:0})),a(e),r(e),s(V({})),Object.keys(p).map(i=>{a(p[i]),r(p[i])})},children:t.jsx(ie,{})})})]})]})}),...o.apps.map(i=>t.jsx(he,{appRootId:e,appId:p[i],appDbId:i,isVisible:i===c,fullScreen:d}))]})})};export{rt as default};
