import{j as s}from"./cm-1.0.31-BzgG35ZX.js";import{r as x}from"./redux-1.0.31-CuzmJMK6.js";import{P as Ce,b as re,a as Se}from"./index-1.0.31-CARe8LQx.js";import{c as te,B,M as _e}from"./cjs-1.0.31-B-_HdexB.js";import{a as Re}from"./RestApi-1.0.31-C4KxgDIV.js";import{bO as Oe,l as we,a9 as ke,ax as qe}from"./lib-1.0.31-BbX3jq4e.js";import{C as Ie}from"./ChartTypeSelection-1.0.31-CmsJYaXK.js";import{C as Ee}from"./Chart-1.0.31-BJ9n7v4e.js";import{u as ze}from"./useTableColumnOrder-1.0.31-CvAinKiB.js";import{e as Me}from"./useTheme-1.0.31-BXg8i2QZ.js";import{c as A,g as ge}from"./vendor-1.0.31-BmpNFhoq.js";import{u as Pe,v as Ae}from"./index-1.0.31-C_6FsHsh.js";import{T as Be}from"./Tooltip-1.0.31-crORCg22.js";import{I as G}from"./iconBase-1.0.31-C37NsRUm.js";import{P as Ge}from"./Menu-1.0.31-BOTBPSPr.js";import{B as z}from"./Spinner-1.0.31-Be7r01J6.js";import{F as Le}from"./FormHelperText-1.0.31-CQcG9a5q.js";import{I as Fe,S as Ne,T as We}from"./TextField-1.0.31-TtMrk-_t.js";import{M as Ue}from"./MenuItem-1.0.31-CTowyoSp.js";import{A as De,C as $e}from"./Autocomplete-1.0.31-DLbMViDM.js";import"./index-1.0.31-545nqCBP.js";import"./Typography-1.0.31-BdhCS1KD.js";import"./notistack-1.0.31-CuGQWCbt.js";import"./loglevel-1.0.31-BZ7XahX3.js";import"./lodash-1.0.31-BtCjXqrS.js";import"./moment-1.0.31-C5S46NFB.js";import"./ChartTypes-1.0.31-BPnqCrdo.js";import"./ListItemIcon-1.0.31-BCafYY7N.js";import"./main-1.0.31.js";import"./index-1.0.31-DboOrfK9.js";import"./AdminTheme-1.0.31-QbwKcRV7.js";import"./Popper-1.0.31-QmfursjS.js";import"./useControlled-1.0.31-27-LkxG9.js";import"./useFormControl-1.0.31-2YJOQA8g.js";import"./FormLabel-1.0.31-7Vju-x1c.js";import"./createSvgIcon-1.0.31-BC4iq9Gi.js";import"./Close-1.0.31-BTPwVQpD.js";var L,ne;function ee(){if(ne)return L;ne=1;function e(r){var t=typeof r;return r!=null&&(t=="object"||t=="function")}return L=e,L}var F,ie;function Xe(){if(ie)return F;ie=1;var e=typeof A=="object"&&A&&A.Object===Object&&A;return F=e,F}var N,oe;function ve(){if(oe)return N;oe=1;var e=Xe(),r=typeof self=="object"&&self&&self.Object===Object&&self,t=e||r||Function("return this")();return N=t,N}var W,ae;function He(){if(ae)return W;ae=1;var e=ve(),r=function(){return e.Date.now()};return W=r,W}var U,se;function Je(){if(se)return U;se=1;var e=/\s/;function r(t){for(var i=t.length;i--&&e.test(t.charAt(i)););return i}return U=r,U}var D,ue;function Ke(){if(ue)return D;ue=1;var e=Je(),r=/^\s+/;function t(i){return i&&i.slice(0,e(i)+1).replace(r,"")}return D=t,D}var $,ce;function je(){if(ce)return $;ce=1;var e=ve(),r=e.Symbol;return $=r,$}var X,le;function Qe(){if(le)return X;le=1;var e=je(),r=Object.prototype,t=r.hasOwnProperty,i=r.toString,o=e?e.toStringTag:void 0;function l(c){var n=t.call(c,o),m=c[o];try{c[o]=void 0;var a=!0}catch{}var d=i.call(c);return a&&(n?c[o]=m:delete c[o]),d}return X=l,X}var H,de;function Ve(){if(de)return H;de=1;var e=Object.prototype,r=e.toString;function t(i){return r.call(i)}return H=t,H}var J,fe;function Ye(){if(fe)return J;fe=1;var e=je(),r=Qe(),t=Ve(),i="[object Null]",o="[object Undefined]",l=e?e.toStringTag:void 0;function c(n){return n==null?n===void 0?o:i:l&&l in Object(n)?r(n):t(n)}return J=c,J}var K,me;function Ze(){if(me)return K;me=1;function e(r){return r!=null&&typeof r=="object"}return K=e,K}var Q,pe;function er(){if(pe)return Q;pe=1;var e=Ye(),r=Ze(),t="[object Symbol]";function i(o){return typeof o=="symbol"||r(o)&&e(o)==t}return Q=i,Q}var V,be;function rr(){if(be)return V;be=1;var e=Ke(),r=ee(),t=er(),i=NaN,o=/^[-+]0x[0-9a-f]+$/i,l=/^0b[01]+$/i,c=/^0o[0-7]+$/i,n=parseInt;function m(a){if(typeof a=="number")return a;if(t(a))return i;if(r(a)){var d=typeof a.valueOf=="function"?a.valueOf():a;a=r(d)?d+"":d}if(typeof a!="string")return a===0?a:+a;a=e(a);var g=l.test(a);return g||c.test(a)?n(a.slice(2),g?2:8):o.test(a)?i:+a}return V=m,V}var Y,he;function Te(){if(he)return Y;he=1;var e=ee(),r=He(),t=rr(),i="Expected a function",o=Math.max,l=Math.min;function c(n,m,a){var d,g,C,O,p,S,j=0,w=!1,b=!1,R=!0;if(typeof n!="function")throw new TypeError(i);m=t(m)||0,e(a)&&(w=!!a.leading,b="maxWait"in a,C=b?o(t(a.maxWait)||0,m):C,R="trailing"in a?!!a.trailing:R);function T(u){var _=d,I=g;return d=g=void 0,j=u,O=n.apply(I,_),O}function v(u){return j=u,p=setTimeout(q,m),w?T(u):O}function E(u){var _=u-S,I=u-j,P=m-_;return b?l(P,C-I):P}function k(u){var _=u-S,I=u-j;return S===void 0||_>=m||_<0||b&&I>=C}function q(){var u=r();if(k(u))return M(u);p=setTimeout(q,E(u))}function M(u){return p=void 0,R&&d?T(u):(d=g=void 0,O)}function h(){p!==void 0&&clearTimeout(p),j=0,d=S=g=p=void 0}function y(){return p===void 0?O:M(r())}function f(){var u=r(),_=k(u);if(d=arguments,g=this,S=u,_){if(p===void 0)return v(S);if(b)return clearTimeout(p),p=setTimeout(q,m),T(S)}return p===void 0&&(p=setTimeout(q,m)),O}return f.cancel=h,f.flush=y,f}return Y=c,Y}var tr=Te();const nr=ge(tr);var Z,xe;function ir(){if(xe)return Z;xe=1;var e=Te(),r=ee(),t="Expected a function";function i(o,l,c){var n=!0,m=!0;if(typeof o!="function")throw new TypeError(t);return r(c)&&(n="leading"in c?!!c.leading:n,m="trailing"in c?!!c.trailing:m),e(o,l,{leading:n,maxWait:l,trailing:m})}return Z=i,Z}var or=ir();const ar=ge(or),sr=(e,r,t,i)=>{switch(r){case"debounce":return nr(e,t,i);case"throttle":return ar(e,t,i);default:return e}},ur=e=>{const r=x.useRef(e);return x.useEffect(()=>{r.current=e}),x.useMemo(()=>(...t)=>{var i;return(i=r.current)===null||i===void 0?void 0:i.call(r,...t)},[])},cr=e=>{const[r,t]=x.useState((e==null?void 0:e.current)||null);return e&&setTimeout(()=>{e.current!==r&&t(e.current)},0),{refProxy:x.useMemo(()=>new Proxy(o=>{o!==r&&t(o)},{get(o,l){return l==="current"?r:o[l]},set(o,l,c){return l==="current"?t(c):o[l]=c,!0}}),[r]),refElement:r,setRefElement:t}},lr=(e,r)=>r==="border-box"?{width:e.borderBoxSize[0].inlineSize,height:e.borderBoxSize[0].blockSize}:r==="content-box"?{width:e.contentBoxSize[0].inlineSize,height:e.contentBoxSize[0].blockSize}:{width:e.contentRect.width,height:e.contentRect.height};function dr({skipOnMount:e=!1,refreshMode:r,refreshRate:t=1e3,refreshOptions:i,handleWidth:o=!0,handleHeight:l=!0,targetRef:c,observerOptions:n,onResize:m}={}){const a=x.useRef(e),d=ur(m),[g,C]=x.useState({width:void 0,height:void 0}),{refProxy:O,refElement:p}=cr(c),{box:S}=n||{},j=x.useCallback(b=>{if(!o&&!l)return;if(a.current){a.current=!1;return}const R=(T,v)=>o&&T.width!==v.width||l&&T.height!==v.height;b.forEach(T=>{const v=lr(T,S);C(E=>R(E,v)?(d==null||d({width:v.width,height:v.height,entry:T}),v):E)})},[o,l,a,S]),w=x.useCallback(sr(j,r,t,i),[j,r,t,i]);return x.useEffect(()=>{let b;return p?(b=new window.ResizeObserver(w),b.observe(p,n)):(g.width||g.height)&&(d==null||d({width:null,height:null,entry:null}),C({width:void 0,height:void 0})),()=>{var R,T,v;(R=b==null?void 0:b.disconnect)===null||R===void 0||R.call(b),(v=(T=w).cancel)===null||v===void 0||v.call(T)}},[w,p]),Object.assign({ref:O},g)}const Kr=({appId:e,componentWidth:r,table:t,tableStore:i,metaData:o,appLanguage:l})=>{const c=Re(),n=Me(e),m=ze(e),a=x.useMemo(()=>{const h=[];return m.map(y=>{var u;const f=(u=o==null?void 0:o.columns)==null?void 0:u.findIndex(_=>_.column_name===y);if(f!==-1)switch(o.columns[f].data_type.toLowerCase()){case"decimal":case"double":case"double precision":case"float":case"real":case"bit":case"tinyint":case"smallint":case"int":case"integer":case"mediumint":case"bigint":h.push({columnName:y,dataType:"number"});break}}),h},[m]),[d,g]=x.useState(""),[C,O]=x.useState([]),[p,S]=x.useState("BarChart"),[j,w]=x.useState(!1),b=x.useRef(null),R=x.useCallback(()=>{b.current&&E(b.current.offsetWidth)},[b]),{width:T}=dr({targetRef:b,onResize:R}),[v,E]=x.useState(),k=h=>{const y=i.columns.filter(f=>f.columnName===h);return y.length===1?y[0].columnLabel:h},q=()=>{var y;const h=Oe(t,d,C,j,i.columns,o);we.debug(h),((y=n==null?void 0:n.data)==null?void 0:y.length)>0?c(ke({appId:e,property:{majorAxisColumn:d,minorAxisColumns:C,data:h,chartType:p,grouped:j}})):c(qe({appId:e,chartState:{majorAxisColumn:d,minorAxisColumns:C,data:h,chartType:p,grouped:j}}))},M=h=>null;return s.jsx(Ce,{variant:"popover",popupId:e,children:h=>{var y;return s.jsxs(s.Fragment,{children:[r<900?s.jsx(Be,{title:"Charts",children:s.jsx(G,{...re(h),children:s.jsx(te,{})})}):s.jsx(B,{variant:"contained",endIcon:s.jsx(te,{}),...re(h),onClickCapture:()=>{n!==void 0&&q()},children:"CHARTS"}),s.jsx(Ge,{...Se(h),anchorOrigin:{vertical:"bottom",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"left"},sx:{boxShadow:"0px 5px 5px -3px rgba(0,0,0,0.2),0px 8px 10px 1px rgba(0,0,0,0.14),0px 3px 14px 2px rgba(0,0,0,0.12)","& > .MuiPaper-root":{resize:"horizontal",minWidth:"380px",width:v+"px"}},children:s.jsxs(z,{sx:{display:"grid",gap:"20px",padding:"20px"},ref:b,children:[s.jsxs(z,{sx:{display:"grid",gridTemplateColumns:"1fr auto auto",alignItems:"center"},children:[s.jsx(z,{sx:{marginRight:"12px"},children:s.jsxs(Le,{fullWidth:!0,sx:{marginTop:"5px"},children:[s.jsx(Fe,{variant:"outlined",children:"Major Axis"}),s.jsx(Ne,{label:"Major Axis",variant:"outlined",value:d,onChange:f=>{g(f.target.value??"")},className:"pp-chart-category-column",sx:{"&.pp-chart-category-column .MuiSelect-select, &.pp-chart-category-column input":{padding:"16.5px 14px"}},children:m.map(function(f){if(k(f)!=="")return s.jsx(Ue,{"data-id":"ppChartCategoryColumn",value:f,children:k(f)},f)})})]})}),s.jsx(G,{color:"primary",onClick:()=>{w(!j)},children:j?s.jsx(Pe,{}):s.jsx(Ae,{})}),s.jsx(G,{color:"primary",onClick:()=>{h.close()},children:s.jsx(_e,{})})]}),s.jsx(De,{multiple:!0,options:a.map(f=>f.columnName),getOptionLabel:f=>k(f),value:C,disableCloseOnSelect:!0,onChange:(f,u)=>{O(u)},renderInput:f=>s.jsx(We,{...f,label:"Minor Axis",variant:"outlined"}),renderTags:(f,u)=>f.map((_,I)=>{const{key:P,...ye}=u({index:I});return s.jsx($e,{variant:"outlined",label:k(_),...ye},P)}),className:"pp-chart-category-column",sx:{"&.pp-chart-category-column .MuiInputBase-root":{backgroundColor:"transparent"}}}),s.jsx(Ie,{chartType:p,setChartType:S,chartTypes:(n==null?void 0:n.chartTypes)??[],isTableChart:!0}),s.jsxs(z,{sx:{display:"grid",gridTemplateColumns:"1fr 100px 100px",gap:"0.5rem"},children:[s.jsx(z,{sx:{whiteSpace:"nowrap"},children:i.state.masterDetailConditions===void 0&&s.jsx(s.Fragment,{children:M()})}),s.jsx(B,{variant:"contained",onClick:()=>{h.close()},children:l.cancel}),s.jsx(B,{variant:"contained",onClick:()=>{q()},children:l.ok})]}),(n==null?void 0:n.docked)==="undocked"&&((y=n==null?void 0:n.data)==null?void 0:y.length)>0&&(n==null?void 0:n.majorAxisColumn)!==""&&(n==null?void 0:n.minorAxisColumns.length)>0&&s.jsx(Ee,{appId:e,isBuilderEnabled:!1,isToolbarEnabled:!1,chartWidth:T,isTableChart:!0})]})})]})}})};export{Kr as default};
