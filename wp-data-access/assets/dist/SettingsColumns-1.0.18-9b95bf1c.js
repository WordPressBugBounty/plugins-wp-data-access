import{l as m,j as e,e5 as V,r as P,cD as c,e6 as ee,e7 as se,e8 as ie,_ as re,e9 as te,cS as ne,k as h,ea as H,eb as oe,ec as le,ed as ae,ee as de,ef as pe}from"./main-1.0.18.js";import{a as w,u as Q}from"./RestApi-1.0.18-cb72bd79.js";import{u as Y,S as me,a as ce,I as _,b as ue,c as xe,d as U,D as ge,e as he,f as fe,g as je,h as be,T as ye,M as Se,P as ve}from"./useMetadataColumns-1.0.18-3cad9c2e.js";import{v as E,ah as Ce,a0 as q,ai as we,a3 as Te,a4 as Fe,a5 as Pe,a6 as _e}from"./index.esm-1.0.18-12f13c4a.js";import{T as L,C as Le}from"./ConfirmDialog-1.0.18-eb1f3988.js";import{j as ke}from"./index.esm-1.0.18-32f5cee0.js";import{u as T}from"./useFormUpdates-1.0.18-2d7a3227.js";import{u as $}from"./useStoreTable-1.0.18-8a593f98.js";import{g as Ee,h as Ae,d as Ne}from"./index.esm-1.0.18-1950fc28.js";import{P as W}from"./PremiumFeature-1.0.18-2f6283b7.js";import{E as z}from"./EnumTypeEnum-1.0.18-7ffcf33a.js";import{g as B,e as Re,D as Oe}from"./useTheme-1.0.18-c1f3f722.js";import{A,a as N}from"./AccordionSummary-1.0.18-f9e114cf.js";import{A as R}from"./AccordionDetails-1.0.18-2900e110.js";import{B as j}from"./Spinner-1.0.18-de8df990.js";import{F as f,a as b}from"./FormHelperText-1.0.18-8b4ce85f.js";import{F as u}from"./FormLabel-1.0.18-47dbe87d.js";import{S as Ge}from"./Slider-1.0.18-32b00bb2.js";import{R as X}from"./RadioGroup-1.0.18-4960e4a8.js";import{R as C}from"./Radio-1.0.18-210e4079.js";import{T as y}from"./TextField-1.0.18-cf148b4e.js";import{F as Z}from"./FormControlLabel-1.0.18-2840e084.js";import{S as J}from"./Switch-1.0.18-cbb6329b.js";import{L as K}from"./Link-1.0.18-41cc6055.js";import{I as k}from"./iconBase-1.0.18-3c21f5e2.js";import"./Typography-1.0.18-dc3c0740.js";import"./useFormStore-1.0.18-a2e1b6cf.js";import"./CardContent-1.0.18-3d5e5525.js";import"./AdminTheme-1.0.18-73e13a4f.js";import"./ActionsDml-1.0.18-7e1a74e9.js";import"./MenuItem-1.0.18-0088f2a2.js";import"./Menu-1.0.18-e8cb0649.js";import"./ThemeProvider-1.0.18-247b72cc.js";import"./Popover-1.0.18-54868205.js";import"./Modal-1.0.18-870f459d.js";import"./Grow-1.0.18-4ebc2ce8.js";import"./index-1.0.18-bd94b546.js";import"./useTableUpdater-1.0.18-089ef7f9.js";import"./Stepper-1.0.18-05ecefbc.js";import"./createSvgIcon-1.0.18-dcf0276e.js";import"./StepContent-1.0.18-147bdc81.js";import"./Collapse-1.0.18-8e581380.js";import"./Checkbox-1.0.18-3ed60478.js";import"./SwitchBase-1.0.18-e2aa3211.js";import"./useFormControl-1.0.18-87a8487d.js";import"./useControlled-1.0.18-12a74006.js";import"./DialogContent-1.0.18-5570cba4.js";import"./colorManipulator-1.0.18-95bf61ec.js";import"./index-1.0.18-ff546563.js";import"./useSlot-1.0.18-71f9e7ae.js";import"./createStyled-1.0.18-b238c9ff.js";const Ve=({appId:r,columnIndex:o,tableColumn:s})=>{m.debug(r,o,s),w();const i=B(r),l=Re(r);T(r);const t=n=>[];return e.jsxs(A,{disableGutters:!0,children:[e.jsxs(N,{expandIcon:e.jsx(E,{}),sx:{fontSize:"1rem","& .MuiAccordionSummary-content":{padding:"1rem",alignItems:"center"}},children:[e.jsx(Ee,{}),e.jsx("span",{style:{paddingLeft:"0.5rem"},children:"Grid positioning"})]}),e.jsxs(R,{sx:{paddingTop:"0.5rem"},children:[e.jsxs(j,{children:[e.jsxs(f,{sx:{display:"grid"},children:[e.jsx(u,{children:"Grid cells"}),e.jsx(Ge,{value:s.cells,min:1,max:l.cellsPerRow,step:1,marks:t(l.cellsPerRow),valueLabelDisplay:"auto",disabled:!0,onChange:(n,g)=>{m.debug(n,g)},sx:{width:"calc(100% - 40px)",margin:"20px"}})]}),e.jsx(b,{children:"Number of grid cells used (can be changed in FORM > Grid)."}),e.jsxs(f,{sx:{width:"100%"},children:[e.jsx(u,{sx:{margin:"15px 0 5px 0"},children:"Grid positioning"}),e.jsx(X,{sx:{flexDirection:"column",alignContent:"flex-start",marginLeft:"10px",marginBottom:"5px"},children:e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",justifyContent:"center",alignItems:"center"},children:[e.jsxs(u,{className:"align-label-radio",children:[e.jsx(C,{checked:s.cellClass===V.AUTO,disabled:!0,onChange:n=>{n.stopPropagation()}}),"Auto"]}),e.jsxs(u,{className:"align-label-radio",children:[e.jsx(C,{checked:s.cellClass===V.START,disabled:!0,onChange:n=>{n.stopPropagation()}}),"Start"]}),e.jsxs(u,{className:"align-label-radio",children:[e.jsx(C,{checked:s.cellClass===V.END,disabled:!0,onChange:n=>{n.stopPropagation()}}),"End"]}),e.jsxs(u,{children:[e.jsx(C,{checked:typeof s.cellClass=="number",disabled:!0,onChange:n=>{n.stopPropagation()}}),"Add"]}),e.jsxs("div",{style:{marginLeft:"10px",gridColumn:"span 2",display:"grid",gridTemplateColumns:"auto auto",alignItems:"center"},children:[e.jsx(y,{id:"pp-cells-before",sx:{width:"60px"},className:"pp-cells-before",type:"number",defaultValue:1,InputProps:{inputProps:{min:1,max:l.cellsPerRow-1}},disabled:!0,InputLabelProps:{shrink:!0},onChange:n=>{n.stopPropagation()}}),e.jsx(u,{sx:{marginLeft:"10px"},children:"cell(s) before"})]})]})})]}),e.jsx(b,{children:"Grid positioning relative to surrounding cells."}),s.computedField&&o!==void 0&&(i==null?void 0:i.columns[o])!==void 0&&i.columns[o].data_type==="enum"&&e.jsxs(j,{sx:{marginTop:"20px"},children:[e.jsx(u,{children:"Show values in"}),e.jsxs(X,{sx:{flexDirection:"column",alignContent:"flex-start",margin:"10px 0 5px 10px"},children:[e.jsxs(u,{className:"align-label-radio",children:[e.jsx(C,{checked:s.updatableEnum===void 0||s.updatableEnum===z.LIST,disabled:!0,onChange:n=>{n.stopPropagation()}}),"Drop-down List"]}),e.jsxs(u,{className:"align-label-radio",children:[e.jsx(C,{checked:s.updatableEnum===z.RADIO_HORIZONTAL,disabled:!0,onChange:n=>{n.stopPropagation()}}),"Horizontal radio group"]}),e.jsxs(u,{className:"align-label-radio",children:[e.jsx(C,{checked:s.updatableEnum===z.RADIO_VERTICAL,disabled:!0,onChange:n=>{n.stopPropagation()}}),"Vertical radio group"]})]})]})]}),e.jsx(W,{single:!1})]})]})},He=({appId:r,columnIndex:o,tableColumn:s,columnMetaData:i})=>{m.debug(r,o,s),w(),T(r);const[l,t]=P.useState(!1);return s.computedField!==void 0||o===void 0||i===void 0||(i==null?void 0:i.data_type)!==void 0&&c(i.data_type)!=="number"?null:e.jsxs(A,{disableGutters:!0,children:[e.jsxs(N,{expandIcon:e.jsx(E,{}),sx:{fontSize:"1rem","& .MuiAccordionSummary-content":{padding:"1rem",alignItems:"center"}},children:[e.jsx(Ae,{}),e.jsx("span",{style:{paddingLeft:"0.5rem"},children:"Validation"})]}),e.jsxs(R,{sx:{paddingTop:"1rem"},children:[e.jsxs(f,{sx:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"10px"},children:[e.jsx(y,{error:l,type:"number",label:"Minimum value allowed",disabled:!0,value:s.numericMin??"",required:!1,InputLabelProps:{shrink:!0},onChange:n=>{m.debug(n)}}),e.jsx(y,{error:l,type:"number",label:"Maximum value allowed",disabled:!0,value:s.numericMax??"",required:!1,InputLabelProps:{shrink:!0},onChange:n=>{m.debug(n)}})]}),e.jsx(W,{})]})]})},Ue=({appId:r,columnIndex:o,tableColumn:s,columnMetaData:i})=>{m.debug(r,o,s,i);const l=w(),t=T(r),[n,g]=P.useState(!1),d=Y(r),F={marginTop:"20px",marginLeft:"10px"};return e.jsxs(A,{disableGutters:!0,children:[e.jsxs(N,{expandIcon:e.jsx(E,{}),sx:{fontSize:"1rem","& .MuiAccordionSummary-content":{padding:"1rem",alignItems:"center"}},children:[e.jsx(Ne,{}),e.jsx("span",{style:{paddingLeft:"0.5rem"},children:"Column settings"})]}),e.jsxs(R,{sx:{display:"grid",gridGap:"2rem",paddingTop:"1rem"},children:[s.computedField!==void 0&&e.jsxs(f,{children:[e.jsx(Z,{control:e.jsx(J,{checked:s.allowMarkup??!1,onChange:(p,S)=>{l(ee({appId:r,index:o,allowMarkup:S})),t(!0),p.stopPropagation()}}),label:"Add as HTML",labelPlacement:"end"}),e.jsx(b,{children:"Adds computed field content as HTML instead of text field."})]}),(s.computedField||d[s.columnName]!==void 0&&(c(d[s.columnName].data_type)==="float"||c(d[s.columnName].data_type)==="number"||c(d[s.columnName].data_type)==="time"||c(d[s.columnName].data_type,!0)==="date"||c(d[s.columnName].data_type,!0)==="datetime"||c(d[s.columnName].data_type,!0)==="timestamp"||c(d[s.columnName].data_type,!0)==="time"))&&e.jsx(j,{children:e.jsxs(f,{children:[e.jsx(Z,{control:e.jsx(J,{checked:!1,disabled:!0,onClick:p=>{p.stopPropagation()}}),label:"Localize",labelPlacement:"end"}),e.jsx(b,{children:s.computedField||d[s.columnName]!==void 0&&(c(d[s.columnName].data_type)==="float"||c(d[s.columnName].data_type)==="number")?"Localizes decimal and thousands seperators.":"Localizes date and time fields."})]})}),e.jsxs(f,{children:[e.jsx(y,{type:"text",variant:"outlined",label:"Default value",value:s.defaultValue??"",placeholder:(i==null?void 0:i.column_default)??"",InputLabelProps:{shrink:!0},onChange:p=>{l(se({appId:r,index:o,defaultValue:p.target.value})),t(!0),p.stopPropagation()}}),e.jsxs(b,{component:"div",children:[e.jsx(e.Fragment,{children:(i==null?void 0:i.column_default)!==void 0&&(i==null?void 0:i.column_default)!==null&&(i==null?void 0:i.column_default)!==""&&e.jsx(j,{sx:{fontWeight:"bold"},children:"Leave empty to use column default constraint."})}),e.jsxs("div",{children:["Only applied on insert ",n?e.jsxs(e.Fragment,{children:[e.jsx("span",{children:e.jsx(K,{sx:{cursor:"pointer"},underline:"none",onClick:()=>{g(!1)},children:"(hide examples)"})}),e.jsxs("ul",{style:{listStyle:"disc",padding:"0 40px"},children:[e.jsx("li",{children:"Hello World"}),e.jsx("li",{children:"@wpda_wp_user_id"}),e.jsx("li",{children:"@now"})]}),e.jsx("div",{style:F,children:"Notes"}),e.jsxs("ul",{style:{listStyle:"disc",padding:"0 40px"},children:[e.jsx("li",{children:"@wpda_wp_user_id returns the WordPress user ID or 0 for anonymous requests"}),e.jsx("li",{children:"@now returns the current date/time and works with date/time fields only"}),e.jsxs("li",{children:["Column default constraints defined in the database are automatically applied",(i==null?void 0:i.column_default)!==void 0&&(i==null?void 0:i.column_default)!==null&&(i==null?void 0:i.column_default)!==""&&e.jsxs(e.Fragment,{children:[" (current value is ",e.jsx("strong",{children:i==null?void 0:i.column_default}),")"]})]})]})]}):e.jsx("span",{children:e.jsx(K,{sx:{cursor:"pointer"},underline:"none",onClick:()=>{g(!0)},children:"(show examples)"})})]})]})]}),((i==null?void 0:i.data_type)!==void 0&&i.data_type.toLowerCase()!=="text"&&i.data_type.toLowerCase()!=="enum"&&i.data_type.toLowerCase()!=="set"&&i.column_type.toLowerCase()!=="tinyint(1)"&&(c(i.data_type)==="string"||c(i.data_type)==="number")||s.computedField)&&e.jsxs(f,{children:[e.jsx(j,{sx:{display:"grid",gridTemplateColumns:"auto auto",gridGap:"10px",alignItems:"center"},children:e.jsxs(e.Fragment,{children:[e.jsx(y,{type:"text",variant:"outlined",label:"Prefix",value:s.prefix,disabled:!0,InputLabelProps:{shrink:!0},onChange:p=>{p.stopPropagation()}}),e.jsx(y,{type:"text",variant:"outlined",label:"Suffix",value:s.suffix,disabled:!0,InputLabelProps:{shrink:!0},onChange:p=>{p.stopPropagation()}})]})}),e.jsx(b,{children:"Adds a prefix and/or suffix to the column content."})]}),e.jsxs(f,{children:[e.jsx(y,{type:"text",variant:"outlined",label:"CSS classes",fullWidth:!0,value:s.classNames,disabled:!0,InputLabelProps:{shrink:!0},onChange:p=>{p.stopPropagation()}}),e.jsx(b,{children:"CSS classes (seperated by spaces) for custom styling."})]}),e.jsxs(f,{children:[e.jsx(y,{type:"text",variant:"outlined",label:"Hint",fullWidth:!0,value:s.hint,disabled:!0,InputLabelProps:{shrink:!0},onChange:p=>{p.stopPropagation()}}),e.jsx(b,{children:"Help text displayed below data entry field."})]}),e.jsx(W,{single:!1,margin:"0"})]})]})},ze=({appId:r,columnIndex:o,tableColumn:s})=>{var p,S;m.debug(r,o,s);const i=w(),l=T(r),t=$(r),n=B(r),d=Y(r)[s.columnName],F=(O,G)=>{i(ie({appId:r,index:O,lookup:G})),l(!0)};return e.jsxs(e.Fragment,{children:[e.jsx(Ve,{appId:r,columnIndex:o,tableColumn:s}),e.jsx(Ue,{appId:r,columnIndex:o,tableColumn:s,columnMetaData:d}),(((p=n==null?void 0:n.privs)==null?void 0:p.insert)||((S=n==null?void 0:n.privs)==null?void 0:S.update))&&(t.table.transactions.insert||t.table.transactions.update)&&e.jsx(He,{appId:r,columnIndex:o,tableColumn:s,columnMetaData:d}),e.jsx(me,{appId:r,columnIndex:o,tableColumn:s,columnMetaData:d,setLookup:F}),e.jsx(ce,{columnMetaData:d})]})};P.lazy(()=>re(()=>import("./ComputedFieldMore-1.0.18-3124cbc3.js"),["./ComputedFieldMore-1.0.18-3124cbc3.js","./main-1.0.18.js","./index.esm-1.0.18-12f13c4a.js","./Typography-1.0.18-dc3c0740.js","./iconBase-1.0.18-3c21f5e2.js","./ConfirmDialog-1.0.18-eb1f3988.js","./AdminTheme-1.0.18-73e13a4f.js","./DialogContent-1.0.18-5570cba4.js","./Modal-1.0.18-870f459d.js","./CardContent-1.0.18-3d5e5525.js","./ConfirmDialog-1.0.18-9bff3a93.css","./index.esm-1.0.18-32f5cee0.js","./Menu-1.0.18-e8cb0649.js","./ThemeProvider-1.0.18-247b72cc.js","./Popover-1.0.18-54868205.js","./Grow-1.0.18-4ebc2ce8.js","./MenuItem-1.0.18-0088f2a2.js"],import.meta.url));const We=({appId:r,columnIndex:o})=>{m.debug(r,o);const s=w(),i=B(r),l=$(r),t=Q(a=>te(a,r,o));m.debug("tableColumn",t);const n=T(r),g=(a,x)=>{m.debug(a,x),s(oe({appId:r,index:a,visible:x})),n(!0)},d=(a,x)=>{m.debug(a,x),s(le({appId:r,index:a,more:x})),n(!0)},F=(a,x)=>{m.debug(a,x),s(ae({appId:r,index:a,updatable:x})),n(!0)};ne.TEXT;const[p,S]=P.useState(!1),[O,G]=P.useState(void 0),I=a=>{a!==void 0&&(s(de({appId:r,index:a})),n(!0))},M=(a,x,D)=>(m.debug(a,x,D),e.jsxs(e.Fragment,{children:[e.jsx(j,{children:e.jsx(ue,{id:a,enabled:!1})}),e.jsxs(j,{sx:{display:"inline-grid",gridTemplateColumns:t.computedField!==void 0?"auto auto":"auto",justifyContent:"start",alignItems:"center",gap:"10px","& svg":{opacity:"0.5"}},children:[t.computedField!==void 0&&e.jsx(ke,{}),e.jsx(u,{children:x})]})]})),v=!i.primary_key.includes(t.columnName);return e.jsxs(e.Fragment,{children:[e.jsxs(A,{disableGutters:!0,slotProps:{transition:{unmountOnExit:!0}},children:[e.jsxs(N,{className:"pp-column-settings",expandIcon:e.jsx(E,{}),sx:{justifyContent:"space-between"},children:[e.jsx(j,{sx:{display:"grid",gridTemplateColumns:"auto 1fr",alignItems:"center","& svg":{display:"flex"}},children:M(t.columnName,t.columnLabel,o)}),e.jsxs(j,{style:{display:"grid",gridTemplateColumns:"40px 40px 40px"},children:[e.jsx(L,{title:"Visibility",position:"bottom",children:e.jsx(k,{onClick:a=>{t.visible?t.more?(g(o,!1),d(o,!1)):d(o,!0):t.more?d(o,!1):g(o,!0),a.stopPropagation()},children:t.visible?e.jsx(e.Fragment,{children:t.more?e.jsx(_,{checked:!0,children:e.jsx(Ce,{})}):e.jsx(_,{checked:!0,children:e.jsx(q,{})})}):e.jsx(_,{checked:!1,children:e.jsx(q,{})})})}),t.computedField?e.jsx(e.Fragment,{children:e.jsx(L,{title:"Delete",position:"bottom",children:e.jsx(k,{onClick:a=>{S(!0),G(o),a.stopPropagation()},children:e.jsx(Te,{})})})}):e.jsx(L,{title:"Updatable",position:"bottom",disabled:!l.table.transactions.insert&&!l.table.transactions.update||!v||!t.visible,children:e.jsx(k,{disabled:!l.table.transactions.insert&&!l.table.transactions.update||!v||!t.visible,onClick:a=>{F(o,!t.updatable),a.stopPropagation()},children:e.jsx(_,{checked:t.updatable&&v&&(l.table.transactions.insert||l.table.transactions.update),disabled:!l.table.transactions.insert&&!l.table.transactions.update||!v,forceOff:!v||!t.visible,children:e.jsx(we,{})})})}),e.jsx(L,{title:"Alignment",position:"bottom",disabled:!v||!t.visible,children:e.jsxs(k,{disabled:!v||!t.visible,onClick:a=>{t.alignment===h.LEFT?s(H({appId:r,index:o,alignment:h.CENTER})):t.alignment===h.CENTER?s(H({appId:r,index:o,alignment:h.RIGHT})):t.alignment===h.RIGHT&&s(H({appId:r,index:o,alignment:h.LEFT})),n(!0),a.stopPropagation()},children:[t.alignment===h.LEFT&&e.jsx(Fe,{}),t.alignment===h.CENTER&&e.jsx(Pe,{}),t.alignment===h.RIGHT&&e.jsx(_e,{})]})})]})]}),e.jsx(R,{children:e.jsx(ze,{appId:r,columnIndex:o,tableColumn:t})})]},o),e.jsx(Le,{title:"Delete computed field?",message:"Are you sure you want to delete this computed field? This action cannot be undone!",open:p,setOpen:S,onConfirm:()=>I(O)})]})},Us=({appId:r})=>{m.debug(r),w();const o=xe(U(ve),U(Se),U(ye));T(r);const s=l=>{const{active:t,over:n}=l;(t==null?void 0:t.id)!==(n==null?void 0:n.id)&&m.debug(t,n)},i=Q(l=>pe(l,r));return i===void 0||i.length===0?null:e.jsxs(e.Fragment,{children:[e.jsx(ge,{autoScroll:!0,sensors:o,collisionDetection:he,onDragEnd:s,children:e.jsx(fe,{items:i,children:i.map((l,t)=>e.jsx(je,{id:l,children:e.jsx(We,{appId:r,columnIndex:t})},l))})}),e.jsx(be,{appId:r,target:Oe.FORM})]})};export{Us as default};
