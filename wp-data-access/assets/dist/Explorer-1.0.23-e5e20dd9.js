import{r as i,j as e,_ as q,l,aV as ws,aW as vs,C as G,aX as ks,aY as Es,aZ as _s,a_ as Ms,a$ as Ps,b0 as Ls,b1 as As,b2 as Ds,b3 as Os,b4 as zs,b5 as Rs,b6 as Fs,b7 as Bs,b8 as Ks,b9 as fe,ba as Vs,bb as Ns,bc as Ws,m as he,bd as $s,be as Gs,bf as Hs,bg as qs,bh as Ys,bi as Qs,bj as Us,bk as Js,bl as Xs,bm as Zs,bn as Ne,bo as je,bp as ye,bq as et,br as st,bs as We,bt as $e,bu as Ge,bv as He,bw as tt,bx as at,by as nt,bz as ot,bA as rt,bB as it,bC as lt,S as ct,e as ze,bD as dt,aO as pt,q as ut,aI as xt,bE as mt,bF as gt,bG as ht}from"./main-1.0.23.js";import{l as ft,a as jt,b as yt,c as bt,d as Tt,e as Ct,f as St,g as It,h as wt}from"./ActionsExplorer-1.0.23-02905de3.js";import{a as R,u as C}from"./RestApi-1.0.23-cc179eb9.js";import{B as p,C as vt,S as kt}from"./Spinner-1.0.23-90ab83ff.js";import{_ as pe,b as V,c as qe,i as Le,m as Et,n as _t,T as we}from"./Typography-1.0.23-19a0fd3e.js";import{u as oe,M as re,B as Re,T as Ye,a as Qe,b as Ie,c as N,d as Ue}from"./index.esm-1.0.23-4f58f177.js";import{T as Q,u as Ae,a as Mt,b as Pt,c as Lt}from"./ActionsAdmin-1.0.23-4f708194.js";import{b as Je,c as Xe,d as Ze,B as At}from"./index.esm-1.0.23-5dc3dbfa.js";import{H as be,I as Dt,J as Ot,d as zt,K as Rt,t as Ft,L as Bt,A as De,T as Oe,N as Kt,O as Vt,P as es,Q as ss,M as Nt,R as Wt,S as $t,v as Fe,U as Gt,h as Ht,q as qt,r as Yt,s as Qt}from"./index.esm-1.0.23-ba0465a2.js";import{a as Ut,b as Jt}from"./index.esm-1.0.23-9200891c.js";import{u as ts,t as Y,T as Xt,a as Zt,b as ea,g as sa,S as ta}from"./TreeItem2Provider-1.0.23-9f893bc1.js";import{C as aa}from"./Collapse-1.0.23-a92fc278.js";import{u as Be,r as ee,I as ne,P as Me}from"./iconBase-1.0.23-43ac6f06.js";import{a as Te,u as na}from"./colorManipulator-1.0.23-e382be1d.js";import{E as Ce}from"./ExplorerActionEnum-1.0.23-304129ea.js";import{A as X}from"./AdminTheme-1.0.23-7044caf5.js";import{C as J}from"./Checkbox-1.0.23-e63c68aa.js";import{T as ue}from"./Tooltip-1.0.23-1b58a848.js";import{L as se}from"./Link-1.0.23-48d9bdb4.js";import{C as oa,a as ra,B as ge}from"./CardContent-1.0.23-cd3f2c87.js";import{C as ia}from"./CardHeader-1.0.23-edc42c3d.js";import{F as te}from"./FormHelperText-1.0.23-83597bdf.js";import{F as Se}from"./FormLabel-1.0.23-71a056b2.js";import{C as la}from"./CardActions-1.0.23-6c452d3f.js";import{T as as,S as ns,I as ca}from"./TextField-1.0.23-1657e9d4.js";import{I as Ke}from"./InputAdornment-1.0.23-4e3a41ab.js";import{D as da,a as pa,b as ua,C as os,T as xa}from"./ConfirmDialog-1.0.23-f318040f.js";import{D as ma,a as ga,b as ha}from"./DialogContent-1.0.23-79893b13.js";import{M as xe}from"./MenuItem-1.0.23-0a5da249.js";/* empty css                    */import"./createSvgIcon-1.0.23-f9410a01.js";import"./Modal-1.0.23-3fe42627.js";import"./useControlled-1.0.23-1e71c28b.js";import"./FormControlLabel-1.0.23-1ad68af6.js";import"./useFormControl-1.0.23-a0ae6ce7.js";import"./createStyled-1.0.23-528f26c2.js";import"./Radio-1.0.23-7006053b.js";import"./SwitchBase-1.0.23-adccc77c.js";import"./Autocomplete-1.0.23-a5bc1209.js";import"./Close-1.0.23-ea28bfa6.js";import"./index-1.0.23-9af490ae.js";import"./Popper-1.0.23-4a0d0616.js";import"./AlertTitle-1.0.23-db3e7867.js";import"./useSlot-1.0.23-b9d48820.js";import"./Menu-1.0.23-e889464a.js";import"./ThemeProvider-1.0.23-f3e5cbc1.js";import"./Popover-1.0.23-6c9c65a6.js";import"./Grow-1.0.23-40b2ff68.js";import"./ListItemIcon-1.0.23-db4c6871.js";import"./Divider-1.0.23-d1a6ffad.js";import"./Switch-1.0.23-86b06b05.js";import"./TimePicker-1.0.23-d0b1e0ce.js";import"./useMobilePicker-1.0.23-d86c6ab1.js";import"./ListItem-1.0.23-64a79cf3.js";import"./date-time-utils-1.0.23-aa0087e0.js";import"./DateTimePicker-1.0.23-f93dd334.js";import"./Tabs-1.0.23-d047285a.js";import"./dateViewRenderers-1.0.23-cded121c.js";import"./DatePicker-1.0.23-0abda5fe.js";import"./Slider-1.0.23-75ca4c04.js";function fa(s){const{instance:t,selection:{multiSelect:o}}=ts(),a=t.isItemExpandable(s),c=t.isItemExpanded(s),x=t.isItemFocused(s),y=t.isItemSelected(s),f=t.isItemDisabled(s);return{disabled:f,expanded:c,selected:y,focused:x,handleExpansion:r=>{if(!f){x||t.focusItem(r,s);const b=o&&(r.shiftKey||r.ctrlKey||r.metaKey);a&&!(b&&t.isItemExpanded(s))&&t.toggleItemExpansion(r,s)}},handleSelection:r=>{f||(x||t.focusItem(r,s),o&&(r.shiftKey||r.ctrlKey||r.metaKey)?r.shiftKey?t.selectRange(r,{end:s}):t.selectItem(r,s,!0):t.selectItem(r,s))},preventSelection:r=>{(r.shiftKey||r.ctrlKey||r.metaKey||f)&&r.preventDefault()}}}const ja=["classes","className","displayIcon","expansionIcon","icon","label","itemId","onClick","onMouseDown"],rs=i.forwardRef(function(t,o){const{classes:a,className:c,displayIcon:x,expansionIcon:y,icon:f,label:u,itemId:j,onClick:n,onMouseDown:r}=t,b=pe(t,ja),{disabled:W,expanded:P,selected:w,focused:D,handleExpansion:F,handleSelection:z,preventSelection:_}=fa(j),I=f||y||x,A=h=>{_(h),r&&r(h)},v=h=>{F(h),z(h),n&&n(h)};return e.jsxs("div",V({},b,{className:qe(c,a.root,P&&a.expanded,w&&a.selected,D&&a.focused,W&&a.disabled),onClick:v,onMouseDown:A,ref:o,children:[e.jsx("div",{className:a.iconContainer,children:I}),e.jsx("div",{className:a.label,children:u})]}))}),ya=["children","className","slots","slotProps","ContentComponent","ContentProps","itemId","id","label","onClick","onMouseDown","onFocus","onBlur","onKeyDown"],ba=["ownerState"],Ta=["ownerState"],Ca=["ownerState"],Sa=s=>{const{classes:t}=s;return _t({root:["root"],content:["content"],expanded:["expanded"],selected:["selected"],focused:["focused"],disabled:["disabled"],iconContainer:["iconContainer"],label:["label"],groupTransition:["groupTransition"]},sa,t)},Ia=Le("li",{name:"MuiTreeItem",slot:"Root",overridesResolver:(s,t)=>t.root})({listStyle:"none",margin:0,padding:0,outline:0}),wa=Le(rs,{name:"MuiTreeItem",slot:"Content",overridesResolver:(s,t)=>[t.content,t.iconContainer&&{[`& .${Y.iconContainer}`]:t.iconContainer},t.label&&{[`& .${Y.label}`]:t.label}]})(({theme:s})=>({padding:s.spacing(.5,1),borderRadius:s.shape.borderRadius,width:"100%",boxSizing:"border-box",display:"flex",alignItems:"center",gap:s.spacing(1),cursor:"pointer",WebkitTapHighlightColor:"transparent","&:hover":{backgroundColor:(s.vars||s).palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${Y.disabled}`]:{opacity:(s.vars||s).palette.action.disabledOpacity,backgroundColor:"transparent"},[`&.${Y.focused}`]:{backgroundColor:(s.vars||s).palette.action.focus},[`&.${Y.selected}`]:{backgroundColor:s.vars?`rgba(${s.vars.palette.primary.mainChannel} / ${s.vars.palette.action.selectedOpacity})`:Te(s.palette.primary.main,s.palette.action.selectedOpacity),"&:hover":{backgroundColor:s.vars?`rgba(${s.vars.palette.primary.mainChannel} / calc(${s.vars.palette.action.selectedOpacity} + ${s.vars.palette.action.hoverOpacity}))`:Te(s.palette.primary.main,s.palette.action.selectedOpacity+s.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:s.vars?`rgba(${s.vars.palette.primary.mainChannel} / ${s.vars.palette.action.selectedOpacity})`:Te(s.palette.primary.main,s.palette.action.selectedOpacity)}},[`&.${Y.focused}`]:{backgroundColor:s.vars?`rgba(${s.vars.palette.primary.mainChannel} / calc(${s.vars.palette.action.selectedOpacity} + ${s.vars.palette.action.focusOpacity}))`:Te(s.palette.primary.main,s.palette.action.selectedOpacity+s.palette.action.focusOpacity)}},[`& .${Y.iconContainer}`]:{width:16,display:"flex",flexShrink:0,justifyContent:"center","& svg":{fontSize:18}},[`& .${Y.label}`]:V({width:"100%",boxSizing:"border-box",minWidth:0,position:"relative"},s.typography.body1)})),va=Le(aa,{name:"MuiTreeItem",slot:"GroupTransition",overridesResolver:(s,t)=>t.groupTransition})({margin:0,padding:0,paddingLeft:12}),$=i.forwardRef(function(t,o){const{icons:a,runItemPlugins:c,selection:{multiSelect:x},disabledItemsFocusable:y,instance:f}=ts(),u=Et({props:t,name:"MuiTreeItem"}),{children:j,className:n,slots:r,slotProps:b,ContentComponent:W=rs,ContentProps:P,itemId:w,id:D,label:F,onClick:z,onMouseDown:_,onBlur:I,onKeyDown:A}=u,v=pe(u,ya),{contentRef:h,rootRef:O}=c(u),M=Be(o,O),m=Be(P==null?void 0:P.ref,h),d={expandIcon:(r==null?void 0:r.expandIcon)??a.slots.expandIcon??Xt,collapseIcon:(r==null?void 0:r.collapseIcon)??a.slots.collapseIcon??Zt,endIcon:(r==null?void 0:r.endIcon)??a.slots.endIcon,icon:r==null?void 0:r.icon,groupTransition:r==null?void 0:r.groupTransition},g=E=>Array.isArray(E)?E.length>0&&E.some(g):!!E,T=g(j),k=f.isItemExpanded(w),S=f.isItemFocused(w),B=f.isItemSelected(w),H=f.isItemDisabled(w),Z=V({},u,{expanded:k,focused:S,selected:B,disabled:H}),K=Sa(Z),ce=d.groupTransition??void 0,ds=be({elementType:ce,ownerState:{},externalSlotProps:b==null?void 0:b.groupTransition,additionalProps:{unmountOnExit:!0,in:k,component:"ul",role:"group"},className:K.groupTransition}),ve=k?d.collapseIcon:d.expandIcon,ps=be({elementType:ve,ownerState:{},externalSlotProps:E=>k?V({},ee(a.slotProps.collapseIcon,E),ee(b==null?void 0:b.collapseIcon,E)):V({},ee(a.slotProps.expandIcon,E),ee(b==null?void 0:b.expandIcon,E))}),us=pe(ps,ba),xs=T&&ve?e.jsx(ve,V({},us)):null,ke=T?void 0:d.endIcon,ms=be({elementType:ke,ownerState:{},externalSlotProps:E=>T?{}:V({},ee(a.slotProps.endIcon,E),ee(b==null?void 0:b.endIcon,E))}),gs=pe(ms,Ta),hs=ke?e.jsx(ke,V({},gs)):null,Ee=d.icon,fs=be({elementType:Ee,ownerState:{},externalSlotProps:b==null?void 0:b.icon}),js=pe(fs,Ca),ys=Ee?e.jsx(Ee,V({},js)):null;let _e;x?_e=B:B&&(_e=!0);function bs(E){!S&&(!H||y)&&E.currentTarget===E.target&&f.focusItem(E,w)}function Ts(E){I==null||I(E),f.removeFocusedItem()}const Cs=E=>{A==null||A(E),f.handleItemKeyDown(E,w)},Ss=f.getTreeItemId(w,D),Is=f.canItemBeTabbed(w)?0:-1;return e.jsx(ea,{itemId:w,children:e.jsxs(Ia,V({className:qe(K.root,n),role:"treeitem","aria-expanded":T?k:void 0,"aria-selected":_e,"aria-disabled":H||void 0,id:Ss,tabIndex:Is},v,{ownerState:Z,onFocus:bs,onBlur:Ts,onKeyDown:Cs,ref:M,children:[e.jsx(wa,V({as:W,classes:{root:K.content,expanded:K.expanded,selected:K.selected,focused:K.focused,disabled:K.disabled,iconContainer:K.iconContainer,label:K.label},label:F,itemId:w,onClick:z,onMouseDown:_,icon:ys,expansionIcon:xs,displayIcon:hs,ownerState:Z},P,{ref:m})),j&&e.jsx(va,V({as:ce},ds,{children:j}))]}))})}),U=()=>e.jsxs(p,{sx:{display:"grid",gridTemplateColumns:"auto auto",justifyContent:"start",alignItems:"center",gap:"10px",padding:"30px"},children:[e.jsx(vt,{sx:{width:"1em !important",height:"1em !important"}}),e.jsx(we,{children:"Loading..."})]}),ie={columns:[],data:[],initialState:{},enableColumnActions:!1,enableColumnFilters:!1,enablePagination:!1,enableSorting:!1,enableBottomToolbar:!1,enableTopToolbar:!1,muiTablePaperProps:{sx:{display:"grid",boxShadow:"none"}},muiTableProps:{sx:{border:"unset","& th, td":{borderTop:"unset",borderRight:"unset",borderLeft:"unset"}}},muiTableHeadCellProps:{sx:{paddingTop:"1rem",paddingRight:"1rem",paddingBottom:"1rem",paddingLeft:"1rem"}},muiTableBodyRowProps:{hover:!0},muiTableBodyCellProps:{sx:{verticalAlign:"top"}}},le=({msg:s})=>e.jsx(p,{sx:{padding:"1rem 0"},children:e.jsx(we,{children:s})}),ka=i.lazy(()=>q(()=>import("./Alert-1.0.23-c5d2670c.js"),["./Alert-1.0.23-c5d2670c.js","./main-1.0.23.js","./index.esm-1.0.23-5dc3dbfa.js","./iconBase-1.0.23-43ac6f06.js","./Typography-1.0.23-19a0fd3e.js","./AlertTitle-1.0.23-db3e7867.js","./index-1.0.23-9af490ae.js","./useSlot-1.0.23-b9d48820.js","./createSvgIcon-1.0.23-f9410a01.js","./Close-1.0.23-ea28bfa6.js"],import.meta.url)),Ea=({dbs:s,tbl:t})=>{l.debug(s,t);const o=R(),a=C(n=>ws(n,s,t));l.debug(a);const c=C(n=>vs(n,s,t));l.debug(c);const[x,y]=i.useState("");i.useEffect(()=>{a||f()},[a]);const f=()=>{ft(s,t,n=>{const r=n==null?void 0:n.data;l.debug("response data",r),o(ks({dbs:s,tbl:t,cls:r}))},n=>{l.error("error",n),y(n??G.contactSupport)})},u=i.useMemo(()=>[{accessorKey:"ordinal_position",header:"#",size:40},{accessorKey:"column_name",header:"Column name",size:100},{accessorKey:"column_type",header:"Column type",size:100},{accessorKey:"is_nullable",header:"Nullable?",size:50},{accessorKey:"character_maximum_length",header:"Max length",size:70,muiTableHeadCellProps:{align:"right"},muiTableBodyCellProps:{align:"right"}},{accessorKey:"numeric_precision",header:"Precision",size:60,muiTableHeadCellProps:{align:"right"},muiTableBodyCellProps:{align:"right"}},{accessorKey:"numeric_scale",header:"Scale",size:60,muiTableHeadCellProps:{align:"right"},muiTableBodyCellProps:{align:"right"}},{accessorKey:"extra",header:"Extra",size:100},{accessorKey:"column_default",header:"Default value",size:100}],[]),j=oe({...ie,columns:u,data:c,initialState:{columnOrder:["ordinal_position","column_name","column_type","is_nullable","extra","column_default","character_maximum_length","numeric_precision","numeric_scale"],density:"comfortable"},muiTableProps:{className:"pp-explorer-table"}});return l.debug(j),x!==""?e.jsx(i.Suspense,{children:e.jsx(ka,{severity:"error",message:x,close:!1})}):a?a&&c.length===0?e.jsx(le,{msg:"Table has no columns"}):(l.debug(c),e.jsx(re,{table:j})):e.jsx(U,{})},_a=i.lazy(()=>q(()=>import("./Alert-1.0.23-c5d2670c.js"),["./Alert-1.0.23-c5d2670c.js","./main-1.0.23.js","./index.esm-1.0.23-5dc3dbfa.js","./iconBase-1.0.23-43ac6f06.js","./Typography-1.0.23-19a0fd3e.js","./AlertTitle-1.0.23-db3e7867.js","./index-1.0.23-9af490ae.js","./useSlot-1.0.23-b9d48820.js","./createSvgIcon-1.0.23-f9410a01.js","./Close-1.0.23-ea28bfa6.js"],import.meta.url)),Ma=({dbs:s,tbl:t})=>{l.debug(s,t);const o=R(),a=C(n=>Es(n,s,t));l.debug(a);const c=C(n=>_s(n,s,t));l.debug(c);const[x,y]=i.useState("");i.useEffect(()=>{a||f()},[a]);const f=()=>{jt(s,t,n=>{const r=n==null?void 0:n.data;l.debug("response data",r),o(Ms({dbs:s,tbl:t,idx:r}))},n=>{l.error("error",n),y(n??G.contactSupport)})},u=i.useMemo(()=>[{accessorKey:"index_name",header:"Index name",size:100},{accessorKey:"non_unique",header:"Unique",size:80},{accessorKey:"seq_in_name",header:"#",size:40,muiTableHeadCellProps:{align:"right"},muiTableBodyCellProps:{align:"right"}},{accessorKey:"column_name",header:"Column name",size:100},{accessorKey:"collation",header:"Collation",size:80},{accessorKey:"nullable",header:"Nullable?",size:80},{accessorKey:"index_type",header:"Index type",size:100},{accessorKey:"cardinality",header:"Cardinality",size:80,muiTableHeadCellProps:{align:"right"},muiTableBodyCellProps:{align:"right"}}],[]),j=oe({...ie,columns:u,data:c,initialState:{density:"comfortable"},muiTableProps:{className:"pp-explorer-table"}});return l.debug(j),x!==""?e.jsx(i.Suspense,{children:e.jsx(_a,{severity:"error",message:x,close:!1})}):a?a&&c.length===0?e.jsx(le,{msg:"Table has no indexes"}):e.jsx(re,{table:j}):e.jsx(U,{})},Pa=i.lazy(()=>q(()=>import("./Alert-1.0.23-c5d2670c.js"),["./Alert-1.0.23-c5d2670c.js","./main-1.0.23.js","./index.esm-1.0.23-5dc3dbfa.js","./iconBase-1.0.23-43ac6f06.js","./Typography-1.0.23-19a0fd3e.js","./AlertTitle-1.0.23-db3e7867.js","./index-1.0.23-9af490ae.js","./useSlot-1.0.23-b9d48820.js","./createSvgIcon-1.0.23-f9410a01.js","./Close-1.0.23-ea28bfa6.js"],import.meta.url)),La=({dbs:s,tbl:t})=>{l.debug(s,t);const o=R(),a=C(n=>Ps(n,s,t));l.debug(a);const c=C(n=>Ls(n,s,t));l.debug(c);const[x,y]=i.useState("");i.useEffect(()=>{a||f()},[a]);const f=()=>{yt(s,t,n=>{const r=n==null?void 0:n.data;l.debug("response data",r),o(As({dbs:s,tbl:t,trg:r}))},n=>{l.error("error",n),y(n??G.contactSupport)})},u=i.useMemo(()=>[{accessorKey:"trigger_name",header:"Trigger name",size:120},{accessorKey:"event_manipulation",header:"Event",size:80},{accessorKey:"action_timing",header:"Timin",size:80},{accessorKey:"action_statement",header:"SQL",size:200,Cell:({cell:n})=>e.jsx("pre",{style:{padding:0,margin:0},children:n.getValue()})}],[]),j=oe({...ie,columns:u,data:c,initialState:{density:"comfortable"},muiTableProps:{className:"pp-explorer-table"}});return l.debug(j),x!==""?e.jsx(i.Suspense,{children:e.jsx(Pa,{severity:"error",message:x,close:!1})}):a?a&&c.length===0?e.jsx(le,{msg:"Table has no triggers"}):e.jsx(re,{table:j}):e.jsx(U,{})},Aa=i.lazy(()=>q(()=>import("./Alert-1.0.23-c5d2670c.js"),["./Alert-1.0.23-c5d2670c.js","./main-1.0.23.js","./index.esm-1.0.23-5dc3dbfa.js","./iconBase-1.0.23-43ac6f06.js","./Typography-1.0.23-19a0fd3e.js","./AlertTitle-1.0.23-db3e7867.js","./index-1.0.23-9af490ae.js","./useSlot-1.0.23-b9d48820.js","./createSvgIcon-1.0.23-f9410a01.js","./Close-1.0.23-ea28bfa6.js"],import.meta.url)),Da=({dbs:s,tbl:t})=>{l.debug(s,t);const o=R(),a=C(n=>Ds(n,s,t));l.debug(a);const c=C(n=>Os(n,s,t));l.debug(c);const[x,y]=i.useState("");i.useEffect(()=>{a||f()},[a]);const f=()=>{bt(s,t,n=>{const r=n==null?void 0:n.data;l.debug("response data",r),o(zs({dbs:s,tbl:t,frk:r}))},n=>{l.error("error",n),y(n)})},u=i.useMemo(()=>[{accessorKey:"constraint_name",header:"Constraint name",size:100},{accessorKey:"column_name",header:"Column name",size:100},{accessorKey:"referenced_table_name",header:"Referenced table",size:100},{accessorKey:"referenced_column_name",header:"Referenced column",size:100}],[]),j=oe({...ie,columns:u,data:c,initialState:{density:"comfortable"},muiTableProps:{className:"pp-explorer-table"}});return l.debug(j),x!==""?e.jsx(i.Suspense,{children:e.jsx(Aa,{severity:"error",message:x,close:!1})}):a?a&&c.length===0?e.jsx(le,{msg:"Table contains no foreign keys"}):e.jsx(re,{table:j}):e.jsx(U,{})},is=i.memo(({dbs:s,tbl:t,typ:o})=>(l.debug(s,t,o),e.jsxs(e.Fragment,{children:[e.jsx($,{itemId:s+"-"+t+"-columns",label:e.jsxs(p,{sx:{display:"inline-grid",gridTemplateColumns:"auto auto",gap:"10px",alignItems:"center"},children:[e.jsx(Dt,{}),e.jsx("span",{children:"Columns"})]}),sx:{padding:0,minWidth:0},children:e.jsx(Ea,{dbs:s,tbl:t})}),o===Q.TABLE&&e.jsxs(e.Fragment,{children:[e.jsx($,{itemId:s+"-"+t+"-indexes",label:e.jsxs(p,{sx:{display:"inline-grid",gridTemplateColumns:"auto auto",gap:"10px",alignItems:"center"},children:[e.jsx(Ot,{}),e.jsx("span",{children:"Indexes"})]}),sx:{padding:0,minWidth:0},children:e.jsx(Ma,{dbs:s,tbl:t})}),e.jsx($,{itemId:s+"-"+t+"-foreignkeys",label:e.jsxs(p,{sx:{display:"inline-grid",gridTemplateColumns:"auto auto",gap:"10px",alignItems:"center"},children:[e.jsx(Ut,{}),e.jsx("span",{children:"Foreign Keys"})]}),sx:{padding:0,minWidth:0},children:e.jsx(Da,{dbs:s,tbl:t})}),e.jsx($,{itemId:s+"-"+t+"-triggers",label:e.jsxs(p,{sx:{display:"inline-grid",gridTemplateColumns:"auto auto",gap:"10px",alignItems:"center"},children:[e.jsx(Je,{}),e.jsx("span",{children:"Triggers"})]}),sx:{padding:0,minWidth:0},children:e.jsx(La,{dbs:s,tbl:t})})]})]}))),Oa=s=>{const t=C(o=>Rs(o,s));return l.debug("tablesSelected",t),t},za=s=>{const t=C(o=>Fs(o,s));return l.debug("viewsSelected",t),t},ls=i.memo(({dbs:s,tbl:t,typ:o,tableContext:a})=>{var j,n;l.debug(s,t,o);const c=R(),x=Oa(s),y=za(s),f=na("(max-width:900px)"),u=i.useMemo(()=>(a==null?void 0:a.wp_tables)!==void 0&&a.wp_tables.filter(r=>r===t).length>0?" (WordPress Table)":(a==null?void 0:a.wpda_tables)!==void 0&&a.wpda_tables.filter(r=>r===t).length>0?" (Plugin Table)":"",[]);return e.jsxs(p,{color:"primary",sx:{display:"grid",gridTemplateColumns:"calc(100% - 110px) auto",justifyContent:"space-between",alignItems:"center",gridGap:"20px",marginLeft:"-10px","&:hover":{".pp-row-actions":{visibility:f?"hidden":"visible"}}},children:[e.jsxs(p,{sx:{display:"grid",gridTemplateColumns:"auto auto",justifyContent:"start",alignItems:"center",gridGap:"0",overflow:"hidden"},children:[e.jsx(p,{sx:{display:"grid",alignItems:"center"},children:e.jsx(J,{size:"small",checked:y.includes(t)||x.includes(t),onClick:r=>{o===Q.VIEW?c(Bs({dbs:s,vws:t,isSelected:!y.includes(t)})):c(Ks({dbs:s,tbl:t,isSelected:!x.includes(t)})),r.stopPropagation()}})}),e.jsxs(p,{sx:{display:"grid",gridTemplateColumns:"auto auto",alignItems:"stretch"},children:[e.jsxs(p,{sx:{textOverflow:"ellipsis",whiteSpace:"nowrap"},children:[t," ",u]}),e.jsxs(p,{sx:{display:"grid",gridTemplateColumns:"auto auto auto auto",gridGap:"10px",marginLeft:"10px",alignItems:"center",visibility:"hidden"},className:"pp-row-actions",children:[e.jsx(p,{sx:{borderLeft:"1px solid black",height:"100%"}}),e.jsx(ue,{title:"Manage table `"+t+"`",placement:"bottom",children:e.jsx(se,{underline:"none",onClick:r=>{c(fe({dbs:s,tbl:t,typ:o,explorerAction:Ce.MANAGE})),r.preventDefault(),r.stopPropagation()},children:"Manage"})}),e.jsx(p,{sx:{borderLeft:"1px solid black",height:"100%"}}),e.jsx(ue,{title:"Explore table `"+t+"`",placement:"bottom",children:e.jsx(se,{underline:"none",onClick:r=>{c(fe({dbs:s,tbl:t,typ:o,explorerAction:Ce.EXPLORE})),r.preventDefault(),r.stopPropagation()},children:"Explore"})})]})]})]}),e.jsxs(p,{sx:{display:"grid",gridTemplateColumns:"auto auto",justifyContent:"space-evenly",alignItems:"center"},children:[e.jsx(ue,{title:"Manage table `"+t+"`",placement:"bottom",children:e.jsx(ne,{sx:{color:(j=X)==null?void 0:j.palette.primary.main},onClick:r=>{c(fe({dbs:s,tbl:t,typ:o,explorerAction:Ce.MANAGE})),r.preventDefault(),r.stopPropagation()},children:e.jsx(zt,{})})}),e.jsx(ue,{title:"Explore table `"+t+"`",placement:"bottom",children:e.jsx(ne,{sx:{color:(n=X)==null?void 0:n.palette.primary.main},onClick:r=>{c(fe({dbs:s,tbl:t,typ:o,explorerAction:Ce.EXPLORE})),r.preventDefault(),r.stopPropagation()},children:e.jsx(Rt,{})})})]})]})}),Ra=i.lazy(()=>q(()=>import("./Alert-1.0.23-c5d2670c.js"),["./Alert-1.0.23-c5d2670c.js","./main-1.0.23.js","./index.esm-1.0.23-5dc3dbfa.js","./iconBase-1.0.23-43ac6f06.js","./Typography-1.0.23-19a0fd3e.js","./AlertTitle-1.0.23-db3e7867.js","./index-1.0.23-9af490ae.js","./useSlot-1.0.23-b9d48820.js","./createSvgIcon-1.0.23-f9410a01.js","./Close-1.0.23-ea28bfa6.js"],import.meta.url)),Fa=i.memo(({dbs:s,search:t})=>{const o=R();l.debug(s,t);const a=C(u=>Vs(u,s));l.debug("tablesLoaded",a);const c=C(u=>Ns(u,s));l.debug("tables",c);const x=C(u=>Ws(u,s));l.debug("tableContext",x);const[y,f]=i.useState("");return i.useEffect(()=>{a||Tt(s,function(u){const j=u==null?void 0:u.data;l.debug("response data",j),o($s({dbs:s,tbl:j,context:u.context??void 0}))},u=>{l.error("error",u),f(u??G.contactSupport)})},[a]),y!==""?e.jsx(i.Suspense,{children:e.jsx(Ra,{severity:"error",message:y,close:!1})}):a?a&&c.length===0?e.jsx(p,{sx:{padding:"1rem"},children:e.jsx(we,{children:"Database contains no tables"})}):e.jsxs(e.Fragment,{children:[...c.map(u=>{const j=!he(u,t);return e.jsx($,{itemId:s+"-"+u,label:e.jsx(ls,{dbs:s,tbl:u,typ:Q.TABLE,tableContext:x}),sx:{visibility:j?"hidden":"inherit",position:j?"fixed !important":"inherit"},children:e.jsx(is,{dbs:s,tbl:u,typ:Q.TABLE})})})]}):e.jsx(U,{})}),Ba=i.lazy(()=>q(()=>import("./Alert-1.0.23-c5d2670c.js"),["./Alert-1.0.23-c5d2670c.js","./main-1.0.23.js","./index.esm-1.0.23-5dc3dbfa.js","./iconBase-1.0.23-43ac6f06.js","./Typography-1.0.23-19a0fd3e.js","./AlertTitle-1.0.23-db3e7867.js","./index-1.0.23-9af490ae.js","./useSlot-1.0.23-b9d48820.js","./createSvgIcon-1.0.23-f9410a01.js","./Close-1.0.23-ea28bfa6.js"],import.meta.url)),Ka=({dbs:s,search:t})=>{const o=R();l.debug(s,t);const a=C(u=>Gs(u,s));l.debug(a);const[c,x]=i.useState("");i.useEffect(()=>{a||f()},[a]);const y=C(u=>Hs(u,s));l.debug(y);const f=()=>{Ct(s,u=>{const j=u==null?void 0:u.data;l.debug("response data",j),o(qs({dbs:s,vws:j}))},u=>{l.error("error",u),x(u??G.contactSupport)})};return c!==""?e.jsx(i.Suspense,{children:e.jsx(Ba,{severity:"error",message:c,close:!1})}):a?a&&y.length===0?e.jsx(p,{sx:{padding:"1rem"},children:e.jsx(we,{children:"Database contains no views"})}):e.jsxs(e.Fragment,{children:[...y.map(u=>{const j=!he(u,t);return e.jsx($,{itemId:s+"-"+u,label:e.jsx(ls,{dbs:s,tbl:u,typ:Q.VIEW}),sx:{visibility:j?"hidden":"unset",position:j?"fixed !important":"inherit"},children:e.jsx(is,{dbs:s,tbl:u,typ:Q.VIEW})})})]}):e.jsx(U,{})},Va=i.lazy(()=>q(()=>import("./Alert-1.0.23-c5d2670c.js"),["./Alert-1.0.23-c5d2670c.js","./main-1.0.23.js","./index.esm-1.0.23-5dc3dbfa.js","./iconBase-1.0.23-43ac6f06.js","./Typography-1.0.23-19a0fd3e.js","./AlertTitle-1.0.23-db3e7867.js","./index-1.0.23-9af490ae.js","./useSlot-1.0.23-b9d48820.js","./createSvgIcon-1.0.23-f9410a01.js","./Close-1.0.23-ea28bfa6.js"],import.meta.url)),Na=({dbs:s,search:t})=>{l.debug(s,t);const o=R(),a=C(n=>Ys(n,s));l.debug(a);const c=C(n=>Qs(n,s));l.debug(c);const[x,y]=i.useState("");i.useEffect(()=>{a||f()},[a]);const f=()=>{St(s,n=>{const r=n==null?void 0:n.data;l.debug("response data",r),o(Us({dbs:s,prc:r}))},n=>{l.error("error",n),y(n??G.contactSupport)})},u=i.useMemo(()=>[{accessorKey:"routine_name",header:"Name",size:100},{accessorKey:"routine_definition",header:"Body",size:300,Cell:({cell:n})=>e.jsx("pre",{style:{padding:0,margin:0},children:n.getValue()})}],[]),j=oe({...ie,columns:u,data:c.filter(n=>he(n.routine_name,t)),initialState:{density:"comfortable"},muiTableProps:{className:"pp-explorer-table"}});return l.debug(j),x!==""?e.jsx(i.Suspense,{children:e.jsx(Va,{severity:"error",message:x,close:!1})}):a?a&&c.length===0?e.jsx(le,{msg:"Database contains no stored procedures"}):e.jsx(re,{table:j}):e.jsx(U,{})},Wa=i.lazy(()=>q(()=>import("./Alert-1.0.23-c5d2670c.js"),["./Alert-1.0.23-c5d2670c.js","./main-1.0.23.js","./index.esm-1.0.23-5dc3dbfa.js","./iconBase-1.0.23-43ac6f06.js","./Typography-1.0.23-19a0fd3e.js","./AlertTitle-1.0.23-db3e7867.js","./index-1.0.23-9af490ae.js","./useSlot-1.0.23-b9d48820.js","./createSvgIcon-1.0.23-f9410a01.js","./Close-1.0.23-ea28bfa6.js"],import.meta.url)),$a=({dbs:s,search:t})=>{l.debug(s,t);const o=R(),a=C(n=>Js(n,s));l.debug(a);const c=C(n=>Xs(n,s));l.debug(c);const[x,y]=i.useState("");i.useEffect(()=>{a||f()},[a]);const f=()=>{It(s,n=>{const r=n==null?void 0:n.data;l.debug("response data",r),o(Zs({dbs:s,fnc:r}))},n=>{l.error("error",n),y(n??G.contactSupport)})},u=i.useMemo(()=>[{accessorKey:"routine_name",header:"Name",size:100},{accessorKey:"routine_definition",header:"Body",size:300,Cell:({cell:n})=>e.jsx("pre",{style:{padding:0,margin:0},children:n.getValue()})}],[]),j=oe({...ie,columns:u,data:c.filter(n=>he(n.routine_name,t)),initialState:{density:"comfortable"},muiTableProps:{className:"pp-explorer-table"}});return l.debug(j),x!==""?e.jsx(i.Suspense,{children:e.jsx(Wa,{severity:"error",message:x,close:!1})}):a?a&&c.length===0?e.jsx(le,{msg:"Database contains no functions"}):e.jsx(re,{table:j}):e.jsx(U,{})};var L=(s=>(s.WP="wp",s.LOCAL="local",s.REMOTE="remote",s.SYSTEM="system",s))(L||{});const Ga=({setShowFilter:s})=>{const t=R(),o=C(a=>Ne(a));return l.debug(o),i.useEffect(()=>{localStorage.setItem("ppExplorerSearchDbsTypes",JSON.stringify(o))},[o]),e.jsxs(oa,{sx:{position:"absolute",top:"3em",right:"0",minWidth:"-webkit-fill-available",zIndex:9999999},children:[e.jsx(ia,{title:"Database filter",sx:{textAlign:"center"}}),e.jsx(ra,{sx:{textAlign:"center",padding:0,borderTop:"1px solid #eee",borderBottom:"1px solid #eee"},children:e.jsxs(p,{sx:{display:"inline-grid",textAlign:"left",padding:"2em","& label":{display:"flex",alignItems:"center"}},children:[e.jsx(te,{children:e.jsxs(Se,{children:[e.jsx(J,{size:"small",checked:o.includes(L.WP),onChange:(a,c)=>{t(c?je({dbsType:L.WP}):ye({dbsType:L.WP}))}}),"WordPress database"]})}),e.jsx(te,{children:e.jsxs(Se,{children:[e.jsx(J,{size:"small",checked:o.includes(L.LOCAL),onChange:(a,c)=>{t(c?je({dbsType:L.LOCAL}):ye({dbsType:L.LOCAL}))}}),"Local databases"]})}),e.jsx(te,{children:e.jsxs(Se,{children:[e.jsx(J,{size:"small",checked:o.includes(L.REMOTE),onChange:(a,c)=>{t(c?je({dbsType:L.REMOTE}):ye({dbsType:L.REMOTE}))}}),"Remote databases"]})}),e.jsx(te,{children:e.jsxs(Se,{children:[e.jsx(J,{size:"small",checked:o.includes(L.SYSTEM),onChange:(a,c)=>{t(c?je({dbsType:L.SYSTEM}):ye({dbsType:L.SYSTEM}))}}),"System databases"]})})]})}),e.jsxs(la,{sx:{display:"grid",gridTemplateColumns:"1fr 1fr"},children:[e.jsx(p,{}),e.jsx(ge,{variant:"contained",onClick:()=>s(!1),children:"OK"})]})]})},ae=({search:s,setSearch:t,addFilter:o})=>{l.debug(s,o);const[a,c]=i.useState(!1);return e.jsxs(p,{sx:{position:"relative"},children:[e.jsx(as,{value:s,type:"search",onChange:x=>{t(x.target.value)},onClick:x=>{x.stopPropagation()},onKeyDown:x=>{x.stopPropagation()},sx:{backgroundColor:"#fff",fontSize:"1em",margin:0,padding:0,borderRadius:"4px","&.MuiFormControl-root.MuiTextField-root .MuiInputBase-root":{paddingRight:0},"&.MuiFormControl-root.MuiTextField-root input":{padding:"8px"}},InputProps:{startAdornment:e.jsx(Ke,{position:"end",sx:{fontSize:"1.5rem",padding:0,margin:0},children:e.jsx(Ft,{})}),endAdornment:e.jsx(e.Fragment,{children:o&&e.jsx(Ke,{position:"end",sx:{fontSize:"1.5rem",padding:0,margin:0},children:e.jsx(ne,{onClick:()=>{c(!a)},children:e.jsx(Bt,{})})})})}}),a&&e.jsx(Ga,{setShowFilter:c})]})},Ha=(s,t)=>{const o=C(a=>et(a,s,t));return l.debug("allTablesSelected",o),o},qa=(s,t)=>{const o=C(a=>st(a,s,t));return l.debug("allViewsSelected",o),o},me=s=>{const[t,o]=i.useState(localStorage.getItem(s)??""),a=c=>{o(c),localStorage.setItem(s,c)};return l.debug(t),{search:t,setSearch:a}},Ya=i.memo(({dbs:s})=>{l.debug(s);const t=R(),[o,a]=i.useState(!1),{search:c,setSearch:x}=me(`ppExplorerSearchTables-${s}`);l.debug(o,c);const[y,f]=i.useState(!1),{search:u,setSearch:j}=me(`ppExplorerSearchViews-${s}`);l.debug(y,u);const[n,r]=i.useState(!1),{search:b,setSearch:W}=me(`ppExplorerSearchProcedures-${s}`);l.debug(n,b);const[P,w]=i.useState(!1),{search:D,setSearch:F}=me(`ppExplorerSearchFunctions-${s}`);l.debug(P,D);const z=Ha(s,c),_=qa(s,u),[I,A]=i.useState("");l.debug(I);const v=Ae();return e.jsxs(e.Fragment,{children:[e.jsx($,{itemId:s+"-tables",className:"pp-data-exporer-table-tree-item "+I,onClickCapture:h=>{var O,M;!(h.target instanceof HTMLInputElement)&&!(h.target instanceof HTMLAnchorElement)&&!((O=h.target.closest("span"))!=null&&O.classList.contains("pp-select-all-tables"))&&((M=h.target.closest("li"))!=null&&M.classList.contains("pp-data-exporer-table-tree-item"))&&(A(I===""?"hide-details":""),o?h.stopPropagation():(a(!0),A("")))},sx:{padding:0,minWidth:0,"&.hide-details > ul":{visibility:"hidden",position:"fixed"}},label:e.jsxs(p,{sx:{display:"grid",gridTemplateColumns:"auto auto",gap:"20px",justifyContent:"space-between",alignItems:"center","&:hover":{".pp-row-actions":{display:"grid"}}},children:[e.jsxs(p,{sx:{display:"grid",gridTemplateColumns:"auto auto",gap:"10px",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs(p,{sx:{display:"grid",gridTemplateColumns:"auto auto",gap:o&&I===""?0:"10px",justifyContent:"space-between",alignItems:"center",margin:"0 8px 0 4px"},children:[o&&I===""?e.jsx(J,{size:"small",className:"pp-select-all-tables",checked:z,onClick:h=>{t(We({dbs:s,isSelected:!z,search:c})),h.stopPropagation()},sx:{marginLeft:"-12px"}}):e.jsx(Xe,{}),e.jsxs("span",{style:{display:"grid",gridTemplateColumns:"auto auto",alignItems:"center",gap:"5px"},children:[e.jsx("span",{children:"Tables"}),e.jsx("span",{style:{fontSize:"90%"},children:v[s].tablesLoaded===!0?"("+v[s].tables.length+"/"+v[s].tablesSelected.length+")":""})]})]}),e.jsxs(p,{className:"pp-row-actions",sx:{display:"none",gridTemplateColumns:"auto auto",gridGap:"10px",alignItems:"center"},children:[e.jsx(p,{sx:{borderLeft:"1px solid black",height:"100%"}}),e.jsx(se,{underline:"none",onClick:h=>{t($e({dbs:s})),h.preventDefault(),h.stopPropagation()},children:"Refresh"})]})]}),e.jsx(p,{children:o&&I===""&&e.jsx(ae,{search:c,setSearch:x})})]}),children:e.jsx(Fa,{dbs:s,search:c})}),e.jsx($,{itemId:s+"-views",onClick:()=>{f(!y)},label:e.jsxs(p,{sx:{display:"grid",gridTemplateColumns:"auto auto",gap:"20px",justifyContent:"space-between",alignItems:"center","&:hover":{".pp-row-actions":{display:"grid"}}},children:[e.jsxs(p,{sx:{display:"grid",gridTemplateColumns:"auto auto",gap:"10px",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs(p,{sx:{display:"grid",gridTemplateColumns:"auto auto",gap:y?0:"10px",justifyContent:"space-between",alignItems:"center",margin:"0 8px 0 4px"},children:[y?e.jsx(J,{size:"small",checked:_,onClick:h=>{t(Ge({dbs:s,isSelected:!_,search:u})),h.stopPropagation()},sx:{marginLeft:"-12px"}}):e.jsx(Ze,{}),e.jsxs("span",{style:{display:"grid",gridTemplateColumns:"auto auto",alignItems:"center",gap:"5px"},children:[e.jsx("span",{children:"Views"}),e.jsx("span",{style:{fontSize:"90%"},children:v[s].viewsLoaded===!0?"("+v[s].views.length+"/"+v[s].viewsSelected.length+")":""})]})]}),e.jsxs(p,{className:"pp-row-actions",sx:{display:"none",gridTemplateColumns:"auto auto",gridGap:"10px",alignItems:"center"},children:[e.jsx(p,{sx:{borderLeft:"1px solid black",height:"100%"}}),e.jsx(se,{underline:"none",onClick:h=>{t(He({dbs:s})),h.preventDefault(),h.stopPropagation()},children:"Refresh"})]})]}),e.jsx(p,{children:y&&e.jsx(ae,{search:u,setSearch:j})})]}),sx:{padding:0,minWidth:0},children:e.jsx(Ka,{dbs:s,search:u})}),e.jsx($,{itemId:s+"-procedures",onClick:()=>{r(!n)},label:e.jsxs(p,{sx:{display:"grid",gridTemplateColumns:"auto auto",gap:"20px",justifyContent:"space-between",alignItems:"center","&:hover":{".pp-row-actions":{display:"grid"}}},children:[e.jsxs(p,{sx:{display:"grid",gridTemplateColumns:"auto auto",gap:"10px",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs(p,{sx:{display:"grid",gridTemplateColumns:"auto auto",gap:"10px",justifyContent:"space-between",alignItems:"center",margin:"0 8px 0 4px"},children:[e.jsx(Je,{}),e.jsxs("span",{style:{display:"grid",gridTemplateColumns:"auto auto",alignItems:"center",gap:"5px"},children:[e.jsx("span",{children:"Stored Procedures"}),e.jsx("span",{style:{fontSize:"90%"},children:v[s].proceduresLoaded===!0?"("+v[s].procedures.length+")":""})]})]}),e.jsxs(p,{className:"pp-row-actions",sx:{display:"none",gridTemplateColumns:"auto auto",gridGap:"10px",alignItems:"center"},children:[e.jsx(p,{sx:{borderLeft:"1px solid black",height:"100%"}}),e.jsx(se,{underline:"none",onClick:h=>{t(tt({dbs:s})),h.preventDefault(),h.stopPropagation()},children:"Refresh"})]})]}),e.jsx(p,{children:n&&e.jsx(ae,{search:b,setSearch:W})})]}),sx:{padding:0,minWidth:0},children:e.jsx(Na,{dbs:s,search:b})}),e.jsx($,{itemId:s+"-functions",onClick:()=>{w(!P)},label:e.jsxs(p,{sx:{display:"grid",gridTemplateColumns:"auto auto",gap:"20px",justifyContent:"space-between",alignItems:"center","&:hover":{".pp-row-actions":{display:"grid"}}},children:[e.jsxs(p,{sx:{display:"grid",gridTemplateColumns:"auto auto",gap:"10px",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs(p,{sx:{display:"grid",gridTemplateColumns:"auto auto",gap:"10px",justifyContent:"space-between",alignItems:"center",margin:"0 8px 0 4px"},children:[e.jsx(Jt,{}),e.jsxs("span",{style:{display:"grid",gridTemplateColumns:"auto auto",alignItems:"center",gap:"5px"},children:[e.jsx("span",{children:"Functions"}),e.jsx("span",{style:{fontSize:"90%"},children:v[s].functionsLoaded===!0?"("+v[s].functions.length+")":""})]})]}),e.jsxs(p,{className:"pp-row-actions",sx:{display:"none",gridTemplateColumns:"auto auto",gridGap:"10px",alignItems:"center"},children:[e.jsx(p,{sx:{borderLeft:"1px solid black",height:"100%"}}),e.jsx(se,{underline:"none",onClick:h=>{t(at({dbs:s})),h.preventDefault(),h.stopPropagation()},children:"Refresh"})]})]}),e.jsx(p,{children:P&&e.jsx(ae,{search:D,setSearch:F})})]}),sx:{padding:0,minWidth:0},children:e.jsx($a,{dbs:s,search:D})})]})}),Qa=()=>{const s=C(t=>nt(t));return l.debug("countSelectedTables",s),s},Ua=()=>{const s=C(t=>ot(t));return l.debug("hasBulkActions",s),s},Ja=()=>{const s=C(t=>rt(t));return l.debug("countSelectedViews",s),s};function Xa(s){const t=i.useRef(null);return e.jsx(ua,{nodeRef:t,handle:"#draggable-dialog-title",cancel:'[class*="MuiDialogContent-root"]',children:e.jsx(Me,{ref:t,...s})})}const Pe=s=>{const{title:t,message:o,open:a,setOpen:c,onConfirm:x}=s;return e.jsxs(ma,{open:a,onClose:()=>c(!1),PaperComponent:Xa,"aria-labelledby":"confirm-dialog",children:[e.jsx(da,{style:{marginTop:"10px",cursor:"move"},id:"draggable-dialog-title",children:t}),e.jsx(ga,{children:e.jsx(pa,{component:"div",children:o})}),e.jsx(ha,{sx:{marginRight:"15px",marginBottom:"15px"},children:e.jsx(ge,{variant:"contained",onClick:()=>{c(!1),x!==void 0&&x()},children:"OK"})})]})},cs=()=>{const s=C(t=>it(t));return l.debug("context",s),s},de={export:"Export table(s)",truncate:"Truncate table(s)",drop:"Drop table(s)/view(s)"},Za=()=>{const s=R(),t=Ua(),o=Qa(),a=Ja(),c=cs(),[x,y]=i.useState({}),[f,u]=i.useState("*"),[j,n]=i.useState(null),[r,b]=i.useState(!1),[W,P]=i.useState(!1),[w,D]=i.useState(!1);i.useEffect(()=>{o===0&&(f==="export"||f==="truncate")&&u("*")},[o]);const F={vertical:"top",horizontal:"right"},z=()=>{const m=lt(ct.getState()),d={};return m==null?{}:(Object.keys(m).map(g=>{m[g].tablesSelected.map(T=>{d[g]===void 0&&(d[g]={}),d[g][T]={status:null,typ:Q.TABLE}}),f==="drop"&&m[g].viewsSelected.map(T=>{d[g]===void 0&&(d[g]={}),d[g][T]={status:null,typ:Q.VIEW}})}),d)},_=(m,d,g)=>{const T={...x};d==="*"?Object.keys(T[m]).map(k=>T[m][k].status=g):T[m][d].status=g,y(T)},I=()=>{Object.keys(x).length>0&&Object.keys(x).map(m=>{window.document.getElementById(`pp-export-tables-${m}`).submit(),_(m,"*",!0)})},A=()=>{Object.keys(x).length>0&&Object.keys(x).map(m=>{Object.keys(x[m]).map(d=>{Mt(m,d,g=>{l.debug(g),(g==null?void 0:g.code)==="ok"&&(g==null?void 0:g.message)!==void 0?_(m,d,!0):_(m,d,!1)},g=>{l.error("error",m,d,g),_(m,d,!1)})})})},v=()=>{Object.keys(x).length>0&&Object.keys(x).map(m=>{Object.keys(x[m]).map(d=>{Pt(m,d,x[m][d].typ,g=>{l.debug(g),(g==null?void 0:g.code)==="ok"&&(g==null?void 0:g.message)!==void 0?_(m,d,!0):_(m,d,!1)},g=>{l.error("error",g),_(m,d,!1)})})})},h=m=>e.jsxs(Ye,{sx:{"& th":{fontWeight:"bold",padding:"4px 6px"},"& td":{padding:"4px 6px",border:"none"}},children:[e.jsx(Qe,{children:e.jsxs(Ie,{children:[e.jsx(N,{children:"Database"}),e.jsx(N,{children:"Table | View"}),e.jsx(N,{children:"Status"})]})}),e.jsx(Ue,{children:Object.keys(m).map(d=>Object.keys(m[d]).map((g,T)=>{var k,S;return e.jsxs(Ie,{children:[e.jsx(N,{children:T===0?d:null}),e.jsx(N,{children:g}),e.jsxs(N,{children:[m[d][g]===null&&e.jsx(Vt,{style:{display:"block",margin:"0 auto"}}),m[d][g].status===!0&&e.jsx(es,{color:(k=X)==null?void 0:k.palette.success.main,style:{display:"block",margin:"0 auto"}}),m[d][g].status===!1&&e.jsx(ss,{color:(S=X)==null?void 0:S.palette.error.main,style:{display:"block",margin:"0 auto"}})]})]},T)}))})]}),O=()=>e.jsx(p,{children:h(x)}),M=()=>{const m=z();return y(m),e.jsxs(p,{children:[h(m),(f==="truncate"||f==="drop")&&e.jsxs(e.Fragment,{children:[e.jsx("hr",{style:{marginTop:"20px"}}),e.jsx(p,{sx:{marginTop:"20px",marginBottom:"20px"},children:f==="drop"?e.jsx("span",{children:"Deletes views and tables with all data permanently."}):e.jsx("span",{children:"Deletes all data permanently."})}),e.jsx(p,{children:e.jsx("strong",{children:"This actions cannot be undone!"})}),e.jsxs(p,{children:["'",e.jsx("strong",{children:"NO"}),"' to stop, '",e.jsx("strong",{children:"YES"}),"' to continue."]}),e.jsxs(p,{sx:{marginTop:"20px",fontSize:"80%",display:"inline-grid",gridTemplateColumns:"auto auto",justifyContent:"space-between",alignItems:"center",gap:"5px"},children:[e.jsx(Kt,{}),e.jsxs("span",{children:["Does not ",f," WordPress tables"]})]})]})]})};return t?e.jsxs(e.Fragment,{children:[e.jsx(De,{className:"pp-bulk-actions-container",color:"inherit",position:"relative",elevation:4,sx:{margin:"0 0 5px 0"},children:e.jsxs(Oe,{sx:{display:"grid",gridTemplateColumns:"auto auto",gap:"12px",justifyContent:"space-between"},children:[e.jsxs(p,{sx:{display:"grid",gridTemplateColumns:"auto auto",gap:"12px",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(te,{variant:"standard",sx:{minWidth:200},children:e.jsxs(ns,{MenuProps:{id:"pp-select-menu"},value:f,onChange:m=>{u(m.target.value)},children:[e.jsx(xe,{value:"*",children:"Bulk actions"}),e.jsx(xe,{value:"export",disabled:o===0,children:de.export}),e.jsx(xe,{value:"truncate",disabled:o===0,children:de.truncate}),e.jsx(xe,{value:"drop",children:de.drop})]})}),e.jsx(ge,{variant:"contained",onClick:()=>{f!=="*"?(n(M()),b(!0)):P(!0)},children:"Apply"})]}),e.jsxs(p,{sx:{display:"grid",gridTemplateColumns:"auto auto",gap:"12px",justifyContent:"space-between"},children:[e.jsx(Re,{badgeContent:o,color:"info",anchorOrigin:F,children:e.jsx(Xe,{color:"action",size:20})}),e.jsx(Re,{badgeContent:a,color:"info",anchorOrigin:F,children:e.jsx(Ze,{color:"action",size:20})})]})]})}),f==="export"&&Object.keys(x).map(m=>e.jsxs("form",{id:"pp-export-tables-"+m,action:c.wp.home+"?action=wpda_export",method:"post",target:"_blank",children:[e.jsx("input",{type:"hidden",name:"type",value:"table"}),e.jsx("input",{type:"hidden",name:"wpdaschema_name",value:m}),Object.keys(x[m]).map(d=>e.jsx("input",{type:"hidden",name:"table_names[]",value:d},d)),e.jsx("input",{type:"hidden",name:"_wpnonce",value:c.wp.nonce.split("-")[0]})]},"pp-export-tables-"+m)),e.jsx(Pe,{title:"Apply bulk action",message:"No bulk action selected",open:W,setOpen:P}),e.jsx(os,{title:de[f],message:j,open:r,setOpen:b,onConfirm:()=>{switch(D(!0),f){case"export":I();break;case"truncate":A();break;case"drop":v()}}}),e.jsx(Pe,{title:de[f],message:O(),open:w,setOpen:D,onConfirm:()=>{Object.keys(x).map(m=>{s($e({dbs:m})),s(We({dbs:m,isSelected:!1,search:""})),s(He({dbs:m})),s(Ge({dbs:m,isSelected:!1,search:""}))})}})]}):null},en=({setCanImport:s})=>{var O,M,m;const t=cs(),o=Ae(),[a,c]=i.useState(""),[x,y]=i.useState("");i.useEffect(()=>{if(o!=null&&Object.keys(o).length>0){const d=Object.keys(o).filter(g=>o[g].dbsType===L.WP);(d==null?void 0:d.length)>0&&c(d[0])}},[o]);const f=i.useRef(null),[u,j]=i.useState(null),n=(O=t==null?void 0:t.wp)!=null&&O.zip?".sql,.zip":".sql",r=(M=t==null?void 0:t.wp)!=null&&M.zip?"SQL and ZIP":"SQL",b=(m=t==null?void 0:t.wp)==null?void 0:m.upload,[W,P]=i.useState(!1),[w,D]=i.useState(null),[F,z]=i.useState(!1),[_,I]=i.useState(""),[A,v]=i.useState(null),h=d=>e.jsx(e.Fragment,{children:e.jsxs(Ye,{sx:{"& th":{fontWeight:"bold",padding:"4px 6px"},"& td":{padding:"4px 6px",border:"none"}},children:[e.jsx(Qe,{children:e.jsxs(Ie,{children:[e.jsx(N,{children:"Import file"}),e.jsx(N,{children:"Message"}),e.jsx(N,{children:"Status"})]})}),e.jsx(Ue,{children:d.map(g=>Object.keys(g).map(T=>{var k,S;return e.jsxs(Ie,{children:[e.jsx(N,{sx:{verticalAlign:"text-top"},children:T}),e.jsxs(N,{sx:{verticalAlign:"text-top"},children:[g[T].msg,g[T].errors.map(B=>{var H;return e.jsx("ul",{style:{listStyle:"disc",padding:"0 40px"},children:e.jsx("li",{style:{color:(H=X)==null?void 0:H.palette.error.main},children:B})})})]}),e.jsx(N,{sx:{verticalAlign:"text-top"},children:g[T].status==="error"?e.jsx(ss,{color:(k=X)==null?void 0:k.palette.error.main,style:{display:"block",margin:"0 auto"}}):e.jsx(es,{color:(S=X)==null?void 0:S.palette.success.main,style:{display:"block",margin:"0 auto"}})})]},T)}))})]})});return e.jsxs(e.Fragment,{children:[e.jsxs(p,{className:"pp-import-container",sx:{position:"relative","& > .tooltip":{position:"absolute",top:"10px",right:"10px",zIndex:999}},children:[e.jsx(xa,{title:"Close",position:"bottom",children:e.jsx(ne,{onClick:()=>{f.current&&(f.current.value=""),y(""),s(!1)},size:"large",color:"inherit",sx:{fontSize:"1.4em"},children:e.jsx(Nt,{})})}),e.jsx(De,{className:"pp-import-container",color:"inherit",position:"relative",elevation:4,sx:{display:"grid",alignItems:"center",margin:"0 0 5px 0"},children:e.jsxs(Oe,{sx:{display:"grid",gap:"10px",alignItems:"center",height:"max-content",paddingTop:"50px",paddingBottom:"30px"},children:[e.jsx(e.Fragment,{children:e.jsxs(p,{sx:{display:"flex",flexWrap:"wrap",justifyContent:"start",alignItems:"center",gap:"15px"},children:[e.jsx(p,{children:e.jsxs(te,{sx:{minWidth:"300px"},children:[e.jsx(ca,{variant:"outlined",children:"Select destination database"}),e.jsx(ns,{MenuProps:{id:"pp-select-menu"},label:"Select destination database",value:a,onChange:d=>{c(d.target.value)},children:o!=null&&Object.keys(o).map(d=>{const g=o[d].dbsType===L.WP?d+" (WordPress database)":d;return e.jsx(xe,{value:d,children:g},d)})})]})}),e.jsx(p,{children:e.jsx("form",{children:e.jsxs(ge,{component:"label",variant:"outlined",startIcon:e.jsx(Wt,{}),children:["Select file(s)",e.jsx(as,{type:"file",inputProps:{accept:n,multiple:!0},onChange:d=>{const g=d.target.files;j(g);const T=Object.keys(g).map(k=>g[k].name).toString();y(T)},InputProps:{inputRef:f},sx:{display:"none"}})]})})}),x!==""&&e.jsx(e.Fragment,{children:e.jsx(p,{children:e.jsx(ge,{component:"label",variant:"contained",startIcon:e.jsx($t,{}),onClick:()=>{D(e.jsxs(p,{children:[e.jsxs(p,{sx:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:["Selected file(s): ",e.jsx("strong",{children:x})]}),e.jsxs(p,{children:["Selected database: ",e.jsx("strong",{children:a})]}),e.jsxs(p,{sx:{marginTop:"20px",fontSize:"80%"},children:[e.jsx("strong",{children:"NOTE"}),"Â  You can work on other tasks while your import is performed in the background."]})]})),P(!0)},children:"Import file(s)"})})})]})}),x!==""&&e.jsxs(p,{sx:{marginTop:"20px",marginBottom:"10px",minWidth:0,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",textAlign:"left",fontWeight:"bold"},children:["Selected file(s): ",x]}),e.jsxs("fieldset",{className:"pp-fieldset",style:{marginTop:"5px",padding:"10px 30px",minWidth:0},children:[e.jsx("legend",{children:"IMPORTANT"}),e.jsxs("ul",{style:{paddingLeft:"15px",listStyle:"disc",padding:"0 40px"},children:[e.jsx("li",{children:"Supports multiple file uploads simultaneously."}),e.jsxs("li",{children:["Server supports ",r," file types."]}),e.jsxs("li",{children:["Maximum supported file size on this server is ",b,"."]}),e.jsx("li",{children:"Add a ; and a new line character at the end of every SQL statement."})]})]})]})})]}),e.jsx(os,{title:"Import selected file(s)?",message:w,open:W,setOpen:P,onConfirm:()=>{Lt(a,u,d=>{var g;if(d!=null&&d.message&&((g=d==null?void 0:d.context)!=null&&g.imported)&&Array.isArray(d.context.imported)){const T=d.context.imported;z(!0),I(d.message),v(h(T))}else ze(G.contactSupport,{variant:"error"})},d=>{l.error("error",d),ze(G.contactSupport,{variant:"error"})})}}),e.jsx(Pe,{title:_,message:A,open:F,setOpen:z,onConfirm:()=>{y(""),s(!1)}})]})};const Ve=i.lazy(()=>q(()=>import("./Alert-1.0.23-c5d2670c.js"),["./Alert-1.0.23-c5d2670c.js","./main-1.0.23.js","./index.esm-1.0.23-5dc3dbfa.js","./iconBase-1.0.23-43ac6f06.js","./Typography-1.0.23-19a0fd3e.js","./AlertTitle-1.0.23-db3e7867.js","./index-1.0.23-9af490ae.js","./useSlot-1.0.23-b9d48820.js","./createSvgIcon-1.0.23-f9410a01.js","./Close-1.0.23-ea28bfa6.js"],import.meta.url)),co=()=>{var v;const s=R(),t=i.useRef(null),{search:o,setSearch:a}=me("ppExplorerSearch"),c=Ae(),x=C(h=>dt(h));l.debug(x);const y=C(h=>pt(h));l.debug(y);const f=C(h=>Ne(h));l.debug(f);const[u,j]=i.useState("");i.useEffect(()=>{window.ppActionEnableImport=(h=!0)=>{D(h)},n()},[]);const n=()=>{let h=[];const O=localStorage.getItem("ppExplorerSearchDbsTypes");O!=null&&O!==""?h=JSON.parse(O):h=[L.WP,L.LOCAL,L.REMOTE],wt(M=>{const m=M==null?void 0:M.data;l.debug("response data",m);const d=[],g={};m.map(S=>{d.push({dbs:S.dbs,dbsType:S.dbs_type,pdsDbs:S.pds}),g[S.dbs]=!1}),b(g),d.sort((S,B)=>{var H,Z,K,ce;return((H=S==null?void 0:S.dbs)==null?void 0:H.toLocaleLowerCase())>((Z=B==null?void 0:B.dbs)==null?void 0:Z.toLocaleLowerCase())?1:((K=B==null?void 0:B.dbs)==null?void 0:K.toLocaleLowerCase())>((ce=S==null?void 0:S.dbs)==null?void 0:ce.toLocaleLowerCase())?-1:0}),l.debug(d),s(mt({dbs:d,dbsTypes:h}));const T={};m.map(S=>{T[S.dbs]=S.dbs_type}),s(gt({dbs:T}));const k=M.context;l.debug("context",k),s(ht({context:k}))},M=>{l.error("error",M),j(M??G.contactSupport)})},[r,b]=i.useState({}),[W,P]=i.useState(!0),[w,D]=i.useState(!1),F=()=>e.jsx(ue,{title:"Import data or execute scripts",children:e.jsx(ne,{sx:{color:"inherit"},onClick:()=>{D(!w)},children:e.jsx(Ht,{})})}),z=()=>e.jsx(ne,{onClick:()=>{A(I==="large"?"medium":I==="medium"?"small":"large")},sx:{color:"#fff"},children:I==="small"?e.jsx(qt,{}):I==="medium"?e.jsx(Yt,{}):e.jsx(Qt,{})}),_=localStorage.getItem("ppDataExplorerDensity"),[I,A]=i.useState(_==="large"||_==="medium"?_:"small");return i.useEffect(()=>{localStorage.setItem("ppDataExplorerDensity",I)},[I]),u!==""?e.jsx(i.Suspense,{children:e.jsx(Ve,{severity:"error",message:u,close:!1})}):e.jsxs(p,{className:"pp-sub-container-explorer",sx:{width:"100%"},children:[e.jsx(De,{className:"pp-explorer-header",elevation:4,position:"relative",sx:{margin:"0 0 5px 0"},children:e.jsx(Oe,{sx:{display:"grid",gridTemplateColumns:"1fr auto",gap:"12px",justifyContent:"space-between",paddingRight:"0 !important"},children:((v=ut.appOrig)==null?void 0:v.appTarget)==="backend"?e.jsxs(p,{sx:{display:"grid",gridTemplateColumns:"auto auto auto",justifyContent:"end",alignItems:"center",gridGap:"10px"},children:[z(),e.jsx(p,{sx:{textAlign:"right"},children:"Search & Filter"}),e.jsx(ae,{search:o,setSearch:a,addFilter:!0})]}):e.jsxs(p,{sx:{display:"grid",gridTemplateColumns:"auto auto 1fr",justifyContent:"space-between",alignItems:"center",gridGap:"10px"},children:[e.jsx(p,{sx:{fontSize:"18px",lineHeight:"18px",fontWeight:"bold",whiteSpace:"nowrap"},children:"Data Explorer"}),e.jsx(p,{children:F()}),e.jsxs(p,{sx:{display:"grid",gridTemplateColumns:"auto auto",justifyContent:"end",alignItems:"center",gap:"10px"},children:[z(),e.jsx(ae,{search:o,setSearch:a,addFilter:!0})]})]})})}),e.jsx(Za,{}),w&&e.jsx(en,{setCanImport:D}),c==null?e.jsx(p,{sx:{padding:"30px"},children:e.jsx(kt,{title:"Loading..."})}):e.jsxs(e.Fragment,{children:[x!==""&&e.jsx(Me,{sx:{marginBottom:"5px"},elevation:4,children:e.jsx(i.Suspense,{children:e.jsx(Ve,{severity:"error",message:x,close:!0,setClose:()=>{s(xt({error:""}))}})})}),e.jsx(Me,{className:"pp-data-exporer",elevation:4,children:e.jsx(ta,{className:"pp-data-exporer-database-tree pp-density-"+I,"aria-label":"Data Explorer",sx:{display:"grid",gridGap:"0","& li.MuiTreeItem-root:first-of-type li.MuiTreeItem-root:first-of-type":{borderTopLeftRadius:0,borderTopRightRadius:0}},children:Object.keys(c).map(h=>{var M;if(f.includes(y[h])===!1||o!==""&&!he(h,o))return null;const O=((M=y[h])==null?void 0:M.toLocaleLowerCase())==="wp"?h+" (WordPress database)":h;return e.jsx($,{ref:t,slots:{expandIcon:Fe,collapseIcon:W?Fe:Gt},itemId:h,className:"pp-data-exporer-database-tree-item hide-details",onClickCapture:m=>{var d,g,T,k;if((d=m.target.closest("li"))!=null&&d.classList.contains("pp-data-exporer-database-tree-item"))if((g=m.target.closest("li"))!=null&&g.classList.contains("hide-details")?((T=m.target.closest("li"))==null||T.classList.remove("hide-details"),P(!1)):((k=m.target.closest("li"))==null||k.classList.add("hide-details"),P(!0)),r[h])m.stopPropagation();else{const S=r;S[h]=!0,b(S)}},sx:{padding:"0","&:first-of-type":{borderTopLeftRadius:"4px",borderTopRightRadius:"4px",overflow:"hidden"},"&.hide-details > ul":{visibility:"hidden",position:"fixed"}},label:e.jsxs(p,{sx:{display:"grid",gridTemplateColumns:"auto auto",justifyContent:"start",alignItems:"center",gap:"10px"},children:[e.jsx(At,{}),O]}),children:e.jsx(Ya,{dbs:h})},h)})})})]})]})};export{co as default};
