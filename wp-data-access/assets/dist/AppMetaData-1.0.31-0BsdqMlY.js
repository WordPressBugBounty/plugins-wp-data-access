const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./SettingsChart-1.0.31-BIFNVwDD.js","./cm-1.0.31-BzgG35ZX.js","./redux-1.0.31-CuzmJMK6.js","./vendor-1.0.31-BmpNFhoq.js","./cjs-1.0.31-B-_HdexB.js","./Typography-1.0.31-BdhCS1KD.js","./lib-1.0.31-BbX3jq4e.js","./loglevel-1.0.31-BZ7XahX3.js","./lodash-1.0.31-BtCjXqrS.js","./moment-1.0.31-C5S46NFB.js","./iconBase-1.0.31-C37NsRUm.js","./notistack-1.0.31-CuGQWCbt.js","./DefaultChartColors-1.0.31-7Kg_XVnf.js","./RestApi-1.0.31-C4KxgDIV.js","./index-1.0.31-DPuH5k6e.js","./FormHelperText-1.0.31-CQcG9a5q.js","./useFormControl-1.0.31-2YJOQA8g.js","./ToggleButtonGroup-1.0.31-CFN9Fx2p.js","./Menu-1.0.31-BOTBPSPr.js","./AdminTheme-1.0.31-QbwKcRV7.js","./FormLabel-1.0.31-7Vju-x1c.js","./RadioGroup-1.0.31-1v754ceS.js","./Radio-1.0.31-DbEe8Ljo.js","./SwitchBase-1.0.31-AIM_3--O.js","./useControlled-1.0.31-27-LkxG9.js","./createSvgIcon-1.0.31-BC4iq9Gi.js","./Slider-1.0.31-BDZ4XVru.js","./visuallyHidden-1.0.31-Dan1xhjv.js","./Spinner-1.0.31-Be7r01J6.js","./Divider-1.0.31-BWKAGEdz.js","./MenuItem-1.0.31-CTowyoSp.js","./TextField-1.0.31-TtMrk-_t.js","./InputAdornment-1.0.31-DPyTBX7W.js","./Accordion-1.0.31-CHSmI5oX.js","./Collapse-1.0.31-CkBm-DA4.js","./AccordionSummary-1.0.31-DgKGWjRF.js","./AccordionDetails-1.0.31-DX5dPS4j.js","./PremiumFeature-1.0.31-B1Kns6o6.js","./index-1.0.31-C_6FsHsh.js","./FormControlLabel-1.0.31-VNfgE3Oe.js","./Switch-1.0.31-LPOyRUXk.js","./ChartTypes-1.0.31-BPnqCrdo.js","./Autocomplete-1.0.31-DLbMViDM.js","./Close-1.0.31-BTPwVQpD.js","./Popper-1.0.31-QmfursjS.js","./ThemeSettings-1.0.31-DhXG_x5i.js","./useTheme-1.0.31-BXg8i2QZ.js","./index-1.0.31-DboOrfK9.js","./index-1.0.31-C4m7fjwq.js","./Stack-1.0.31-Bz9nXUZB.js","./DialogContent-1.0.31-_6ykng6a.js","./Link-1.0.31-ae0Alyop.js","./CssUnitTextField-1.0.31-DtyzTfQS.js","./ResizableDrawer-1.0.31-Bry8nGEd.js","./useScreenSize-1.0.31-DKas25yF.js","./ThemeContainer-1.0.31-D01zq5BI.js","./main-1.0.31.js","./useStoreTable-1.0.31-CksmwD3u.js","./ActionsDml-1.0.31-DnIQKtBi.js","./dompurify-1.0.31-CCJo14B2.js","./FallbackSpinner-1.0.31-B4qqxHwC.js","./Tooltip-1.0.31-crORCg22.js","./ThemeContainer-1.0.31-DR7D6eET.css"])))=>i.map(i=>d[i]);
import{_ as $}from"./main-1.0.31.js";import{j as e}from"./cm-1.0.31-BzgG35ZX.js";import{b as Ae}from"./ActionsApp-1.0.31-UHtVyR0L.js";import{r as a}from"./redux-1.0.31-CuzmJMK6.js";import{u as K,a as D,R as Ce}from"./RestApi-1.0.31-C4KxgDIV.js";import{l,A as G,am as Te,a2 as ve,a3 as ye,an as _e,S as V,v as Ee,C as le,ao as ce,_ as ke,d as ue,a5 as Me,ap as Pe,aq as ee,ar as Ne,P as Oe,a as te,as as we,a9 as Re,s as Le,at as ze,b as P,au as Be,p as Fe,av as De,aw as Ve,ax as We,ay as $e,az as He}from"./lib-1.0.31-BbX3jq4e.js";import{e as w}from"./notistack-1.0.31-CuGQWCbt.js";import{u as se,S as re,D as Ue}from"./StoreTypeEnum-1.0.31-nL46tw9S.js";import{u as Je,C as Ge}from"./Chart-1.0.31-BJ9n7v4e.js";import{T as U,C as ae,a as oe,b as Ye}from"./ConfirmDialog-1.0.31-bZDmgpd0.js";import{u as qe,g as Ke,c as Xe,B as Qe,a as Ze,T as Ie,b as ne}from"./TabPanel-1.0.31-CQFpWPRX.js";import{e as et,N as tt,A as me,T as he,M as de,B as J}from"./cjs-1.0.31-B-_HdexB.js";import{T as Y,A as ie,a as st}from"./AdminTheme-1.0.31-QbwKcRV7.js";import{d as rt,c as X,B as at,D as Q,R as ot,C as nt,b as it,e as xe,f as pt,a as lt,h as fe,g as ge}from"./useTheme-1.0.31-BXg8i2QZ.js";import{a as ct}from"./ActionsSettings-1.0.31-Cf56Toxs.js";import{B as N,S as W}from"./Spinner-1.0.31-Be7r01J6.js";import{T as ut}from"./Typography-1.0.31-BdhCS1KD.js";import{I as R}from"./iconBase-1.0.31-C37NsRUm.js";import{a as mt,T as pe}from"./Tabs-1.0.31-XRJEidP6.js";import{F as q}from"./FallbackSpinner-1.0.31-B4qqxHwC.js";import ht from"./Alert-1.0.31-CW3F7gbN.js";import{T as be}from"./Tooltip-1.0.31-crORCg22.js";import{M as dt}from"./MenuItem-1.0.31-CTowyoSp.js";import{M as xt}from"./Menu-1.0.31-BOTBPSPr.js";const ft=a.forwardRef(function(r,i){const{children:m,...p}=r,s=qe();if(s===null)throw new TypeError("No TabContext provided");const h=a.Children.map(m,n=>a.isValidElement(n)?a.cloneElement(n,{"aria-controls":Ke(s,n.props.value),id:Xe(s,n.props.value)}):null);return e.jsx(mt,{...p,ref:i,value:s.value,children:h})}),gt=()=>{const t=K(r=>r.appData);return l.debug("appData",t),t},bt=({appRootId:t,appId:r,appDbId:i,isVisible:m,fullScreen:p})=>{const[s,h]=a.useState(!1);return a.useEffect(()=>{m&&!s&&h(!0)},[m]),s?e.jsx(N,{className:"pp-apps-root"+(m?"":" pp-element-hide"),sx:{"& .pp-app-container .pp-component header.pp-header":{margin:0,visibility:"hidden",position:"absolute",left:-99999,top:-99999}},children:e.jsx(Se,{appId:r,appDbId:i,fullScreen:p,appRootId:t})}):null},St=t=>{const r=K(i=>i.appApps[t]!==void 0?i.appApps[t].activeAppId??i.appApps[t].apps[0]:0);return l.debug("activeAppId",r,t),r},jt=t=>{const r=K(i=>i.appData[t]);return l.debug("appData",r),r},At=({appId:t})=>{const r=D(),i=rt(t),m=X(t),p=jt(t);return e.jsx(be,{title:e.jsx(at,{details:i,mode:p==null?void 0:p.mode}),className:"pp-builder-button",children:e.jsx(R,{sx:{color:"inherit",padding:0},onClick:()=>{var s,h;((h=(s=m==null?void 0:m.app)==null?void 0:s.app[0])==null?void 0:h.app_type)==G.CHART?r(Te({appId:t})):(p==null?void 0:p.mode)===Q.FORM?r(ve({appId:t})):r(ye({appId:t}))},children:e.jsx(et,{})})})},Ct=({appDbId:t,appTitle:r,setActiveApp:i,handleClose:m})=>e.jsx(dt,{onClick:()=>{i(t),m()},children:e.jsx("span",{children:r})}),Tt=({apps:t,setActiveApp:r})=>{const[i,m]=a.useState(null),p=!!i,s=n=>{m(n.currentTarget),n.stopPropagation()},h=()=>{m(null)};return e.jsxs(N,{sx:{position:"relative"},children:[e.jsx(R,{sx:{color:"inherit",padding:0},onClick:s,children:e.jsx(tt,{})}),e.jsxs(xt,{anchorEl:i,open:p,onClose:h,anchorOrigin:{vertical:"bottom",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"left"},sx:{marginTop:"8px","& ul":{padding:"0 !important"},"& ul li":{padding:"12px 24px 12px 18px !important"}},children:[...t.apps.map(n=>t.titles[n]===void 0?null:e.jsx(Ct,{appDbId:n,appTitle:t.titles[n],setActiveApp:r,handleClose:h}))]})]})},vt=({appId:t})=>{var c;l.debug(t);const r=D(),i=ot(),m=nt(),p=_e.getSelectors().selectApps(V.getState().appApps,t),s=a.useMemo(()=>{const u={};return Array.isArray(p.apps)&&p.apps.length>0&&p.apps.map(o=>{u[o]=Ee()}),u},[]),h=it(t),n=X(t),T=a.useMemo(()=>{var u,o;return((o=(u=n==null?void 0:n.app)==null?void 0:u.app[0])==null?void 0:o.app_title)!==""?n.app.app[0].app_title:"WP Data Access"},[]),d=St(t),v=u=>{r(Pe({appId:t,activeAppId:u}))};xe(s[d]);const y=pt(s[d]),x=lt(s[d]),S=fe(s[d]),j=ge(S,y,x),[b,k]=a.useState(le.appOrig.appFullscreen===!0);l.debug("appFullScreen",b);const A=gt();a.useEffect(()=>{l.debug("setFullScreen",s,b),Object.keys(s).map(u=>{r(ce({appId:s[Number(u)],property:{fullScreen:b??!1}}))})},[A,b]);const _=((c=A[s[d]])==null?void 0:c.mode)??Q.TABLE;l.debug("mode",_);let M={};const g=()=>null;return p===void 0||Object.keys(s).length===0?e.jsx(W,{}):e.jsx(Y,{theme:j,children:e.jsxs(N,{className:"pp-apps-container",sx:{...b?M:{},"& .pp-element-hide":{visibility:"hidden",position:"absolute",left:-99999,top:-99999}},children:[e.jsx(me,{className:"pp-apps-header",position:"relative",sx:{margin:"0 0 5px 0"},children:e.jsxs(he,{sx:{display:"grid",gridTemplateColumns:"auto auto",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs(N,{sx:{display:"grid",gridTemplateColumns:"auto auto",justifyContent:"space-between",alignItems:"center",gap:"5px","& span":{whiteSpace:"nowrap",fontSize:"18px",lineHeight:"18px",fontWeight:"bold"},"& span.pp-header-title":{minWidth:0,textOverflow:"ellipsis",overflow:"hidden",marginRight:"10px"}},children:[e.jsx("span",{children:e.jsx(Tt,{apps:p,setActiveApp:v})}),e.jsxs("span",{className:"pp-header-title",children:[T," - ",p.titles[d]]})]}),e.jsxs(N,{sx:{display:"flex",gap:"10px",justifyContent:"center",alignItems:"center"},children:[ke(n)&&e.jsx(At,{appId:s[d]}),g(),(n==null?void 0:n.isExploring)&&e.jsx(be,{title:h.close,children:e.jsx(R,{sx:{color:"inherit",padding:0},onClick:()=>{r(ue({isActive:!1,appDbId:0})),m(t),i(t),r(Me({})),Object.keys(s).map(u=>{m(s[u]),i(s[u])})},children:e.jsx(de,{})})})]})]})}),...p.apps.map(u=>e.jsx(bt,{appRootId:t,appId:s[u],appDbId:u,isVisible:u===d,fullScreen:b}))]})})},yt=a.lazy(()=>$(()=>import("./SettingsChart-1.0.31-BIFNVwDD.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44]),import.meta.url)),_t=a.lazy(()=>$(()=>import("./ThemeSettings-1.0.31-DhXG_x5i.js"),__vite__mapDeps([45,1,2,3,13,6,7,8,9,46,47,5,4,10,11,37,38,19,20,16,48,28,15,40,23,24,49,50,26,27,18,39,51,21,22,25,52,31,33,34,35,36]),import.meta.url)),Et=a.lazy(()=>$(()=>import("./ResizableDrawer-1.0.31-Bry8nGEd.js"),__vite__mapDeps([53,1,2,3,54,6,7,8,9,13,5,19,10,4,11,18]),import.meta.url)),kt=({appId:t})=>{var c,u;const r=D(),[i,m]=a.useState(ee.getSelectors().selectChart(V.getState().charts,t));a.useState(Ne.getSelectors().selectThemeById(V.getState().themes,t));const p=xe(t),s=Je(t),[h,n]=a.useState(!1),[T,d]=a.useState(!1),[v,y]=a.useState("1"),x=(o,E)=>{y(E)},S=()=>{r(we({})),n(!1)},j=()=>{h?d(!0):(A(),S())},b=o=>{l.debug(o),r(Re({appId:t,property:o})),n(!0)},k=o=>{r(Le({anchor:o}))},A=()=>{r(ze({appId:t,chartState:i}))},_=()=>{ct(t,o=>{if(l.debug(o),o!=null&&o.code&&(o==null?void 0:o.message)!==void 0)switch(o.code){case"ok":m(ee.getSelectors().selectChart(V.getState().charts,t)),w(o.message,{variant:"success"});break;case"info":w(o.message,{variant:"info"});break;default:l.error(o),w(o.message??P.contactSupport,{variant:"error"})}},o=>{l.error("error",o),w(o??P.contactSupport,{variant:"error"})}),n(!1)},M=()=>{h?(_(),setTimeout(()=>{S()},1e3)):S()},g=((c=ie)==null?void 0:c.palette.mode)===Oe.LIGHT?(u=ie)==null?void 0:u.palette.primary.main:"";return e.jsx(e.Fragment,{children:s&&e.jsxs(e.Fragment,{children:[e.jsx(a.Suspense,{fallback:e.jsx(W,{}),children:e.jsxs(Et,{closeDrawer:j,children:[e.jsx(me,{position:"static",elevation:4,sx:{borderRadius:0},children:e.jsxs(he,{className:"pp-setting-toolbar",sx:{borderRadius:0},children:[e.jsx(ut,{variant:"h5",noWrap:!0,component:"div",className:"unselectable",sx:{flexGrow:1,paddingLeft:"6px"},children:"Chart Builder"}),e.jsx(U,{title:"Dock to left",position:"bottom",children:e.jsx(R,{onClick:()=>{k(te.LEFT)},size:"large",color:"inherit",sx:{fontSize:"1em"},children:e.jsx(Qe,{})})}),e.jsx(U,{title:"Dock to right",position:"bottom",children:e.jsx(R,{onClick:()=>{k(te.RIGHT)},size:"large",color:"inherit",sx:{fontSize:"1em"},children:e.jsx(Ze,{})})}),e.jsx(U,{title:"Close",position:"bottom",children:e.jsx(R,{onClick:j,size:"large",color:"inherit",sx:{fontSize:"1.4em"},children:e.jsx(de,{})})})]})}),e.jsx(ae,{className:"pp-settings-container",children:e.jsx(oe,{sx:{padding:0,margin:0},children:e.jsxs(Ie,{value:v,children:[e.jsxs(ft,{variant:"fullWidth",textColor:"primary",onChange:x,sx:{width:"100%",height:"80px",padding:0,margin:0,backgroundColor:"rgb(242, 242, 242)"},children:[e.jsx(pe,{label:"Chart",value:"1",sx:{fontWeight:"bold",fontSize:"110%",height:"80px"}}),e.jsx(pe,{label:"Theme",value:"2",sx:{fontWeight:"bold",fontSize:"110%",height:"80px"}})]}),e.jsxs(N,{sx:{margin:0,padding:0,overflowX:"hidden",overflowY:"auto",height:"calc(100vh - 250px)","& > div.MuiTabPanel-root":{padding:0}},children:[e.jsx(ne,{value:"1",children:e.jsx(a.Suspense,{fallback:e.jsx(W,{}),children:e.jsx(yt,{appId:t,chartSettings:p,updateSettings:b})})}),e.jsx(ne,{value:"2",children:e.jsx(a.Suspense,{fallback:e.jsx(W,{}),children:e.jsx(_t,{appId:t,source:Q.TABLE,setIsUpdated:n})})})]})]})})}),e.jsx(ae,{className:"pp-setting-footer",sx:{borderRadius:0,backgroundColor:g},children:e.jsxs(oe,{className:"pp-setting-footer-buttons",sx:{borderRadius:0},children:[e.jsx(J,{variant:"outlined",className:"footer_action_button_apply",onClick:_,children:"Apply"}),e.jsx(J,{variant:"outlined",className:"footer_action_button",onClick:M,children:"OK"}),e.jsx(J,{variant:"outlined",className:"footer_action_button",onClick:j,children:"Cancel"})]})})]})}),e.jsx(Ye,{title:"Close Chart Builder?",message:"All uncommitted changes will be lost!",open:T,setOpen:d,onConfirm:()=>{A(),S()},onKeep:()=>{S()}})]})})},Mt=({appId:t,appDbId:r})=>{l.debug(t,r);const i=D(),[m,p]=a.useState(!1),s=X(t),h=fe(),n=ge(h,Fe.table,Be.form),T=a.useMemo(()=>st(),[]),d=x=>{switch(x.substring(0,x.indexOf("(")).toLowerCase()){case"decimal":case"double":case"double precision":case"float":case"real":case"bit":case"tinyint":case"smallint":case"int":case"integer":case"mediumint":case"bigint":return"number";case"time":return"time";case"date":return"date";case"datetime":case"timestamp":return"datetime"}return"text"},v=()=>{Ce(le.appUrlChartData,{app_id:r},x=>{var S,j,b,k,A,_,M,g,c,u,o,E;if(l.debug(x),(x==null?void 0:x.data)!==void 0){if(Array.isArray(x.data)){const L=x.data,z=[];x.explain.map(f=>{f.Type?z.push(d(f.Type)):f.type?z.push(d(f.type)):f.TYPE&&z.push(d(f.TYPE))}),l.debug(z);const O=[],Z=[];Object.keys(L[0]).map(f=>Z.push(f)),O.push(Z);for(let f=0;f<L.length;f++){const H=[];Object.keys(L[f]).map((I,je)=>z[je]==="text"?H.push(L[f][I]):H.push(Number(L[f][I]))),O.push(H)}l.debug(O);let C={};if(((j=(S=s==null?void 0:s.app)==null?void 0:S.app[0])==null?void 0:j.app_theme)!==void 0&&((k=(b=s==null?void 0:s.app)==null?void 0:b.app[0])==null?void 0:k.app_theme)!==null&&((_=(A=s==null?void 0:s.app)==null?void 0:A.app[0])==null?void 0:_.app_theme)!=="")try{C=JSON.parse(s.app.container[0].cnt_chart)}catch(f){l.error("Invalid JSON - theme settings"),l.error(f)}C===!1&&(C={}),l.debug(C);const B=De({},Ve,C);B.data=O,B.majorAxisColumn=O[0][0],B.minorAxisColumns=O[0].slice(1),Array.isArray(C==null?void 0:C.chartTypes)&&C.chartTypes.length>0&&(B.chartType=C.chartTypes[0]),i(We({appId:t,chartState:B}));let F={};if(((g=(M=s==null?void 0:s.app)==null?void 0:M.app[0])==null?void 0:g.app_theme)!==void 0&&((u=(c=s==null?void 0:s.app)==null?void 0:c.app[0])==null?void 0:u.app_theme)!==null&&((E=(o=s==null?void 0:s.app)==null?void 0:o.app[0])==null?void 0:E.app_theme)!=="")try{F=JSON.parse(s.app.app[0].app_theme)}catch(f){l.error("Invalid JSON - theme settings"),l.error(f)}F===!1&&(F={}),l.debug(F),i($e({appId:t,themeState:F})),p(!0)}}else l.error("Error loading chart data")},()=>{l.error("Error loading chart data")})};a.useEffect(()=>{v()},[]);const y=a.useMemo(()=>!0,[]);return m?e.jsxs(e.Fragment,{children:[e.jsx(Y,{theme:n,children:e.jsx(Ge,{appId:t,isBuilderEnabled:y,isToolbarEnabled:!0,isExploring:s==null?void 0:s.isExploring})}),y&&e.jsx(Y,{theme:T,children:e.jsx(kt,{appId:t})})]}):e.jsx(q,{})},Pt=a.lazy(()=>$(()=>import("./ThemeContainer-1.0.31-D01zq5BI.js").then(t=>t.T),__vite__mapDeps([55,1,2,3,56,11,6,7,8,9,13,28,5,19,57,58,46,47,4,10,54,59,60,61,44,24,62]),import.meta.url)),Se=({appId:t,appDbId:r,designMode:i,staticFilter:m,shortcodeArgs:p,fullScreen:s,isExploring:h,appRootId:n})=>{l.debug(t,r,i,m,p,s,h);const T=D(),[d,v]=a.useState(""),[y,x]=a.useState(!1),[S,j]=a.useState(!1),[b,k]=a.useState(!1),{prepareAppStore:A}=se(t,re.APP),{prepareApp:_}=se(t,re.APP);a.useEffect(()=>{y||M()},[r]);const M=()=>{Ae(r,g=>{var u,o;const c=g==null?void 0:g.data;if(l.debug("response data",c),c.app&&c.app.app&&Array.isArray(c.app.app)&&c.app.container&&Array.isArray(c.app.container)&&c.app.apps&&Array.isArray(c.app.apps))if(c.app.app[0].app_type==G.APPCONTAINER)_(c,h),j(!0),x(!0);else if(c.app.app[0].app_type==G.CHART){const E={...c};E.src=Ue(r,(o=(u=c==null?void 0:c.app)==null?void 0:u.container[0])==null?void 0:o.cnt_id),h===!0&&(E.isExploring=!0),n!==void 0&&(E.appRootId=n),T(He({appId:t,metaData:E})),k(!0),x(!0)}else A(r,c,i===!0,void 0,n,()=>{})?(T(ce({appId:t,property:{staticFilter:m,shortcodeArgs:p}})),x(!0)):v(P.contactSupport);else w(P.contactSupport,{variant:"error"}),v(P.contactSupport)},g=>{l.error("error",g),w(g??P.contactSupport,{variant:"error"}),v(g??P.contactSupport)})};return d!==""?e.jsx(a.Suspense,{children:e.jsx(ht,{severity:"error",message:d,close:!0,setClose:()=>{T(ue({isActive:!1,appDbId:0}))}})}):y?S?e.jsx(vt,{appId:t}):b?e.jsx(Mt,{appId:t,appDbId:r}):e.jsx(N,{id:"pp-app-"+t,className:"pp-app-container pp-app-"+r,sx:{[`&#pp-app-${t} .pp-column-search-field ul`]:{marginLeft:0,padding:0},[`&#pp-app-${t} .pp-global-search-field input, &#pp-app-${t} .pp-column-search-field input`]:{boxSizing:"content-box"},[`&#pp-app-${t} .pp-form form input`]:{boxSizing:"content-box"}},children:e.jsx(a.Suspense,{fallback:e.jsx(q,{}),children:e.jsx(Pt,{appId:t})})}):e.jsx(q,{})},ts=Object.freeze(Object.defineProperty({__proto__:null,default:Se},Symbol.toStringTag,{value:"Module"}));export{Se as A,ft as T,ts as a};
