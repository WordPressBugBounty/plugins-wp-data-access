const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./SettingsChart-1.0.32-BsOljVI4.js","./cm-1.0.32-roxymF9V.js","./redux-1.0.32-BsgiH_bG.js","./vendor-1.0.32-BmpNFhoq.js","./cjs-1.0.32-AqZgyPIn.js","./Typography-1.0.32-D9d-UzA0.js","./lib-1.0.32-CBsDffd2.js","./loglevel-1.0.32-BZ7XahX3.js","./lodash-1.0.32-B7VmFneh.js","./moment-1.0.32-C5S46NFB.js","./iconBase-1.0.32-inVKjZEJ.js","./notistack-1.0.32-N2grKTUm.js","./DefaultChartColors-1.0.32-CE4EAOeB.js","./RestApi-1.0.32-Bp_RRidr.js","./index-1.0.32-C02EIL93.js","./FormHelperText-1.0.32-BG3xt4JA.js","./useFormControl-1.0.32-Tf9RtQ-m.js","./ToggleButtonGroup-1.0.32-BmgjhW3x.js","./Menu-1.0.32-CRF2Elfu.js","./AdminTheme-1.0.32-WcjuTcVF.js","./FormLabel-1.0.32-agP5qBoD.js","./RadioGroup-1.0.32-BPYStg8S.js","./Radio-1.0.32-Dg2N7INw.js","./SwitchBase-1.0.32-8MhCpXB3.js","./useControlled-1.0.32-fDn_qfrW.js","./createSvgIcon-1.0.32-DGmABpxr.js","./Slider-1.0.32-C4ittimZ.js","./visuallyHidden-1.0.32-Dan1xhjv.js","./Spinner-1.0.32-D1QL5ry3.js","./Divider-1.0.32-kK3jX0R7.js","./MenuItem-1.0.32-Bc1CXi88.js","./TextField-1.0.32-EUJpMVir.js","./InputAdornment-1.0.32-B4eTRvU4.js","./AccordionSummary-1.0.32-9Jmrvpfq.js","./Collapse-1.0.32-3dNdwtSs.js","./AccordionDetails-1.0.32-DYksa6e-.js","./PremiumFeature-1.0.32-DzBj81Kk.js","./index-1.0.32-wSDMfVDG.js","./FormControlLabel-1.0.32-B7mCGY7x.js","./Switch-1.0.32-BfMlbG-m.js","./ChartTypes-1.0.32-DrYtp9hR.js","./Autocomplete-1.0.32-CC-cYb5n.js","./Close-1.0.32-BV_W41ov.js","./Popper-1.0.32-Dr5x4zRa.js","./ThemeSettings-1.0.32-Ck8NwdcD.js","./useTheme-1.0.32-Boox29T5.js","./index-1.0.32-D6IhVoXv.js","./index-1.0.32-DEU9wnLT.js","./Stack-1.0.32-BKAIHkUk.js","./DialogContent-1.0.32-B0aW5NMk.js","./Link-1.0.32-BLIjMrJd.js","./CssUnitTextField-1.0.32-DMkEfH2_.js","./ResizableDrawer-1.0.32-BHU0VG8c.js","./useScreenSize-1.0.32-ZGgk_gJq.js","./ThemeContainer-1.0.32-DQB7LmiJ.js","./main-1.0.32.js","./useStoreTable-1.0.32-DHfF4DKP.js","./ActionsDml-1.0.32-CqneDSgR.js","./dompurify-1.0.32-CCJo14B2.js","./FallbackSpinner-1.0.32-kTXSQeKF.js","./Tooltip-1.0.32-BFRxm1kH.js","./ThemeContainer-1.0.32-DR7D6eET.css"])))=>i.map(i=>d[i]);
import{_ as $}from"./main-1.0.32.js";import{j as e}from"./cm-1.0.32-roxymF9V.js";import{b as Ae}from"./ActionsApp-1.0.32-CpkxEv_o.js";import{r as a}from"./redux-1.0.32-BsgiH_bG.js";import{u as K,a as D,R as Ce}from"./RestApi-1.0.32-Bp_RRidr.js";import{l as p,A as G,an as Te,a3 as ve,a4 as ye,ao as _e,S as V,v as Ee,C as pe,ap as ce,_ as ke,d as ue,a6 as Me,aq as Pe,ar as ee,as as Ne,P as Oe,a as te,at as we,aa as Re,s as Le,au as ze,b as P,av as Be,p as Fe,aw as De,ax as Ve,ay as We,az as $e,aA as He}from"./lib-1.0.32-CBsDffd2.js";import{e as w}from"./notistack-1.0.32-N2grKTUm.js";import{u as se,S as re,D as Ue}from"./StoreTypeEnum-1.0.32-DZ67pAPg.js";import{u as Je,C as Ge}from"./Chart-1.0.32-D0aR_QQf.js";import{T as U,C as ae,a as ne,b as Ye}from"./ConfirmDialog-1.0.32-A4KvBqFE.js";import{u as qe,g as Ke,c as Xe,B as Qe,a as Ze,T as Ie,b as oe}from"./TabPanel-1.0.32-DFUvt78C.js";import{e as et,N as tt,A as he,T as me,M as de,B as J}from"./cjs-1.0.32-AqZgyPIn.js";import{T as Y,A as ie,a as st}from"./AdminTheme-1.0.32-WcjuTcVF.js";import{d as rt,c as X,B as at,D as Q,R as nt,C as ot,b as it,e as xe,f as lt,a as pt,h as fe,g as ge}from"./useTheme-1.0.32-Boox29T5.js";import{a as ct}from"./ActionsSettings-1.0.32-u1MS6Fmu.js";import{B as N,S as W}from"./Spinner-1.0.32-D1QL5ry3.js";import{T as ut}from"./Typography-1.0.32-D9d-UzA0.js";import{I as R}from"./iconBase-1.0.32-inVKjZEJ.js";import{a as ht,T as le}from"./Tabs-1.0.32-B237JaNe.js";import{F as q}from"./FallbackSpinner-1.0.32-kTXSQeKF.js";import mt from"./Alert-1.0.32-BfuX6f_g.js";import{T as be}from"./Tooltip-1.0.32-BFRxm1kH.js";import{M as dt}from"./MenuItem-1.0.32-Bc1CXi88.js";import{M as xt}from"./Menu-1.0.32-CRF2Elfu.js";const ft=a.forwardRef(function(r,i){const{children:h,...l}=r,s=qe();if(s===null)throw new TypeError("No TabContext provided");const m=a.Children.map(h,o=>a.isValidElement(o)?a.cloneElement(o,{"aria-controls":Ke(s,o.props.value),id:Xe(s,o.props.value)}):null);return e.jsx(ht,{...l,ref:i,value:s.value,children:m})}),gt=()=>{const t=K(r=>r.appData);return p.debug("appData",t),t},bt=({appRootId:t,appId:r,appDbId:i,isVisible:h,fullScreen:l})=>{const[s,m]=a.useState(!1);return a.useEffect(()=>{h&&!s&&m(!0)},[h]),s?e.jsx(N,{className:"pp-apps-root"+(h?"":" pp-element-hide"),sx:{"& .pp-app-container .pp-component header.pp-header":{margin:0,visibility:"hidden",position:"absolute",left:-99999,top:-99999}},children:e.jsx(Se,{appId:r,appDbId:i,fullScreen:l,appRootId:t})}):null},St=t=>{const r=K(i=>i.appApps[t]!==void 0?i.appApps[t].activeAppId??i.appApps[t].apps[0]:0);return p.debug("activeAppId",r,t),r},jt=t=>{const r=K(i=>i.appData[t]);return p.debug("appData",r),r},At=({appId:t})=>{const r=D(),i=rt(t),h=X(t),l=jt(t);return e.jsx(be,{title:e.jsx(at,{details:i,mode:l==null?void 0:l.mode}),className:"pp-builder-button",children:e.jsx(R,{sx:{color:"inherit",padding:0},onClick:()=>{var s,m;((m=(s=h==null?void 0:h.app)==null?void 0:s.app[0])==null?void 0:m.app_type)==G.CHART?r(Te({appId:t})):(l==null?void 0:l.mode)===Q.FORM?r(ve({appId:t})):r(ye({appId:t}))},children:e.jsx(et,{})})})},Ct=({appDbId:t,appTitle:r,setActiveApp:i,handleClose:h})=>e.jsx(dt,{onClick:()=>{i(t),h()},children:e.jsx("span",{children:r})}),Tt=({apps:t,setActiveApp:r})=>{const[i,h]=a.useState(null),l=!!i,s=o=>{h(o.currentTarget),o.stopPropagation()},m=()=>{h(null)};return e.jsxs(N,{sx:{position:"relative"},children:[e.jsx(R,{sx:{color:"inherit",padding:0},onClick:s,children:e.jsx(tt,{})}),e.jsxs(xt,{anchorEl:i,open:l,onClose:m,anchorOrigin:{vertical:"bottom",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"left"},sx:{marginTop:"8px","& ul":{padding:"0 !important"},"& ul li":{padding:"12px 24px 12px 18px !important"}},children:[...t.apps.map(o=>t.titles[o]===void 0?null:e.jsx(Ct,{appDbId:o,appTitle:t.titles[o],setActiveApp:r,handleClose:m}))]})]})},vt=({appId:t})=>{var c;p.debug(t);const r=D(),i=nt(),h=ot(),l=_e.getSelectors().selectApps(V.getState().appApps,t),s=a.useMemo(()=>{const u={};return Array.isArray(l.apps)&&l.apps.length>0&&l.apps.map(n=>{u[n]=Ee()}),u},[]),m=it(t),o=X(t),T=a.useMemo(()=>{var u,n;return((n=(u=o==null?void 0:o.app)==null?void 0:u.app[0])==null?void 0:n.app_title)!==""?o.app.app[0].app_title:"WP Data Access"},[]),d=St(t),v=u=>{r(Pe({appId:t,activeAppId:u}))};xe(s[d]);const y=lt(s[d]),x=pt(s[d]),S=fe(s[d]),j=ge(S,y,x),[b,k]=a.useState(pe.appOrig.appFullscreen===!0);p.debug("appFullScreen",b);const A=gt();a.useEffect(()=>{p.debug("setFullScreen",s,b),Object.keys(s).map(u=>{r(ce({appId:s[Number(u)],property:{fullScreen:b??!1}}))})},[A,b]);const _=((c=A[s[d]])==null?void 0:c.mode)??Q.TABLE;p.debug("mode",_);let M={};const g=()=>null;return l===void 0||Object.keys(s).length===0?e.jsx(W,{}):e.jsx(Y,{theme:j,children:e.jsxs(N,{className:"pp-apps-container",sx:{...b?M:{},"& .pp-element-hide":{visibility:"hidden",position:"absolute",left:-99999,top:-99999}},children:[e.jsx(he,{className:"pp-apps-header",position:"relative",sx:{margin:"0 0 5px 0"},children:e.jsxs(me,{sx:{display:"grid",gridTemplateColumns:"auto auto",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs(N,{sx:{display:"grid",gridTemplateColumns:"auto auto",justifyContent:"space-between",alignItems:"center",gap:"5px","& span":{whiteSpace:"nowrap",fontSize:"18px",lineHeight:"18px",fontWeight:"bold"},"& span.pp-header-title":{minWidth:0,textOverflow:"ellipsis",overflow:"hidden",marginRight:"10px"}},children:[e.jsx("span",{children:e.jsx(Tt,{apps:l,setActiveApp:v})}),e.jsxs("span",{className:"pp-header-title",children:[T," - ",l.titles[d]]})]}),e.jsxs(N,{sx:{display:"flex",gap:"10px",justifyContent:"center",alignItems:"center"},children:[ke(o)&&e.jsx(At,{appId:s[d]}),g(),(o==null?void 0:o.isExploring)&&e.jsx(be,{title:m.close,children:e.jsx(R,{sx:{color:"inherit",padding:0},onClick:()=>{r(ue({isActive:!1,appDbId:0})),h(t),i(t),r(Me({})),Object.keys(s).map(u=>{h(s[u]),i(s[u])})},children:e.jsx(de,{})})})]})]})}),...l.apps.map(u=>e.jsx(bt,{appRootId:t,appId:s[u],appDbId:u,isVisible:u===d,fullScreen:b}))]})})},yt=a.lazy(()=>$(()=>import("./SettingsChart-1.0.32-BsOljVI4.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43]),import.meta.url)),_t=a.lazy(()=>$(()=>import("./ThemeSettings-1.0.32-Ck8NwdcD.js"),__vite__mapDeps([44,1,2,3,13,6,7,8,9,45,46,5,4,10,11,36,37,19,20,16,47,28,15,39,23,24,48,49,26,27,18,38,50,21,22,25,51,31,33,34,35]),import.meta.url)),Et=a.lazy(()=>$(()=>import("./ResizableDrawer-1.0.32-BHU0VG8c.js"),__vite__mapDeps([52,1,2,3,53,6,7,8,9,13,5,19,10,4,11,18]),import.meta.url)),kt=({appId:t})=>{var c,u;const r=D(),[i,h]=a.useState(ee.getSelectors().selectChart(V.getState().charts,t));a.useState(Ne.getSelectors().selectThemeById(V.getState().themes,t));const l=xe(t),s=Je(t),[m,o]=a.useState(!1),[T,d]=a.useState(!1),[v,y]=a.useState("1"),x=(n,E)=>{y(E)},S=()=>{r(we({})),o(!1)},j=()=>{m?d(!0):(A(),S())},b=n=>{p.debug(n),r(Re({appId:t,property:n})),o(!0)},k=n=>{r(Le({anchor:n}))},A=()=>{r(ze({appId:t,chartState:i}))},_=()=>{ct(t,n=>{if(p.debug(n),n!=null&&n.code&&(n==null?void 0:n.message)!==void 0)switch(n.code){case"ok":h(ee.getSelectors().selectChart(V.getState().charts,t)),w(n.message,{variant:"success"});break;case"info":w(n.message,{variant:"info"});break;default:p.error(n),w(n.message??P.contactSupport,{variant:"error"})}},n=>{p.error("error",n),w(n??P.contactSupport,{variant:"error"})}),o(!1)},M=()=>{m?(_(),setTimeout(()=>{S()},1e3)):S()},g=((c=ie)==null?void 0:c.palette.mode)===Oe.LIGHT?(u=ie)==null?void 0:u.palette.primary.main:"";return e.jsx(e.Fragment,{children:s&&e.jsxs(e.Fragment,{children:[e.jsx(a.Suspense,{fallback:e.jsx(W,{}),children:e.jsxs(Et,{closeDrawer:j,children:[e.jsx(he,{position:"static",elevation:4,sx:{borderRadius:0},children:e.jsxs(me,{className:"pp-setting-toolbar",sx:{borderRadius:0},children:[e.jsx(ut,{variant:"h5",noWrap:!0,component:"div",className:"unselectable",sx:{flexGrow:1,paddingLeft:"6px"},children:"Chart Builder"}),e.jsx(U,{title:"Dock to left",position:"bottom",children:e.jsx(R,{onClick:()=>{k(te.LEFT)},size:"large",color:"inherit",sx:{fontSize:"1em"},children:e.jsx(Qe,{})})}),e.jsx(U,{title:"Dock to right",position:"bottom",children:e.jsx(R,{onClick:()=>{k(te.RIGHT)},size:"large",color:"inherit",sx:{fontSize:"1em"},children:e.jsx(Ze,{})})}),e.jsx(U,{title:"Close",position:"bottom",children:e.jsx(R,{onClick:j,size:"large",color:"inherit",sx:{fontSize:"1.4em"},children:e.jsx(de,{})})})]})}),e.jsx(ae,{className:"pp-settings-container",children:e.jsx(ne,{sx:{padding:0,margin:0},children:e.jsxs(Ie,{value:v,children:[e.jsxs(ft,{variant:"fullWidth",textColor:"primary",onChange:x,sx:{width:"100%",height:"80px",padding:0,margin:0,backgroundColor:"rgb(242, 242, 242)"},children:[e.jsx(le,{label:"Chart",value:"1",sx:{fontWeight:"bold",fontSize:"110%",height:"80px"}}),e.jsx(le,{label:"Theme",value:"2",sx:{fontWeight:"bold",fontSize:"110%",height:"80px"}})]}),e.jsxs(N,{sx:{margin:0,padding:0,overflowX:"hidden",overflowY:"auto",height:"calc(100vh - 250px)","& > div.MuiTabPanel-root":{padding:0}},children:[e.jsx(oe,{value:"1",children:e.jsx(a.Suspense,{fallback:e.jsx(W,{}),children:e.jsx(yt,{appId:t,chartSettings:l,updateSettings:b})})}),e.jsx(oe,{value:"2",children:e.jsx(a.Suspense,{fallback:e.jsx(W,{}),children:e.jsx(_t,{appId:t,source:Q.TABLE,setIsUpdated:o})})})]})]})})}),e.jsx(ae,{className:"pp-setting-footer",sx:{borderRadius:0,backgroundColor:g},children:e.jsxs(ne,{className:"pp-setting-footer-buttons",sx:{borderRadius:0},children:[e.jsx(J,{variant:"outlined",className:"footer_action_button_apply",onClick:_,children:"Apply"}),e.jsx(J,{variant:"outlined",className:"footer_action_button",onClick:M,children:"OK"}),e.jsx(J,{variant:"outlined",className:"footer_action_button",onClick:j,children:"Cancel"})]})})]})}),e.jsx(Ye,{title:"Close Chart Builder?",message:"All uncommitted changes will be lost!",open:T,setOpen:d,onConfirm:()=>{A(),S()},onKeep:()=>{S()}})]})})},Mt=({appId:t,appDbId:r})=>{p.debug(t,r);const i=D(),[h,l]=a.useState(!1),s=X(t),m=fe(),o=ge(m,Fe.table,Be.form),T=a.useMemo(()=>st(),[]),d=x=>{switch(x.substring(0,x.indexOf("(")).toLowerCase()){case"decimal":case"double":case"double precision":case"float":case"real":case"bit":case"tinyint":case"smallint":case"int":case"integer":case"mediumint":case"bigint":return"number";case"time":return"time";case"date":return"date";case"datetime":case"timestamp":return"datetime"}return"text"},v=()=>{Ce(pe.appUrlChartData,{app_id:r},x=>{var S,j,b,k,A,_,M,g,c,u,n,E;if(p.debug(x),(x==null?void 0:x.data)!==void 0){if(Array.isArray(x.data)){const L=x.data,z=[];x.explain.map(f=>{f.Type?z.push(d(f.Type)):f.type?z.push(d(f.type)):f.TYPE&&z.push(d(f.TYPE))}),p.debug(z);const O=[],Z=[];Object.keys(L[0]).map(f=>Z.push(f)),O.push(Z);for(let f=0;f<L.length;f++){const H=[];Object.keys(L[f]).map((I,je)=>z[je]==="text"?H.push(L[f][I]):H.push(Number(L[f][I]))),O.push(H)}p.debug(O);let C={};if(((j=(S=s==null?void 0:s.app)==null?void 0:S.container[0])==null?void 0:j.cnt_chart)!==void 0&&((k=(b=s==null?void 0:s.app)==null?void 0:b.container[0])==null?void 0:k.cnt_chart)!==null&&((_=(A=s==null?void 0:s.app)==null?void 0:A.container[0])==null?void 0:_.cnt_chart)!=="")try{C=JSON.parse(s.app.container[0].cnt_chart)}catch(f){p.error("Invalid JSON - chart settings"),p.error(f)}C===!1&&(C={}),p.debug(C);const B=De({},Ve,C);B.data=O,B.majorAxisColumn=O[0][0],B.minorAxisColumns=O[0].slice(1),Array.isArray(C==null?void 0:C.chartTypes)&&C.chartTypes.length>0&&(B.chartType=C.chartTypes[0]),i(We({appId:t,chartState:B}));let F={};if(((g=(M=s==null?void 0:s.app)==null?void 0:M.app[0])==null?void 0:g.app_theme)!==void 0&&((u=(c=s==null?void 0:s.app)==null?void 0:c.app[0])==null?void 0:u.app_theme)!==null&&((E=(n=s==null?void 0:s.app)==null?void 0:n.app[0])==null?void 0:E.app_theme)!=="")try{F=JSON.parse(s.app.app[0].app_theme)}catch(f){p.error("Invalid JSON - theme settings"),p.error(f)}F===!1&&(F={}),p.debug(F),i($e({appId:t,themeState:F})),l(!0)}}else p.error("Error loading chart data")},()=>{p.error("Error loading chart data")})};a.useEffect(()=>{v()},[]);const y=a.useMemo(()=>!0,[]);return h?e.jsxs(e.Fragment,{children:[e.jsx(Y,{theme:o,children:e.jsx(Ge,{appId:t,isBuilderEnabled:y,isToolbarEnabled:!0,isExploring:s==null?void 0:s.isExploring})}),y&&e.jsx(Y,{theme:T,children:e.jsx(kt,{appId:t})})]}):e.jsx(q,{})},Pt=a.lazy(()=>$(()=>import("./ThemeContainer-1.0.32-DQB7LmiJ.js").then(t=>t.T),__vite__mapDeps([54,1,2,3,55,11,6,7,8,9,13,28,5,19,56,57,45,46,4,10,53,58,59,60,43,24,61]),import.meta.url)),Se=({appId:t,appDbId:r,designMode:i,staticFilter:h,shortcodeArgs:l,fullScreen:s,isExploring:m,appRootId:o})=>{p.debug(t,r,i,h,l,s,m);const T=D(),[d,v]=a.useState(""),[y,x]=a.useState(!1),[S,j]=a.useState(!1),[b,k]=a.useState(!1),{prepareAppStore:A}=se(t,re.APP),{prepareApp:_}=se(t,re.APP);a.useEffect(()=>{y||M()},[r]);const M=()=>{Ae(r,g=>{var u,n;const c=g==null?void 0:g.data;if(p.debug("response data",c),c.app&&c.app.app&&Array.isArray(c.app.app)&&c.app.container&&Array.isArray(c.app.container)&&c.app.apps&&Array.isArray(c.app.apps))if(c.app.app[0].app_type==G.APPCONTAINER)_(c,m),j(!0),x(!0);else if(c.app.app[0].app_type==G.CHART){const E={...c};E.src=Ue(r,(n=(u=c==null?void 0:c.app)==null?void 0:u.container[0])==null?void 0:n.cnt_id),m===!0&&(E.isExploring=!0),o!==void 0&&(E.appRootId=o),T(He({appId:t,metaData:E})),k(!0),x(!0)}else A(r,c,i===!0,void 0,o,()=>{})?(T(ce({appId:t,property:{staticFilter:h,shortcodeArgs:l}})),x(!0)):v(P.contactSupport);else w(P.contactSupport,{variant:"error"}),v(P.contactSupport)},g=>{p.error("error",g),w(g??P.contactSupport,{variant:"error"}),v(g??P.contactSupport)})};return d!==""?e.jsx(a.Suspense,{children:e.jsx(mt,{severity:"error",message:d,close:!0,setClose:()=>{T(ue({isActive:!1,appDbId:0}))}})}):y?S?e.jsx(vt,{appId:t}):b?e.jsx(Mt,{appId:t,appDbId:r}):e.jsx(N,{id:"pp-app-"+t,className:"pp-app-container pp-app-"+r,sx:{[`&#pp-app-${t} .pp-column-search-field ul`]:{marginLeft:0,padding:0},[`&#pp-app-${t} .pp-global-search-field input, &#pp-app-${t} .pp-column-search-field input`]:{boxSizing:"content-box"},[`&#pp-app-${t} .pp-form form input`]:{boxSizing:"content-box"}},children:e.jsx(a.Suspense,{fallback:e.jsx(q,{}),children:e.jsx(Pt,{appId:t})})}):e.jsx(q,{})},ts=Object.freeze(Object.defineProperty({__proto__:null,default:Se},Symbol.toStringTag,{value:"Module"}));export{Se as A,ft as T,ts as a};
