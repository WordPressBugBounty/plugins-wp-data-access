const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./TableContainer-1.0.34-BLwrPgAg.js","./cm-1.0.34-jkgb9fqk.js","./redux-1.0.34-BykGtd51.js","./vendor-1.0.34-CN03Eozo.js","./AdminTheme-1.0.34-9phfEwG6.js","./Typography-1.0.34-CPcqRq0L.js","./lib-1.0.34-CKToGW0d.js","./loglevel-1.0.34-BZ7XahX3.js","./lodash-1.0.34-Bq_dBoMp.js","./moment-1.0.34-C5S46NFB.js","./useEnhancedEffect-1.0.34-BO4gRPLZ.js","./main-1.0.34.js","./notistack-1.0.34-CSyPb4yh.js","./tanstack-1.0.34-BsMqwVPV.js","./FallbackSpinner-1.0.34-CVwfde-i.js","./Spinner-1.0.34-Co4td_et.js","./RestApi-1.0.34-BxEfvjo_.js","./ActionsSettings-1.0.34-D8Qcsc97.js","./TargetEnum-1.0.34-DPFnTxiX.js","./ConfirmDialog-1.0.34-DWUfUq0S.js","./iconBase-1.0.34-CNhS-hAm.js","./cjs-1.0.34-s8JVqkTy.js","./DialogContent-1.0.34-BpZCA1LJ.js","./ConfirmDialog-1.0.34--D4jr2go.css","./ScopeEnum-1.0.34-B4DDvIDj.js","./index-1.0.34-BtSBPsUk.js","./TabPanel-1.0.34-CMifEkiN.js","./useTableUpdater-1.0.34-BLO2sgaU.js","./settings-1.0.34-CczHVXWk.js","./Menu-1.0.34-BOIQgOXy.js","./MenuItem-1.0.34-B8z32nyF.js","./settings-1.0.34-Bx2jvYL6.css","./useTheme-1.0.34-Dw3pdMXg.js","./index-1.0.34-DYDf2euy.js","./Row-1.0.34-LFmIHed8.js","./useStoreTable-1.0.34-BdrzT-QA.js","./ActionsDml-1.0.34-JQvmPQlJ.js","./useScreenSize-1.0.34-BKzZJVVv.js","./dompurify-1.0.34-DhD2mIk-.js","./Tooltip-1.0.34-DVgtOKOZ.js","./useControlled-1.0.34-CU9helXh.js","./Popper-1.0.34-DHAHquMb.js","./Alert-1.0.34-DYUt3HUT.js","./AlertTitle-1.0.34-BvvYwV0a.js","./createSvgIcon-1.0.34-oaLYTlaR.js","./Close-1.0.34-Bguo8ejS.js","./Settings-1.0.34-Bs5c_VxC.js","./useFormStore-1.0.34-DKJCi3HA.js","./TableChartDock-1.0.34-cW3T_4Js.js","./Chart-1.0.34-D5cOeU0a.js"])))=>i.map(i=>d[i]);
import{j as t}from"./cm-1.0.34-jkgb9fqk.js";import{_ as ee}from"./main-1.0.34.js";import{r as i}from"./redux-1.0.34-BykGtd51.js";import{l as r,K as L,P as $t,L as mt,v as Gt,M as Jt,N as de,S as I,O as Ee,Q as Qt,T as Ke,U as Ie,V as me,W as Xt,X as ye,Y as Ce,Z as ft,_ as fe,$ as qt,A as Fe,a0 as ge,a1 as gt,b as Zt,a2 as Se,a3 as et,a4 as Kt,a5 as It,d as en,a6 as tn,a7 as nn,a8 as sn,a9 as rn,aa as on}from"./lib-1.0.34-CKToGW0d.js";import{u as te,a as xt}from"./RestApi-1.0.34-BxEfvjo_.js";import{B as M,S as Me}from"./Spinner-1.0.34-Co4td_et.js";import{a as ln,T as ht}from"./AdminTheme-1.0.34-9phfEwG6.js";import{u as we}from"./useStoreTable-1.0.34-BdrzT-QA.js";import{s as an,u as tt,i as nt}from"./ActionsDml-1.0.34-JQvmPQlJ.js";import{e as w}from"./notistack-1.0.34-CSyPb4yh.js";import{u as Oe,a as ke,A as cn,r as un,b as pt,c as he,d as _t,R as dn,C as mn,e as fn,D as J,B as gn,f as xn,g as hn,h as pn}from"./useTheme-1.0.34-Dw3pdMXg.js";import"./moment-1.0.34-C5S46NFB.js";import{G as _n,A as jt,T as bt,H as st,I as rt,B as ie,e as Tt,M as Et,F as jn}from"./cjs-1.0.34-s8JVqkTy.js";import{u as bn}from"./useScreenSize-1.0.34-BKzZJVVv.js";import"./dompurify-1.0.34-DhD2mIk-.js";import{g as Tn}from"./vendor-1.0.34-CN03Eozo.js";import{P as ot,I as ue}from"./iconBase-1.0.34-CNhS-hAm.js";import{F as ve}from"./FallbackSpinner-1.0.34-CVwfde-i.js";import{T as it}from"./Tooltip-1.0.34-DVgtOKOZ.js";const Re=e=>{const o=te(f=>{var a,p;return(p=(a=f.forms[e])==null?void 0:a.state)==null?void 0:p.data});return r.debug("data",o,e),o};var pe=(e=>(e[e.SELECT=0]="SELECT",e[e.INSERT=1]="INSERT",e[e.UPDATE=2]="UPDATE",e[e.DELETE=3]="DELETE",e[e.EXPORT=4]="EXPORT",e[e.IMPORT=5]="IMPORT",e[e.VIEW=6]="VIEW",e))(pe||{});i.lazy(()=>ee(()=>import("./TableContainer-1.0.34-BLwrPgAg.js").then(e=>e.T),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33]),import.meta.url));i.lazy(()=>ee(()=>import("./TableContainer-1.0.34-BLwrPgAg.js").then(e=>e.T),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33]),import.meta.url));const yt=e=>4,En=e=>{const o=te(f=>{var a;return((a=f.forms[e])==null?void 0:a.columns)??[]});return r.debug("storeColumns",o),o},lt=e=>{const o=te(f=>f.forms[e]!==void 0?f.forms[e].columns.filter(a=>a.more).length>0:!1);return r.debug("hasMoreColumns",o),o},yn=e=>{const o=te(f=>{var a,p;return((p=(a=f.forms[e])==null?void 0:a.state)==null?void 0:p.more)??!1});return r.debug("moreState",o),o},vn=e=>{const o=te(f=>{var a,p;return(p=(a=f.forms[e])==null?void 0:a.state)==null?void 0:p.initialData});return r.debug("initialData",o),o},Fn=i.lazy(()=>ee(()=>import("./Row-1.0.34-LFmIHed8.js"),__vite__mapDeps([34,11,1,2,3,12,6,7,8,9,16,32,33,5,21,20,10,15,4,35,36,37,38,14,39,40,41]),import.meta.url)),Sn=({appId:e,metaData:o,primaryKey:f,formMode:a,formUuid:p})=>{var P;r.debug(e,o,f,a,p);const C=ke(),O=Oe(e),j=Re(e),v=vn(e);return t.jsx("form",{id:p,className:"pp-form-content",onSubmit:c=>(c.preventDefault(),!1),children:t.jsx(M,{className:"pp-form-grid",sx:{display:"grid",gridTemplateColumns:{lg:`repeat(${C.cellsPerRow}, 1fr)`,md:"repeat("+Math.min(C.cellsPerRow,2)+", 1fr)",xs:"1fr"},gap:"30px",marginBottom:0,background:C.showGrid?((P=cn)==null?void 0:P.palette.mode)===$t.LIGHT?"repeating-linear-gradient( -45deg, transparent, transparent 10px, #eee 10px, #eee 20px )":"repeating-linear-gradient( -45deg, transparent, transparent 10px, #111 10px, #111 20px )":"","& p.MuiFormHelperText-root":{...a===L.VIEW&&!0&&{display:"none"}}},children:t.jsx(i.Suspense,{fallback:t.jsx(Me,{}),children:t.jsx(Fn,{appId:e,metaData:o,data:j,initialData:v,primaryKey:f,formMode:a,formSettings:C,language:O.language})})})})},Rn=e=>({}),Cn=e=>{const o=te(f=>{var a,p;return((p=(a=f.forms[e])==null?void 0:a.state)==null?void 0:p.m2mUpdate)??!1});return r.debug("m2mUpdate",o),o},Mn=({code:e,safeMode:o,isExpression:f,args:a})=>{const p=mt(e,o,f,a);return window.jQuery&&p instanceof window.jQuery&&p.html(),null};var wn=un();const xe=Tn(wn),at=i.lazy(()=>ee(()=>import("./Alert-1.0.34-DYUt3HUT.js"),__vite__mapDeps([42,1,2,3,25,20,5,6,7,8,9,10,43,44,45]),import.meta.url)),ct=({appId:e,primaryKey:o,formMode:f,showTable:a,showForm:p,detailKey:C,children:O,relationAppId:j,relTab:v,joinTab:m,isEmbedded:P,masterAppId:c,isModal:U})=>{var Ae,He,We,Ye,ze,$e;r.debug(e,o,f,C,j,v,m,P,c,U);const T=xt(),ne=i.useRef(null),Q=En(e),b=pt(e),Y=yt(),V=we(e),A=Rn(),X=Oe(e),[z,$]=i.useState(f),H=i.useMemo(()=>Gt(),[]),[se,G]=i.useState(!1),[q,_e]=i.useState(""),s=he(e),Z=Re(e),u=Jt((Ae=s==null?void 0:s.app)==null?void 0:Ae.container[0]),R=Cn(e),k=he(c??""),le=Re(c??""),ae=_t(e),[je,be]=i.useState(null);i.useEffect(()=>{r.debug(R,e),R===!0&&(r.debug("setM2MUpdate: false"),ce(!1,()=>{},()=>{},()=>{T(Ke({appId:e,update:!1}))}))},[R]),i.useEffect(()=>{o===null?Ft():Object.keys(o).length>0?vt():G(!0)},[o]);const vt=()=>{an(e,o,s==null?void 0:s.media,n=>{if(r.debug(n),(n==null?void 0:n.code)==="ok"){if(Array.isArray(n.data)&&n.data.length>0){const d={...n.data[0]},_={...n.context};delete _.debug,T(Ee({appId:e,data:d,context:_})),n.data.length>1?be("Query returned more than one row. Check configuration."):be(null)}else{const d={...n.context};delete d.debug,T(Ee({appId:e,data:{},context:d})),be("Invalid primary key. Check configuration.")}G(!0)}else w(b.invalidResponse,{variant:"error"})},n=>{r.error("error",n),_e(n??b.invalidResponse)},!1,v)},Ft=()=>{var n,d;if(s.columns&&Array.isArray(s.columns)){const _={},y=de.getSelectors().selectFormColumns(I.getState().forms,e),l=Object.fromEntries(y.map(h=>[h.columnName,h.defaultValue]));r.debug("defaultValues",l);for(let h=0;h<s.columns.length;h++)_[s.columns[h].column_name]=null,l[s.columns[h].column_name]!==void 0&&(l[s.columns[h].column_name]==="@wpda_wp_user_id"?_[s.columns[h].column_name]=(d=(n=s==null?void 0:s.settings)==null?void 0:n.env)==null?void 0:d.id:l[s.columns[h].column_name]==="@now"?s.columns[h]==="date"?_[s.columns[h].column_name]=xe(Date.now()).format("YYYY-MM-DD"):_[s.columns[h].column_name]=xe(Date.now()).format("YYYY-MM-DD HH:mm:ss"):s.columns[h].column_default!==null&&s.columns[h].column_default!=="NULL"&&s.columns[h].column_default!==""?s.columns[h].column_default==="CURRENT_TIMESTAMP"?s.columns[h]==="date"?_[s.columns[h].column_name]=xe(Date.now()).format("YYYY-MM-DD"):_[s.columns[h].column_name]=xe(Date.now()).format("YYYY-MM-DD HH:mm:ss"):_[s.columns[h].column_name]=s.columns[h].column_default:_[s.columns[h].column_name]=l[s.columns[h].column_name]);r.debug(_),T(Ee({appId:e,data:_,context:{media:{}}})),r.debug("init"),G(!0)}},Ne=()=>{let n="";for(const d in s.columns)s.columns[d].extra==="auto_increment"&&(n=s.columns[d].column_name);return r.debug(n),n},Le=n=>{var h;const d=(h=de.getSelectors().selectFormState(I.getState().forms,e))==null?void 0:h.validation;r.debug("rowValidation",d);let _=!1;for(const g in d)if(d[g].error===!0&&d[g].type===me.COLUMN){_=!0;break}if(_)return r.debug("validateForm returned errors"),!1;let y=!0;const l=Ne();for(const g in n){const x=Xt(s,g);let F=!0;x.column_name!==l&&x.is_nullable==="NO"&&(n[g]===null||n[g]==="")&&(f===L.UPDATE||f===L.INSERT&&(x.column_default===null||x.column_default==="NULL"||x.column_default==="")||Nt.preserveSpacesOnUpdate===!1&&n[g]==="")&&(T(ye({appId:e,columnName:g,columnError:!0,columnText:b.mandatoryField,columnType:me.FORM})),F=!1,y=!1);const S=de.getSelectors().selectFormColumns(I.getState().forms,e);let B;for(let E=0;E<S.length;E++)S[E].columnName===g&&(B=S[E]);if(r.debug(B),F&&x.data_type==="time"){const E=n[g];if(E.length===6){let D=E.substring(2,3),N=E.substring(4,5);(Number(D)>5||Number(N)>5)&&(T(ye({appId:e,columnName:g,columnError:!0,columnText:b.mandatoryField,columnType:me.FORM})),F=!1,y=!1)}}F&&T(ye({appId:e,columnName:g,columnError:!1,columnText:"",columnType:me.FORM}))}return y},ce=(n,d,_,y)=>{var h;const l=(h=de.getSelectors().selectFormState(I.getState().forms,e))==null?void 0:h.data;if(r.debug(l),Le(l)){if(o!==null){const g={};Object.keys(l).map(x=>{Q.map(F=>{x===F.columnName&&F.updatable&&(g[x]=l[x])})}),r.debug(g),tt(e,o,g,x=>{var F;if(r.debug(x),x!=null&&x.code&&(x!=null&&x.message))switch(x.code){case"ok":w(b.updatedSuccessful,{variant:"success"}),((F=x.context)==null?void 0:F.updated)!==void 0&&Object.keys(x.context.updated).map(S=>{T(et({appId:e,columnName:S,columnValue:x.context.updated[S]}))}),n&&(d!==void 0&&d(o),setTimeout(()=>{a(!0,j)},1e3)),y&&y();break;case"info":w(b.nothingToUpdate,{variant:"info"}),n&&(d!==void 0&&d(o),setTimeout(()=>{a(!0,j)},1e3)),y&&y();break;default:r.error(x),w(x.message??b.invalidResponse,{variant:"error"}),n&&a(!0,j)}else r.error(x),w(b.invalidResponse,{variant:"error"})},x=>{r.error("error",x),w(x??b.invalidResponse,{variant:"error"})},!1,m,v)}else T(Qt({appId:e,property:{isRowCountUpdated:!0}})),nt(e,l,g=>{if(r.debug(g),g!=null&&g.code&&(g!=null&&g.message)){let x;const F={};switch(g.code){case"ok":w(b.insertSuccessful,{variant:"success"}),x=Ne();for(let S=0;S<s.primary_key.length;S++){const B=Kt(s,s.primary_key[S]);let E;B!==void 0&&(E=s==null?void 0:s.columns[B]),x!==""&&x===(E==null?void 0:E.column_name)?F[s.primary_key[S]]=g.context.insert_id:F[s.primary_key[S]]=l[s.primary_key[S]]}if((u==null?void 0:u.cardinality)===ge.ONE_TO_ONE){const S={};k!=null&&k.primary_key&&Array.isArray(k==null?void 0:k.primary_key)&&(k==null||k.primary_key.map(E=>S[E]=le[E]));const B={};if(u.join_condition!==void 0){const E=u.join_condition.split(",");for(let D=0;D<E.length;D++){const N=E[D].split("=");N.length===2&&(B[N[0]]=F[N[1]])}}tt(e,S,B,()=>{Object.keys(le).map(E=>{if(u.join_condition!==void 0){const D=u.join_condition.split(",");for(let N=0;N<D.length;N++){const oe=D[N].split("=");oe.length===2&&oe[0]===E&&T(et({appId:c,columnName:E,columnValue:Z[oe[1]]}))}}})},()=>{})}if(n){d!==void 0&&d(F),a(!0,j);return}p(F,pe.UPDATE),_&&_(),y&&y();break;default:r.error(g),w(g.message??b.invalidResponse,{variant:"error"})}}else r.error(g),w(b.invalidResponse,{variant:"error"})},g=>{r.error("error",g),w(g??b.invalidResponse,{variant:"error"})},!1,m,v);r.debug(j),j!==void 0&&(r.debug("setM2MUpdate: true"),T(Ke({appId:j,update:!0})))}else r.error("Validate failed: ",l)},St=()=>je===null?null:t.jsx(i.Suspense,{children:t.jsx(M,{sx:{marginTop:"30px"},children:t.jsx(at,{severity:"error",message:je,close:!1})})}),Rt=n=>{if(n!==null&&Le(Z)){const d=Se.getSelectors().selectTableById(I.getState().tables,e),_=d.state.relation.relation_join_condition.split(",").map(l=>l.split("=")),y={...d.state.detailKey};_.map(l=>{y[l[0]]=n[l[1]]}),nt(e,y,l=>{if(r.debug(l),l!=null&&l.code&&(l!=null&&l.message))switch(l.code){case"ok":r.debug("Added relation to join table",l);break;default:r.error(l),w(l.message??b.invalidResponse,{variant:"error"})}else r.error(l),w(b.invalidResponse,{variant:"error"})},l=>{r.error(l),w(l??b.invalidResponse,{variant:"error"})},!1,!0,!1)}},[Ct,Mt]=i.useState(void 0),wt=()=>{try{ce(!1,()=>{},()=>{var d,_,y,l,h,g,x,F,S,B,E,D,N,oe,Ge,Je,Qe,Xe,qe,Ze;const n=JSON.parse((_=(d=s==null?void 0:s.app)==null?void 0:d.app[0])==null?void 0:_.app_settings);if(r.debug(n),((l=(y=n==null?void 0:n.settings)==null?void 0:y.app_registration)==null?void 0:l.showMessage)===!0&&((g=(h=n==null?void 0:n.settings)==null?void 0:h.app_registration)==null?void 0:g.message)!==void 0&&((F=(x=n==null?void 0:n.settings)==null?void 0:x.app_registration)==null?void 0:F.message)!==null&&((B=(S=n==null?void 0:n.settings)==null?void 0:S.app_registration)==null?void 0:B.message.trim())!==""&&Mt((D=(E=n==null?void 0:n.settings)==null?void 0:E.app_registration)==null?void 0:D.message),((oe=(N=n==null?void 0:n.settings)==null?void 0:N.app_registration)==null?void 0:oe.allowUpdates)!==!0&&($(L.VIEW),((Je=(Ge=n==null?void 0:n.settings)==null?void 0:Ge.app_registration)==null?void 0:Je.showUrl)===!0&&((Xe=(Qe=n==null?void 0:n.settings)==null?void 0:Qe.app_registration)==null?void 0:Xe.url)!=="")){const zt=((Ze=(qe=n==null?void 0:n.settings)==null?void 0:qe.app_registration)==null?void 0:Ze.urlTime)??3;setTimeout(()=>{window.location.href=n.settings.app_registration.url},zt)}})}catch(n){r.error("Invalid JSON - app settings"),r.error(n),w(Zt.contactSupport,{variant:"error"})}},Ot=()=>{ce(!1)},kt=()=>{var d,_,y;const n=Se.getSelectors().selectTableById(I.getState().tables,e);r.debug((d=n==null?void 0:n.state)==null?void 0:d.relation),((y=(_=n==null?void 0:n.state)==null?void 0:_.relation)==null?void 0:y.cardinality)===ge.MANY_TO_MANY?ce(!0,Rt):ce(!0)},Te=()=>{a(!0,j)},Nt=ke(),Lt=lt(e),Pt=lt(j??""),K=yn(e),W=i.useRef(null),Ut=bn(),[re,Vt]=i.useState((He=W==null?void 0:W.current)==null?void 0:He.offsetWidth),[Bt,Dt]=i.useState({paddingTop:"50px",paddingBottom:"50px",paddingLeft:"50px",paddingRight:"50px"}),[At,Pe]=i.useState("30px"),[Ht,Ue]=i.useState("");if(i.useEffect(()=>{if(W.current!==null){Vt(W.current.offsetWidth);let n=re<600?.3:re<900?.6:1;(U??!1)===!0&&(n=1),Dt({paddingTop:`calc(${n} * 50px)`,paddingBottom:`calc(${n} * 50px)`,paddingLeft:`calc(${n} * 50px)`,paddingRight:`calc(${n} * 50px)`}),re<600?(Pe("10px"),Ue("10px")):re<900&&(Pe("20px"),Ue("20px"))}},[Ut.width,W.current]),q!=="")return t.jsx(i.Suspense,{children:t.jsx(at,{severity:"error",message:q,close:!1})});const Ve=()=>t.jsx(Sn,{appId:e,metaData:s,primaryKey:o,formMode:z,formUuid:H}),Wt=()=>t.jsxs(t.Fragment,{children:[t.jsx(ue,{color:"inherit",onClick:()=>{const n={appId:e};r.info(u),u!=null&&(n.hideThemeSettings=!0),j!==void 0&&(n.isRelationForm=!0),T(gt(n))},children:t.jsx(Tt,{})}),t.jsx(ue,{color:"inherit",onClick:()=>{Te()},children:t.jsx(Et,{})})]}),Yt=i.useMemo(()=>{var n,d,_,y,l;return(n=s==null?void 0:s.src)!=null&&n.app_id&&((_=(d=s==null?void 0:s.app)==null?void 0:d.app[0])==null?void 0:_.app_title)!==""?s.app.app[0].app_title:(y=s==null?void 0:s.src)!=null&&y.dbs&&((l=s==null?void 0:s.src)!=null&&l.tbl)?s.src.dbs+" - "+s.src.tbl:"WP Data Access"},[]),Be=(((Ye=(We=V==null?void 0:V.table)==null?void 0:We.modal)==null?void 0:Ye.maxHeight)??95)+((($e=(ze=V==null?void 0:V.table)==null?void 0:ze.modal)==null?void 0:$e.maxHeightUnit)??"vh"),De=()=>{var n,d;return t.jsxs(ot,{elevation:Y,ref:ne,children:[(U??!1)===!0&&t.jsx(jt,{sx:{position:"unset",borderBottomRightRadius:0,borderBottomLeftRadius:0,boxShadow:"none"},children:t.jsxs(bt,{sx:{display:"grid",gridTemplateColumns:"auto auto",justifyContent:"space-between",alignItems:"center"},children:[t.jsx(M,{sx:{display:"flex",alignItems:"center",cursor:"move",gap:"2px","& svg":{width:"2em",height:"2em"}},id:Ie(s,"title"),children:t.jsx(M,{sx:{display:"block",whiteSpace:"nowrap",fontSize:"18px",lineHeight:"18px",fontWeight:"bold",textOverflow:"ellipsis",overflow:"hidden",marginRight:"10px"},children:Yt})}),t.jsx(M,{children:(U??!1)===!0&&Ce(s)&&t.jsx(t.Fragment,{children:Wt()})})]})}),t.jsxs(M,{style:Bt,sx:{...(U??!1)===!0&&ae!==void 0&&{maxHeight:`calc(${Be} - 240px)`,overflow:"auto",backgroundColor:"transparent",border:"none",borderRadius:0}},children:[t.jsxs(M,{sx:{margin:0,padding:"5px 0",...(U??!1)===!0&&ae===void 0&&{maxHeight:`calc(${Be} - 240px)`,overflow:"auto"}},children:[Ve(),O,St()]}),t.jsxs(M,{sx:{marginTop:{marginTop:At},paddingRight:{paddingRight:Ht},padding:0,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[t.jsxs(M,{sx:{display:"flex",gap:"8px"},children:[!1,(Lt||Pt)&&t.jsx(t.Fragment,{children:re<600?t.jsx(ue,{color:"primary",onClick:()=>{T(fe({appId:e,more:!K})),j!==void 0&&T(fe({appId:j,more:!K}))},children:K?t.jsx(st,{}):t.jsx(rt,{})}):t.jsx(ie,{variant:"outlined",startIcon:K?t.jsx(st,{}):t.jsx(rt,{}),onClick:()=>{T(fe({appId:e,more:!K})),j!==void 0&&T(fe({appId:j,more:!K}))},children:K?b.less:b.more})}),(A==null?void 0:A.customActionsBottom)!==void 0&&ft(s)&&t.jsx(t.Fragment,{children:t.jsx(Mn,{code:A.customActionsBottom.code??"",safeMode:X.safeMode,isExpression:!1,args:{log:r,row:Z,mode:qt[f]}})}),t.jsx(M,{className:"pp-registration-form-message",children:Ct})]}),t.jsx(M,{sx:{...re<600&&{marginLeft:"0 !important","& button":{marginLeft:"2px",padding:"6px"}}},children:f!==L.VIEW?t.jsx(t.Fragment,{children:((d=(n=s==null?void 0:s.app)==null?void 0:n.app[0])==null?void 0:d.app_type)==Fe.REGISTRATION&&V.state.masterDetailConditions===void 0?t.jsx(t.Fragment,{children:(z===L.INSERT||z===L.UPDATE)&&t.jsx(ie,{variant:"contained",onClick:wt,type:"submit",form:H,sx:{marginLeft:"8px"},children:b.ok})}):t.jsxs(t.Fragment,{children:[t.jsx(ie,{variant:"contained",onClick:Ot,type:"submit",form:H,disabled:je!==null,children:b.apply}),(u==null?void 0:u.cardinality)!==ge.ONE_TO_ONE&&t.jsxs(t.Fragment,{children:[t.jsx(ie,{variant:"outlined",onClick:kt,sx:{marginLeft:"8px"},children:b.ok}),t.jsx(ie,{variant:"outlined",onClick:Te,sx:{marginLeft:"8px"},children:b.cancel})]})]})}):t.jsx(t.Fragment,{children:(u==null?void 0:u.cardinality)!==ge.ONE_TO_ONE&&t.jsx(ie,{variant:"contained",onClick:Te,children:b.back})})})]}),t.jsx(t.Fragment,{children:!1})]})]})};return P?Ve():(i.useEffect(()=>{var n;W.current!==null&&((n=window.document.getElementById(`pp-app-${e}`))==null||n.scrollIntoView())},[W.current]),t.jsx("div",{className:`${e}_wrapper pp-form`,ref:W,style:{scrollMarginTop:"70px"},children:se&&Z!==null?t.jsx(t.Fragment,{children:(U??!1)===!0?t.jsx(t.Fragment,{children:t.jsx(_n,{handle:"#"+Ie(s,"title"),nodeRef:ne,offsetParent:document.body,children:De()})}):t.jsx(t.Fragment,{children:De()})}):t.jsx(ot,{style:{padding:"50px"},elevation:Y,children:t.jsx(Me,{title:b.loadingData})})}))},On=i.lazy(()=>ee(()=>import("./Settings-1.0.34-Bs5c_VxC.js"),__vite__mapDeps([46,11,1,2,3,12,6,7,8,9,16,4,5,10,17,18,24,19,20,21,22,23,25,26,47,15,28,29,30,31,32,33]),import.meta.url)),ut=({appId:e,primaryKey:o,formMode:f,showTable:a,showForm:p,metaData:C,detailKey:O,selectionForm:j,masterAppId:v})=>{r.debug(e,o,f,C,O,j,v);const m=ln(),c=we(e).table;r.debug("relationship",null);const T=i.useMemo(()=>{},[]);r.debug("relationAppId",T);const ne=()=>null,Q=()=>null,b=()=>null,Y=()=>{var A,X,z,$,H,se,G,q;return t.jsx(jn,{open:!0,className:"pp-form-modal",sx:{zIndex:9999990},children:t.jsx(M,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",minWidth:(((A=c==null?void 0:c.modal)==null?void 0:A.minWidth)??60)+(((X=c==null?void 0:c.modal)==null?void 0:X.minWidthUnit)??"vw"),maxWidth:(((z=c==null?void 0:c.modal)==null?void 0:z.maxWidth)??90)+((($=c==null?void 0:c.modal)==null?void 0:$.maxWidthUnit)??"vw"),minHeight:(((H=c==null?void 0:c.modal)==null?void 0:H.minHeight)??0)+(((se=c==null?void 0:c.modal)==null?void 0:se.minHeightUnit)??"vh"),maxHeight:(((G=c==null?void 0:c.modal)==null?void 0:G.maxHeight)??95)+(((q=c==null?void 0:c.modal)==null?void 0:q.maxHeightUnit)??"vh"),backgroundColor:"transparent"},children:t.jsx(ct,{appId:e,primaryKey:o,formMode:f,showTable:a,showForm:p,detailKey:O,relationAppId:T,masterAppId:v,isModal:!0,children:Q()})})})},V=()=>t.jsx(ct,{appId:e,primaryKey:o,formMode:f,showTable:a,showForm:p,detailKey:O,relationAppId:T,masterAppId:v,children:Q()});return t.jsxs(t.Fragment,{children:[j===!0?t.jsx(t.Fragment,{children:ne()}):t.jsx(t.Fragment,{children:c.formModal===!0?t.jsx(t.Fragment,{children:Y()}):t.jsx(t.Fragment,{children:V()})}),t.jsx(t.Fragment,{children:Ce(C)&&t.jsx(ht,{theme:m,children:t.jsx(i.Suspense,{fallback:t.jsx(Me,{}),children:t.jsx(On,{appId:e})})})}),b()]})},kn=e=>{const o=te(f=>{var a,p;return((p=(a=f.tables[e])==null?void 0:a.state)==null?void 0:p.fullScreen)??!1});return r.debug("fullScreen",o),o},Nn=i.lazy(()=>ee(()=>import("./TableContainer-1.0.34-BLwrPgAg.js").then(e=>e.T),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33]),import.meta.url));i.lazy(()=>ee(()=>import("./TableChartDock-1.0.34-cW3T_4Js.js"),__vite__mapDeps([48,1,2,3,49,11,12,6,7,8,9,32,16,33,5,21,20,10,15,39,4,40,41]),import.meta.url));const dt=({appId:e})=>{var s,Z;r.debug(e);const o=xt(),f=dn(),a=mn(),p=yt(),C=_t(e);fn(e),we(e).table;const j=pt(e),v="pp-remove-body-vertical-scrollbar",m=he(e),P=i.useMemo(()=>{var u,R,k,le,ae;return(u=m==null?void 0:m.src)!=null&&u.app_id&&((k=(R=m==null?void 0:m.app)==null?void 0:R.app[0])==null?void 0:k.app_title)!==""?m.app.app[0].app_title:(le=m==null?void 0:m.src)!=null&&le.dbs&&((ae=m==null?void 0:m.src)!=null&&ae.tbl)?m.src.dbs+" - "+m.src.tbl:"WP Data Access"},[]),c=kn(e);i.useEffect(()=>(r.debug(c),()=>{var u;(u=window.document.getElementById(v))==null||u.remove(),window.document.body.classList.remove("pp-fullscreen")}),[c]);const U=i.useMemo(()=>Se.getSelectors().selectTableExploring(I.getState().tables,e),[e]);r.debug("tableExploring",U);const[T,ne]=i.useState(((Z=(s=m==null?void 0:m.app)==null?void 0:s.app[0])==null?void 0:Z.app_type)==Fe.REGISTRATION?J.FORM:J.TABLE),[Q,b]=i.useState(!1),Y=u=>{o(sn({appId:e,mode:u})),ne(u)};i.useEffect(()=>{window.ppShowForm=function(u){r.debug(u),X(u),Y(J.FORM)}},[e]);const V=(u,R)=>{r.debug(u,R),rn(e)&&(a(e),R!==void 0&&(f(R),a(R))),u&&b(!Q),Y(J.TABLE)},[A,X]=i.useState(null),[z,$]=i.useState(L.VIEW),H=(u,R)=>{switch(r.debug(u,R),R){case pe.INSERT:$(L.INSERT);break;case pe.UPDATE:$(L.UPDATE);break;default:$(L.VIEW)}X(u),Y(J.FORM)};let se={};Oe(e);const G=()=>null,q=()=>t.jsx(i.Suspense,{fallback:t.jsx(ve,{title:j.loadingForm}),children:t.jsx(ut,{appId:e,primaryKey:A,formMode:L.INSERT,showTable:()=>{},showForm:H,metaData:m})}),_e=()=>{var u,R;return((R=(u=m==null?void 0:m.app)==null?void 0:u.app[0])==null?void 0:R.app_type)==Fe.REGISTRATION?q():t.jsxs(t.Fragment,{children:[t.jsxs(i.Suspense,{fallback:t.jsx(ve,{title:j.loadingTable}),children:[!1,t.jsx(Nn,{appId:e,display:T===J.TABLE,refresh:Q,showForm:H,metaData:m}),!1]}),T===J.FORM&&t.jsx(i.Suspense,{fallback:t.jsx(ve,{title:j.loadingForm}),children:t.jsx(ut,{appId:e,primaryKey:A,formMode:z,showTable:V,showForm:H,metaData:m})})]})};return t.jsxs(M,{className:"pp-component",sx:c?se:{},children:[t.jsx(jt,{className:"pp-header",elevation:p,position:"relative",sx:{margin:"0 0 5px 0"},children:t.jsxs(bt,{sx:{display:"grid",gridTemplateColumns:"auto auto",justifyContent:"space-between",alignItems:"center"},children:[t.jsx(M,{sx:{display:"block",whiteSpace:"nowrap",fontSize:"18px",lineHeight:"18px",fontWeight:"bold",textOverflow:"ellipsis",overflow:"hidden",marginRight:"10px"},children:P}),t.jsxs(M,{sx:{display:"flex",gap:"10px",justifyContent:"center",alignItems:"center"},children:[Ce(m)&&t.jsx(it,{title:t.jsx(gn,{details:C,mode:T}),className:"pp-builder-button",children:t.jsx(ue,{sx:{color:"inherit",padding:0},onClick:()=>{T===J.FORM?o(gt({appId:e})):o(It({appId:e}))},children:t.jsx(Tt,{})})}),G(),U&&t.jsx(it,{title:j.close,children:t.jsx(ue,{sx:{color:"inherit",padding:0},onClick:()=>{var u;(u=window.document.getElementById(v))==null||u.remove(),window.document.body.classList.remove("pp-fullscreen"),m.src.app_id?o(en({isActive:!1,appDbId:0})):o(tn({})),a(e),f(e),o(nn({}))},children:t.jsx(Et,{})})})]})]})}),_e()]})},Ln=e=>({}),Pn=({appId:e})=>{r.debug(e);const o=xn(e),f=ke(),a=pn(),p=he(e);let C;p.appRootId===void 0&&(C=hn(a,o,f));const O=Ln(),j=`pp-global-code-${e}`;return i.useEffect(()=>{r.debug("open app")},[]),i.useEffect(()=>()=>{var v;r.debug("close app"),mt(((v=O.onAppClose)==null?void 0:v.code)??"",on(p),!1)},[]),i.useEffect(()=>{var v,m,P;if(O!==void 0&&ft(p)){(v=window.document.getElementById(j))==null||v.remove();const c=window.document.createElement("script");c.id=j,c.innerHTML=((m=O.global)==null?void 0:m.code)??"",(P=window.document.getElementById(`pp-app-${e}`))==null||P.appendChild(c)}},[O]),C!==void 0?t.jsx(ht,{theme:C,children:t.jsx(dt,{appId:e})}):t.jsx(dt,{appId:e})},ts=Object.freeze(Object.defineProperty({__proto__:null,default:Pn},Symbol.toStringTag,{value:"Module"}));export{pe as R,ts as T,yn as a,kn as b,yt as c,Ln as d,Rn as e,Re as f,xe as g,En as u};
